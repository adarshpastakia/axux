"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[5007],{"./node_modules/@arcgis/core/arcade/functions/featuresetbase.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{registerFunctions:()=>ee});var _ArcadePortal_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/arcade/ArcadePortal.js"),_Dictionary_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/arcade/Dictionary.js"),_executionError_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/arcade/executionError.js"),_Feature_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/arcade/Feature.js"),_featureSetCollection_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureSetCollection.js"),_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureSetUtils.js"),_ImmutableArray_js__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("./node_modules/@arcgis/core/arcade/ImmutableArray.js"),_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/chunks/languageUtils.js"),_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureset/actions/Adapted.js"),_featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureset/actions/AttributeFilter.js"),_featureset_actions_OrderBy_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureset/actions/OrderBy.js"),_featureset_actions_Top_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureset/actions/Top.js"),_featureset_sources_Empty_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureset/sources/Empty.js"),_featureset_sources_FeatureLayerMemory_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerMemory.js"),_featureset_support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureset/support/OrderbyClause.js"),_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureset/support/shared.js"),_featureset_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js"),_fieldStats_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@arcgis/core/arcade/functions/fieldStats.js"),_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/@arcgis/core/core/sql/WhereClause.js"),_layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./node_modules/@arcgis/core/layers/FeatureLayer.js"),_layers_support_Field_js__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./node_modules/@arcgis/core/layers/support/Field.js");async function V(e,t,n){const i=e.getVariables();if(i.length>0){const a=[];for(let e=0;e<i.length;e++){const r={name:i[e]};a.push(await t.evaluateIdentifier(n,r))}const r={};for(let e=0;e<i.length;e++)r[i[e]]=a[e];return e.parameters=r,e}return e}function q(e,t,n=null){for(const i in e)if(i.toLowerCase()===t.toLowerCase())return e[i];return n}function K(e){if(null===e)return null;const t={type:q(e,"type",""),name:q(e,"name","")};if("range"===t.type)t.range=q(e,"range",[]);else{t.codedValues=[];for(const n of q(e,"codedValues",[]))t.codedValues.push({name:q(n,"name",""),code:q(n,"code",null)})}return t}function X(e){if(null===e)return null;const t={},n=q(e,"wkt",null);null!==n&&(t.wkt=n);const i=q(e,"wkid",null);return null!==i&&(t.wkid=i),t}function Y(e){if(null===e)return null;const t={hasZ:q(e,"hasz",!1),hasM:q(e,"hasm",!1)},n=q(e,"spatialreference",null);n&&(t.spatialReference=X(n));const i=q(e,"x",null);if(null!==i)return t.x=i,t.y=q(e,"y",null),t;const a=q(e,"rings",null);if(null!==a)return t.rings=a,t;const r=q(e,"paths",null);if(null!==r)return t.paths=r,t;const s=q(e,"points",null);if(null!==s)return t.points=s,t;for(const o of["xmin","xmax","ymin","ymax","zmin","zmax","mmin","mmax"]){const n=q(e,o,null);null!==n&&(t[o]=n)}return t}function ee(G){"async"===G.mode&&(G.functions.getuser=function(a,r){return G.standardFunctionAsync(a,r,(async(l,f,c)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(c,0,2,a,r);let u=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(c[1],""),d=!0===u;if(u=!0===u||!1===u?"":(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(u),0===c.length||c[0]instanceof _ArcadePortal_js__WEBPACK_IMPORTED_MODULE_0__.Z){let e=null;a.services&&a.services.portal&&(e=a.services.portal),c.length>0&&(e=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.getPortal)(c[0],e));const n=await(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.lookupUser)(e,u,d);if(n){const e=JSON.parse(JSON.stringify(n));for(const t of["lastLogin","created","modified"])void 0!==e[t]&&null!==e[t]&&(e[t]=new Date(e[t]));return _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z.convertObjectToArcadeDictionary(e)}return null}let m=null;if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.T)(c[0])&&(m=c[0]),m){if(d=!1,u)return null;await m.load();const n=await m.getOwningSystemUrl();if(!n){if(!u){const e=await m.getIdentityUser();return e?_Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z.convertObjectToArcadeDictionary({username:e}):null}return null}let i=null;a.services&&a.services.portal&&(i=a.services.portal),i=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.getPortal)(new _ArcadePortal_js__WEBPACK_IMPORTED_MODULE_0__.Z(n),i);const r=await(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.lookupUser)(i,u,d);if(r){const e=JSON.parse(JSON.stringify(r));for(const t of["lastLogin","created","modified"])void 0!==e[t]&&null!==e[t]&&(e[t]=new Date(e[t]));return _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z.convertObjectToArcadeDictionary(e)}return null}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(a,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,r)}))},G.signatures.push({name:"getuser",min:1,max:2}),G.functions.featuresetbyid=function(e,t){return G.standardFunctionAsync(e,t,((a,s,o)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(o,2,4,e,t),o[0]instanceof _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_19__.Z){const a=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(o[1]);let r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(o[2],null);const s=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.h)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(o[3],!0));if(null===r&&(r=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(r))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t);return o[0].featureSetById(a,s,r)}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t)}))},G.signatures.push({name:"featuresetbyid",min:2,max:4}),G.functions.getfeatureset=function(e,t){return G.standardFunctionAsync(e,t,((a,r,s)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(s,1,2,e,t),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.w)(s[0])){let t=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(s[1],"datasource");return null===t&&(t="datasource"),t=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(t).toLowerCase(),(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.convertToFeatureSet)(s[0].fullSchema(),t,e.lrucache,e.interceptor,e.spatialReference)}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t)}))},G.signatures.push({name:"getfeatureset",min:1,max:2}),G.functions.featuresetbyportalitem=function(t,a){return G.standardFunctionAsync(t,a,((r,o,l)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(l,2,5,t,a),null===l[0])throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(t,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.PortalRequired,a);if(l[0]instanceof _ArcadePortal_js__WEBPACK_IMPORTED_MODULE_0__.Z){const e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(l[1]),r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(l[2]);let o=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(l[3],null);const c=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.h)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(l[4],!0));if(null===o&&(o=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(o))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(t,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);let u=null;return t.services&&t.services.portal&&(u=t.services.portal),u=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.getPortal)(l[0],u),(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSetFromPortalItem)(e,r,t.spatialReference,o,c,u,t.lrucache,t.interceptor)}if(!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.c)(l[0]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(t,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.PortalRequired,a);const c=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(l[0]),u=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(l[1]);let d=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(l[2],null);const m=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.h)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(l[3],!0));if(null===d&&(d=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(d))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(t,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);if(t.services&&t.services.portal)return(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSetFromPortalItem)(c,u,t.spatialReference,d,m,t.services.portal,t.lrucache,t.interceptor);throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(t,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.PortalRequired,a)}))},G.signatures.push({name:"featuresetbyportalitem",min:2,max:5}),G.functions.featuresetbyname=function(e,t){return G.standardFunctionAsync(e,t,((a,s,o)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(o,2,4,e,t),o[0]instanceof _featureSetCollection_js__WEBPACK_IMPORTED_MODULE_19__.Z){const a=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(o[1]);let r=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(o[2],null);const s=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.h)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(o[3],!0));if(null===r&&(r=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(r))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t);return o[0].featureSetByName(a,s,r)}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t)}))},G.signatures.push({name:"featuresetbyname",min:2,max:4}),G.functions.featureset=function(e,a){return G.standardFunction(e,a,((r,s,o)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(o,1,1,e,a);let l=o[0];const f={layerDefinition:{geometryType:"",objectIdField:"",globalIdField:"",typeIdField:"",fields:[]},featureSet:{geometryType:"",features:[]}};if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.c)(l))l=JSON.parse(l),void 0!==l.layerDefinition?(f.layerDefinition=l.layerDefinition,f.featureSet=l.featureSet,l.layerDefinition.spatialReference&&(f.layerDefinition.spatialReference=l.layerDefinition.spatialReference)):(f.featureSet.features=l.features,f.featureSet.geometryType=l.geometryType,f.layerDefinition.geometryType=f.featureSet.geometryType,f.layerDefinition.objectIdField=l.objectIdFieldName,f.layerDefinition.typeIdField=l.typeIdFieldName,f.layerDefinition.globalIdField=l.globalIdFieldName,f.layerDefinition.fields=l.fields,l.spatialReference&&(f.layerDefinition.spatialReference=l.spatialReference));else{if(!(o[0]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);{l=JSON.parse(o[0].castToText(!0));const e=q(l,"layerdefinition");if(null!==e){f.layerDefinition.geometryType=q(e,"geometrytype",""),f.featureSet.geometryType=f.layerDefinition.geometryType,f.layerDefinition.globalIdField=q(e,"globalidfield",""),f.layerDefinition.objectIdField=q(e,"objectidfield",""),f.layerDefinition.typeIdField=q(e,"typeidfield","");const t=q(e,"spatialreference",null);t&&(f.layerDefinition.spatialReference=X(t));for(const i of q(e,"fields",[])){const e={name:q(i,"name",""),alias:q(i,"alias",""),type:q(i,"type",""),nullable:q(i,"nullable",!0),editable:q(i,"editable",!0),length:q(i,"length",null),domain:K(q(i,"domain"))};f.layerDefinition.fields.push(e)}const n=q(l,"featureset",null);if(n){const e={};for(const t of f.layerDefinition.fields)e[t.name.toLowerCase()]=t.name;for(const t of q(n,"features",[])){const n={},i=q(t,"attributes",{});for(const t in i)n[e[t.toLowerCase()]]=i[t];f.featureSet.features.push({attributes:n,geometry:Y(q(t,"geometry",null))})}}}else{f.layerDefinition.geometryType=q(l,"geometrytype",""),f.featureSet.geometryType=f.layerDefinition.geometryType,f.layerDefinition.objectIdField=q(l,"objectidfieldname",""),f.layerDefinition.typeIdField=q(l,"typeidfieldname","");const e=q(l,"spatialreference",null);e&&(f.layerDefinition.spatialReference=X(e));for(const n of q(l,"fields",[])){const e={name:q(n,"name",""),alias:q(n,"alias",""),type:q(n,"type",""),nullable:q(n,"nullable",!0),editable:q(n,"editable",!0),length:q(n,"length",null),domain:K(q(n,"domain"))};f.layerDefinition.fields.push(e)}const t={};for(const n of f.layerDefinition.fields)t[n.name.toLowerCase()]=n.name;for(const n of q(l,"features",[])){const e={},i=q(n,"attributes",{});for(const n in i)e[t[n.toLowerCase()]]=i[n];f.featureSet.features.push({attributes:e,geometry:Y(q(n,"geometry",null))})}}}}if(!1===function Q(e){return!!e.layerDefinition&&!!e.featureSet&&!1!==function Z(e,t){for(const n of t)if(n===e)return!0;return!1}(e.layerDefinition.geometryType,["","esriGeometryPoint","esriGeometryPolyline","esriGeometryPolygon","esriGeometryMultipoint","esriGeometryEnvelope"])&&null!==e.layerDefinition.objectIdField&&""!==e.layerDefinition.objectIdField&&!1!==(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(e.layerDefinition.fields)&&!1!==(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(e.featureSet.features)}(f))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);return _featureset_sources_FeatureLayerMemory_js__WEBPACK_IMPORTED_MODULE_11__.Z.create(f,e.spatialReference)}))},G.signatures.push({name:"featureset",min:1,max:1}),G.functions.filter=function(e,t){return G.standardFunctionAsync(e,t,(async(a,r,s)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(s,2,2,e,t),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(s[0])||(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.x)(s[0])){const a=[];let r=s[0];r instanceof _ImmutableArray_js__WEBPACK_IMPORTED_MODULE_20__.Z&&(r=r.toArray());let o=null;if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.i)(s[1]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t);o=s[1].createFunction(e);for(const e of r){const t=o(e);(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_15__.y8)(t)?!0===await t&&a.push(e):!0===t&&a.push(e)}return a}if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.T)(s[0])){const t=await s[0].load(),n=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(s[1],t.getFieldsIndex()),i=n.getVariables();if(i.length>0){const t=[];for(let n=0;n<i.length;n++){const a={name:i[n]};t.push(await G.evaluateIdentifier(e,a))}const a={};for(let e=0;e<i.length;e++)a[i[e]]=t[e];return n.parameters=a,new _featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_7__.Z({parentfeatureset:s[0],whereclause:n})}return new _featureset_actions_AttributeFilter_js__WEBPACK_IMPORTED_MODULE_7__.Z({parentfeatureset:s[0],whereclause:n})}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t)}))},G.signatures.push({name:"filter",min:2,max:2}),G.functions.orderby=function(e,t){return G.standardFunctionAsync(e,t,(async(a,r,s)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(s,2,2,e,t),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.T)(s[0])){const e=new _featureset_support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_21__.Z(s[1]);return new _featureset_actions_OrderBy_js__WEBPACK_IMPORTED_MODULE_8__.Z({parentfeatureset:s[0],orderbyclause:e})}throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t)}))},G.signatures.push({name:"orderby",min:2,max:2}),G.functions.top=function(e,t){return G.standardFunctionAsync(e,t,(async(a,r,s)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(s,2,2,e,t),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.T)(s[0]))return new _featureset_actions_Top_js__WEBPACK_IMPORTED_MODULE_9__.Z({parentfeatureset:s[0],topnum:s[1]});if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(s[0]))return(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.g)(s[1])>=s[0].length?s[0].slice(0):s[0].slice(0,(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.g)(s[1]));if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.x)(s[0]))return(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.g)(s[1])>=s[0].length()?s[0].slice(0):s[0].slice(0,(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.g)(s[1]));throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t)}))},G.signatures.push({name:"top",min:2,max:2}),G.functions.first=function(e,t){return G.standardFunctionAsync(e,t,(async(n,i,r)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(r,1,1,e,t),(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.T)(r[0])){const e=await r[0].first(n.abortSignal);if(null!==e){const t=_Feature_js__WEBPACK_IMPORTED_MODULE_3__.Z.createFromGraphicLikeObject(e.geometry,e.attributes,r[0]);return t._underlyingGraphic=e,t}return e}return(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(r[0])?0===r[0].length?null:r[0][0]:(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.x)(r[0])?0===r[0].length()?null:r[0].get(0):null}))},G.signatures.push({name:"first",min:1,max:1}),G.functions.attachments=function(e,a){return G.standardFunctionAsync(e,a,(async(r,s,o)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(o,1,2,e,a);const l={minsize:-1,maxsize:-1,types:null,returnMetadata:!1};if(o.length>1)if(o[1]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z){if(o[1].hasField("minsize")&&(l.minsize=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.g)(o[1].field("minsize"))),o[1].hasField("metadata")&&(l.returnMetadata=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.h)(o[1].field("metadata"))),o[1].hasField("maxsize")&&(l.maxsize=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.g)(o[1].field("maxsize"))),o[1].hasField("types")){const e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.X)(o[1].field("types"),!1);e.length>0&&(l.types=e)}}else if(null!==o[1])throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.w)(o[0])){let t=o[0]._layer;return t instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_17__.default&&(t=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSet)(t,e.spatialReference,["*"],!0,e.lrucache,e.interceptor)),null===t||!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.T)(t)?[]:(await t.load(),t.queryAttachments(o[0].field(t.objectIdField),l.minsize,l.maxsize,l.types,l.returnMetadata))}if(null===o[0])return[];throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a)}))},G.signatures.push({name:"attachments",min:1,max:2}),G.functions.featuresetbyrelationshipname=function(e,t){return G.standardFunctionAsync(e,t,(async(a,r,s)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(s,2,4,e,t);const o=s[0],l=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(s[1]);let f=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(s[2],null);const m=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.h)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(s[3],!0));if(null===f&&(f=["*"]),!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(f))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t);if(null===s[0])return null;if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.w)(s[0]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t);let p=o._layer;if(p instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_17__.default&&(p=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSet)(p,e.spatialReference,["*"],!0,e.lrucache,e.interceptor)),null===p)return null;if(!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.T)(p))return null;p=await p.load();const D=p.relationshipMetaData().filter((e=>e.name===l));if(0===D.length)return null;if(void 0!==D[0].relationshipTableId&&null!==D[0].relationshipTableId&&D[0].relationshipTableId>-1)return(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSetFromRelationship)(p,D[0],o.field(p.objectIdField),p.spatialReference,f,m,e.lrucache,e.interceptor);let b=p.serviceUrl();if(!b)return null;b="/"===b.charAt(b.length-1)?b+D[0].relatedTableId.toString():b+"/"+D[0].relatedTableId.toString();const A=await(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSetFromUrl)(b,p.spatialReference,f,m,e.lrucache,e.interceptor);await A.load();let N=A.relationshipMetaData();if(N=N.filter((e=>e.id===D[0].id)),!1===o.hasField(D[0].keyField)||null===o.field(D[0].keyField)){const e=await p.getFeatureByObjectId(o.field(p.objectIdField),[D[0].keyField]);if(e){const t=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(N[0].keyField+"= @id",A.getFieldsIndex());return t.parameters={id:e.attributes[D[0].keyField]},A.filter(t)}return new _featureset_sources_Empty_js__WEBPACK_IMPORTED_MODULE_10__.Z({parentfeatureset:A})}const x=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(N[0].keyField+"= @id",A.getFieldsIndex());return x.parameters={id:o.field(D[0].keyField)},A.filter(x)}))},G.signatures.push({name:"featuresetbyrelationshipname",min:2,max:4}),G.functions.featuresetbyassociation=function(e,t){return G.standardFunctionAsync(e,t,(async(a,r,s)=>{(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(s,2,3,e,t);const o=s[0],l=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.A)(s[1],"")).toLowerCase(),f=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.c)(s[2])?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(s[2]):null;if(null===s[0])return null;if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.w)(s[0]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t);let u=o._layer;if(u instanceof _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_17__.default&&(u=(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructFeatureSet)(u,e.spatialReference,["*"],!0,e.lrucache,e.interceptor)),null===u)return null;if(!1===(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.T)(u))return null;await u.load();const d=u.serviceUrl(),p=await(0,_featureSetUtils_js__WEBPACK_IMPORTED_MODULE_4__.constructAssociationMetaDataFeatureSetFromUrl)(d,e.spatialReference);let I=null,F=null,b=!1;if(null!==f&&""!==f&&void 0!==f){for(const e of p.terminals)e.terminalName===f&&(F=e.terminalId);null===F&&(b=!0)}const A=p.associations.getFieldsIndex(),N=A.get("TOGLOBALID").name,x=A.get("FROMGLOBALID").name,P=A.get("TOTERMINALID").name,R=A.get("FROMTERMINALID").name,O=A.get("FROMNETWORKSOURCEID").name,C=A.get("TONETWORKSOURCEID").name,M=A.get("ASSOCIATIONTYPE").name,k=A.get("ISCONTENTVISIBLE").name,z=A.get("OBJECTID").name;for(const e of u.fields)if("global-id"===e.type){I=o.field(e.name);break}let G=null,U=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.yN(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_18__.Z({name:"percentalong",alias:"percentalong",type:"double"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create("0",p.associations.getFieldsIndex())),J=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.yN(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_18__.Z({name:"side",alias:"side",type:"string"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create("''",p.associations.getFieldsIndex()));const V="globalid",q="globalId",K={};for(const e in p.lkp)K[e]=p.lkp[e].sourceId;const X=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.TO(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_18__.Z({name:"classname",alias:"classname",type:"string"}),null,K);let Y="";switch(l){case"midspan":{Y=`((${N}='${I}') OR ( ${x}='${I}')) AND (${M} IN (5))`,X.codefield=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(`CASE WHEN (${N}='${I}') THEN ${O} ELSE ${C} END`,p.associations.getFieldsIndex());const e=(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_12__.JW)(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx.findField(p.associations.fields,x));e.name=V,e.alias=V,G=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.yN(e,_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(`CASE WHEN (${x}='${I}') THEN ${N} ELSE ${x} END`,p.associations.getFieldsIndex())),U=p.unVersion>=4?new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.$X(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx.findField(p.associations.fields,A.get("PERCENTALONG").name)):new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.yN(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_18__.Z({name:"percentalong",alias:"percentalong",type:"double"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create("0",p.associations.getFieldsIndex()));break}case"junctionedge":{Y=`((${N}='${I}') OR ( ${x}='${I}')) AND (${M} IN (4,6))`,X.codefield=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(`CASE WHEN (${N}='${I}') THEN ${O} ELSE ${C} END`,p.associations.getFieldsIndex());const e=(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_12__.JW)(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx.findField(p.associations.fields,x));e.name=V,e.alias=V,G=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.yN(e,_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(`CASE WHEN (${x}='${I}') THEN ${N} ELSE ${x} END`,p.associations.getFieldsIndex())),J=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.yN(new _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_18__.Z({name:"side",alias:"side",type:"string"}),_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(`CASE WHEN (${M}=4) THEN 'from' ELSE 'to' END`,p.associations.getFieldsIndex()));break}case"connected":{let e=`${N}='@T'`,t=`${x}='@T'`;null!==F&&(e+=` AND ${P}=@A`,t+=` AND ${R}=@A`),Y="(("+e+") OR ("+t+"))",Y=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.L)(Y,"@T",I??""),e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.L)(e,"@T",I??""),null!==F&&(e=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.L)(e,"@A",F.toString()),Y=(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.L)(Y,"@A",F.toString())),X.codefield=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create("CASE WHEN "+e+` THEN ${O} ELSE ${C} END`,p.associations.getFieldsIndex());const n=(0,_featureset_support_shared_js__WEBPACK_IMPORTED_MODULE_12__.JW)(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx.findField(p.associations.fields,x));n.name=V,n.alias=V,G=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.yN(n,_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create("CASE WHEN "+e+` THEN ${x} ELSE ${N} END`,p.associations.getFieldsIndex()));break}case"container":Y=`${N}='${I}' AND ${M} = 2`,null!==F&&(Y+=` AND ${P} = `+F.toString()),X.codefield=O,Y="( "+Y+" )",G=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.QP(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx.findField(p.associations.fields,x),V,V);case"content":Y=`(${x}='${I}' AND ${M} = 2)`,null!==F&&(Y+=` AND ${R} = `+F.toString()),X.codefield=C,Y="( "+Y+" )",G=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.QP(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx.findField(p.associations.fields,N),V,V);break;case"structure":Y=`(${N}='${I}' AND ${M} = 3)`,null!==F&&(Y+=` AND ${P} = `+F.toString()),X.codefield=O,Y="( "+Y+" )",G=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.QP(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx.findField(p.associations.fields,x),V,q);break;case"attached":Y=`(${x}='${I}' AND ${M} = 3)`,null!==F&&(Y+=` AND ${R} = `+F.toString()),X.codefield=C,Y="( "+Y+" )",G=new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.QP(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx.findField(p.associations.fields,N),V,q);break;default:throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,t)}return b&&(Y="1 <> 1"),new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx({parentfeatureset:p.associations,adaptedFields:[new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.$X(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx.findField(p.associations.fields,z)),new _featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.$X(_featureset_actions_Adapted_js__WEBPACK_IMPORTED_MODULE_6__.Xx.findField(p.associations.fields,k)),G,J,X,U],extraFilter:Y?_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(Y,p.associations.getFieldsIndex()):null})}))},G.signatures.push({name:"featuresetbyassociation",min:2,max:6}),G.functions.groupby=function(e,a){return G.standardFunctionAsync(e,a,(async(r,s,o)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(o,3,3,e,a),!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.T)(o[0]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);const l=await o[0].load(),f=[],c=[];let u=!1,d=[];if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.c)(o[1]))d.push(o[1]);else if(o[1]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z)d.push(o[1]);else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(o[1]))d=o[1];else{if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.x)(o[1]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);d=o[1].toArray()}for(const m of d)if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.c)(m)){const e=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(m),l.getFieldsIndex()),t=!0===(0,_featureset_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_13__.y5)(e)?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(m):"%%%%FIELDNAME";f.push({name:t,expression:e}),"%%%%FIELDNAME"===t&&(u=!0)}else{if(!(m instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);{const t=m.hasField("name")?m.field("name"):"%%%%FIELDNAME",r=m.hasField("expression")?m.field("expression"):"";if("%%%%FIELDNAME"===t&&(u=!0),!t)throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);f.push({name:t,expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(r||t,l.getFieldsIndex())})}}if(d=[],(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.c)(o[2]))d.push(o[2]);else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(o[2]))d=o[2];else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.x)(o[2]))d=o[2].toArray();else{if(!(o[2]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);d.push(o[2])}for(const m of d){if(!(m instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);{const t=m.hasField("name")?m.field("name"):"",r=m.hasField("statistic")?m.field("statistic"):"",s=m.hasField("expression")?m.field("expression"):"";if(!t||!r||!s)throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);c.push({name:t,statistic:r.toLowerCase(),expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(s,l.getFieldsIndex())})}}if(u){const e={};for(const n of l.fields)e[n.name.toLowerCase()]=1;for(const n of f)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);for(const n of c)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let t=0;for(const n of f)if("%%%%FIELDNAME"===n.name){for(;1===e["field_"+t.toString()];)t++;e["field_"+t.toString()]=1,n.name="FIELD_"+t.toString()}}for(const t of f)await V(t.expression,G,e);for(const t of c)await V(t.expression,G,e);return o[0].groupby(f,c)}))},G.signatures.push({name:"groupby",min:3,max:3}),G.functions.distinct=function(e,a){return G.standardFunctionAsync(e,a,(async(r,s,o)=>{if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.T)(o[0])){(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.y)(o,2,2,e,a);const r=await o[0].load(),s=[];let l=[];if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.c)(o[1]))l.push(o[1]);else if(o[1]instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z)l.push(o[1]);else if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(o[1]))l=o[1];else{if(!(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.x)(o[1]))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);l=o[1].toArray()}let f=!1;for(const o of l)if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.c)(o)){const e=_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(o),r.getFieldsIndex()),t=!0===(0,_featureset_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_13__.y5)(e)?(0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.j)(o):"%%%%FIELDNAME";s.push({name:t,expression:e}),"%%%%FIELDNAME"===t&&(f=!0)}else{if(!(o instanceof _Dictionary_js__WEBPACK_IMPORTED_MODULE_1__.Z))throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);{const t=o.hasField("name")?o.field("name"):"%%%%FIELDNAME",l=o.hasField("expression")?o.field("expression"):"";if("%%%%FIELDNAME"===t&&(f=!0),!t)throw new _executionError_js__WEBPACK_IMPORTED_MODULE_2__.aV(e,_executionError_js__WEBPACK_IMPORTED_MODULE_2__.rH.InvalidParameter,a);s.push({name:t,expression:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_16__.WhereClause.create(l||t,r.getFieldsIndex())})}}if(f){const e={};for(const n of r.fields)e[n.name.toLowerCase()]=1;for(const n of s)"%%%%FIELDNAME"!==n.name&&(e[n.name.toLowerCase()]=1);let t=0;for(const n of s)if("%%%%FIELDNAME"===n.name){for(;1===e["field_"+t.toString()];)t++;e["field_"+t.toString()]=1,n.name="FIELD_"+t.toString()}}for(const t of s)await V(t.expression,G,e);return o[0].groupby(s,[])}return function J(e,t,n,i){if(1===i.length){if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.m)(i[0]))return(0,_fieldStats_js__WEBPACK_IMPORTED_MODULE_14__.t)(e,i[0],-1);if((0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_5__.x)(i[0]))return(0,_fieldStats_js__WEBPACK_IMPORTED_MODULE_14__.t)(e,i[0].toArray(),-1)}return(0,_fieldStats_js__WEBPACK_IMPORTED_MODULE_14__.t)(e,i,-1)}("distinct",0,0,o)}))})}}}]);