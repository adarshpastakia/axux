"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[49908,12292],{"./node_modules/@arcgis/core/layers/GroupLayer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>E});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),CollectionFlattener=__webpack_require__("./node_modules/@arcgis/core/core/CollectionFlattener.js"),loadAll=__webpack_require__("./node_modules/@arcgis/core/core/loadAll.js"),Logger=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),MultiOriginJSONSupport=__webpack_require__("./node_modules/@arcgis/core/core/MultiOriginJSONSupport.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),utils=(__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/utils.js")),reader=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/reader.js"),subclass=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),writer=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/writer.js"),PropertyOrigin=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/PropertyOrigin.js"),Layer=__webpack_require__("./node_modules/@arcgis/core/layers/Layer.js"),BlendLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/BlendLayer.js"),OperationalLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/OperationalLayer.js"),PortalLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/PortalLayer.js"),ScaleRangeLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/ScaleRangeLayer.js"),lazyLayerLoader=__webpack_require__("./node_modules/@arcgis/core/layers/support/lazyLayerLoader.js"),PortalItem=__webpack_require__("./node_modules/@arcgis/core/portal/PortalItem.js"),collectionUtils=__webpack_require__("./node_modules/@arcgis/core/support/collectionUtils.js"),LayersMixin=__webpack_require__("./node_modules/@arcgis/core/support/LayersMixin.js"),TablesMixin=__webpack_require__("./node_modules/@arcgis/core/support/TablesMixin.js");const tagSymbols_e=Symbol("WebScene");var interfaces=__webpack_require__("./node_modules/@arcgis/core/webdoc/interfaces.js"),saveUtils=__webpack_require__("./node_modules/@arcgis/core/webdoc/support/saveUtils.js"),writeUtils=__webpack_require__("./node_modules/@arcgis/core/webdoc/support/writeUtils.js");let V=class extends((0,BlendLayer.W)((0,ScaleRangeLayer.I)((0,OperationalLayer.Y)((0,PortalLayer.K)((0,TablesMixin.K)((0,LayersMixin.u)((0,MultiOriginJSONSupport.U)(Layer.c)))))))){constructor(e){super(e),this.allLayers=new CollectionFlattener.c({getCollections:()=>[this.layers],getChildrenFunction:e=>"layers"in e?e.layers:null}),this.allTables=(0,collectionUtils.A)(this),this.fullExtent=void 0,this.operationalLayerType="GroupLayer",this.spatialReference=void 0,this.type="group",this._debouncedSaveOperations=(0,promiseUtils.Cu)((async(e,r,t)=>{const{save:i,saveAs:s}=await __webpack_require__.e(42224).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/layers/save/groupLayerUtils.js"));switch(e){case interfaces.U.SAVE:return i(this,r);case interfaces.U.SAVE_AS:return s(this,t,r)}}))}initialize(){this._enforceVisibility(this.visibilityMode,this.visible),this.addHandles([(0,reactiveUtils.aE)((()=>{let e=this.parent;for(;e&&"parent"in e&&e.parent;)e=e.parent;return e&&tagSymbols_e in e}),(e=>{const r="prevent-adding-tables";this.removeHandles(r),e&&(this.tables.removeAll(),this.addHandles((0,reactiveUtils.on)((()=>this.tables),"before-add",(e=>{e.preventDefault(),Logger.c.getLogger(this).errorOnce("tables","tables in group layers in a webscene are not supported. Please move the tables from the group layer to the webscene if you want to persist them.")})),r))}),reactiveUtils.KG),(0,reactiveUtils.aE)((()=>this.visible),this._onVisibilityChange.bind(this),reactiveUtils.du)])}destroy(){this.allLayers.destroy(),this.allTables.destroy()}get sourceIsPortalItem(){return this.portalItem&&this.originIdOf("portalItem")===PropertyOrigin.sT.USER}_writeLayers(e,r,t,i){const s=[];if(!e)return s;e.forEach((e=>{const r=(0,writeUtils.WW)(e,i.webmap?i.webmap.getLayerJSONFromResourceInfo(e):null,i);r?.layerType&&s.push(r)})),r.layers=s}set portalItem(e){this._set("portalItem",e)}readPortalItem(e,r,t){const{itemId:i,layerType:s}=r;if("GroupLayer"===s&&i)return new PortalItem.default({id:i,portal:t?.portal})}writePortalItem(e,r){e?.id&&(r.itemId=e.id)}set visibilityMode(e){const r=this._get("visibilityMode")!==e;this._set("visibilityMode",e),r&&this._enforceVisibility(e,this.visible)}async beforeSave(){return(0,saveUtils.Wq)(this)}load(e){const r=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Group Layer","Scene Service"],layerModuleTypeMap:lazyLayerLoader.q},e).catch((e=>{if((0,promiseUtils.CE)(e),this.sourceIsPortalItem)throw e}));return this.addResolvingPromise(r),Promise.resolve(this)}async loadAll(){return(0,loadAll.A)(this,(e=>{e(this.layers,this.tables)}))}async save(e){return this._debouncedSaveOperations(interfaces.U.SAVE,e)}async saveAs(e,r){return this._debouncedSaveOperations(interfaces.U.SAVE_AS,r,e)}layerAdded(e){e.visible&&"exclusive"===this.visibilityMode?this._turnOffOtherLayers(e):"inherited"===this.visibilityMode&&(e.visible=this.visible),this.hasHandles(e.uid)?console.error(`Layer readded to Grouplayer: uid=${e.uid}`):this.addHandles((0,reactiveUtils.aE)((()=>e.visible),(r=>this._onChildVisibilityChange(e,r)),reactiveUtils.du),e.uid)}layerRemoved(e){this.removeHandles(e.uid),this._enforceVisibility(this.visibilityMode,this.visible)}_turnOffOtherLayers(e){this.layers.forEach((r=>{r!==e&&(r.visible=!1)}))}_enforceVisibility(e,r){if(!(0,utils.m6)(this).initialized)return;const t=this.layers;let i=t.find((e=>e.visible));switch(e){case"exclusive":t.length&&!i&&(i=t.at(0),i.visible=!0),this._turnOffOtherLayers(i);break;case"inherited":t.forEach((e=>{e.visible=r}))}}_onVisibilityChange(e){"inherited"===this.visibilityMode&&this.layers.forEach((r=>{r.visible=e}))}_onChildVisibilityChange(e,r){switch(this.visibilityMode){case"exclusive":r?this._turnOffOtherLayers(e):this._isAnyLayerVisible()||(e.visible=!0);break;case"inherited":e.visible=this.visible}}_isAnyLayerVisible(){return this.layers.some((e=>e.visible))}};(0,tslib_es6._)([(0,property.qq)({readOnly:!0,dependsOn:[]})],V.prototype,"allLayers",void 0),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],V.prototype,"allTables",void 0),(0,tslib_es6._)([(0,property.qq)({json:{read:!0,write:!0}})],V.prototype,"blendMode",void 0),(0,tslib_es6._)([(0,property.qq)()],V.prototype,"fullExtent",void 0),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],V.prototype,"sourceIsPortalItem",null),(0,tslib_es6._)([(0,property.qq)({json:{read:!1,write:{ignoreOrigin:!0}}})],V.prototype,"layers",void 0),(0,tslib_es6._)([(0,writer.G)("layers")],V.prototype,"_writeLayers",null),(0,tslib_es6._)([(0,property.qq)({type:["GroupLayer"]})],V.prototype,"operationalLayerType",void 0),(0,tslib_es6._)([(0,property.qq)({json:{origins:{"web-map":{read:!1,write:{overridePolicy(e,r,t){return{enabled:"Group Layer"===e?.type&&t?.initiator!==this}}}},"web-scene":{read:!1,write:!1}}}})],V.prototype,"portalItem",null),(0,tslib_es6._)([(0,reader.E)("web-map","portalItem",["itemId"])],V.prototype,"readPortalItem",null),(0,tslib_es6._)([(0,writer.G)("web-map","portalItem",{itemId:{type:String}})],V.prototype,"writePortalItem",null),(0,tslib_es6._)([(0,property.qq)()],V.prototype,"spatialReference",void 0),(0,tslib_es6._)([(0,property.qq)({json:{read:!1},readOnly:!0,value:"group"})],V.prototype,"type",void 0),(0,tslib_es6._)([(0,property.qq)({type:["independent","inherited","exclusive"],value:"independent",json:{write:!0,origins:{"web-map":{type:["independent","exclusive"],write:(e,r,t)=>{"inherited"!==e&&(r[t]=e)}}}}})],V.prototype,"visibilityMode",null),V=(0,tslib_es6._)([(0,subclass.c)("esri.layers.GroupLayer")],V);const E=V},"./node_modules/@arcgis/core/portal/support/resourceUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{CW:()=>m,EN:()=>p,addOrUpdateResource:()=>s,fetchResources:()=>o,removeAllResources:()=>l,removeResource:()=>n});var _request_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/request.js"),_core_Error_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js");async function o(e,t={},a){await e.load(a);const o=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.kn)(e.itemUrl,"resources"),{start:s=1,num:n=10,sortOrder:l="asc",sortField:u="created"}=t,c={query:{start:s,num:n,sortOrder:l,sortField:u,token:e.apiKey},signal:a?.signal},i=await e.portal.request(o,c);return{total:i.total,nextStart:i.nextStart,resources:i.resources.map((({created:t,size:r,resource:a})=>({created:new Date(t),size:r,resource:e.resourceFromPath(a)})))}}async function s(e,a,o,s){if(!e.hasPath())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.c(`portal-item-resource-${a}:invalid-path`,"Resource does not have a valid path");const n=e.portalItem;await n.load(s);const l=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.kn)(n.userItemUrl,"add"===a?"addResources":"updateResources"),[c,i]=u(e.path),p=new FormData;return c&&"."!==c&&p.append("resourcesPrefix",c),null!=s&&s.compress&&p.append("compress","true"),p.append("fileName",i),p.append("file",o,i),p.append("f","json"),s?.access&&p.append("access",s.access),await n.portal.request(l,{method:"post",body:p,signal:s?.signal}),e}async function n(e,a,o){if(!a.hasPath())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.c("portal-item-resources-remove:invalid-path","Resource does not have a valid path");await e.load(o);const s=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.kn)(e.userItemUrl,"removeResources");await e.portal.request(s,{method:"post",query:{resource:a.path},signal:o?.signal}),a.portalItem=null}async function l(e,t){await e.load(t);const a=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.kn)(e.userItemUrl,"removeResources");return e.portal.request(a,{method:"post",query:{deleteAll:!0},signal:t?.signal})}function u(e){const t=e.lastIndexOf("/");return-1===t?[".",e]:[e.slice(0,t),e.slice(t+1)]}function c(e){const[t,r]=function i(e){const t=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.wt)(e);return null==t?[e,""]:[e.slice(0,e.length-t.length-1),`.${t}`]}(e),[a,o]=u(t);return[a,o,r]}async function p(t){return"blob"===t.type?t.blob:"json"===t.type?new Blob([t.jsonString],{type:"application/json"}):(await(0,_request_js__WEBPACK_IMPORTED_MODULE_0__.c)(t.url,{responseType:"blob"})).data}function m(e,t){if(!e.hasPath())return null;const[a,,o]=c(e.path);return e.portalItem.resourceFromPath((0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.kn)(a,t+o))}},"./node_modules/@arcgis/core/webdoc/interfaces.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{var A;__webpack_require__.d(__webpack_exports__,{U:()=>A}),function(A){A[A.SAVE=0]="SAVE",A[A.SAVE_AS=1]="SAVE_AS"}(A||(A={}))},"./node_modules/@arcgis/core/webdoc/support/saveUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{U$:()=>u,Wq:()=>m,Ww:()=>p});var _core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/asyncUtils.js"),_core_Error_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_core_uuid_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/uuid.js"),_portal_support_resourceUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/portal/support/resourceUtils.js");async function u(e,r,o=null){const t=await i(e,r,o);await h(t,r,o)}async function p(e,r,o,t,s=null){const a=await i(o,t,s);await e.update({data:r}),await h(a,t,s)}async function i(e,s,n=null){if(!s?.resources)return;const u=s.portalItem===e.portalItem?new Set(e.paths):new Set;e.paths.length=0,e.portalItem=s.portalItem;const p=new Set(s.resources.toKeep.map((e=>e.resource.path))),i=new Set,h=[];p.forEach((r=>{u.delete(r),e.paths.push(r)}));for(const r of s.resources.toUpdate)if(u.delete(r.resource.path),p.has(r.resource.path)||i.has(r.resource.path)){const{resource:o,content:t,finish:s,error:u}=r,p=(0,_portal_support_resourceUtils_js__WEBPACK_IMPORTED_MODULE_4__.CW)(o,(0,_core_uuid_js__WEBPACK_IMPORTED_MODULE_3__.g1)());e.paths.push(p.path),h.push(f({resource:p,content:t,compress:r.compress,finish:s,error:u},n))}else e.paths.push(r.resource.path),h.push(l(r,n)),i.add(r.resource.path);for(const r of s.resources.toAdd)e.paths.push(r.resource.path),u.has(r.resource.path)?u.delete(r.resource.path):h.push(f(r,n));if(0===h.length)return u;const m=await(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.Ml)(h);if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.wp)(n),m.length>0)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.c("save:resources","Failed to save one or more resources",{errors:m});return u}async function h(e,r,o=null){if(!e||!r.portalItem)return;const t=[];for(const s of e){const e=r.portalItem.resourceFromPath(s);t.push(e.portalItem.removeResource(e,o))}await(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_2__.Dv)(t)}async function f(r,o){const t={...null!=o?o:{},compress:r.compress},s=await(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.aG)(r.resource.portalItem.addResource(r.resource,await(0,_portal_support_resourceUtils_js__WEBPACK_IMPORTED_MODULE_4__.EN)(r.content),t));if(!0!==s.ok)throw r.error?.(s.error),s.error;r.finish?.(r.resource)}async function l(r,o){const t=await(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.aG)(r.resource.update(await(0,_portal_support_resourceUtils_js__WEBPACK_IMPORTED_MODULE_4__.EN)(r.content),o));if(!0!==t.ok)throw r.error?.(t.error),t.error;r.finish?.(r.resource)}async function m(e){const r=[];for(const o of e.allLayers)if("beforeSave"in o&&"function"==typeof o.beforeSave){const e=o.beforeSave();e&&r.push(e)}await Promise.allSettled(r)}}}]);