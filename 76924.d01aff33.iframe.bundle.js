"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[76924],{"./node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>m,b:()=>v});var _views_3d_webgl_engine_core_shaderLibrary_ShaderOutput_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js"),_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_shading_MultipassTerrainTest_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_AlphaCutoff_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff.js"),_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js"),_views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js"),_views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js"),_views_3d_webgl_engine_lib_TransparencyPassType_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/TransparencyPassType.js"),_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js");function v(v){const m=new _views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_8__.i0,{vertex:f,fragment:u}=m;return(0,_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_5__.IE)(f,v),m.include(_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_2__.w,v),m.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_11__.K.POSITION,"vec3"),m.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_11__.K.UV0,"vec2"),v.perspectiveInterpolation&&m.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_11__.K.PERSPECTIVEDIVIDE,"float"),m.varyings.add("vpos","vec3"),v.multipassEnabled&&m.varyings.add("depth","float"),f.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_7__.Y`
    void main(void) {
      vpos = position;
      ${v.multipassEnabled?"depth = (view * vec4(vpos, 1.0)).z;":""}
      vTexCoord = uv0;
      gl_Position = transformPosition(proj, view, vpos);

      ${v.perspectiveInterpolation?"gl_Position *= perspectiveDivide;":""}
    }
  `),m.include(_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_1__.A3,v),m.include(_views_3d_webgl_engine_core_shaderLibrary_shading_MultipassTerrainTest_glsl_js__WEBPACK_IMPORTED_MODULE_3__._,v),u.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_9__.W("tex",(e=>e.texture)),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.d("opacity",(e=>e.opacity))),m.varyings.add("vTexCoord","vec2"),v.output===_views_3d_webgl_engine_core_shaderLibrary_ShaderOutput_js__WEBPACK_IMPORTED_MODULE_0__.m.Alpha?u.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_7__.Y`
    void main() {
      discardBySlice(vpos);
      ${v.multipassEnabled?"terrainDepthTest(depth);":""}

      float alpha = texture(tex, vTexCoord).a * opacity;
      if (alpha  < ${_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_7__.Y.float(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaCutoff_js__WEBPACK_IMPORTED_MODULE_12__.k)}) {
        discard;
      }

      fragColor = vec4(alpha);
    }
    `):(u.include(_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_4__.I),u.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_7__.Y`
    void main() {
      discardBySlice(vpos);
      ${v.multipassEnabled?"terrainDepthTest(depth);":""}
      fragColor = texture(tex, vTexCoord) * opacity;

      if (fragColor.a < ${_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_7__.Y.float(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaCutoff_js__WEBPACK_IMPORTED_MODULE_12__.k)}) {
        discard;
      }

      fragColor = highlightSlice(fragColor, vpos);
      ${v.transparencyPassType===_views_3d_webgl_engine_lib_TransparencyPassType_js__WEBPACK_IMPORTED_MODULE_10__.H.Color?"fragColor = premultiplyAlpha(fragColor);":""}
    }
    `)),m}const m=Object.freeze(Object.defineProperty({__proto__:null,build:v},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/LaserlinePath.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>w,b:()=>v});var _mat4_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4.js"),_mat4f64_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4f64.js"),_vec2_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec2.js"),_vec2f64_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec2f64.js"),_views_3d_webgl_engine_core_shaderLibrary_Laserline_glsl_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js"),_views_3d_webgl_engine_core_shaderModules_Matrix4PassUniform_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Matrix4PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js"),_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js");function v(i){const r=new _views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_9__.i0;r.include(_views_3d_webgl_engine_core_shaderLibrary_Laserline_glsl_js__WEBPACK_IMPORTED_MODULE_4__.W,i);const{vertex:v,fragment:w}=r;return v.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Matrix4PassUniform_js__WEBPACK_IMPORTED_MODULE_8__.O("modelView",((i,o)=>(0,_mat4_js__WEBPACK_IMPORTED_MODULE_0__.w)(m,o.camera.viewMatrix,i.origin))),new _views_3d_webgl_engine_core_shaderModules_Matrix4PassUniform_js__WEBPACK_IMPORTED_MODULE_8__.O("proj",((e,i)=>i.camera.projectionMatrix)),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.d("glowWidth",((e,i)=>e.glowWidth*i.camera.pixelRatio)),new _views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_5__.$("pixelToNDC",((e,i)=>(0,_vec2_js__WEBPACK_IMPORTED_MODULE_2__.s)(p,2/i.camera.fullViewport[2],2/i.camera.fullViewport[3])))),r.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.K.START,"vec3"),r.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.K.END,"vec3"),r.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.K.UP,"vec3"),r.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_10__.K.EXTRUDE,"vec2"),r.varyings.add("uv","vec2"),r.varyings.add("vViewStart","vec3"),r.varyings.add("vViewEnd","vec3"),r.varyings.add("vViewPlane","vec4"),v.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_7__.Y`void main() {
vec3 pos = mix(start, end, extrude.x);
vec4 viewPos = modelView * vec4(pos, 1);
vec4 projPos = proj * viewPos;
vec2 ndcPos = projPos.xy / projPos.w;
vec3 viewUp = (modelView * vec4(extrude.y * up, 0)).xyz;
vec4 projPosUp = proj * vec4(viewPos.xyz + viewUp, 1);
vec2 projExtrudeDir = normalize(projPosUp.xy / projPosUp.w - ndcPos);
vec2 lxy = abs(sign(projExtrudeDir) - ndcPos);
ndcPos += length(lxy) * projExtrudeDir;
vec3 worldPlaneNormal = normalize(cross(up, normalize(end - start)));
vec3 viewPlaneNormal = (modelView * vec4(worldPlaneNormal, 0)).xyz;
vViewStart = (modelView * vec4(start, 1)).xyz;
vViewEnd = (modelView * vec4(end, 1)).xyz;
vViewPlane = vec4(viewPlaneNormal, -dot(viewPlaneNormal, vViewStart));
float xPaddingPixels = sign(dot(viewPlaneNormal, viewPos.xyz)) * (extrude.x * 2.0 - 1.0) * glowWidth;
ndcPos.x += xPaddingPixels * pixelToNDC.x;
uv = ndcPos * 0.5 + 0.5;
gl_Position = vec4(ndcPos, 0, 1);
}`),w.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.d("perScreenPixelRatio",((e,i)=>i.camera.perScreenPixelRatio))),w.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_7__.Y`float planeDistancePixels(vec4 plane, vec3 pos, vec3 start, vec3 end) {
vec3 origin = mix(start, end, 0.5);
vec3 basis = end - origin;
vec3 posAtOrigin = pos - origin;
float x = dot(normalize(basis), posAtOrigin);
float y = dot(plane.xyz, posAtOrigin);
float dx = max(abs(x) - length(basis), 0.0);
float dy = y;
float dist = length(vec2(dx, dy));
float width = fwidth(y);
float maxPixelDistance = length(pos) * perScreenPixelRatio * 2.0;
float pixelDist = dist / min(width, maxPixelDistance);
return abs(pixelDist);
}
void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
vec3 dEndStart = vViewEnd - vViewStart;
if (dot(dEndStart, dEndStart) < 1e-5) {
discard;
}
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
float distance = planeDistancePixels(vViewPlane, pos, vViewStart, vViewEnd);
vec4 color = laserlineProfile(distance);
float alpha = 1.0 - smoothstep(0.995, 0.999, abs(dot(normal, vViewPlane.xyz)));
fragColor = laserlineOutput(color * alpha * depthDiscontinuityAlpha);
}`),r}const p=(0,_vec2f64_js__WEBPACK_IMPORTED_MODULE_3__.a)(),m=(0,_mat4f64_js__WEBPACK_IMPORTED_MODULE_1__.a)(),w=Object.freeze(Object.defineProperty({__proto__:null,build:v},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/Laserlines.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>_,b:()=>A,d:()=>C});var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),_vec2_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec2.js"),_vec2f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec2f64.js"),_vec3_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3.js"),_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3f64.js"),_vec4_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec4.js"),_vec4f64_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec4f64.js"),_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/lineSegment.js"),_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/plane.js"),_sphere_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/chunks/sphere.js"),_views_3d_webgl_engine_core_shaderLibrary_Laserline_glsl_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSpacePass.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js"),_views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js");const C=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.EF)(6);function A(e){const i=new _views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_17__.i0;i.include(_views_3d_webgl_engine_core_shaderLibrary_ScreenSpacePass_glsl_js__WEBPACK_IMPORTED_MODULE_11__.Y),i.include(_views_3d_webgl_engine_core_shaderLibrary_Laserline_glsl_js__WEBPACK_IMPORTED_MODULE_10__.W,e);const t=i.fragment;if(e.lineVerticalPlaneEnabled||e.heightManifoldEnabled)if(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_15__.d("maxPixelDistance",((i,t)=>e.heightManifoldEnabled?2*t.camera.computeScreenPixelSizeAt(i.heightManifoldTarget):2*t.camera.computeScreenPixelSizeAt(i.lineVerticalPlaneSegment.origin)))),t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`float planeDistancePixels(vec4 plane, vec3 pos) {
float dist = dot(plane.xyz, pos) + plane.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`),e.spherical){const e=(e,i,t)=>(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.e)(e,i.heightManifoldTarget,t.camera.viewMatrix),i=(e,i)=>(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.e)(e,[0,0,0],i.camera.viewMatrix);t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_14__.U("heightManifoldOrigin",((t,r)=>(e(T,t,r),i(U,r),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.f)(U,U,T),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.n)(R,U),R[3]=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.l)(U),R))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_13__.C("globalOrigin",((e,t)=>i(T,t))),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_15__.d("cosSphericalAngleThreshold",((e,i)=>1-Math.max(2,(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.o)(i.camera.eye,e.heightManifoldTarget)*i.camera.perRenderPixelRatio)/(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.l)(e.heightManifoldTarget)))),t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`float globeDistancePixels(float posInGlobalOriginLength) {
float dist = abs(posInGlobalOriginLength - heightManifoldOrigin.w);
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}
float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
vec3 posInGlobalOriginNorm = normalize(globalOrigin - pos);
float cosAngle = dot(posInGlobalOriginNorm, heightManifoldOrigin.xyz);
vec3 posInGlobalOrigin = globalOrigin - pos;
float posInGlobalOriginLength = length(posInGlobalOrigin);
float sphericalDistance = globeDistancePixels(posInGlobalOriginLength);
float planarDistance = planeDistancePixels(heightPlane, pos);
return cosAngle < cosSphericalAngleThreshold ? sphericalDistance : planarDistance;
}`)}else t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`float heightManifoldDistancePixels(vec4 heightPlane, vec3 pos) {
return planeDistancePixels(heightPlane, pos);
}`);if(e.pointDistanceEnabled&&(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_15__.d("maxPixelDistance",((e,i)=>2*i.camera.computeScreenPixelSizeAt(e.pointDistanceTarget)))),t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`float sphereDistancePixels(vec4 sphere, vec3 pos) {
float dist = distance(sphere.xyz, pos) - sphere.w;
float width = fwidth(dist);
dist /= min(width, maxPixelDistance);
return abs(dist);
}`)),e.intersectsLineEnabled&&(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_15__.d("perScreenPixelRatio",((e,i)=>i.camera.perScreenPixelRatio))),t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`float lineDistancePixels(vec3 start, vec3 dir, float radius, vec3 pos) {
float dist = length(cross(dir, pos - start)) / (length(pos) * perScreenPixelRatio);
return abs(dist) - radius;
}`)),(e.lineVerticalPlaneEnabled||e.intersectsLineEnabled)&&t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`bool pointIsWithinLine(vec3 pos, vec3 start, vec3 end) {
vec3 dir = end - start;
float t2 = dot(dir, pos - start);
float l2 = dot(dir, dir);
return t2 >= 0.0 && t2 <= l2;
}`),t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`void main() {
vec3 pos;
vec3 normal;
float depthDiscontinuityAlpha;
if (!laserlineReconstructFromDepth(pos, normal, depthDiscontinuityAlpha)) {
discard;
}
vec4 color = vec4(0, 0, 0, 0);`),e.heightManifoldEnabled){t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_12__.$("angleCutoff",(e=>V(e))),new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_14__.U("heightPlane",((e,i)=>z(e.heightManifoldTarget,e.renderCoordsHelper.worldUpAtPosition(e.heightManifoldTarget,T),i.camera.viewMatrix))));const i=e.spherical?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`normalize(globalOrigin - pos)`:_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`heightPlane.xyz`;t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`
    {
      float heightManifoldAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, ${i})));
      vec4 heightManifoldColor = laserlineProfile(heightManifoldDistancePixels(heightPlane, pos));
      color = max(color, heightManifoldColor * heightManifoldAlpha);
    }
    `)}return e.pointDistanceEnabled&&(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_12__.$("angleCutoff",(e=>V(e))),new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_14__.U("pointDistanceSphere",((e,i)=>function j(e,i){return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.e)(H,e.pointDistanceOrigin,i.camera.viewMatrix),H[3]=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.o)(e.pointDistanceOrigin,e.pointDistanceTarget),H}(e,i)))),t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`{
float pointDistanceSphereDistance = sphereDistancePixels(pointDistanceSphere, pos);
vec4 pointDistanceSphereColor = laserlineProfile(pointDistanceSphereDistance);
float pointDistanceSphereAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, normalize(pos - pointDistanceSphere.xyz))));
color = max(color, pointDistanceSphereColor * pointDistanceSphereAlpha);
}`)),e.lineVerticalPlaneEnabled&&(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_12__.$("angleCutoff",(e=>V(e))),new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_14__.U("lineVerticalPlane",((e,i)=>function y(e,i){const t=(0,_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_7__.KO)(e.lineVerticalPlaneSegment,.5,T),n=e.renderCoordsHelper.worldUpAtPosition(t,G),o=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.n)(U,e.lineVerticalPlaneSegment.vector),r=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.b)(R,n,o);return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.n)(r,r),z(e.lineVerticalPlaneSegment.origin,r,i.camera.viewMatrix)}(e,i))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_13__.C("lineVerticalStart",((e,i)=>function O(e,i){const t=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.c)(T,e.lineVerticalPlaneSegment.origin);return e.renderCoordsHelper.setAltitude(t,0),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.e)(t,t,i.camera.viewMatrix)}(e,i))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_13__.C("lineVerticalEnd",((e,i)=>function E(e,i){const t=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.g)(T,e.lineVerticalPlaneSegment.origin,e.lineVerticalPlaneSegment.vector);return e.renderCoordsHelper.setAltitude(t,0),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.e)(t,t,i.camera.viewMatrix)}(e,i)))),t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`{
if (pointIsWithinLine(pos, lineVerticalStart, lineVerticalEnd)) {
float lineVerticalDistance = planeDistancePixels(lineVerticalPlane, pos);
vec4 lineVerticalColor = laserlineProfile(lineVerticalDistance);
float lineVerticalAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, abs(dot(normal, lineVerticalPlane.xyz)));
color = max(color, lineVerticalColor * lineVerticalAlpha);
}
}`)),e.intersectsLineEnabled&&(t.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_12__.$("angleCutoff",(e=>V(e))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_13__.C("intersectsLineStart",((e,i)=>(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.e)(T,e.lineStartWorld,i.camera.viewMatrix))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_13__.C("intersectsLineEnd",((e,i)=>(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.e)(T,e.lineEndWorld,i.camera.viewMatrix))),new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_13__.C("intersectsLineDirection",((e,i)=>((0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.c)(R,e.intersectsLineSegment.vector),R[3]=0,(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.n)(T,(0,_vec4_js__WEBPACK_IMPORTED_MODULE_5__.t)(R,R,i.camera.viewMatrix))))),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_15__.d("intersectsLineRadius",(e=>e.intersectsLineRadius))),t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`{
if (pointIsWithinLine(pos, intersectsLineStart, intersectsLineEnd)) {
float intersectsLineDistance = lineDistancePixels(intersectsLineStart, intersectsLineDirection, intersectsLineRadius, pos);
vec4 intersectsLineColor = laserlineProfile(intersectsLineDistance);
float intersectsLineAlpha = 1.0 - smoothstep(angleCutoff.x, angleCutoff.y, 1.0 - abs(dot(normal, intersectsLineDirection)));
color = max(color, intersectsLineColor * intersectsLineAlpha);
}
}`)),t.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_16__.Y`fragColor = laserlineOutput(color * depthDiscontinuityAlpha);
}`),i}function V(t){return(0,_vec2_js__WEBPACK_IMPORTED_MODULE_1__.s)(I,Math.cos(t.angleCutoff),Math.cos(Math.max(0,t.angleCutoff-(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.EF)(2))))}function z(e,i,t){return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.e)(F,e,t),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_3__.c)(R,i),R[3]=0,(0,_vec4_js__WEBPACK_IMPORTED_MODULE_5__.t)(R,R,t),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_8__.aY)(F,R,W)}const I=(0,_vec2f64_js__WEBPACK_IMPORTED_MODULE_2__.a)(),T=(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.c)(),R=(0,_vec4f64_js__WEBPACK_IMPORTED_MODULE_6__.c)(),G=(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.c)(),U=(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.c)(),F=(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_4__.c)(),W=(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_8__.Su)(),H=(0,_sphere_js__WEBPACK_IMPORTED_MODULE_9__.c)(),_=Object.freeze(Object.defineProperty({__proto__:null,build:A,defaultAngleCutoff:C},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/ShadedColorMaterial.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>h,b:()=>p});var _vec4f64_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec4f64.js"),_views_3d_webgl_engine_core_shaderLibrary_ScreenSizeScaling_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_ShaderOutput_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js"),_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Slice.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Transform.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_shading_MultipassTerrainTest_glsl_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/shading/MultipassTerrainTest.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_AlphaCutoff_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/AlphaCutoff.js"),_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/ColorConversion.glsl.js"),_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js"),_views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js"),_views_3d_webgl_engine_lib_TransparencyPassType_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/TransparencyPassType.js"),_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js");function p(e){const p=new _views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_11__.i0,b=e.multipassEnabled&&(e.output===_views_3d_webgl_engine_core_shaderLibrary_ShaderOutput_js__WEBPACK_IMPORTED_MODULE_2__.m.Color||e.output===_views_3d_webgl_engine_core_shaderLibrary_ShaderOutput_js__WEBPACK_IMPORTED_MODULE_2__.m.Alpha);p.include(_views_3d_webgl_engine_core_shaderLibrary_Transform_glsl_js__WEBPACK_IMPORTED_MODULE_4__.w,e),p.include(_views_3d_webgl_engine_core_shaderLibrary_ScreenSizeScaling_glsl_js__WEBPACK_IMPORTED_MODULE_1__.E,e),p.include(_views_3d_webgl_engine_core_shaderLibrary_Slice_glsl_js__WEBPACK_IMPORTED_MODULE_3__.A3,e);const{vertex:h,fragment:C}=p;return C.include(_views_3d_webgl_engine_core_shaderLibrary_util_ColorConversion_glsl_js__WEBPACK_IMPORTED_MODULE_6__.I),(0,_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_7__.IE)(h,e),C.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_9__.U("uColor",(e=>e.color))),p.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_13__.K.POSITION,"vec3"),p.varyings.add("vWorldPosition","vec3"),b&&p.varyings.add("depth","float"),e.screenSizeEnabled&&p.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_13__.K.OFFSET,"vec3"),e.shadingEnabled&&((0,_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_7__.CI)(h),p.attributes.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_13__.K.NORMAL,"vec3"),p.varyings.add("vViewNormal","vec3")),h.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y`
    void main(void) {
      vWorldPosition = ${e.screenSizeEnabled?"screenSizeScaling(offset, position)":"position"};
  `),e.shadingEnabled&&h.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y`vec3 worldNormal = normal;
vViewNormal = (viewNormal * vec4(worldNormal, 1)).xyz;`),h.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y`
    ${b?"depth = (view * vec4(vWorldPosition, 1.0)).z;":""}
    gl_Position = transformPosition(proj, view, vWorldPosition);
  }
  `),b&&p.include(_views_3d_webgl_engine_core_shaderLibrary_shading_MultipassTerrainTest_glsl_js__WEBPACK_IMPORTED_MODULE_5__._,e),C.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y`
    void main() {
      discardBySlice(vWorldPosition);
      ${b?"terrainDepthTest(depth);":""}
    `),e.shadingEnabled?(C.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_8__.C("shadingDirection",(e=>e.shadingDirection))),C.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_9__.U("shadedColor",(e=>w(e.shadingTint,e.color)))),C.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y`vec3 viewNormalNorm = normalize(vViewNormal);
float shadingFactor = 1.0 - clamp(-dot(viewNormalNorm, shadingDirection), 0.0, 1.0);
vec4 finalColor = mix(uColor, shadedColor, shadingFactor);`)):C.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y`vec4 finalColor = uColor;`),C.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y`
      ${e.output===_views_3d_webgl_engine_core_shaderLibrary_ShaderOutput_js__WEBPACK_IMPORTED_MODULE_2__.m.ObjectAndLayerIdColor?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y`finalColor.a = 1.0;`:""}
      if (finalColor.a < ${_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y.float(_views_3d_webgl_engine_core_shaderLibrary_util_AlphaCutoff_js__WEBPACK_IMPORTED_MODULE_14__.A)}) {
        discard;
      }
      ${e.output===_views_3d_webgl_engine_core_shaderLibrary_ShaderOutput_js__WEBPACK_IMPORTED_MODULE_2__.m.Alpha?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y`fragColor = vec4(finalColor.a);`:""}

      ${e.output===_views_3d_webgl_engine_core_shaderLibrary_ShaderOutput_js__WEBPACK_IMPORTED_MODULE_2__.m.Color?_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_10__.Y`fragColor = highlightSlice(finalColor, vWorldPosition); ${e.transparencyPassType===_views_3d_webgl_engine_lib_TransparencyPassType_js__WEBPACK_IMPORTED_MODULE_12__.H.Color?"fragColor = premultiplyAlpha(fragColor);":""}`:""}
    }
    `),p}function w(e,o){const r=1-e[3],i=e[3]+o[3]*r;return 0===i?(b[3]=i,b):(b[0]=(e[0]*e[3]+o[0]*o[3]*r)/i,b[1]=(e[1]*e[3]+o[1]*o[3]*r)/i,b[2]=(e[2]*e[3]+o[2]*o[3]*r)/i,b[3]=o[3],b)}const b=(0,_vec4f64_js__WEBPACK_IMPORTED_MODULE_0__.c)(),h=Object.freeze(Object.defineProperty({__proto__:null,build:p},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/SlicePlaneMaterial.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>g,b:()=>t});var _views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js"),_views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float4PassUniform.js"),_views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js"),_views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/ShaderBuilder.js"),_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js");function t(t){const g=new _views_3d_webgl_engine_core_shaderModules_ShaderBuilder_js__WEBPACK_IMPORTED_MODULE_4__.i0,{vertex:l,fragment:s,attributes:n,varyings:c}=g;return(0,_views_3d_webgl_engine_core_shaderLibrary_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_0__.IE)(l,t),n.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_5__.K.POSITION,"vec3"),n.add(_views_3d_webgl_engine_lib_VertexAttribute_js__WEBPACK_IMPORTED_MODULE_5__.K.UV0,"vec2"),c.add("vUV","vec2"),l.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_3__.Y`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),s.uniforms.add(new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_1__.U("backgroundColor",(e=>e.backgroundColor)),new _views_3d_webgl_engine_core_shaderModules_Float4PassUniform_js__WEBPACK_IMPORTED_MODULE_1__.U("gridColor",(e=>e.gridColor)),new _views_3d_webgl_engine_core_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_2__.d("gridWidth",(e=>e.gridWidth))),s.code.add(_views_3d_webgl_engine_core_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_3__.Y`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
fragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),g}const g=Object.freeze(Object.defineProperty({__proto__:null,build:t},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/chunks/vec4f32.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function n(){return new Float32Array(4)}function t(n){const t=new Float32Array(4);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function r(n,t,r,e){const a=new Float32Array(4);return a[0]=n,a[1]=t,a[2]=r,a[3]=e,a}function a(){return n()}function o(){return r(1,1,1,1)}function u(){return r(1,0,0,0)}function s(){return r(0,1,0,0)}function c(){return r(0,0,1,0)}function i(){return r(0,0,0,1)}__webpack_require__.d(__webpack_exports__,{c:()=>t,f:()=>r});const f=a(),l=o(),_=u(),y=s(),w=c(),N=i();Object.freeze(Object.defineProperty({__proto__:null,ONES:l,UNIT_W:N,UNIT_X:_,UNIT_Y:y,UNIT_Z:w,ZEROS:f,clone:t,create:n,createView:function e(n,t){return new Float32Array(n,t,4)},fromValues:r,ones:o,unitW:i,unitX:u,unitY:s,unitZ:c,zeros:a},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>j});var _Error_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_MD5_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/MD5.js"),_multiOriginJSONSupportUtils_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js"),_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js"),_uuid_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/uuid.js"),_metadata_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/metadata.js"),_PropertyOrigin_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/PropertyOrigin.js"),_property_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/portal/support/resourceExtension.js"),_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/chunks/persistableUrlUtils.js");function j(t){const r=t?.origins??[void 0];return(e,o)=>{const s=function U(t,r,e){if("resource"===t?.type)return function w(t,r,n){const i=(0,_metadata_js__WEBPACK_IMPORTED_MODULE_4__.EF)(r,n);return{type:String,read:(t,r,e)=>{const o=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(t,r,e);return i.type===String?o:"function"==typeof i.type?new i.type({url:o}):void 0},write:{writer(r,p,c,u){if(!u?.resources)return"string"==typeof r?void(p[c]=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.t)(r,u)):void(p[c]=r.write({},u));const l=function x(t){return null==t?null:"string"==typeof t?t:t.url}(r),m=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.t)(l,{...u,verifyItemRelativeUrls:u?.verifyItemRelativeUrls?{writtenUrls:u.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.M.NO),d=i.type!==String&&(!(0,_multiOriginJSONSupportUtils_js__WEBPACK_IMPORTED_MODULE_9__.w)(this)||u?.origin&&this.originIdOf(n)>(0,_PropertyOrigin_js__WEBPACK_IMPORTED_MODULE_5__.CQ)(u.origin)),h={object:this,propertyName:n,value:r,targetUrl:m,dest:p,targetPropertyName:c,context:u,params:t};u?.portalItem&&m&&!(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.ic)(m)?d&&t?.contentAddressed?I(h):d?function N(t){const{context:r,targetUrl:e,params:o,value:s,dest:n,targetPropertyName:i}=t;if(!r.portalItem)return;const c=r.portalItem.resourceFromPath(e),u=b(s,e,r),a=(0,_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__.e)(u),l=(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.wt)(c.path),d=o?.compress??!1;a===l?(r.resources&&S({...t,resource:c,content:u,compress:d,updates:r.resources.toUpdate}),n[i]=e):I(t)}(h):function P({context:t,targetUrl:r,dest:e,targetPropertyName:o}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(r),compress:!1}),e[o]=r)}(h):u?.portalItem&&(null==m||null!=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.i)(m)||(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.ue)(m)||d)?I(h):p[c]=m}}}}(t,r,e);switch(t?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:t,write:r}=_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.a;return{read:t,write:r}}}}(t,e,o);for(const t of r){const r=(0,_property_js__WEBPACK_IMPORTED_MODULE_6__.aq)(e,t,o);for(const t in s)r[t]=s[t]}}}function I(e){const{targetUrl:o,params:p,value:u,context:a,dest:l,targetPropertyName:d}=e;if(!a.portalItem)return;const f=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.p)(o),y=b(u,o,a);if(p?.contentAddressed&&"json"!==y.type)return void a.messages?.push(new _Error_js__WEBPACK_IMPORTED_MODULE_0__.c("persistable:contentAddressingUnsupported",`Property "${d}" is trying to serializing a resource with content of type ${y.type} with content addressing. Content addressing is only supported for json resources.`,{content:y}));const g=p?.contentAddressed&&"json"===y.type?(0,_MD5_js__WEBPACK_IMPORTED_MODULE_1__.I)(y.jsonString):f?.filename??(0,_uuid_js__WEBPACK_IMPORTED_MODULE_3__.g1)(),v=(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.kn)(p?.prefix??f?.prefix,g),j=`${v}.${(0,_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__.e)(y)}`;if(p?.contentAddressed&&a.resources&&"json"===y.type){const t=a.resources.toKeep.find((t=>t.resource.path===j))??a.resources.toAdd.find((t=>t.resource.path===j));if(t)return void(l[d]=t.resource.itemRelativeUrl)}const U=a.portalItem.resourceFromPath(j);(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.ue)(o)&&a.resources&&a.resources.pendingOperations.push((0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.SW)(o).then((t=>{U.path=`${v}.${(0,_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__.e)({type:"blob",blob:t})}`,l[d]=U.itemRelativeUrl})).catch((()=>{})));const w=p?.compress??!1;a.resources&&S({...e,resource:U,content:y,compress:w,updates:a.resources.toAdd}),l[d]=U.itemRelativeUrl}function S({object:t,propertyName:r,updates:e,resource:o,content:s,compress:n}){e.push({resource:o,content:s,compress:n,finish:e=>{!function O(t,r,e){"string"==typeof t[r]?t[r]=e.url:t[r].url=e.url}(t,r,e)}})}function b(t,r,e){return"string"==typeof t?{type:"url",url:r}:{type:"json",jsonString:JSON.stringify(t.toJSON(e))}}},"./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function i(i){return i&&"getAtOrigin"in i&&"originOf"in i}__webpack_require__.d(__webpack_exports__,{w:()=>i})},"./node_modules/@arcgis/core/portal/support/resourceExtension.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{e:()=>p});var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js");function p(i){return o[function t(i){return"json"===i.type?"application/json":"blob"===i.type?i.blob.type:function n(p){const t=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_0__.wt)(p);return g[t]||a}(i.url)}(i)]||e}const o={},a="text/plain",e=o[a],g={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const l in g)o[g[l]]=l},"./node_modules/@arcgis/core/views/3d/interactive/editingTools.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{DrawGraphicTool3D:()=>DrawGraphicTool3D_z,ExtentTransformTool:()=>ExtentTransformTool_U,GraphicMoveTool:()=>GraphicMoveTool_q,GraphicReshapeTool:()=>GraphicReshapeTool_u,GraphicTransformTool:()=>GraphicTransformTool_Y});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),colorUtils=__webpack_require__("./node_modules/@arcgis/core/core/colorUtils.js"),handleUtils=__webpack_require__("./node_modules/@arcgis/core/core/handleUtils.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),ensureType=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),arrayUtils=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),has=__webpack_require__("./node_modules/@arcgis/core/core/has.js"),subclass=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),vec3=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3.js"),vec3f64=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3f64.js"),elevationInfoUtils=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js"),ElevationInfo=__webpack_require__("./node_modules/@arcgis/core/symbols/support/ElevationInfo.js"),screenUtils=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),Color=(__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),__webpack_require__("./node_modules/@arcgis/core/Color.js")),Accessor=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),asyncUtils=__webpack_require__("./node_modules/@arcgis/core/core/asyncUtils.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),quantityFormatUtils=__webpack_require__("./node_modules/@arcgis/core/core/quantityFormatUtils.js"),vec2=__webpack_require__("./node_modules/@arcgis/core/chunks/vec2.js"),vec2f64=__webpack_require__("./node_modules/@arcgis/core/chunks/vec2f64.js"),coordsUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/coordsUtils.js"),messages=__webpack_require__("./node_modules/@arcgis/core/intl/messages.js"),getDefaultUnitForView=__webpack_require__("./node_modules/@arcgis/core/support/getDefaultUnitForView.js");__webpack_require__("./node_modules/@arcgis/core/libs/maquette/projection.js");let h_e=e=>({vnodeSelector:"",properties:void 0,children:void 0,text:e.toString(),domNode:null}),h_r=(t,o,n)=>{for(let l=0,i=o.length;l<i;l++){let i=o[l];Array.isArray(i)?h_r(t,i,n):null!=i&&!1!==i&&("string"==typeof i&&(i=h_e(i)),n.push(i))}};__webpack_require__("./node_modules/@arcgis/core/libs/maquette/projector.js");const TextOverlayItem_l={bottom:"esri-text-overlay-item-anchor-bottom","bottom-right":"esri-text-overlay-item-anchor-bottom-right","bottom-left":"esri-text-overlay-item-anchor-bottom-left",top:"esri-text-overlay-item-anchor-top","top-right":"esri-text-overlay-item-anchor-top-right","top-left":"esri-text-overlay-item-anchor-top-left",center:"esri-text-overlay-item-anchor-center",right:"esri-text-overlay-item-anchor-right",left:"esri-text-overlay-item-anchor-left"};let TextOverlayItem_n=class extends Accessor.c{get position(){return[this.x,this.y]}set position(t){this._set("x",t[0]),this._set("y",t[1])}get _textShadowColor(){const{textColor:t,backgroundColor:e}=this,o=e.clone();return o.a*=t.a,o}get _textShadow(){const t=this._textShadowColor.toCss(!0);return`0 0 ${this._textShadowSize}px ${t}`}get _padding(){return.5*this.fontSize}get _borderRadius(){return this._padding}constructor(t){super(t),this.x=0,this.y=0,this.text="-",this.fontSize=14,this.anchor="center",this.visible=!0,this.isDecoration=!0,this.backgroundColor=new Color.c([0,0,0,.6]),this.textColor=new Color.c([255,255,255]),this._textShadowSize=1}render(){return function h_t(e,t,o){if(Array.isArray(t))o=t,t=void 0;else if(t&&("string"==typeof t||t.hasOwnProperty("vnodeSelector"))||o&&("string"==typeof o||o.hasOwnProperty("vnodeSelector")))throw new Error("h called with invalid arguments");let n,l;return o&&1===o.length&&"string"==typeof o[0]?n=o[0]:o&&(l=[],h_r(e,o,l),0===l.length&&(l=void 0)),{vnodeSelector:e,properties:t,children:l,text:""===n?void 0:n,domNode:null}}("div",{classes:this._cssClasses(),styles:{left:Math.floor(this.x)+"px",top:Math.floor(this.y)+"px",visibility:this.visible?"visible":"hidden",fontSize:this.fontSize+"px",lineHeight:this.fontSize+"px",backgroundColor:this.backgroundColor.toCss(!0),color:this.textColor.toCss(!0),padding:this._padding+"px",borderRadius:this._borderRadius+"px",textShadow:this._textShadow}},[this.text])}renderCanvas(t){if(!this.visible)return;const e=t.font.replace(/^(.*?)px/,"");t.font=`${this.fontSize}px ${e}`;const o=this._padding,i=this._borderRadius,r=t.measureText(this.text).width,s=this.fontSize,l=TextOverlayItem_h[this.anchor];t.textAlign="center",t.textBaseline="middle";const n=r+2*o,a=s+2*o,x=this.x+l.x*n,p=this.y+l.y*a;this._roundedRect(t,x,p,n,a,i),t.fillStyle=this.backgroundColor.toCss(!0),t.fill();const c=this.x+(l.x+.5)*n,d=this.y+(l.y+.5)*a;this._renderTextShadow(t,this.text,c,d),t.fillStyle=this.textColor.toCss(!0),t.fillText(this.text,c,d)}_renderTextShadow(t,e,o,i){t.lineJoin="miter",t.fillStyle=`rgba(${this._textShadowColor.r}, ${this._textShadowColor.g}, ${this._textShadowColor.b}, ${1/TextOverlayItem_a.length})`;const r=this._textShadowSize;for(const[s,l]of TextOverlayItem_a)t.fillText(e,o+r*s,i+r*l)}_roundedRect(t,e,o,i,r,s){t.beginPath(),t.moveTo(e,o+s),t.arcTo(e,o,e+s,o,s),t.lineTo(e+i-s,o),t.arcTo(e+i,o,e+i,o+s,s),t.lineTo(e+i,o+r-s),t.arcTo(e+i,o+r,e+i-s,o+r,s),t.lineTo(e+s,o+r),t.arcTo(e,o+r,e,o+r-s,s),t.closePath()}_cssClasses(){const t={"esri-text-overlay-item":!0};let e;for(e in TextOverlayItem_l)t[TextOverlayItem_l[e]]=this.anchor===e;return t}};(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"x",void 0),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"y",void 0),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"position",null),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"text",void 0),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"fontSize",void 0),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"anchor",void 0),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"visible",void 0),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"isDecoration",void 0),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"backgroundColor",void 0),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"textColor",void 0),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"_textShadowSize",void 0),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"_textShadowColor",null),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"_textShadow",null),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"_padding",null),(0,tslib_es6._)([(0,property.qq)()],TextOverlayItem_n.prototype,"_borderRadius",null),TextOverlayItem_n=(0,tslib_es6._)([(0,subclass.c)("esri.views.overlay.TextOverlayItem")],TextOverlayItem_n);const TextOverlayItem_h={bottom:{x:-.5,y:-1,textAlign:"center",textBaseline:"bottom"},"bottom-left":{x:0,y:-1,textAlign:"left",textBaseline:"bottom"},"bottom-right":{x:-1,y:-1,textAlign:"right",textBaseline:"bottom"},center:{x:-.5,y:-.5,textAlign:"center",textBaseline:"middle"},left:{x:0,y:-.5,textAlign:"left",textBaseline:"middle"},right:{x:-1,y:-.5,textAlign:"right",textBaseline:"middle"},top:{x:-.5,y:0,textAlign:"center",textBaseline:"top"},"top-left":{x:0,y:0,textAlign:"left",textBaseline:"top"},"top-right":{x:-1,y:0,textAlign:"right",textBaseline:"top"}},TextOverlayItem_a=[];{const t=16;for(let e=0;e<360;e+=360/t)TextOverlayItem_a.push([Math.cos(Math.PI*e/180),Math.sin(Math.PI*e/180)])}const TextOverlayItem_x=TextOverlayItem_n;var automaticLengthMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/automaticLengthMeasurementUtils.js");const SegmentLabels_D={default:15,far:25};let SegmentLabels_O=class extends Accessor.c{constructor(t){super(t),this.context=null,this.stagedVertex=null,this.visible=!0,this.edgeDistance="default",this._messagesUnits=null,this._labelInfos=[],this._nextLabelIndex=0}initialize(){const t=(0,asyncUtils.kn)((async t=>{const e=await(0,messages.kB)("esri/core/t9n/Units");(0,promiseUtils.wp)(t),this._messagesUnits=e}));this.addHandles([(0,reactiveUtils.aE)((()=>[null!=this.context&&this.getCameraOrExtent(this.context),this.visible,this._edgeDistancePixels,this.stagedVertex,this._messagesUnits]),(()=>this._update())),...["vertex-add","vertex-update","vertex-remove"].map((t=>(0,reactiveUtils.on)((()=>this.context?.editGeometryOperations),t,(()=>this._update())))),(0,handleUtils.uU)((()=>t.abort())),(0,reactiveUtils.aE)((()=>this._colors),(t=>this._updateStyle(t)))])}destroy(){for(this._nextLabelIndex=0;this._labelInfos.length;)this._destroyLabel(this._labelInfos.pop())}get updating(){return null==this._messagesUnits}get test(){return{labelContents:this._labelInfos.slice(0,this._nextLabelIndex).map((t=>t.label.text))}}get _edgeDistancePixels(){return SegmentLabels_D[this.edgeDistance]}get _colors(){const t=this.context?.view.effectiveTheme.textColor??Color.c.fromArray([255,255,255]);return{textColor:t,backgroundColor:(0,colorUtils.iw)((0,colorUtils.u8)(t,colorUtils.Ib.Low),.6)}}_update(){if(this.destroyed)return;this._nextLabelIndex=0;const t=this.context;if(null==t)return void this._destroyUnusedLabels();const{components:e,geometry:s,coordinateHelper:o}=t.editGeometryOperations.data;if(!s)return void this._destroyUnusedLabels();const r=e.length;for(let i=0;i<r;++i){const n=[];if(e[i].iterateVertices((t=>{n.push(o.toXYZ(t.pos))})),0===i&&null!=this.stagedVertex&&n.push(o.toXYZ(this.stagedVertex)),n.length<2)continue;const l=n[0],a=n[n.length-1];"polygon"===s.type&&n.length>2&&!(0,vec3.G)(l,a)&&n.push(l);const c=1===r&&!(0,coordsUtils.K_)(n);let p=SegmentLabels_G,h=SegmentLabels_A;this.toScreenPointArray(t,l,p);for(let e=1;e<n.length;++e){const s=n[e-1],o=n[e];this.toScreenPointArray(t,o,h),this._addLabel(t,s,p,o,h,c),[p,h]=[h,p]}}this._destroyUnusedLabels()}_updateStyle({textColor:t,backgroundColor:e}){const s=this._nextLabelIndex,o=this._labelInfos;for(let r=0;r<s;++r){const{label:s}=o[r];s.textColor=t,s.backgroundColor=e}}_addLabel(t,e,s,o,r,i){const{label:n}=this._getOrCreateLabel(t);if(!this.visible||(0,vec2.k)(s,r)<3025)return void(n.visible=!1);const l=null!=t.graphicState?t.graphicState.isDraped?"on-the-ground":"absolute-height":(0,elevationInfoUtils.m6)(t.editGeometryOperations.data.geometry,t.elevationInfo),{spatialReference:a}=t.editGeometryOperations.data,p=(0,automaticLengthMeasurementUtils.S0)(e,o,a,l),h=this._messagesUnits,d=(0,getDefaultUnitForView.K)(t.view);n.text=null!=h&&null!=p?(0,quantityFormatUtils.sz)(h,p,d):"",n.visible=!0;const m=r[0]-s[0],u=r[1]-s[1];i?(0,vec2.s)(SegmentLabels_V,-u,m):(0,vec2.s)(SegmentLabels_V,u,-m),(0,vec2.e)(SegmentLabels_V,SegmentLabels_V),(0,vec2.a)(SegmentLabels_V,SegmentLabels_V,this._edgeDistancePixels),(0,vec2.l)(SegmentLabels_P,s,r,.5),(0,vec2.i)(SegmentLabels_P,SegmentLabels_P,SegmentLabels_V),n.position=[SegmentLabels_P[0],SegmentLabels_P[1]],Math.abs(SegmentLabels_V[0])>Math.abs(SegmentLabels_V[1])?n.anchor=SegmentLabels_V[0]>0?"left":"right":n.anchor=-SegmentLabels_V[1]<0?"top":"bottom"}_getOrCreateLabel(t){const e=this._labelInfos.length>this._nextLabelIndex,{textColor:s,backgroundColor:o}=this._colors;if(e){const t=this._labelInfos[this._nextLabelIndex++],{label:e}=t;return e.textColor=s,e.backgroundColor=o,t}const r=new TextOverlayItem_x({anchor:"center",fontSize:10,textColor:s,backgroundColor:o});t.view.overlay?.items.add(r);const i={label:r};return this._labelInfos.push(i),this._nextLabelIndex=this._labelInfos.length,i}_destroyUnusedLabels(){for(;this._labelInfos.length>this._nextLabelIndex;)this._destroyLabel(this._labelInfos.pop())}_destroyLabel({label:t}){this.context?.view.overlay?.items.remove(t),t.destroy()}};(0,tslib_es6._)([(0,property.qq)()],SegmentLabels_O.prototype,"context",void 0),(0,tslib_es6._)([(0,property.qq)()],SegmentLabels_O.prototype,"stagedVertex",void 0),(0,tslib_es6._)([(0,property.qq)()],SegmentLabels_O.prototype,"visible",void 0),(0,tslib_es6._)([(0,property.qq)()],SegmentLabels_O.prototype,"edgeDistance",void 0),(0,tslib_es6._)([(0,property.qq)()],SegmentLabels_O.prototype,"updating",null),(0,tslib_es6._)([(0,property.qq)()],SegmentLabels_O.prototype,"_messagesUnits",void 0),(0,tslib_es6._)([(0,property.qq)()],SegmentLabels_O.prototype,"_edgeDistancePixels",null),(0,tslib_es6._)([(0,property.qq)()],SegmentLabels_O.prototype,"_colors",null),SegmentLabels_O=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive")],SegmentLabels_O);const SegmentLabels_V=(0,vec2f64.a)(),SegmentLabels_P=(0,vec2f64.a)(),SegmentLabels_G=(0,screenUtils.Yv)(),SegmentLabels_A=(0,screenUtils.Yv)();var viewUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/support/viewUtils.js");let SegmentLabels3D_a=class extends SegmentLabels_O{getCameraOrExtent({view:e}){return e.state.camera}toScreenPointArray({view:e,elevationInfo:t,editGeometryOperations:o},s,a=(0,screenUtils.Yv)()){const{spatialReference:m}=o.data.coordinateHelper;return(0,viewUtils.oi)(s,m,t,e,SegmentLabels3D_c),e.state.camera.projectToScreen(SegmentLabels3D_c,a),a}};SegmentLabels3D_a=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.SegmentLabels3D")],SegmentLabels3D_a);const SegmentLabels3D_c=(0,vec3f64.c)();var projectVectorToVector=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectVectorToVector.js"),vec4=__webpack_require__("./node_modules/@arcgis/core/chunks/vec4.js"),vec4f32=__webpack_require__("./node_modules/@arcgis/core/chunks/vec4f32.js"),clipRay=__webpack_require__("./node_modules/@arcgis/core/geometry/support/clipRay.js"),frustum=__webpack_require__("./node_modules/@arcgis/core/geometry/support/frustum.js"),lineSegment=__webpack_require__("./node_modules/@arcgis/core/geometry/support/lineSegment.js"),ray=__webpack_require__("./node_modules/@arcgis/core/geometry/support/ray.js"),Identifiable=__webpack_require__("./node_modules/@arcgis/core/core/Identifiable.js"),interfaces=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/interfaces.js"),ModelDirtyTypes=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/ModelDirtyTypes.js"),UpdatePolicy=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/UpdatePolicy.js");class DrapedVisualElementResources_n{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1,this._renderGroup=interfaces.a_.Outline}destroy(){this._destroyResources()}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncGeometriesToRenderer())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}get renderGroup(){return this._renderGroup}set renderGroup(e){this._renderGroup=e;const r=this._resources?.layerView;r&&(r.renderGroup=e)}recreate(){this.attached&&this._createResources()}recreateGeometry(){this._resourceFactory.recreateGeometry?null!=this._resources&&(this._ensureRenderGeometriesRemoved(),this._resourceFactory.recreateGeometry(this._resources.external),this._syncGeometriesToRenderer()):this.recreate()}_createOrDestroyResources(){this._attached?null==this._resources&&this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const e=this._resourceFactory.createResources(),r=new DrapedVisualElementResources_d({view:this._resourceFactory.view,renderGroup:this._renderGroup}),s=this._resourceFactory.view.basemapTerrain?.overlayManager;this._resources={layerView:new DrapedVisualElementResources_d({view:this._resourceFactory.view,renderGroup:this._renderGroup}),external:e,geometriesAdded:!1},s&&(this._resources.drapeSourceRenderer=s.registerGeometryDrapeSource(r)),this._syncGeometriesToRenderer()}_destroyResources(){if(null==this._resources)return;this._ensureRenderGeometriesRemoved();const e=this._resourceFactory.view.basemapTerrain?.overlayManager;e&&e.unregisterDrapeSource(this._resources.layerView),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncGeometriesToRenderer(){this._visible?this._ensureRenderGeometriesAdded():this._ensureRenderGeometriesRemoved()}_ensureRenderGeometriesRemoved(){null!=this._resources?.drapeSourceRenderer&&this._resources.geometriesAdded&&(this._resources.drapeSourceRenderer.removeGeometries(this._resources.external.geometries,ModelDirtyTypes.C.UPDATE),this._resources.geometriesAdded=!1)}_ensureRenderGeometriesAdded(){null!=this._resources?.drapeSourceRenderer&&(this._resources.geometriesAdded||(this._resources.drapeSourceRenderer.addGeometries(this._resources.external.geometries,ModelDirtyTypes.C.UPDATE),this._resources.geometriesAdded=!0))}}let DrapedVisualElementResources_d=class extends((0,Identifiable.MR)(Accessor.c)){constructor(e){super(e),this.drapeSourceType=interfaces.CU.Features,this.updatePolicy=UpdatePolicy.C.SYNC,this.renderGroup=interfaces.a_.Outline}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],DrapedVisualElementResources_d.prototype,"view",void 0),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],DrapedVisualElementResources_d.prototype,"drapeSourceType",void 0),(0,tslib_es6._)([(0,property.qq)()],DrapedVisualElementResources_d.prototype,"renderGroup",void 0),DrapedVisualElementResources_d=(0,tslib_es6._)([(0,subclass.c)("DrapedVisualElementLayerView")],DrapedVisualElementResources_d);class VisualElement_t{get isDecoration(){return this._isDecoration}set isDecoration(e){this._isDecoration=e}constructor(t){this._isDecoration=!1,this._attached=!1,this._resourcesCreated=!1,this._visible=!0,this.view=t.view,this._handle=(0,reactiveUtils.aE)((()=>t.view.ready),(e=>{this._resourcesCreated&&(e?this._createResources():this._destroyResources())}))}applyProperties(e){let t=!1;for(const s in e)s in this?"attached"===s?t=e[s]:this[s]=e[s]:console.error("Cannot set unknown property",s);this.attached=t}destroy(){this.attached=!1,this._handle.remove()}get attached(){return this._attached}set attached(e){e!==this._attached&&this.view._stage&&(this._attached=e,this._attached&&!this._resourcesCreated?this._createResources():!this._attached&&this._resourcesCreated&&this._destroyResources(),this.onAttachedChange(e))}onAttachedChange(e){}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this.attached&&this.updateVisibility(e))}_createResources(){this.createResources(),this._resourcesCreated=!0,this.updateVisibility(this.visible)}_destroyResources(){this.destroyResources(),this._resourcesCreated=!1}}var ContentObjectType=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/ContentObjectType.js"),Object3D=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Object3D.js"),WebGLLayer=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/WebGLLayer.js");class VisualElementResources_c{constructor(e){this._resourceFactory=e,this._resources=null,this._visible=!0,this._attached=!1}destroy(){this._destroyResources()}get object(){return null!=this._resources?this._resources.object:null}get resources(){return null!=this._resources?this._resources.external:null}get visible(){return this._visible}set visible(e){e!==this._visible&&(this._visible=e,this._syncVisible())}get attached(){return this._attached}set attached(e){e!==this._attached&&(this._attached=e,this._createOrDestroyResources())}recreate(){this.attached&&this._createResources()}recreateGeometry(){if(!this._resourceFactory.recreateGeometry)return void this.recreate();const e=this._resourceFactory.view._stage;if(null==this._resources||!e)return;const s=this._resources.object;this._resources.external.forEach((s=>{s.type!==ContentObjectType.C.Mesh&&s.type!==ContentObjectType.C.Line&&s.type!==ContentObjectType.C.Point||e.remove(s)})),s.removeAllGeometries(),this._resourceFactory.recreateGeometry(this._resources.external,s,this._resources.layer),this._resources.external.forEach((s=>{s.type!==ContentObjectType.C.Mesh&&s.type!==ContentObjectType.C.Line&&s.type!==ContentObjectType.C.Point||e.add(s)}))}_createOrDestroyResources(){this._attached?this._resources||this._createResources():this._destroyResources()}_createResources(){this._destroyResources();const c=this._resourceFactory,a=c.view,h=a._stage;if(!h)return;const u=new WebGLLayer.O(h,{pickable:!1,updatePolicy:UpdatePolicy.C.SYNC}),l=new Object3D.m({castShadow:!1}),n=c.createResources(l,u);n.forEach((e=>{h.add(e),e.type===ContentObjectType.C.Texture&&e.load(h.renderView.renderingContext)})),h.add(l),u.add(l);const _=c.cameraChanged,y=_?(0,reactiveUtils.aE)((()=>a.state.camera),(e=>_(e)),reactiveUtils._8):null;this._resources={layer:u,object:l,external:n,cameraHandle:y},this._syncVisible()}_destroyResources(){if(null==this._resources)return;const e=this._resourceFactory.view._stage;e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this._resources.external.forEach((s=>{e.remove(s),s.type===ContentObjectType.C.Texture&&s.unload()}))),this._resources.object.dispose(),this._resources.cameraHandle?.remove(),this._resourceFactory.destroyResources(this._resources.external),this._resources=null}_syncVisible(){null!=this._resources&&(this._resources.object.visible=this._visible)}}class EngineVisualElement_t extends VisualElement_t{constructor(s){super(s),this._isDraped=!1,this.object3dResources=new VisualElementResources_c(this.createObject3DResourceFactory(s.view)),this.drapedResources=new DrapedVisualElementResources_n(this.createDrapedResourceFactory(s.view)),this.isDraped=s.isDraped??!1}get isDraped(){return this._isDraped}set isDraped(e){e!==this._isDraped&&(this._isDraped=e,this.object3dResources.attached=this.attached&&!e,this.drapedResources.attached=this.attached&&e)}get renderGroup(){return this.drapedResources.renderGroup}set renderGroup(e){this.drapedResources.renderGroup=e}createResources(){this.object3dResources.attached=!this._isDraped,this.drapedResources.attached=this._isDraped}destroyResources(){this.object3dResources.attached=!1,this.drapedResources.attached=!1}recreate(){this.object3dResources.recreate(),this.drapedResources.recreate()}recreateGeometry(){this.object3dResources.recreateGeometry(),this.drapedResources.recreateGeometry()}destroy(){this.object3dResources.destroy(),this.drapedResources.destroy(),super.destroy()}updateVisibility(e){this.object3dResources.visible=e,this.drapedResources.visible=e}}var ViewingMode=__webpack_require__("./node_modules/@arcgis/core/views/ViewingMode.js"),DoubleArray=__webpack_require__("./node_modules/@arcgis/core/geometry/support/DoubleArray.js"),glUtil=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/buffer/glUtil.js"),InterleavedLayout=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/buffer/InterleavedLayout.js"),VertexArrayObject=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexArrayObject.js"),VertexAttribute=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/VertexAttribute.js"),ReloadableShaderModule=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ReloadableShaderModule.js"),ShaderTechnique=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechnique.js"),Program=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Program.js"),LaserlinePath_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/LaserlinePath.glsl.js"),enums=__webpack_require__("./node_modules/@arcgis/core/views/webgl/enums.js"),renderState=__webpack_require__("./node_modules/@arcgis/core/views/webgl/renderState.js");class LaserlinePathTechnique_m extends ShaderTechnique.O{initializeProgram(e){return new Program.G(e.rctx,LaserlinePathTechnique_m.shader.get().build(this.configuration),LaserlinePathTechnique_h)}initializePipeline(){return(0,renderState._w)({blending:(0,renderState.KO)(enums.w$.ONE,enums.w$.ONE_MINUS_SRC_ALPHA),colorWrite:renderState.kp})}}LaserlinePathTechnique_m.shader=new ReloadableShaderModule.O(LaserlinePath_glsl.L,(()=>__webpack_require__.e(37364).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/LaserlinePath.glsl.js"))));const LaserlinePathTechnique_h=new Map([[VertexAttribute.K.START,0],[VertexAttribute.K.END,1],[VertexAttribute.K.UP,2],[VertexAttribute.K.EXTRUDE,3]]);var BufferObject=__webpack_require__("./node_modules/@arcgis/core/views/webgl/BufferObject.js");class LaserlinePathData_c{constructor(e){this._renderCoordsHelper=e,this._buffers=null,this._origin=(0,vec3f64.c)(),this._dirty=!1,this._count=0,this._vao=null}set vertices(e){const t=(0,DoubleArray.Gg)(3*e.length);let r=0;for(const s of e)t[r++]=s[0],t[r++]=s[1],t[r++]=s[2];this.buffers=[t]}set buffers(t){if(this._buffers=t,this._buffers.length>0){const t=this._buffers[0],r=3*Math.floor(t.length/3/2);(0,vec3.s)(this._origin,t[r],t[r+1],t[r+2])}else(0,vec3.s)(this._origin,0,0,0);this._dirty=!0}get origin(){return this._origin}draw(e){const t=this._ensureVAO(e);null!=t&&(e.bindVAO(t),e.drawArrays(enums.Uf.TRIANGLES,0,this._count))}dispose(){null!=this._vao&&this._vao.dispose()}_ensureVAO(e){return null==this._buffers?null:(null==this._vao&&(this._vao=this._createVAO(e,this._buffers)),this._ensureVertexData(this._vao,this._buffers),this._vao)}_createVAO(e,t){const r=this._createDataBuffer(t);return this._dirty=!1,new VertexArrayObject._(e,LaserlinePathTechnique_h,{data:(0,glUtil.W)(LaserlinePathData_b)},{data:BufferObject.g.createVertex(e,enums._m.STATIC_DRAW,r)})}_ensureVertexData(e,t){if(!this._dirty)return;const r=this._createDataBuffer(t);e.vertexBuffers.data?.setData(r),this._dirty=!1}_numberOfRenderVertices(e){return 2*(e.length/3-1)*3}_createDataBuffer(r){const s=r.reduce(((e,t)=>e+this._numberOfRenderVertices(t)),0);this._count=s;const i=LaserlinePathData_b.createBuffer(s),o=this._origin;let n=0,u=0;for(const f of r){for(let r=0;r<f.length;r+=3){const s=(0,vec3.s)(LaserlinePathData_d,f[r],f[r+1],f[r+2]);0===r?u=this._renderCoordsHelper.getAltitude(s):this._renderCoordsHelper.setAltitude(s,u);const a=this._renderCoordsHelper.worldUpAtPosition(s,LaserlinePathData_),l=n+2*r,h=(0,vec3.f)(LaserlinePathData_d,s,o);if(r<f.length-3){i.up.setVec(l,a),i.up.setVec(l+3,a),i.up.setVec(l+5,a);for(let e=0;e<6;e++)i.start.setVec(l+e,h);i.extrude.setValues(l,0,-1),i.extrude.setValues(l+1,1,-1),i.extrude.setValues(l+2,1,1),i.extrude.setValues(l+3,0,-1),i.extrude.setValues(l+4,1,1),i.extrude.setValues(l+5,0,1)}if(r>0){i.up.setVec(l-2,a),i.up.setVec(l-4,a),i.up.setVec(l-5,a);for(let e=-6;e<0;e++)i.end.setVec(l+e,h)}}n+=this._numberOfRenderVertices(f)}return i.buffer}}const LaserlinePathData_=(0,vec3f64.c)(),LaserlinePathData_d=(0,vec3f64.c)(),LaserlinePathData_b=(0,InterleavedLayout.iC)().vec3f(VertexAttribute.K.START).vec3f(VertexAttribute.K.END).vec3f(VertexAttribute.K.UP).vec2f(VertexAttribute.K.EXTRUDE);var RenderPlugin=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/effects/RenderPlugin.js"),RenderSlot=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderSlot.js"),MaterialUtil=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/MaterialUtil.js"),ShaderTechniqueConfiguration=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderTechnique/ShaderTechniqueConfiguration.js");class LaserlinePathTechniqueConfiguration_e extends ShaderTechniqueConfiguration.K{constructor(){super(...arguments),this.contrastControlEnabled=!1}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],LaserlinePathTechniqueConfiguration_e.prototype,"contrastControlEnabled",void 0);var mathUtils=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),shaderModules_interfaces=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js"),DefaultVertexAttributeLocations=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/DefaultVertexAttributeLocations.js"),Laserlines_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/Laserlines.glsl.js");class LaserlineTechnique_f extends shaderModules_interfaces.a{constructor(){super(...arguments),this.innerColor=(0,vec3f64.f)(1,1,1),this.innerWidth=1,this.glowColor=(0,vec3f64.f)(1,.5,0),this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=.75,this.globalAlphaContrastBoost=2,this.angleCutoff=(0,mathUtils.EF)(6),this.pointDistanceOrigin=(0,vec3f64.c)(),this.pointDistanceTarget=(0,vec3f64.c)(),this.lineVerticalPlaneSegment=(0,lineSegment.Su)(),this.intersectsLineSegment=(0,lineSegment.Su)(),this.intersectsLineRadius=3,this.heightManifoldTarget=(0,vec3f64.c)(),this.lineStartWorld=(0,vec3f64.c)(),this.lineEndWorld=(0,vec3f64.c)()}}class LaserlineTechnique_p extends ShaderTechnique.O{initializeProgram(e){return new Program.G(e.rctx,LaserlineTechnique_p.shader.get().build(this.configuration),DefaultVertexAttributeLocations.q)}initializePipeline(){return(0,renderState._w)({blending:(0,renderState.KO)(enums.w$.ONE,enums.w$.ONE_MINUS_SRC_ALPHA),colorWrite:renderState.kp})}}LaserlineTechnique_p.shader=new ReloadableShaderModule.O(Laserlines_glsl.L,(()=>__webpack_require__.e(96192).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/Laserlines.glsl.js"))));class LaserlineTechniqueConfiguration_n extends LaserlinePathTechniqueConfiguration_e{constructor(){super(...arguments),this.heightManifoldEnabled=!1,this.pointDistanceEnabled=!1,this.lineVerticalPlaneEnabled=!1,this.intersectsLineEnabled=!1,this.spherical=!1}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],LaserlineTechniqueConfiguration_n.prototype,"heightManifoldEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],LaserlineTechniqueConfiguration_n.prototype,"pointDistanceEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],LaserlineTechniqueConfiguration_n.prototype,"lineVerticalPlaneEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],LaserlineTechniqueConfiguration_n.prototype,"intersectsLineEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],LaserlineTechniqueConfiguration_n.prototype,"spherical",void 0);let LaserLineRenderer_D=class extends RenderPlugin.Ul{constructor(e){super(e),this._technique=null,this._heightManifoldEnabled=!1,this._pointDistanceEnabled=!1,this._lineVerticalPlaneEnabled=!1,this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._viewingMode=ViewingMode.UZ.Local,this._pathVerticalPlaneEnabled=!1,this._pathVerticalPlaneData=null,this._pathTechnique=null,this._passParameters=new LaserlineTechnique_f,this.produces=new Map([[RenderSlot.y.LASERLINES,()=>!this.contrastControlEnabled],[RenderSlot.y.LASERLINES_CONTRAST_CONTROL,()=>this.contrastControlEnabled]])}initialize(){this._passParameters.renderCoordsHelper=this.renderCoordsHelper}consumes(){return RenderPlugin.Qn}get isDecoration(){return this._isDecoration}get heightManifoldEnabled(){return this._heightManifoldEnabled}set heightManifoldEnabled(e){this._heightManifoldEnabled!==e&&(this._heightManifoldEnabled=e,this._requestRender())}get heightManifoldTarget(){return this._passParameters.heightManifoldTarget}set heightManifoldTarget(e){(0,vec3.c)(this._passParameters.heightManifoldTarget,e),this._requestRender()}get pointDistanceEnabled(){return this._pointDistanceEnabled}set pointDistanceEnabled(e){e!==this._pointDistanceEnabled&&(this._pointDistanceEnabled=e,this._requestRender())}get pointDistanceTarget(){return this._passParameters.pointDistanceTarget}set pointDistanceTarget(e){(0,vec3.c)(this._passParameters.pointDistanceTarget,e),this._requestRender()}get pointDistanceOrigin(){return this._passParameters.pointDistanceOrigin}set pointDistanceOrigin(e){(0,vec3.c)(this._passParameters.pointDistanceOrigin,e),this._requestRender()}get lineVerticalPlaneEnabled(){return this._lineVerticalPlaneEnabled}set lineVerticalPlaneEnabled(e){e!==this._lineVerticalPlaneEnabled&&(this._lineVerticalPlaneEnabled=e,this._requestRender())}get lineVerticalPlaneSegment(){return this._passParameters.lineVerticalPlaneSegment}set lineVerticalPlaneSegment(e){(0,lineSegment.kT)(e,this._passParameters.lineVerticalPlaneSegment),this._requestRender()}get intersectsLineEnabled(){return this._intersectsLineEnabled}set intersectsLineEnabled(e){e!==this._intersectsLineEnabled&&(this._intersectsLineEnabled=e,this._requestRender())}get intersectsLineSegment(){return this._passParameters.intersectsLineSegment}set intersectsLineSegment(e){(0,lineSegment.kT)(e,this._passParameters.intersectsLineSegment),this._requestRender()}get intersectsLineRadius(){return this._passParameters.intersectsLineRadius}set intersectsLineRadius(e){e!==this._passParameters.intersectsLineRadius&&(this._passParameters.intersectsLineRadius=e,this._requestRender())}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){e!==this._intersectsLineInfinite&&(this._intersectsLineInfinite=e,this._requestRender())}get viewingMode(){return this._viewingMode}set viewingMode(e){e!==this._viewingMode&&(this._viewingMode=e,this._requestRender())}get pathVerticalPlaneEnabled(){return this._pathVerticalPlaneEnabled}set pathVerticalPlaneEnabled(e){e!==this._pathVerticalPlaneEnabled&&(this._pathVerticalPlaneEnabled=e,null!=this._pathVerticalPlaneData&&this._requestRender())}set pathVerticalPlaneVertices(e){null==this._pathVerticalPlaneData&&(this._pathVerticalPlaneData=new LaserlinePathData_c(this._passParameters.renderCoordsHelper)),this._pathVerticalPlaneData.vertices=e,this.pathVerticalPlaneEnabled&&this._requestRender()}set pathVerticalPlaneBuffers(e){null==this._pathVerticalPlaneData&&(this._pathVerticalPlaneData=new LaserlinePathData_c(this._passParameters.renderCoordsHelper)),this._pathVerticalPlaneData.buffers=e,this.pathVerticalPlaneEnabled&&this._requestRender()}setParameters(e){(0,MaterialUtil.S_)(this._passParameters,e)&&this._requestRender()}initializeRenderContext(e){this._context=e,this._techniqueRepository=e.techniqueRepository,this._techniqueConfig=new LaserlineTechniqueConfiguration_n;const t=new LaserlinePathTechniqueConfiguration_e;t.contrastControlEnabled=this.contrastControlEnabled,this._pathTechnique=this._techniqueRepository.acquire(LaserlinePathTechnique_m,t)}uninitializeRenderContext(){this._technique=(0,maybe.gT)(this._technique),this._pathVerticalPlaneData=(0,maybe.yI)(this._pathVerticalPlaneData),this._pathTechnique=(0,maybe.gT)(this._pathTechnique)}prepareTechnique(){return this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled?(this._techniqueConfig.heightManifoldEnabled=this.heightManifoldEnabled,this._techniqueConfig.lineVerticalPlaneEnabled=this.lineVerticalPlaneEnabled,this._techniqueConfig.pointDistanceEnabled=this.pointDistanceEnabled,this._techniqueConfig.intersectsLineEnabled=this.intersectsLineEnabled,this._techniqueConfig.contrastControlEnabled=this.contrastControlEnabled,this._techniqueConfig.spherical=this._viewingMode===ViewingMode.UZ.Global,this._technique=this._techniqueRepository.releaseAndAcquire(LaserlineTechnique_p,this._techniqueConfig,this._technique),this._technique):this._pathTechnique}renderNode(e,t){(this.heightManifoldEnabled||this.pointDistanceEnabled||this.lineVerticalPlaneSegment||this.intersectsLineEnabled)&&this._renderUnified(e,t),this.pathVerticalPlaneEnabled&&this._renderPath(e)}_renderUnified(e,t){const i=e.rctx;this._updatePassParameters(e),i.bindTechnique(t,this._passParameters,e.bindParameters),i.screen.draw()}_renderPath(e){if(null==this._pathVerticalPlaneData||null==this._pathTechnique)return;const t=e.rctx,i=this._pathTechnique;t.bindTechnique(i,{...this._passParameters,origin:this._pathVerticalPlaneData.origin},e.bindParameters),this._pathVerticalPlaneData.draw(e.rctx)}_updatePassParameters(e){if(!this._intersectsLineEnabled)return;const t=e.bindParameters.camera;if(this._intersectsLineInfinite){if((0,clipRay._y)((0,ray.em)(this._passParameters.intersectsLineSegment.origin,this._passParameters.intersectsLineSegment.vector),LaserLineRenderer_S),LaserLineRenderer_S.c0=-Number.MAX_VALUE,!(0,frustum.MJ)(t.frustum,LaserLineRenderer_S))return;(0,clipRay.Ap)(LaserLineRenderer_S,this._passParameters.lineStartWorld),(0,clipRay.YB)(LaserLineRenderer_S,this._passParameters.lineEndWorld)}else(0,vec3.c)(this._passParameters.lineStartWorld,this._passParameters.intersectsLineSegment.origin),(0,vec3.g)(this._passParameters.lineEndWorld,this._passParameters.intersectsLineSegment.origin,this._passParameters.intersectsLineSegment.vector)}_requestRender(){this._context&&this._context.requestRender()}get test(){return{passParameters:this._passParameters}}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],LaserLineRenderer_D.prototype,"contrastControlEnabled",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],LaserLineRenderer_D.prototype,"_isDecoration",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],LaserLineRenderer_D.prototype,"renderCoordsHelper",void 0),LaserLineRenderer_D=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.support.LaserLineRenderer")],LaserLineRenderer_D);const LaserLineRenderer_S=(0,clipRay.Su)();class LaserlineVisualElement_c extends VisualElement_t{constructor(e){super(e),this._angleCutoff=Laserlines_glsl.d,this._style={},this._heightManifoldTarget=(0,vec3f64.c)(),this._heightManifoldEnabled=!1,this._intersectsLine=(0,lineSegment.Su)(),this._intersectsLineEnabled=!1,this._intersectsLineInfinite=!1,this._lineVerticalPlaneSegment=null,this._pathVerticalPlaneBuffers=null,this._pointDistanceLine=null,this.applyProperties(e)}get testData(){return this._renderer}createResources(){this._ensureRenderer()}destroyResources(){this._disposeRenderer()}updateVisibility(){this._syncRenderer(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance()}get angleCutoff(){return this._angleCutoff}set angleCutoff(e){this._angleCutoff!==e&&(this._angleCutoff=e,this._syncAngleCutoff())}get style(){return this._style}set style(e){this._style=e,this._syncStyle()}get heightManifoldTarget(){return this._heightManifoldEnabled?this._heightManifoldTarget:null}set heightManifoldTarget(t){null!=t?((0,vec3.c)(this._heightManifoldTarget,t),this._heightManifoldEnabled=!0):this._heightManifoldEnabled=!1,this._syncRenderer(),this._syncHeightManifold()}set intersectsWorldUpAtLocation(e){if(null==e)return void(this.intersectsLine=null);const t=this.view.renderCoordsHelper.worldUpAtPosition(e,LaserlineVisualElement_);this.intersectsLine=(0,lineSegment.WK)(e,t),this.intersectsLineInfinite=!0}get intersectsLine(){return this._intersectsLineEnabled?this._intersectsLine:null}set intersectsLine(e){null!=e?((0,lineSegment.kT)(e,this._intersectsLine),this._intersectsLineEnabled=!0):this._intersectsLineEnabled=!1,this._syncIntersectsLine(),this._syncRenderer()}get intersectsLineInfinite(){return this._intersectsLineInfinite}set intersectsLineInfinite(e){this._intersectsLineInfinite=e,this._syncIntersectsLineInfinite()}get lineVerticalPlaneSegment(){return this._lineVerticalPlaneSegment}set lineVerticalPlaneSegment(e){this._lineVerticalPlaneSegment=null!=e?(0,lineSegment.kT)(e):null,this._syncLineVerticalPlane(),this._syncRenderer()}get pathVerticalPlane(){return this._pathVerticalPlaneBuffers}set pathVerticalPlane(e){this._pathVerticalPlaneBuffers=e,this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncRenderer()}get pointDistanceLine(){return this._pointDistanceLine}set pointDistanceLine(e){this._pointDistanceLine=null!=e?{origin:(0,vec3f64.g)(e.origin),target:e.target?(0,vec3f64.g)(e.target):null}:null,this._syncPointDistance(),this._syncRenderer()}_syncRenderer(){this.attached&&this.visible&&(this._intersectsLineEnabled||this._heightManifoldEnabled||null!=this._pointDistanceLine||null!=this._pathVerticalPlaneBuffers)?this._ensureRenderer():this._disposeRenderer()}_ensureRenderer(){null==this._renderer&&(this._renderer=new LaserLineRenderer_D({renderCoordsHelper:this.view.renderCoordsHelper,contrastControlEnabled:!0,_isDecoration:this.isDecoration}),this._renderer.viewingMode=this.view.state.viewingMode,this._syncStyle(),this._syncHeightManifold(),this._syncIntersectsLine(),this._syncIntersectsLineInfinite(),this._syncPathVerticalPlane(),this._syncLineVerticalPlane(),this._syncPointDistance(),this._syncAngleCutoff(),this.view._stage&&this.view._stage.addRenderPlugin(this._renderer))}_syncStyle(){null!=this._renderer&&(this._renderer.setParameters(this._style),null!=this._style.intersectsLineRadius&&(this._renderer.intersectsLineRadius=this._style.intersectsLineRadius))}_syncAngleCutoff(){null!=this._renderer&&this._renderer.setParameters({angleCutoff:this._angleCutoff})}_syncHeightManifold(){null!=this._renderer&&(this._renderer.heightManifoldEnabled=this._heightManifoldEnabled&&this.visible,this._heightManifoldEnabled&&(this._renderer.heightManifoldTarget=this._heightManifoldTarget))}_syncIntersectsLine(){null!=this._renderer&&(this._renderer.intersectsLineEnabled=this._intersectsLineEnabled&&this.visible,this._intersectsLineEnabled&&(this._renderer.intersectsLineSegment=this._intersectsLine))}_syncIntersectsLineInfinite(){null!=this._renderer&&(this._renderer.intersectsLineInfinite=this._intersectsLineInfinite)}_syncPathVerticalPlane(){null!=this._renderer&&(this._renderer.pathVerticalPlaneEnabled=null!=this._pathVerticalPlaneBuffers&&this.visible,null!=this._pathVerticalPlaneBuffers&&(this._renderer.pathVerticalPlaneBuffers=this._pathVerticalPlaneBuffers))}_syncLineVerticalPlane(){null!=this._renderer&&(this._renderer.lineVerticalPlaneEnabled=null!=this._lineVerticalPlaneSegment&&this.visible,null!=this._lineVerticalPlaneSegment&&(this._renderer.lineVerticalPlaneSegment=this._lineVerticalPlaneSegment))}_syncPointDistance(){if(null==this._renderer)return;const e=this._pointDistanceLine,t=null!=e;this._renderer.pointDistanceEnabled=t&&null!=e.target&&this.visible,t&&(this._renderer.pointDistanceOrigin=e.origin,null!=e.target&&(this._renderer.pointDistanceTarget=e.target))}_disposeRenderer(){null!=this._renderer&&this.view._stage&&(this.view._stage.removeRenderPlugin(this._renderer),this._renderer=null)}}const LaserlineVisualElement_=(0,vec3f64.c)();var OverlayRenderer=__webpack_require__("./node_modules/@arcgis/core/views/3d/terrain/OverlayRenderer.js"),GeometryUtil=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GeometryUtil.js"),Material=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Material.js"),RenderGeometry=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/RenderGeometry.js"),RibbonLineMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/RibbonLineMaterial.js");class ExtendedLineVisualElement_G extends EngineVisualElement_t{constructor(e){super(e),this._ray=(0,ray.Su)(),this._isWorldDown=!1,this._start=(0,vec3f64.c)(),this._end=(0,vec3f64.f)(1,0,0),this._width=1,this._color=(0,vec4f32.f)(1,0,1,1),this._polygonOffset=!1,this._writeDepthEnabled=!0,this._innerWidth=0,this._innerColor=(0,vec4f32.f)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._stipplePreferContinuous=!0,this._falloff=0,this._extensionType=ExtendedLineVisualElement_V.LINE,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=Material.C2.OccludeAndTransparent,this._fadedExtensions=ExtendedLineVisualElement_T,this._laserline=new LaserlineVisualElement_c({view:this.view,isDecoration:e.isDecoration}),this.applyProperties(e)}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:e=>this._destroyExternalResources(e),recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyExternalResources(e),recreateGeometry:e=>this._recreateDrapedGeometry(e)}}updateVisibility(e){super.updateVisibility(e),this._laserline.visible=e}onAttachedChange(){this._laserline.attached=this._laserlineAttached}setStartEndFromWorldDownAtLocation(r){this._isWorldDown=!0,(0,vec3.c)(this._start,r),this.view.renderCoordsHelper.worldUpAtPosition(r,this._end),(0,vec3.f)(this._end,r,this._end),(0,ray.i_)(this._start,this._end,this._ray),this._updateGeometry()}get start(){return this._start}set start(t){this._isWorldDown=!1,(0,vec3.h)(this._start,t)||((0,vec3.c)(this._start,t),(0,ray.i_)(this._start,this._end,this._ray),this._updateGeometry())}get end(){return this._end}set end(t){this._isWorldDown=!1,(0,vec3.h)(this._end,t)||((0,vec3.c)(this._end,t),(0,ray.i_)(this._start,this._end,this._ray),this._updateGeometry())}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,vec4.h)(e,this._color)||((0,vec4.c)(this._color,e),this._updateMaterial())}get polygonOffset(){return this._polygonOffset}set polygonOffset(e){e!==this._polygonOffset&&(this._polygonOffset=e,this._updateMaterial())}get writeDepthEnabled(){return this._writeDepthEnabled}set writeDepthEnabled(e){this._writeDepthEnabled!==e&&(this._writeDepthEnabled=e,this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,vec4.h)(e,this._innerColor)||((0,vec4.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){null!=e&&null!=this._stippleOffColor&&(0,vec4.h)(e,this._stippleOffColor)||(this._stippleOffColor=null!=e?(0,vec4f32.c)(e):null,this._updateMaterial())}get stipplePreferContinuous(){return this._stipplePreferContinuous}set stipplePreferContinuous(e){e!==this._stipplePreferContinuous&&(this._stipplePreferContinuous=e,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get extensionType(){return this._extensionType}set extensionType(e){e!==this._extensionType&&(this._extensionType=e,this.recreateGeometry())}get _laserlineAttached(){return this._laserlineEnabled&&null!=this._laserlineStyle&&this.attached&&!this.isDraped}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===Material.C2.OccludeAndTransparentStencil?Material.C2.OccludeAndTransparent:this._renderOccluded}get fadedExtensions(){return this._fadedExtensions}set fadedExtensions(e){this._fadedExtensions=e??ExtendedLineVisualElement_T,this.recreateGeometry()}_updateMaterial(){const{materialParameters:e}=this;this.object3dResources.resources?.material.setParameters(e),this.drapedResources.resources?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:this._stipplePreferContinuous,innerWidth:this._innerWidth,innerColor:this._innerColor,falloff:this._falloff,hasPolygonOffset:this._polygonOffset,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration,writeDepth:this._writeDepthEnabled}}_createObject3DResources(e){const t=new RibbonLineMaterial.O(this.materialParameters),r=new Array;return this._createObject3DGeometry(t,e,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_destroyExternalResources(e){e.geometries=[]}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,r){const s=this._createGeometry(e);r.push(s),t.addGeometry(s),this._updateVerticesObject3D(t)}_createDrapedResources(){const e=new RibbonLineMaterial.O(this.materialParameters);return{material:e,geometries:[this._createDrapedGeometry(e)]}}_recreateDrapedGeometry(e){e.geometries=[this._createDrapedGeometry(e.material)]}_createDrapedGeometry(e){const t=this._createGeometry(e);return this._updateVerticesDraped(t),new RenderGeometry.o(t)}_createGeometry(e){const t=this.extensionType===ExtendedLineVisualElement_V.FADED,r=t?[(0,vec3f64.c)(),(0,vec3f64.c)(),(0,vec3f64.c)(),(0,vec3f64.c)()]:[(0,vec3f64.c)(),(0,vec3f64.c)()];return(0,GeometryUtil.oF)(e,r,null,t?[1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0]:null)}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=this.object3dResources.object;e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this._lineSegment;this._updateVertexAttributesObject3D(e,t),this._laserline.intersectsLine=t}_updateVerticesDraped(e){this._updateVertexAttributesDraped(e,this._lineSegment)}get _lineSegment(){return this._extensionType===ExtendedLineVisualElement_V.FADED?this._updateLineSegmentFinite(ExtendedLineVisualElement_S):this._updateLineSegmentInfinite(this._extensionType,ExtendedLineVisualElement_S)}_updateLineSegmentFinite(e){return(0,lineSegment.i_)(this._start,this._end,e)}_updateLineSegmentInfinite(e,t){const r=this.view.state.camera;switch((0,clipRay._y)(this._ray,ExtendedLineVisualElement_P),e){case ExtendedLineVisualElement_V.LINE:ExtendedLineVisualElement_P.c0=-Number.MAX_VALUE;break;case ExtendedLineVisualElement_V.RAY:case ExtendedLineVisualElement_V.GROUND_RAY:{const e=this._ray.origin,t=this.view.elevationProvider.getElevation(e[0],e[1],e[2],this.view.renderCoordsHelper.spatialReference,"ground")??0,r=this.view.renderCoordsHelper.getAltitude(e);this._isWorldDown&&r<t&&(0,vec3.E)(ExtendedLineVisualElement_P.ray.direction,ExtendedLineVisualElement_P.ray.direction),this._extensionType===ExtendedLineVisualElement_V.GROUND_RAY&&null!=t&&(ExtendedLineVisualElement_P.c1=Math.abs(r-t));break}}if(!(0,frustum.MJ)(r.frustum,ExtendedLineVisualElement_P))return this._updateLineSegmentFinite(t);const i=(0,clipRay.Ap)(ExtendedLineVisualElement_P,ExtendedLineVisualElement_x),n=(0,clipRay.YB)(ExtendedLineVisualElement_P,ExtendedLineVisualElement_v);return(0,lineSegment.i_)(i,n,t)}_updateVertexAttributesObject3D(e,t){const r=e.geometries[0].getMutableAttribute(VertexAttribute.K.POSITION)?.data;if(!r)return;let s=0;for(const i of this._lineVertices(t))r[s++]=i[0],r[s++]=i[1],r[s++]=i[2];e.geometryVertexAttributeUpdated(e.geometries[0],VertexAttribute.K.POSITION)}_updateVertexAttributesDraped(e,t){const r=e.getMutableAttribute(VertexAttribute.K.POSITION)?.data;if(!r)return;let s=0;for(const i of this._lineVertices(t))r[s++]=i[0],r[s++]=i[1],r[s++]=OverlayRenderer.IY;e.invalidateBoundingInfo()}*_lineVertices(e){this.extensionType===ExtendedLineVisualElement_V.FADED?(yield(0,lineSegment.KO)(e,-this.fadedExtensions.start,ExtendedLineVisualElement_x),yield(0,lineSegment.KO)(e,0,ExtendedLineVisualElement_x),yield(0,lineSegment.KO)(e,1,ExtendedLineVisualElement_x),yield(0,lineSegment.KO)(e,1+this.fadedExtensions.end,ExtendedLineVisualElement_x)):(yield(0,lineSegment.KO)(e,0,ExtendedLineVisualElement_x),yield(0,lineSegment.KO)(e,1,ExtendedLineVisualElement_x))}}const ExtendedLineVisualElement_P=(0,clipRay.Su)(),ExtendedLineVisualElement_x=(0,vec3f64.c)(),ExtendedLineVisualElement_v=(0,vec3f64.c)(),ExtendedLineVisualElement_S=(0,lineSegment.Su)();var ExtendedLineVisualElement_V;!function(e){e[e.LINE=0]="LINE",e[e.RAY=1]="RAY",e[e.GROUND_RAY=2]="GROUND_RAY",e[e.FADED=3]="FADED"}(ExtendedLineVisualElement_V||(ExtendedLineVisualElement_V={}));const ExtendedLineVisualElement_T={start:.3333333333333333,end:.3333333333333333};var dehydratedPoint=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedPoint.js");class ParallelLineVisualElement_x extends EngineVisualElement_t{constructor(e){super(e),this._location=(0,vec3f64.c)(),this._direction=(0,vec3f64.f)(1,0,0),this._width=1,this._offset=1,this._length=18,this._color=(0,vec4f32.f)(1,0,1,1),this._renderOccluded=Material.C2.OccludeAndTransparent,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:e=>this._destroyObject3DResources(e),recreateGeometry:(e,t)=>this._recreateObject3DGeometry(e,t),cameraChanged:()=>this._updateGeometry()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyDrapedResources(e),recreateGeometry:e=>this._recreateDrapedGeometry(e)}}get location(){return this._location}set location(e){(0,vec3.h)(this._location,e)||((0,vec3.c)(this._location,e),this._updateGeometry())}get direction(){return this._direction}set direction(e){(0,vec3.h)(this._direction,e)||((0,vec3.c)(this._direction,e),this._updateGeometry())}setDirectionFromPoints(e,t){(0,vec3.n)(this._direction,(0,vec3.f)(this._direction,t,e)),this._updateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get offset(){return this._offset}set offset(e){e!==this._offset&&(this._offset=e,this._updateGeometry())}get length(){return this._length}set length(e){e!==this._length&&(this._length=e,this._updateGeometry())}get color(){return this._color}set color(e){(0,vec4.h)(e,this._color)||((0,vec4.c)(this._color,e),this._updateMaterial())}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}_createObject3DResources(e){const t=new RibbonLineMaterial.O(this.materialParameters),r=new Array;return this._createObject3DGeometry(t,e,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_destroyObject3DResources(e){e.geometries.length=0}_recreateObject3DGeometry(e,t){e.geometries.length=0,this._createObject3DGeometry(e.material,t,e.geometries)}_createObject3DGeometry(e,t,r){const[s,i]=this._createGeometries(e);t.addGeometry(s),t.addGeometry(i),r.push(s),r.push(i),this._updateVerticesObject3D(t)}_createDrapedResources(){const t=new RibbonLineMaterial.O(this.materialParameters),r=(0,reactiveUtils.aE)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}));return{material:t,geometries:this._createDrapedGeometry(t),pixelRatioHandle:r}}_destroyDrapedResources(e){e.pixelRatioHandle.remove(),e.geometries=[]}_recreateDrapedGeometry(e){e.geometries=this._createDrapedGeometry(e.material)}_createDrapedGeometry(e){const t=this._createGeometries(e);return this._updateVerticesDraped(t),t.map((e=>new RenderGeometry.o(e)))}_createGeometries(e){return[(0,GeometryUtil.oF)(e,[(0,vec3f64.c)(),(0,vec3f64.c)()]),(0,GeometryUtil.oF)(e,[(0,vec3f64.c)(),(0,vec3f64.c)()])]}_updateMaterial(){const{materialParameters:e}=this;this.object3dResources.resources?.material.setParameters(e),this.drapedResources.resources?.material.setParameters(e)}get materialParameters(){return{width:this._width,color:this._color,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateGeometry(){if(this.isDraped)this.drapedResources.recreateGeometry();else{const e=this.object3dResources.object;e&&this._updateVerticesObject3D(e)}}_updateVerticesObject3D(e){const t=this.view.state.camera;t.projectToScreen(this.location,ParallelLineVisualElement_M),(0,vec3.g)(ParallelLineVisualElement_P,this.location,this.direction),t.projectToScreen(ParallelLineVisualElement_P,ParallelLineVisualElement_I),(0,vec2.e)(ParallelLineVisualElement_I,(0,vec2.c)(ParallelLineVisualElement_I,ParallelLineVisualElement_I,ParallelLineVisualElement_M)),this._updateVertexAttributesObject3D(t,e,0,ParallelLineVisualElement_M,ParallelLineVisualElement_I,1),this._updateVertexAttributesObject3D(t,e,1,ParallelLineVisualElement_M,ParallelLineVisualElement_I,-1)}_updateVertexAttributesObject3D(e,r,s,i,o,a){const c=r.geometries[s],n=c.getMutableAttribute(VertexAttribute.K.POSITION)?.data;if(!n)return;const{start:d,end:h}=this._computeStartEnd(o,i,a,this.offset,this.width,this.length);e.unprojectFromScreen((0,screenUtils.iS)(d),ParallelLineVisualElement_P),n[0]=ParallelLineVisualElement_P[0],n[1]=ParallelLineVisualElement_P[1],n[2]=ParallelLineVisualElement_P[2],e.unprojectFromScreen((0,screenUtils.iS)(h),ParallelLineVisualElement_P),n[3]=ParallelLineVisualElement_P[0],n[4]=ParallelLineVisualElement_P[1],n[5]=ParallelLineVisualElement_P[2],r.geometryVertexAttributeUpdated(c,VertexAttribute.K.POSITION)}_updateVerticesDraped(e){const{view:{basemapTerrain:{overlayManager:t},state:{contentPixelRatio:r}}}=this,{location:s,width:i,length:o,offset:a}=this,c=ParallelLineVisualElement_E;c.spatialReference=t.renderer.spatialReference,c.x=s[0],c.y=s[1];const n=this.view.overlayPixelSizeInMapUnits(c)*r,d=i*n,h=o*n,u=a*n;this._updateVertexAttributesDraped(e[0],d,h,u,-1),this._updateVertexAttributesDraped(e[1],d,h,u,1)}_updateVertexAttributesDraped(e,t,r,s,i){const o=e.getMutableAttribute(VertexAttribute.K.POSITION)?.data;if(!o)return;const{location:a,direction:c}=this,{start:n,end:d}=this._computeStartEnd(c,a,i,s,t,r);o[0]=n[0],o[1]=n[1],o[2]=OverlayRenderer.IY,o[3]=d[0],o[4]=d[1],o[5]=OverlayRenderer.IY,e.invalidateBoundingInfo()}_computeStartEnd(e,t,r,s,i,n){const d=(0,vec2.a)(ParallelLineVisualElement_V,(0,vec2.s)(ParallelLineVisualElement_V,e[1]*r,e[0]*-r),s+i/2),h=(0,vec2.i)(ParallelLineVisualElement_A,(0,vec2.i)(ParallelLineVisualElement_A,(0,vec2.i)(ParallelLineVisualElement_A,t,(0,vec2.a)(ParallelLineVisualElement_A,e,n/2)),d),d);return{start:h,end:(0,vec2.i)(ParallelLineVisualElement_S,h,(0,vec2.a)(ParallelLineVisualElement_S,e,-n))}}}const ParallelLineVisualElement_P=(0,vec3f64.c)(),ParallelLineVisualElement_V=(0,vec2f64.a)(),ParallelLineVisualElement_A=(0,vec2f64.a)(),ParallelLineVisualElement_S=(0,vec2f64.a)(),ParallelLineVisualElement_M=(0,screenUtils.Yv)(),ParallelLineVisualElement_I=(0,screenUtils.Yv)(),ParallelLineVisualElement_E=(0,dehydratedPoint.A)(0,0,void 0,null);var vec4f64=__webpack_require__("./node_modules/@arcgis/core/chunks/vec4f64.js"),aaBoundingBox=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js"),vectorStacks=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vectorStacks.js"),mat4=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4.js"),mat4f64=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4f64.js");class Object3DVisualElement_a extends VisualElement_t{constructor(e){super(e),this._resources=null,this._transform=(0,mat4f64.a)()}get object(){return null!=this._resources?this._resources.object:null}get transform(){return this._transform}set transform(s){(0,mat4.h)(this._transform,s),null!=this._resources&&(this._resources.object.transformation=this._transform)}recreate(){this.attached&&this.createResources()}recreateGeometry(){if(null==this._resources)return;const e=this._resources.object,s=this.view._stage;s.removeMany(e.geometries),e.removeAllGeometries(),this.createGeometries(e),e.visible=this.visible,s.addMany(e.geometries)}createResources(){this.destroyResources();const e=this.view._stage;if(!e)return;const s=new WebGLLayer.O(e,{pickable:!1,updatePolicy:UpdatePolicy.C.SYNC}),r=new Object3D.m({castShadow:!1});r.transformation=this._transform,this.createExternalResources(),this.createGeometries(r),e.addMany(r.geometries),this.forEachExternalMaterial((s=>e.add(s))),e.add(r),s.add(r),r.visible=this.visible,this._resources={layer:s,object:r}}destroyResources(){const e=this.view._stage;null!=this._resources&&e&&(e.remove(this._resources.object),this._resources.layer.destroy(),this.forEachExternalMaterial((s=>{e.remove(s)})),e.removeMany(this._resources.object.geometries),this._resources.object.dispose(),this.destroyExternalResources(),this._resources=null)}updateVisibility(e){null!=this._resources&&(this._resources.object.visible=e)}}var elevationAlignmentUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/graphics/elevationAlignmentUtils.js"),ElevationContext=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/graphics/ElevationContext.js"),sdfPrimitives=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/engineContent/sdfPrimitives.js"),HUDMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/HUDMaterial.js");class PointVisualElement_x extends Object3DVisualElement_a{constructor(e){super(e),this._material=null,this._texture=null,this._geometry=null,this._size=3,this._color=(0,vec4f64.f)(1,0,1,1),this._pixelSnappingEnabled=!0,this._primitive="square",this._outlineSize=1,this._outlineColor=(0,vec4f64.f)(1,1,1,1),this._elevationInfo=null,this.applyProperties(e)}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get size(){return this._size}set size(e){if(e!==this._size){const t=this._preferredTextureSize;this._size=e,t<this._preferredTextureSize?this.recreate():this._updateSizeAttribute()}}get color(){return this._color}set color(e){(0,vec4.h)(e,this._color)||((0,vec4.c)(this._color,e),this._updateMaterial())}get pixelSnappingEnabled(){return this._pixelSnappingEnabled}set pixelSnappingEnabled(e){this._pixelSnappingEnabled!==e&&(this._pixelSnappingEnabled=e,this._updateMaterial())}get primitive(){return this._primitive}set primitive(e){this._primitive!==e&&(this._primitive=e,this.recreate())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,vec4.h)(e,this._outlineColor)||((0,vec4.c)(this._outlineColor,e),this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}_updateMaterial(){this._material&&this._material.setParameters(this._materialParameters)}_updateSizeAttribute(){const e=this.object;if(null==e)return;const t=e.geometries[0];if(null==t)return;const i=t.getMutableAttribute(VertexAttribute.K.SIZE).data,r=this._geometrySize;i[0]=r,i[1]=r,e.geometryVertexAttributeUpdated(e.geometries[0],VertexAttribute.K.SIZE)}get _materialParameters(){return{color:this._color,textureIsSignedDistanceField:!0,sampleSignedDistanceFieldTexelCenter:(0,sdfPrimitives.s7)(this._primitive),distanceFieldBoundingBox:PointVisualElement_v,occlusionTest:!1,outlineColor:this._outlineColor,outlineSize:this._outlineSize,textureId:this._texture?.id,polygonOffset:!1,shaderPolygonOffset:0,drawInSecondSlot:!0,depthEnabled:!1,pixelSnappingEnabled:this.pixelSnappingEnabled,isDecoration:this.isDecoration}}get _geometrySize(){return this._size/PointVisualElement_S}createExternalResources(){this._texture=(0,sdfPrimitives.Cg)(this._primitive,this._preferredTextureSize),this._material=new HUDMaterial.Q(this._materialParameters);const e=this.view._stage;this._texture.load(e.renderView.renderingContext),e.add(this._texture)}destroyExternalResources(){this._texture&&(this.view._stage.remove(this._texture),this._texture.dispose(),this._texture=null),this._material=null}createGeometries(e){const t=this._createRenderGeometry();null!=t&&e.addGeometry(t)}forEachExternalMaterial(e){this._material&&e(this._material)}get _preferredTextureSize(){return(0,mathUtils.qk)(2*this._geometrySize,16,128)}calculateMapBounds(e){const t=this.object?.geometries[0];if(!t)return!1;const i=t.attributes.get(VertexAttribute.K.POSITION);return(0,projectVectorToVector.Z)(i.data,this.view.renderCoordsHelper.spatialReference,PointVisualElement_y,this.view.spatialReference),(0,aaBoundingBox.qe)(e,PointVisualElement_y),!0}_createRenderGeometry(){const{geometry:e,_material:i}=this;if(null==e||null==i)return null;const{renderCoordsHelper:r,elevationProvider:s}=this.view,o=(0,elevationAlignmentUtils.eG)(e,s,ElevationContext.E.fromElevationInfo(this.elevationInfo),r),l=(0,vec3.s)(vectorStacks.Wq.get(),e.x,e.y,o),u=vectorStacks.Wq.get();(0,projectVectorToVector.Z)(l,e.spatialReference,u,r.spatialReference);const p=this._geometrySize;return(0,GeometryUtil.Oc)(i,null,u,null,[p,p],[0,0,0,1])}}const PointVisualElement_S=sdfPrimitives.Mp,PointVisualElement_v=[PointVisualElement_S/2,PointVisualElement_S/2,1-PointVisualElement_S/2,1-PointVisualElement_S/2],PointVisualElement_y=(0,vec3f64.c)();var Attribute=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Attribute.js"),Geometry=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Geometry.js"),ColorMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/ColorMaterial.js");class RightAngleQuadVisualElement_z extends EngineVisualElement_t{constructor(e){super(e),this._maxSize=0,this._position=(0,vec3f64.c)(),this._up=(0,vec3f64.c)(),this._right=(0,vec3f64.c)(),this._renderOccluded=Material.C2.OccludeAndTransparent,this._color=(0,vec4f64.f)(1,0,0,1),this._outlineColor=(0,vec4f64.f)(0,0,0,1),this._outlineSize=0,this._size=32,this._outlineRenderOccluded=Material.C2.Opaque,this.applyProperties(e)}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:()=>{},cameraChanged:()=>this._updateTransformObject3D()}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyDrapedResources(e)}}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateQuadMaterial())}get color(){return this._color}set color(e){(0,vec4.c)(this._color,e),this._updateQuadMaterial()}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,vec4.c)(this._outlineColor,e),this._updateOutlineMaterial()}get outlineSize(){return this._outlineSize}set outlineSize(e){const t=0===this._outlineSize!=(0===e);this._outlineSize=e,t?this.recreateGeometry():this._updateOutlineMaterial()}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateTransform())}get outlineRenderOccluded(){return this._outlineRenderOccluded}set outlineRenderOccluded(e){this._outlineRenderOccluded=e,this._updateOutlineMaterial()}set geometry({previous:e,center:t,next:r}){this._maxSize=Math.min((0,vec3.o)(t,e),(0,vec3.o)(t,r))/3,(0,vec3.n)(this._up,(0,vec3.f)(this._up,e,t)),(0,vec3.n)(this._right,(0,vec3.f)(this._right,r,t)),(0,vec3.c)(this._position,t),this.recreateGeometry()}_createObject3DResources(e){const t=new ColorMaterial.U(this._quadMaterialParameters),r=0===this._outlineSize?void 0:new RibbonLineMaterial.O(this._outlineMaterialParameters);return this._createObject3DGeometries(e,t,r),{quadMaterial:t,outlineMaterial:r,forEach:e=>{e(t),r&&e(r)}}}_createObject3DGeometries(e,t,r){if((0,vec3.h)(this._up,vec3f64.Z)&&(0,vec3.h)(this._right,vec3f64.Z))return;const i=this._createGeometries(t,r);for(const s of i)e.addGeometry(s);this._updateTransformObject3D(e)}_createDrapedResources(){const t=new ColorMaterial.U(this._quadMaterialParameters),r=0===this._outlineSize?void 0:new RibbonLineMaterial.O(this._outlineMaterialParameters),i=this._createGeometries(t,r).map((e=>new RenderGeometry.o(e)));return this._setTransformDraped(i),{quadMaterial:t,outlineMaterial:r,geometries:i,pixelRatioHandle:(0,reactiveUtils.aE)((()=>this.view.state.contentPixelRatio),(()=>{this.drapedResources.recreateGeometry()}))}}_destroyDrapedResources(e){e.pixelRatioHandle.remove(),e.geometries=[]}_createGeometries(e,t){const{up:r,right:i,corner:s}=this._getVertices(),a=this._quadGeometryData(r,i,s,e);return t?[a,(0,GeometryUtil.oF)(t,[r,s,i])]:[a]}_getVertices(){let e=this._up,t=this._right;const r=(0,vec3.g)(vectorStacks.Wq.get(),e,t);return this.isDraped&&(e=(0,vec3.c)(vectorStacks.Wq.get(),e),t=(0,vec3.c)(vectorStacks.Wq.get(),t),e[2]=0,t[2]=0,r[2]=0),{up:e,right:t,corner:r}}_updateTransform(){this.isDraped?this.drapedResources.recreateGeometry():this._updateTransformObject3D()}_updateTransformObject3D(e=this.object3dResources.object){if(!e)return;const i=this.view.state.camera,s=this._size*i.computeScreenPixelSizeAt(this._position),a=Math.min(this._maxSize,s);(0,mat4.d)(RightAngleQuadVisualElement_P,this._position),(0,mat4.b)(RightAngleQuadVisualElement_P,RightAngleQuadVisualElement_P,[a,a,a]),e.transformation=RightAngleQuadVisualElement_P}_setTransformDraped(e){if(0===e.length)return;const{view:{basemapTerrain:{overlayManager:i},state:{contentPixelRatio:s}}}=this,{_position:a,_size:o}=this,c=(0,vec3.c)(vectorStacks.Wq.get(),a);c[2]=OverlayRenderer.IY;const u=RightAngleQuadVisualElement_v;u.spatialReference=i.renderer.spatialReference,u.x=c[0],u.y=c[1];const l=o*(this.view.overlayPixelSizeInMapUnits(u)*s),d=Math.min(this._maxSize,l);(0,mat4.d)(RightAngleQuadVisualElement_P,c),(0,mat4.b)(RightAngleQuadVisualElement_P,RightAngleQuadVisualElement_P,[d,d,1]);for(const t of e)t.transformation=RightAngleQuadVisualElement_P}_quadGeometryData(e,t,r,i){return new Geometry.K(i,[[VertexAttribute.K.POSITION,new Attribute.O([0,0,0,...t,...e,...r],[0,1,2,1,2,3],3,!0)]])}get _quadMaterialParameters(){return{color:this._color,forceTransparentMode:!0,writeDepth:!1,polygonOffset:!0,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateQuadMaterial(){this.object3dResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters),this.drapedResources.resources?.quadMaterial.setParameters(this._quadMaterialParameters)}get _outlineMaterialParameters(){return{color:this._outlineColor,width:this._outlineSize,renderOccluded:this._outlineRenderOccluded,isDecoration:this.isDecoration}}_updateOutlineMaterial(){this.object3dResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters),this.drapedResources.resources?.outlineMaterial?.setParameters(this._outlineMaterialParameters)}}const RightAngleQuadVisualElement_P=(0,mat4f64.a)(),RightAngleQuadVisualElement_v=(0,dehydratedPoint.A)(0,0,void 0,null);var normalizedPoint=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/normalizedPoint.js"),Settings=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/Settings.js"),SnappingDomain=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDomain.js"),snappingUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),SnappingVisualizer=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingVisualizer.js"),LineSnappingHint=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/LineSnappingHint.js");class SnappingVisualizer3D_O extends SnappingVisualizer.W{sortUniqueHints(e){return e.sort(((e,n)=>(n instanceof LineSnappingHint.q?n.length:0)-(e instanceof LineSnappingHint.q?e.length:0)))}visualizeIntersectionPoint(e,n){const{spatialReference:t,view:r}=n,o=SnappingVisualizer3D_D(n);return(0,handleUtils.sX)(new PointVisualElement_x({view:r,primitive:"circle",geometry:(0,normalizedPoint.Uz)(e.intersectionPoint,t),elevationInfo:e.isDraped?elevationInfoUtils.s6:elevationInfoUtils.IP,size:20,outlineSize:2,color:o.intersectionPointColor,outlineColor:o.intersectionPointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizePoint(e,n){const{view:t,spatialReference:r}=n,o=SnappingVisualizer3D_D(n),a=SnappingVisualizer3D_R(e.point,e.domain,n);return(0,handleUtils.sX)(new PointVisualElement_x({view:t,primitive:"circle",geometry:(0,normalizedPoint.Uz)(a,r),elevationInfo:SnappingVisualizer3D_A(e,n),size:20,outlineSize:2,color:o.pointColor,outlineColor:o.pointOutlineColor,pixelSnappingEnabled:!1,isDecoration:!0,attached:!0}))}visualizeLine(e,n){const{view:t,spatialReference:r}=n,o=SnappingVisualizer3D_D(n),a=SnappingVisualizer3D_R(e.lineStart,e.domain,n),l=SnappingVisualizer3D_R(e.lineEnd,e.domain,n);return(0,handleUtils.sX)(this._createLineSegmentHint(e.type,a,l,r,SnappingVisualizer3D_A(e,n),t,o,e.isDraped,e.fadeLeft,e.fadeRight))}visualizeParallelSign(e,n){const{view:r,spatialReference:o}=n,a=SnappingVisualizer3D_D(n),{isDraped:l}=e,s=SnappingVisualizer3D_A(e,n),p=SnappingVisualizer3D_R(e.lineStart,e.domain,n),d=SnappingVisualizer3D_R(e.lineEnd,e.domain,n),u=SnappingVisualizer3D_x(p,o,s,r,l),g=SnappingVisualizer3D_x(d,o,s,r,l),v=(0,vec3.p)(g,u,g,.5),E=new ParallelLineVisualElement_x({view:r,attached:!1,offset:Settings.Q.parallelLineHintOffset,length:Settings.Q.parallelLineHintLength,width:Settings.Q.parallelLineHintWidth,color:a.parallelSignColor,location:v,renderOccluded:l?Material.C2.OccludeAndTransparent:Material.C2.Opaque,isDraped:l,renderGroup:interfaces.a_.SnappingHint,isDecoration:!0});return E.setDirectionFromPoints(u,v),E.attached=!0,(0,handleUtils.sX)(E)}visualizeRightAngleQuad(e,n){const{view:t,spatialReference:r}=n,o=SnappingVisualizer3D_D(n),a=SnappingVisualizer3D_A(e,n),{isDraped:l}=e,s=SnappingVisualizer3D_R(e.previousVertex,e.domain,n),p=SnappingVisualizer3D_R(e.centerVertex,e.domain,n),c=SnappingVisualizer3D_R(e.nextVertex,e.domain,n),d=SnappingVisualizer3D_x(s,r,a,t,l),g=SnappingVisualizer3D_x(p,r,a,t,l),v=SnappingVisualizer3D_x(c,r,a,t,l);return(0,handleUtils.sX)(new RightAngleQuadVisualElement_z({view:t,attached:!0,color:l?o.rightAngleColorDraped:o.rightAngleColor,renderOccluded:l?Material.C2.OccludeAndTransparent:Material.C2.Transparent,outlineRenderOccluded:l?Material.C2.OccludeAndTransparent:Material.C2.Opaque,outlineColor:o.rightAngleOutlineColor,outlineSize:Settings.Q.rightAngleHintOutlineSize,size:Settings.Q.rightAngleHintSize,isDraped:l,geometry:{previous:d,center:g,next:v},renderGroup:interfaces.a_.SnappingHint,isDecoration:!0}))}_createLineSegmentHint(e,n,i,t,r,o,a,l=!1,c=!0,d=!0){const u=SnappingVisualizer3D_x(n,t,r,o,l),g=SnappingVisualizer3D_x(i,t,r,o,l),v=new ExtendedLineVisualElement_G({view:o,extensionType:ExtendedLineVisualElement_V.FADED,start:u,end:g,isDraped:l,color:a.lineColor,renderOccluded:l?Material.C2.OccludeAndTransparent:Material.C2.Opaque,renderGroup:interfaces.a_.SnappingHint,isDecoration:!0});switch(e){case snappingUtils.Iv.TARGET:v.width=Settings.Q.lineHintWidthTarget,v.fadedExtensions={start:0,end:Settings.Q.lineHintFadedExtensions};break;case snappingUtils.Iv.REFERENCE_EXTENSION:v.width=Settings.Q.lineHintWidthReference,v.fadedExtensions={start:0,end:0};break;case snappingUtils.Iv.REFERENCE:v.width=Settings.Q.lineHintWidthReference,v.fadedExtensions={start:c?Settings.Q.lineHintFadedExtensions:0,end:d?Settings.Q.lineHintFadedExtensions:0}}return v.attached=!0,v}}function SnappingVisualizer3D_D(i){const{effectiveTheme:t}=i.view,r=Color.c.toUnitRGBA(t.accentColor),o=[0,0,0,0];return{intersectionPointColor:o,intersectionPointOutlineColor:r,pointColor:o,pointOutlineColor:r,lineColor:r,lineOutlineColor:void 0,parallelSignColor:r,rightAngleColor:r,rightAngleColorDraped:Color.c.toUnitRGBA((0,colorUtils.iw)(t.accentColor,.5)),rightAngleOutlineColor:r}}function SnappingVisualizer3D_R(e,n,i){const t=SnappingVisualizer3D_H(n,i);return null==t?e:(0,normalizedPoint.Su)(e[0],e[1],t)}function SnappingVisualizer3D_A(e,n){return null!=SnappingVisualizer3D_H(e.domain,n)?n.selfSnappingZ.elevationInfo:e.isDraped?elevationInfoUtils.s6:elevationInfoUtils.IP}function SnappingVisualizer3D_H(e,{selfSnappingZ:n}){return e===SnappingDomain.e.SELF&&null!=n?n.value:null}function SnappingVisualizer3D_x(e,n,i,t,a,l=(0,vec3f64.c)()){if(a){const i=t.basemapTerrain.overlayManager.renderer.spatialReference;(0,projectVectorToVector.Z)(e,n,l,i)}else(0,viewUtils.oi)(e,n,i,t,l);return l}var sources_interfaces=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/sources/interfaces.js");function meshFastUpdateUtils_o(n){const{graphic:o}=n;return[(0,reactiveUtils.aE)((()=>n.displaying),(e=>{e?function meshFastUpdateUtils_s(e){const{geometry:t}=e;meshFastUpdateUtils_a(t)&&e.notifyMeshTransformChanged({action:sources_interfaces.C.EnableFastUpdates})}(o):meshFastUpdateUtils_i(o)}),{...reactiveUtils.KG}),(0,handleUtils.uU)((()=>meshFastUpdateUtils_i(o)))]}function meshFastUpdateUtils_i(e){const{geometry:t}=e;meshFastUpdateUtils_a(t)&&e.notifyMeshTransformChanged({action:sources_interfaces.C.DisableFastUpdates})}function meshFastUpdateUtils_a(e){return"mesh"===e?.type&&!e.vertexSpace.isGeoreferenced}var lineStippleUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/lineStippleUtils.js");function settings_u(o,t){t&&Object.assign(o,t)}class settings_g{constructor(o){this.height=90,this.coneHeight=40,this.coneWidth=23,this.width=3,this.renderOccluded=Material.C2.Opaque,this.color=o.accent}}class settings_f{constructor({colors:o,...t}){this.size=11,this.outlineSize=1,this.collisionPadding=9,this.color=o.accent,this.outlineColor=o.outline,this.renderOccluded=Material.C2.Opaque,this.hoverOutlineColor=o.selectedOutline,settings_u(this,t)}applyColor(o){this._apply(this.color,o)}applyOutline(o){this._apply(this.outlineColor,o)}applyHoverOutline(o){this._apply(this.hoverOutlineColor,o)}_apply(o,t){t.setParameters({color:(0,colorUtils.aS)(o),renderOccluded:this.renderOccluded})}}class settings_w{constructor({colors:o,...t}){this.size=40,this.height=.2,this.offset=.25,this.collisionPadding=2,this.renderOccluded=Material.C2.Transparent,this.minSquaredEdgeLength=900,this.color=(0,colorUtils.iw)(o.accent,.5),this.hoverColor=o.accent,settings_u(this,t)}applyColor(o){this._apply(this.color,o)}applyHover(o){this._apply(this.hoverColor,o)}_apply(o,t){t.setParameters({color:(0,colorUtils.aS)(o),renderOccluded:this.renderOccluded})}}class settings_C{constructor(o){this.vertex=new settings_f({colors:o,color:o.accent,outlineColor:o.outline}),this.edge=new settings_f({colors:o,color:(0,colorUtils.MZ)((0,colorUtils.iw)(o.accent,2/3),.5),outlineColor:(0,colorUtils.iw)(o.outline,.5),size:8,collisionPadding:8}),this.selected=new settings_f({colors:o,color:o.selected,outlineColor:o.outline}),this.edgeOffset=new settings_w({colors:o})}}class settings_m{constructor({colors:o,...t}){this.width=1.5,this.stipplePattern=(0,lineStippleUtils.ui)(3.3),this.falloff=0,this.innerWidth=1.5,this.renderOccluded=Material.C2.OccludeAndTransparent,this.color=o.selected,this.stippleOffColor=o.outline,this.innerColor=o.selected,settings_u(this,t)}apply(o){o.color=(0,colorUtils.aS)(this.color),o.width=this.width,o.stipplePattern=this.stipplePattern,o.stippleOffColor=(0,colorUtils.aS)(this.stippleOffColor),o.falloff=this.falloff,o.innerWidth=this.innerWidth,o.innerColor=(0,colorUtils.aS)(this.innerColor),o.renderOccluded=this.renderOccluded}}class settings_O{constructor({colors:o,...t}){this.size=4,this.outlineSize=1,this.shape="square",this.color=o.selected,this.outlineColor=o.outline,settings_u(this,t)}apply(o){o.color=(0,colorUtils.aS)(this.color),o.size=this.size,o.outlineSize=this.outlineSize,o.outlineColor=(0,colorUtils.aS)(this.outlineColor),o.primitive=this.shape}}class settings_y{constructor({colors:o,...t}){this.innerWidth=1,this.glowWidth=8,this.glowFalloff=8,this.globalAlpha=.3,this.globalAlphaContrastBoost=1.5,this.radius=3,this.innerColor=o.selected,this.glowColor=o.accent,this.heightFillColor=o.accent,settings_u(this,t)}apply(o,e=1){const l={glowColor:Color.c.toUnitRGB(this.glowColor),glowFalloff:this.glowFalloff,glowWidth:this.glowWidth,innerColor:Color.c.toUnitRGB(this.innerColor),innerWidth:this.innerWidth,globalAlpha:this.globalAlpha*e*this.glowColor.a,globalAlphaContrastBoost:this.globalAlphaContrastBoost,intersectsLineRadius:this.radius};"style"in o?o.style=l:o.laserlineStyle=l}}class settings_A{constructor(o){this.outline=new settings_m({colors:o,color:o.stippleOff,renderOccluded:Material.C2.OccludeAndTransparentStencil,stippleOffColor:o.stippleOn,innerWidth:0}),this.staged=new settings_m({colors:o,color:o.stippleOn,renderOccluded:Material.C2.OccludeAndTransparentStencil,innerColor:o.stagedSolid,stippleOffColor:o.stippleOff}),this.shadowStyle=new settings_y({colors:o,globalAlpha:.3,glowColor:o.accent,glowFalloff:8,glowWidth:8,innerColor:o.selected,innerWidth:1})}}class W{constructor(o){this.outline=new settings_O({colors:o,color:o.selected,outlineColor:o.outline,outlineSize:1,shape:"circle",size:4}),this.shadowStyle=new settings_y({colors:o,globalAlpha:.3,glowColor:o.accent,glowFalloff:1.5,glowWidth:6,innerColor:o.selected,innerWidth:1,radius:2})}}class settings_S extends settings_m{constructor({colors:o,...t}){super({colors:o}),this.extensionType=ExtendedLineVisualElement_V.GROUND_RAY,settings_u(this,t)}}class settings_b{constructor(o){this.laserlineAlphaMultiplier=1.5,this.heightPlaneAngleCutoff=20,this.lineGraphics=new settings_A(o),this.pointGraphics=new W(o),this.heightPlane=new settings_y({colors:o,globalAlpha:.3,glowColor:o.accent,glowFalloff:8,glowWidth:8,innerColor:o.selected,innerWidth:1}),this.heightBox=new settings_y({colors:o,globalAlpha:.3,glowColor:o.accent,glowFalloff:8,glowWidth:8,innerColor:o.selected,innerWidth:0,heightFillColor:o.accent}),this.zVerticalLine=new settings_S({colors:o,color:(0,colorUtils.iw)(o.accent,.5),falloff:2,innerColor:(0,colorUtils.iw)(o.selected,0),renderOccluded:Material.C2.OccludeAndTransparent,stipplePattern:null,width:5,extensionType:ExtendedLineVisualElement_V.GROUND_RAY})}}let settings_z=class extends Accessor.c{constructor(o){super(o)}get colors(){const o=this.getTheme().accentColor,e=o.a;return{accent:o,contrast:(0,colorUtils.u8)(o),selected:Color.c.fromArray([255,255,255,e]),selectedOutline:Color.c.fromArray([255,255,255,e]),staged:Color.c.fromArray([12,207,255,e]),stagedSolid:Color.c.fromArray([12,207,255,1]),outline:Color.c.fromArray([0,0,0,.5*e]),stippleOn:Color.c.fromArray([255,255,255,1]),stippleOff:Color.c.fromArray([0,0,0,.5])}}get visualElements(){return new settings_b(this.colors)}get manipulators(){return new settings_C(this.colors)}get zManipulator(){return new settings_g(this.colors)}};(0,tslib_es6._)([(0,property.qq)()],settings_z.prototype,"colors",null),(0,tslib_es6._)([(0,property.qq)()],settings_z.prototype,"visualElements",null),(0,tslib_es6._)([(0,property.qq)()],settings_z.prototype,"manipulators",null),(0,tslib_es6._)([(0,property.qq)()],settings_z.prototype,"zManipulator",null),(0,tslib_es6._)([(0,property.qq)()],settings_z.prototype,"getTheme",void 0),settings_z=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.editingTools.settings.Settings")],settings_z);var Evented=__webpack_require__("./node_modules/@arcgis/core/core/Evented.js"),projectBuffer=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectBuffer.js"),line=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/engineContent/line.js"),renderInfoUtils_line=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/renderInfoUtils/line.js");class OutlineVisualElement_w extends EngineVisualElement_t{constructor(t){super(t),this._attachmentOrigin=(0,dehydratedPoint.A)(0,0,0,null),this._attachmentOriginDirty=!0,this.events=new Evented.c,this._geometry=null,this._width=1,this._color=(0,vec4f32.f)(1,0,1,1),this._innerWidth=0,this._innerColor=(0,vec4f32.f)(1,1,1,1),this._stipplePattern=null,this._stippleOffColor=null,this._falloff=0,this._elevationInfo=null,this._laserlineStyle=null,this._laserlineEnabled=!1,this._renderOccluded=Material.C2.OccludeAndTransparentStencil,this._attachmentOrigin.spatialReference=t.view.spatialReference,this._laserline=new LaserlineVisualElement_c({view:t.view,isDecoration:t.isDecoration}),this.applyProperties(t),this.attached=t.attached??!0}destroy(){this._laserline.destroy(),super.destroy()}createObject3DResourceFactory(e){return{view:e,createResources:e=>this._createObject3DResources(e),destroyResources:e=>this._destroyExternalResources(e),recreateGeometry:(e,t)=>{e.geometries.length=0,this._recreateGeometry(t,e.material,e.geometries)}}}createDrapedResourceFactory(e){return{view:e,createResources:()=>this._createDrapedResources(),destroyResources:e=>this._destroyExternalResources(e),recreateGeometry:e=>{e.geometries=this._createRenderGeometriesDraped(e.material),this._attachmentOriginChanged()}}}get _laserlineAttached(){return this.attached&&this.visible&&null!=this._laserlineStyle&&!this.isDraped&&this.laserlineEnabled}onAttachedChange(e){this._laserline.attached=this._laserlineAttached,e&&this._attachmentOriginChanged()}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get width(){return this._width}set width(e){e!==this._width&&(this._width=e,this._updateMaterial())}get color(){return this._color}set color(e){(0,vec4.h)(e,this._color)||((0,vec4.c)(this._color,e),this._updateMaterial())}get innerWidth(){return this._innerWidth}set innerWidth(e){e!==this._innerWidth&&(this._innerWidth=e,this._updateMaterial())}get innerColor(){return this._innerColor}set innerColor(e){(0,vec4.h)(e,this._innerColor)||((0,vec4.c)(this._innerColor,e),this._updateMaterial())}get stipplePattern(){return this._stipplePattern}set stipplePattern(e){const t=null!=e!=(null!=this._stipplePattern);this._stipplePattern=e,t?this.recreate():this._updateMaterial()}get stippleOffColor(){return this._stippleOffColor}set stippleOffColor(e){e&&this._stippleOffColor&&(0,vec4.h)(e,this._stippleOffColor)||(this._stippleOffColor=e?(0,vec4f32.c)(e):null,this._updateMaterial())}get falloff(){return this._falloff}set falloff(e){e!==this._falloff&&(this._falloff=e,this._updateMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get laserlineStyle(){return this._laserlineStyle}set laserlineStyle(e){this._laserlineStyle=e,this._laserline.attached=this._laserlineAttached,null!=e&&(this._laserline.style=e)}get laserlineEnabled(){return this._laserlineEnabled}set laserlineEnabled(e){this._laserlineEnabled!==e&&(this._laserlineEnabled=e,this._laserline.attached=this._laserlineAttached)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get attachmentOrigin(){if(!this._attachmentOriginDirty)return this._attachmentOrigin;const e=this.object3dResources.resources?.geometries;if(!e||0===e.length)return null;(0,vec3.s)(OutlineVisualElement_P,0,0,0);let s=0;for(const t of e)t.computeAttachmentOrigin(OutlineVisualElement_D)&&((0,vec3.g)(OutlineVisualElement_P,OutlineVisualElement_P,OutlineVisualElement_D),s++);return 0===s?null:((0,vec3.i)(OutlineVisualElement_P,OutlineVisualElement_P,1/s),this.view.renderCoordsHelper.fromRenderCoords(OutlineVisualElement_P,this._attachmentOrigin),this._attachmentOriginDirty=!1,this._attachmentOrigin)}_updateMaterial(){null!=this.object3dResources.resources&&this.object3dResources.resources.material.setParameters(this._materialParameters),null!=this.drapedResources.resources&&this.drapedResources.resources.material.setParameters(this._materialParameters)}get _isClosed(){return null!=this.geometry&&"polygon"===this.geometry.type}get _materialParameters(){return{width:this._width,color:this._color,stippleOffColor:this._stippleOffColor,stipplePattern:this._stipplePattern,stipplePreferContinuous:!1,isClosed:this._isClosed,falloff:this._falloff,innerColor:this._innerColor,innerWidth:this._innerWidth,join:"round",hasPolygonOffset:!0,renderOccluded:this._normalizedRenderOccluded,isDecoration:this.isDecoration}}get _normalizedRenderOccluded(){return this.isDraped&&this._renderOccluded===Material.C2.OccludeAndTransparentStencil?Material.C2.OccludeAndTransparent:this._renderOccluded}_recreateGeometry(e,t,r){this._createRenderGeometries(t,r);for(const i of r)e.addGeometry(i);this._attachmentOriginChanged()}_attachmentOriginChanged(){this._attachmentOriginDirty=!0,this.events.emit("attachment-origin-changed")}_destroyExternalResources(e){e.geometries=[]}_createObject3DResources(e){const t=new RibbonLineMaterial.O(this._materialParameters),r=new Array;return this._recreateGeometry(e,t,r),{material:t,geometries:r,forEach:e=>{e(t),r.forEach(e)}}}_createDrapedResources(){const e=new RibbonLineMaterial.O(this._materialParameters);return{material:e,geometries:this._createRenderGeometriesDraped(e)}}_createRenderGeometriesDraped(e){const{geometry:t,view:r}=this,i=r.basemapTerrain.spatialReference;return null==t||null==i?[]:(0,renderInfoUtils_line.C)(t,i).lines.map((({position:t})=>{const s={overlayInfo:{spatialReference:i,renderCoordsHelper:r.renderCoordsHelper},attributeData:{position:t},removeDuplicateStartEnd:this._isClosed};return new RenderGeometry.o((0,line.M)(e,s))}))}calculateMapBounds(e){if(null==this.object3dResources.resources)return!1;const t=this.view.renderCoordsHelper;for(const r of this.object3dResources.resources.geometries){const i=r.attributes.get(VertexAttribute.K.POSITION),s=(0,DoubleArray.Gg)(i.data.length);(0,projectBuffer.projectBuffer)(i.data,t.spatialReference,0,s,this.view.spatialReference,0,i.data.length/3),(0,aaBoundingBox.qe)(e,s)}return!0}_createRenderGeometries(e,t){const r=this.geometry;if(null==r)return;const i=(0,renderInfoUtils_line.y)(r,this.view.elevationProvider,this.view.renderCoordsHelper,ElevationContext.E.fromElevationInfo(this.elevationInfo??new ElevationInfo.c({mode:(0,elevationInfoUtils.m6)(r,null)}))),s=new Array;for(const{position:n,mapPositions:o}of i.lines){const r={mapPositions:o,attributeData:{position:n},removeDuplicateStartEnd:this._isClosed};t.push((0,line.M)(e,r)),s.push(n)}this._laserline.pathVerticalPlane=s}}const OutlineVisualElement_D=(0,vec3f64.c)(),OutlineVisualElement_P=(0,vec3f64.c)();var basicInterfaces=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/basicInterfaces.js"),BufferView=__webpack_require__("./node_modules/@arcgis/core/geometry/support/buffer/BufferView.js"),ShaderOutput=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ShaderOutput.js"),GLMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLMaterial.js"),Util=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Util.js"),bufferWriterUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/internal/bufferWriterUtils.js"),OrderIndependentTransparency=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/OrderIndependentTransparency.js"),TransparencyPassType=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/TransparencyPassType.js"),DefaultTechniqueConfiguration=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultTechniqueConfiguration.js"),ShadedColorMaterial_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/ShadedColorMaterial.glsl.js");class ShadedColorMaterialTechnique_T extends ShaderTechnique.O{initializeProgram(e){return new Program.G(e.rctx,ShadedColorMaterialTechnique_T.shader.get().build(this.configuration),ShadedColorMaterialTechnique_v)}_setPipelineState(e){const r=this.configuration,o=e===TransparencyPassType.H.NONE,i=e===TransparencyPassType.H.FrontFace;return(0,renderState._w)({blending:r.output!==ShaderOutput.m.Color&&r.output!==ShaderOutput.m.Alpha||!r.transparent?null:o?OrderIndependentTransparency.yU:(0,OrderIndependentTransparency.y2)(e),culling:(0,renderState.AD)(r.cullFace),depthTest:{func:i?enums.et.LESS:r.shadingEnabled?enums.et.LEQUAL:enums.et.LESS},depthWrite:o?r.writeDepth?renderState.AT:null:(0,OrderIndependentTransparency.A9)(e),colorWrite:renderState.kp,polygonOffset:o||i?null:OrderIndependentTransparency.sz})}initializePipeline(){return this._setPipelineState(this.configuration.transparencyPassType)}}ShadedColorMaterialTechnique_T.shader=new ReloadableShaderModule.O(ShadedColorMaterial_glsl.S,(()=>__webpack_require__.e(17016).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ShadedColorMaterial.glsl.js"))));class ShadedColorMaterialTechnique_j extends DefaultTechniqueConfiguration.Q{constructor(){super(...arguments),this.output=ShaderOutput.m.Color,this.cullFace=basicInterfaces.CM.None,this.transparencyPassType=TransparencyPassType.H.NONE,this.hasSlicePlane=!1,this.transparent=!1,this.writeDepth=!0,this.screenSizeEnabled=!0,this.shadingEnabled=!0,this.multipassEnabled=!1,this.cullAboveGround=!1}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)({count:ShaderOutput.m.COUNT})],ShadedColorMaterialTechnique_j.prototype,"output",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)({count:basicInterfaces.CM.COUNT})],ShadedColorMaterialTechnique_j.prototype,"cullFace",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)({count:TransparencyPassType.H.COUNT})],ShadedColorMaterialTechnique_j.prototype,"transparencyPassType",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ShadedColorMaterialTechnique_j.prototype,"hasSlicePlane",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ShadedColorMaterialTechnique_j.prototype,"transparent",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ShadedColorMaterialTechnique_j.prototype,"writeDepth",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ShadedColorMaterialTechnique_j.prototype,"screenSizeEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ShadedColorMaterialTechnique_j.prototype,"shadingEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ShadedColorMaterialTechnique_j.prototype,"multipassEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ShadedColorMaterialTechnique_j.prototype,"cullAboveGround",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)({constValue:!1})],ShadedColorMaterialTechnique_j.prototype,"occlusionPass",void 0);const ShadedColorMaterialTechnique_v=new Map([[VertexAttribute.K.POSITION,0],[VertexAttribute.K.NORMAL,1],[VertexAttribute.K.OFFSET,2]]);class ShadedColorMaterial_j extends Material.iK{constructor(e){super(e,new ShadedColorMaterial_v),this.supportsEdges=!0,this._configuration=new ShadedColorMaterialTechnique_j,this._vertexAttributeLocations=ShadedColorMaterialTechnique_v}getConfiguration(e,t){return this._configuration.output=e,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this._isTransparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.screenSizeEnabled=this.parameters.screenSizeEnabled,this._configuration.shadingEnabled=this.parameters.shadingEnabled,this._configuration.transparencyPassType=t.transparencyPassType,this._configuration.multipassEnabled=t.multipassEnabled,this._configuration.cullAboveGround=t.multipassTerrain.cullAboveGround,this._configuration}intersect(e,s,a,c,l,u){if(this.parameters.screenSizeEnabled){const s=e.attributes.get(VertexAttribute.K.OFFSET),h={applyToVertex:(e,n,o,c)=>{const l=(0,vec3.s)(ShadedColorMaterial_z,s.data[3*c],s.data[3*c+1],s.data[3*c+2]),u=(0,vec3.s)(ShadedColorMaterial_L,e,n,o);return(0,vec3.i)(l,l,this.parameters.screenSizeScale*a.camera.computeScreenPixelSizeAt(l)),(0,vec3.g)(u,u,l),[u[0],u[1],u[2]]},applyToAabb:e=>{const t=(0,aaBoundingBox.Uw)(e,ShadedColorMaterial_z);return(0,aaBoundingBox.aU)(e,this.parameters.screenSizeScale*a.camera.computeScreenPixelSizeAt(t))}};(0,MaterialUtil.Ep)(e,a,c,l,h,u)}else(0,MaterialUtil.Ep)(e,a,c,l,void 0,u)}produces(e,t){if(t===ShaderOutput.m.Highlight)return e===RenderSlot.y.OPAQUE_MATERIAL;if(t===ShaderOutput.m.Color||t===ShaderOutput.m.Alpha||t===ShaderOutput.m.ObjectAndLayerIdColor){let t=RenderSlot.y.OPAQUE_MATERIAL;return this._isTransparent&&(t=this.parameters.writeDepth?RenderSlot.y.TRANSPARENT_MATERIAL:RenderSlot.y.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL),e===t||e===RenderSlot.y.DRAPED_MATERIAL}return!1}createGLMaterial(e){return new ShadedColorMaterial_O(e)}createBufferWriter(){return new ShadedColorMaterial_w(this.parameters.screenSizeEnabled)}get _isTransparent(){return this.parameters.color[3]<1||this.parameters.forceTransparentMode}}class ShadedColorMaterial_O extends GLMaterial.c{beginSlot(e){return this.ensureTechnique(ShadedColorMaterialTechnique_T,e)}}class ShadedColorMaterial_v extends Material.oL{constructor(){super(...arguments),this.color=(0,vec4f64.f)(1,1,1,1),this.shadingTint=(0,vec4f64.f)(0,0,0,.25),this.shadingDirection=(0,vec3.n)((0,vec3f64.c)(),[.5,-.5,-.5]),this.screenSizeScale=14,this.forceTransparentMode=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=basicInterfaces.CM.None,this.screenSizeEnabled=!1,this.shadingEnabled=!0}}class ShadedColorMaterial_w{constructor(e){this.screenSizeEnabled=e;const t=(0,InterleavedLayout.iC)().vec3f(VertexAttribute.K.POSITION).vec3f(VertexAttribute.K.NORMAL);this.screenSizeEnabled&&t.vec3f(VertexAttribute.K.OFFSET),this.vertexBufferLayout=t}elementCount(e){return e.attributes.get(VertexAttribute.K.POSITION).indices.length}write(e,t,r,i,s){if((0,bufferWriterUtils.OC)(r,this.vertexBufferLayout,e,t,i,s),this.screenSizeEnabled){if(!r.attributes.has(VertexAttribute.K.OFFSET))throw new Error(`${VertexAttribute.K.OFFSET} vertex attribute required for screenSizeEnabled ShadedColorMaterial`);{const e=r.attributes.get(VertexAttribute.K.OFFSET);(0,Util.Uc)(3===e.size);const a=i.getField(VertexAttribute.K.OFFSET,BufferView.Yj);if(!a)throw new Error("unable to acquire view for "+VertexAttribute.K.OFFSET);(0,bufferWriterUtils.uL)(e,t,a,s)}}}}const ShadedColorMaterial_z=(0,vec3f64.c)(),ShadedColorMaterial_L=(0,vec3f64.c)();class VerticesVisualElement_d extends Object3DVisualElement_a{constructor(e){super(e),this.view=null,this._renderOccluded=Material.C2.OccludeAndTransparent,this._vertices=null,this._spatialReference=null,this._color=(0,vec4f64.b)([1,127/255,0,1]),this._size=11,this._outlineColor=(0,vec4f64.b)([0,0,0,.5]),this._outlineSize=1,this._elevationInfo=null,this.applyProperties(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial(),this._updateOutlineMaterial())}get vertices(){return this._vertices}set vertices(e){this._vertices=e,this.recreateGeometry()}get spatialReference(){return this._spatialReference}set spatialReference(e){this._spatialReference=e,this.recreateGeometry()}get color(){return this._color}set color(e){(0,vec4.h)(e,this._color)||((0,vec4.c)(this._color,e),this._updateMaterial())}get size(){return this._size}set size(e){e!==this._size&&(this._size=e,this._updateMaterial())}get outlineColor(){return this._outlineColor}set outlineColor(e){(0,vec4.h)(e,this._outlineColor)||((0,vec4.c)(this._outlineColor,e),this._updateOutlineMaterial())}get outlineSize(){return this._outlineSize}set outlineSize(e){e!==this._outlineSize&&(this._outlineSize=e,this._updateOutlineMaterial())}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this.recreateGeometry()}get _vertexMaterialParameters(){return{color:this._color,screenSizeScale:this.size,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}get _vertexOutlineMaterialParameters(){return{color:this._outlineColor,screenSizeScale:this.size+2*this.outlineSize,renderOccluded:this._renderOccluded,isDecoration:this.isDecoration}}_updateMaterial(){this.attached&&this._vertexMaterial.setParameters(this._vertexMaterialParameters)}_updateOutlineMaterial(){this.attached&&this._vertexOutlineMaterial.setParameters(this._vertexOutlineMaterialParameters)}_createRenderGeometries(){const t=this.vertices;if(null==t||0===t.length)return[];const s=function point_o(o,n,r,s,i){const l=(0,DoubleArray.Gg)(3*o.length),p=(0,DoubleArray.Gg)(l.length);o.forEach(((t,e)=>{l[3*e]=t[0],l[3*e+1]=t[1],l[3*e+2]=t.length>2?t[2]:0}));const c=(0,elevationAlignmentUtils.A5)(l,n,0,p,0,l,0,l.length/3,r,s,i),m=null!=c;return{numVertices:o.length,position:l,mapPositions:p,projectionSuccess:m,sampledElevation:c}}(t,this.spatialReference,this.view.elevationProvider,this.view.renderCoordsHelper,ElevationContext.E.fromElevationInfo(this.elevationInfo)),a=[],n=s.numVertices,c=s.position;for(let l=0;l<n;++l){const t=(0,vec3.s)(VerticesVisualElement_,c[3*l],c[3*l+1],c[3*l+2]),s=VerticesVisualElement_m(this._vertexMaterial,.5,t),o=VerticesVisualElement_m(this._vertexOutlineMaterial,.5,t);a.push({vertexGeometry:s,vertexOutlineGeometry:o})}return a}createGeometries(e){const t=this._createRenderGeometries();for(const{vertexGeometry:r,vertexOutlineGeometry:i}of t)e.addGeometry(r),e.addGeometry(i)}createExternalResources(){this._vertexMaterial=new ShadedColorMaterial_j({...this._vertexMaterialParameters,writeDepth:!0,cullFace:basicInterfaces.CM.Back,screenSizeEnabled:!0}),this._vertexOutlineMaterial=new ShadedColorMaterial_j({...this._vertexOutlineMaterialParameters,forceTransparentMode:!0,writeDepth:!0,cullFace:basicInterfaces.CM.Front,screenSizeEnabled:!0,shadingEnabled:!1})}destroyExternalResources(){this._vertexMaterial=null,this._vertexOutlineMaterial=null}forEachExternalMaterial(e){e(this._vertexMaterial),e(this._vertexOutlineMaterial)}}const VerticesVisualElement_=(0,vec3f64.c)();function VerticesVisualElement_m(e,t,r){return(0,GeometryUtil.R1)(e,t,16,16,{offset:r})}let GraphicState_e=class extends Evented.c.EventedAccessor{constructor(r){super(r),this.tracking=!1,this.displaying=!1,this.isDraped=!1}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],GraphicState_e.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicState_e.prototype,"tracking",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicState_e.prototype,"displaying",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicState_e.prototype,"isDraped",void 0),GraphicState_e=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.layers.graphics.GraphicState")],GraphicState_e);var DrawGraphicTool=__webpack_require__("./node_modules/@arcgis/core/views/draw/DrawGraphicTool.js"),DrawOperation=__webpack_require__("./node_modules/@arcgis/core/views/draw/DrawOperation.js"),drawSurfaces=__webpack_require__("./node_modules/@arcgis/core/views/draw/drawSurfaces.js"),unitUtils=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js");const helpMessageUtils3d_m=20,helpMessageUtils3d_c=1,helpMessageUtils3d_a=.1,helpMessageUtils3d_u=(0,vec3f64.c)();let DrawGraphicTool3D_z=class extends DrawGraphicTool.CS{constructor(e){super(e),this._activeVertexVisualElement=null,this._createGraphicState=null,this._outlineVisualElement=null,this._verticesVisualElement=null,this._verticalLineVisualElement=null,this._settings=new settings_z({getTheme:()=>this.view.effectiveTheme}),this.geometryType=null,this.type="draw-3d"}initialize(){const{mode:e,offset:t}=this.elevationInfo;this.internalGraphicsLayer.elevationInfo=new ElevationInfo.c({mode:e,offset:t})}normalizeCtorArgs(e){if(!e.elevationInfo){const t=e.hasZ??!0;return{...e,elevationInfo:(0,elevationInfoUtils.yO)(t)}}return e}initializeGraphic(e){const{view:t}=this,r=this._createGraphicState=new GraphicState_e({graphic:e});return(0,handleUtils.Ip)([t.maskOccludee(e),t.trackGraphicState(r),(0,reactiveUtils.aE)((()=>({element:this._outlineVisualElement,isDraped:r.isDraped})),(({element:e,isDraped:t})=>{e&&(e.isDraped=t)}),reactiveUtils.KG),this._setupLoadingIndicator(r),...meshFastUpdateUtils_o(r)])}updateDrawMeshTooltipInfo(e){const{graphic:t,tooltipOptions:i,view:r}=this;e.tooltipOptions=i,e.viewType=r.type,e.helpMessage=function helpMessageUtils3d_i(r,i){const f=r?.geometry;if(!r||"mesh"!==f?.type||!i)return;const{renderCoordsHelper:h,elevationProvider:p}=i,{camera:l}=i.state,{extent:d}=f,{center:v,spatialReference:x}=d,g=(0,unitUtils.k8)(x),j=(0,unitUtils.gl)(x),z=(0,unitUtils.k8)(h.spatialReference),y=d.width*g,C=d.height*j,R=(d.zmax??0)*j,U=R-(d.zmin??0)*j,k=Math.max(y,C,U)/z,{x:w,y:P}=v,S=v.z??0;(0,vec3.s)(helpMessageUtils3d_u,w,P,S),h.toRenderCoords(helpMessageUtils3d_u,x,helpMessageUtils3d_u);const T=k/l.computeScreenPixelSizeAt(helpMessageUtils3d_u);if(T>l.width*helpMessageUtils3d_c)return"meshTooClose";if(T<helpMessageUtils3d_m)return"meshTooFar";const b=(0,elevationInfoUtils.CI)(r),{absoluteZ:A}=(0,elevationInfoUtils.Si)(w,P,R,x,i,b);return A<(p.getElevation(w,P,S,x,"ground")??0)*j+U*helpMessageUtils3d_a?"meshUnderground":"mesh"}(t,this.view),this.updateElevation(e.elevation)}makeDrawOperation(){const{geometryType:e}=this,t="circle"!==e&&"rectangle"!==e;return new DrawOperation.eY({view:this.view,manipulators:this.manipulators,geometryType:(0,DrawGraphicTool.mg)(e),drawingMode:this.mode,hasZ:this.hasZ,defaultZ:this.defaultZ,snapToSceneEnabled:this.snapToScene,drawSurface:new drawSurfaces.Ev(this.view,this.elevationInfo,[this.internalGraphicsLayer]),elevationDrawSurface:new drawSurfaces.sj(this.elevationInfo,this.defaultZ,this.view,this.internalGraphicsLayer),hasM:!1,elevationInfo:this.elevationInfo,snappingManager:this.snappingManager,snappingVisualizer:new SnappingVisualizer3D_O,segmentLabels:t?new SegmentLabels3D_a:null,labelOptions:this.labelOptions,tooltipOptions:this.tooltipOptions,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===(0,elevationInfoUtils.E$)(this.hasZ,this.elevationInfo),cursor:this.cursor})}onActiveVertexChanged(e){const{view:n}=this;if(this._activeVertexVisualElement)return this._activeVertexVisualElement.vertices=[e],this._updateVerticalLineVisualElement(e),(0,handleUtils.uU)();const a=this._settings,c=a.manipulators.vertex,p=new VerticesVisualElement_d({view:n,spatialReference:n.spatialReference,vertices:[e],elevationInfo:this.internalGraphicsLayer.elevationInfo,size:c.size,outlineSize:c.outlineSize,renderOccluded:c.renderOccluded,attached:!1,isDecoration:!0});this._activeVertexVisualElement=p;const h=a.visualElements.zVerticalLine,m=new ExtendedLineVisualElement_G({view:n,extensionType:h.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:Material.C2.OccludeAndTransparent,isDecoration:!0});this._verticalLineVisualElement=m;const u=(0,handleUtils.Ip)([(0,reactiveUtils.aE)((()=>a.visualElements.zVerticalLine),(e=>e.apply(m)),reactiveUtils._8),(0,reactiveUtils.aE)((()=>({selectedColor:(0,colorUtils.aS)(a.colors.selected),outlineColor:(0,colorUtils.aS)(a.manipulators.vertex.outlineColor)})),(({selectedColor:e,outlineColor:t})=>{p.color=e,p.outlineColor=t}),reactiveUtils._8),(0,handleUtils.uU)((()=>{this._activeVertexVisualElement=(0,maybe.mG)(this._activeVertexVisualElement),this._verticalLineVisualElement=(0,maybe.mG)(this._verticalLineVisualElement)}))]);return p.attached=!0,u}_updateVerticalLineVisualElement(e){const t=this._verticalLineVisualElement;if(!t)return;const{renderCoordsHelper:i,elevationProvider:r}=this.view;(0,vec3.s)(DrawGraphicTool3D_M,e[0],e[1],e[2]),DrawGraphicTool3D_b.setFromElevationInfo(this.elevationInfo),DrawGraphicTool3D_M[2]=(0,elevationAlignmentUtils.eG)(DrawGraphicTool3D_M,r,DrawGraphicTool3D_b,i),i.toRenderCoords(DrawGraphicTool3D_M,this.view.spatialReference,DrawGraphicTool3D_M)?(t.setStartEndFromWorldDownAtLocation(DrawGraphicTool3D_M),t.attached=!0):t.attached=!1}onOutlineChanged(e){if(this._outlineVisualElement)return this._outlineVisualElement.geometry=e,(0,handleUtils.uU)();const t=this.internalGraphicsLayer.elevationInfo,{view:n}=this,a=this._settings,c=new OutlineVisualElement_w({view:n,geometry:e,elevationInfo:t,isDraped:this._createGraphicState?this._createGraphicState.isDraped:"on-the-ground"===(0,elevationInfoUtils.E$)(this.hasZ,t),attached:!1,isDecoration:!0});this._outlineVisualElement=c;const p=(0,handleUtils.Ip)([(0,reactiveUtils.aE)((()=>a.visualElements.lineGraphics.outline),(e=>e.apply(c)),reactiveUtils._8),(0,reactiveUtils.aE)((()=>a.visualElements.lineGraphics.shadowStyle),(e=>e.apply(c)),reactiveUtils._8),(0,handleUtils.uU)((()=>{this._outlineVisualElement=(0,maybe.mG)(this._outlineVisualElement)}))]);return c.attached=!0,c.laserlineEnabled=!0,p}onRegularVerticesChanged(e){if(this._verticesVisualElement)return this._verticesVisualElement.vertices=e,(0,handleUtils.uU)();const{view:n}=this,a=this._settings,c=a.manipulators.vertex,p=new VerticesVisualElement_d({view:n,spatialReference:n.spatialReference,vertices:e,elevationInfo:this.internalGraphicsLayer.elevationInfo,size:c.size,outlineSize:c.outlineSize,renderOccluded:c.renderOccluded,attached:!1,isDecoration:!0}),h=(0,handleUtils.Ip)([(0,reactiveUtils.aE)((()=>({color:(0,colorUtils.aS)(a.manipulators.vertex.color),outlineColor:(0,colorUtils.aS)(a.manipulators.vertex.outlineColor)})),(({color:e,outlineColor:t})=>{p.color=e,p.outlineColor=t}),reactiveUtils._8),(0,handleUtils.uU)((()=>{this._verticesVisualElement=(0,maybe.mG)(this._verticesVisualElement)}))]);return p.attached=!0,this._verticesVisualElement=p,h}updateGraphicGeometry(e,t){if("mesh"===this.geometryType&&"point"===t?.type){const i=this.geometryToPlace;return i&&i.centerAt(t),void(i&&e.geometry===i?i.vertexSpace.isGeoreferenced?e.notifyGeometryChanged():e.notifyMeshTransformChanged():e.geometry=i)}super.updateGraphicGeometry(e,t)}_setupLoadingIndicator(e){const{drawOperation:t}=this;if(!this.geometryToPlace)return t.loading=!1,null;t.loading=!0;const s=(0,handleUtils.uU)((()=>{t.loading=!1}));let o;const l=()=>o&&cancelAnimationFrame(o);return(0,handleUtils.Ip)([(0,reactiveUtils._I)((()=>e.displaying),(()=>{l(),o=requestAnimationFrame((()=>s.remove()))}),{...reactiveUtils.KG,once:!0}),(0,handleUtils.uU)(l),s])}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],DrawGraphicTool3D_z.prototype,"elevationInfo",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],DrawGraphicTool3D_z.prototype,"geometryType",void 0),(0,tslib_es6._)([(0,property.qq)()],DrawGraphicTool3D_z.prototype,"type",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],DrawGraphicTool3D_z.prototype,"view",void 0),DrawGraphicTool3D_z=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.editingTools.draw.DrawGraphicTool3D")],DrawGraphicTool3D_z);const DrawGraphicTool3D_b=new ElevationContext.E,DrawGraphicTool3D_M=(0,vec3f64.c)();var Collection=__webpack_require__("./node_modules/@arcgis/core/core/Collection.js"),quantityUtils=__webpack_require__("./node_modules/@arcgis/core/core/quantityUtils.js"),UpdatingHandles=__webpack_require__("./node_modules/@arcgis/core/core/support/UpdatingHandles.js"),hydratedFeatures=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/hydratedFeatures.js"),compilerUtils=(__webpack_require__("./node_modules/@arcgis/core/geometry.js"),__webpack_require__("./node_modules/@arcgis/core/core/compilerUtils.js")),mat3=__webpack_require__("./node_modules/@arcgis/core/chunks/mat3.js"),mat3f64=__webpack_require__("./node_modules/@arcgis/core/chunks/mat3f64.js"),ellipsoidUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/ellipsoidUtils.js"),geometry_projection=__webpack_require__("./node_modules/@arcgis/core/geometry/projection.js"),localRotationUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/localRotationUtils.js"),projectors=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectors.js"),aaBoundingRect=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js"),plane=__webpack_require__("./node_modules/@arcgis/core/geometry/support/plane.js"),ElevationProvider=__webpack_require__("./node_modules/@arcgis/core/views/3d/support/ElevationProvider.js");function ray_m(e,n,t=(0,ray.Su)()){return ray_g(e,(0,screenUtils.WO)(n),t),(0,vec3.n)(t.direction,t.direction),t}function ray_g(r,n,o){return function ray_p(r,o,c){const i=(0,screenUtils.iG)((0,vec2.j)(vectorStacks.Wq.get(),o));if(i[2]=0,!r.unprojectFromRenderScreen(i,c.origin))return null;const s=(0,screenUtils.iG)((0,vec2.j)(vectorStacks.Wq.get(),o));s[2]=1;const m=r.unprojectFromRenderScreen(s,vectorStacks.Wq.get());return null==m?null:((0,vec3.f)(c.direction,m,c.origin),c)}(r,r.screenToRender(n,(0,screenUtils.iG)(vectorStacks.Wq.get())),o)}var Camera=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Camera.js"),interactive_interfaces=__webpack_require__("./node_modules/@arcgis/core/views/interactive/interfaces.js"),Point=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js");class Manipulator3D_${constructor(e){this.metadata=void 0,this._camera=new Camera.U,this._elevation={offset:0,override:null},this.collisionType={type:"point"},this.collisionPriority=0,this._renderObjects=new Array,this.autoScaleRenderObjects=!0,this._available=!0,this._noDisplayCount=0,this._radius=10,this._worldSized=!1,this.focusMultiplier=2,this.touchMultiplier=2.5,this.worldOriented=!1,this._modelTransform=(0,mat4f64.a)(),this._worldFrame=null,this._renderLocation=(0,vec3f64.c)(),this._renderLocationDirty=!0,this._location=new Point.c({x:0,y:0,z:0}),this._elevationAlignedLocation=new Point.c,this._elevationAlignedLocationDirty=!0,this.interactive=!0,this.selectable=!1,this.grabbable=!0,this.consumesClicks=!0,this.cursor=null,this.grabCursor=null,this._grabbing=!1,this.dragging=!1,this._hovering=!1,this._selected=!1,this._state=interactive_interfaces.Yp.None,this._focused=!1,this.events=new Evented.c.EventEmitter,this._screenLocation={screenPointArray:(0,screenUtils.Yv)(),renderScreenPointArray:(0,screenUtils.UZ)(),pixelSize:0},this._screenLocationDirty=!0,this._engineResourcesAddedToStage=!1,this._attached=!1,this._location.spatialReference=e.view.spatialReference,Object.assign(this,e);const i=this.view.state?.camera;i&&this._camera.copyFrom(i)}destroy(){this._applyObjectTransform=fe,this._removeResourcesFromStage(),this._engineResources=null,this.view=null,this._camera=null}get _stage(){return this.view?._stage}get elevationInfo(){return this._elevationInfo}set elevationInfo(e){this._elevationInfo=e,this._elevationAlignedLocationDirty=!0,this._renderLocationDirty=!0,this._updateEngineObject()}get renderObjects(){return this._renderObjects}set renderObjects(e){this._removeResourcesFromStage(),this._engineResources=null,this._renderObjects=e.slice(),this._updateEngineObject()}set available(e){e!==this._available&&(this._available=e,this._updateEngineObject())}get available(){return this._available}disableDisplay(){return this._noDisplayCount++,1===this._noDisplayCount&&this._updateEngineObject(),(0,handleUtils.uU)((()=>{this._noDisplayCount--,0===this._noDisplayCount&&this._updateEngineObject()}))}set radius(e){e!==this._radius&&(this._radius=e,this._updateEngineObject())}get radius(){return this._radius}set worldSized(e){e!==this._worldSized&&(this._worldSized=e,this._updateEngineObject())}get worldSized(){return this._worldSized}get modelTransform(){return this._modelTransform}set modelTransform(e){ee(e)&&(this._screenLocationDirty=!0),(0,mat4.h)(this._modelTransform,e),this._updateEngineObject()}get renderLocation(){return this._renderLocationDirty&&(this._renderLocationDirty=!1,this.view.renderCoordsHelper.toRenderCoords(this.elevationAlignedLocation,this._renderLocation),this.worldOriented?(this._worldFrame||(this._worldFrame=(0,mat4f64.a)()),function te(e,t,i){switch(e.viewingMode){case"local":return(0,mat4.g)(i),!0;case"global":{const o=(0,ellipsoidUtils.e0)(e.renderCoordsHelper.spatialReference);return(0,projectors.qr)(t,0,le,0,o.radius),(0,localRotationUtils.e)((0,mathUtils.EF)(le[0]),(0,mathUtils.EF)(le[1]),i),!0}}}(this.view,this._renderLocation,this._worldFrame)):this._worldFrame&&(this._worldFrame=null)),this._renderLocation}set renderLocation(e){this.view.renderCoordsHelper.fromRenderCoords(e,this._location),this.elevationAlignedLocation=this._location}get location(){return this._location}set location(e){(0,hydratedFeatures.EX)(e,this._location),this._notifyLocationChanged()}_notifyLocationChanged(){this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!0,this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}get elevationAlignedLocation(){return this._elevationAlignedLocationDirty?(this._evaluateElevationAlignment(),this._updateElevationAlignedLocation(),this._elevationAlignedLocation):this._elevationAlignedLocation}set elevationAlignedLocation(e){(0,hydratedFeatures.EX)(e,this._location),this._evaluateElevationAlignment(),this._location.z-=this._elevation.offset,this._updateElevationAlignedLocation(),this._updateEngineObject(),this.events.emit("location-update",{location:this._location})}_updateElevationAlignedLocation(){const e=null!=this._elevation.override?this._elevation.override:this.location.z||0;this._elevationAlignedLocation.x=this.location.x,this._elevationAlignedLocation.y=this.location.y,this._elevationAlignedLocation.z=e+this._elevation.offset,this._elevationAlignedLocation.spatialReference=(0,hydratedFeatures.cv)(this.location.spatialReference),this._renderLocationDirty=!0,this._screenLocationDirty=!0,this._elevationAlignedLocationDirty=!1}grabbableForEvent(){return!0}get grabbing(){return this._grabbing}set grabbing(e){e!==this._grabbing&&(this._grabbing=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get hovering(){return this._hovering}set hovering(e){e!==this._hovering&&(this._hovering=e,this._setFocused(this._hovering||this._grabbing),this._updateEngineObject())}get selected(){return this._selected}set selected(e){e!==this._selected&&(this._selected=e,this._updateEngineObject(),this.events.emit("select-changed",{action:e?"select":"deselect"}))}get state(){return this._state}set state(e){e!==this._state&&(this._state=e,this._updateEngineObject())}updateStateEnabled(e,t){t?this.state|=e:this.state&=~e}_setFocused(e){e!==this._focused&&(this._focused=e,this.events.emit("focus-changed",{action:!0===e?"focus":"unfocus"}))}get focused(){return this._focused}get screenLocation(){return this._ensureScreenLocation(),this._screenLocation}_ensureScreenLocation(){if(!this._screenLocationDirty)return;let e;if(this._screenLocation.pixelSize=this._camera.computeScreenPixelSizeAt(this.renderLocation),this._screenLocationDirty=!1,ee(this._modelTransform)){const t=this._calculateModelTransformOffset(ge);e=(0,vec3.g)(t,t,this.renderLocation)}else e=this.renderLocation;this._camera.projectToRenderScreen(e,this._screenLocation.renderScreenPointArray),this._camera.renderToScreen(this._screenLocation.renderScreenPointArray,this._screenLocation.screenPointArray)}get applyObjectTransform(){return this._applyObjectTransform}set applyObjectTransform(e){this._applyObjectTransform=e,this._screenLocationDirty=!0,this._updateEngineObject()}get attached(){return this._attached}intersectionDistance(t,i){if(!this.available)return null;const s=(0,screenUtils.WO)(t,ie),o=this._getCollisionRadius(i),n=-1*this.collisionPriority;switch(this.collisionType.type){case"point":if((0,vec2.k)(this.screenLocation.screenPointArray,s)<o*o)return this.screenLocation.renderScreenPointArray[2]+n;break;case"line":{const e=this.collisionType.paths,t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,ae),r=o*this.screenLocation.pixelSize,a=ray_g(this._camera,s,oe);if(null==a)return null;for(const s of e){if(0===s.length)continue;const e=(0,vec3.e)(le,s[0],i);for(let t=1;t<s.length;t++){const o=(0,vec3.e)(he,s[t],i),l=(0,lineSegment.Yf)((0,lineSegment.i_)(e,o,se),a);if(null!=l&&l<r*r){const t=(0,vec3.g)(vectorStacks.Wq.get(),e,o);(0,vec3.i)(t,t,.5);const i=(0,screenUtils.s9)(vectorStacks.Wq.get());return this._camera.projectToRenderScreen(t,i),i[2]+n}(0,vec3.c)(e,o)}}break}case"disc":{const e=this.collisionType.direction,t=this.collisionType.offset??vec3f64.Z,i=this._getWorldToScreenObjectScale(),r=this._calculateObjectTransform(i,ae),a=o*this.screenLocation.pixelSize,c=ray_g(this._camera,s,oe);if(null==c)return null;const h=(0,mat3.f)(ne,r),d=(0,vec3.t)(_e,e,h),_=(0,vec3.e)(ue,t,r);(0,plane.aY)(_,d,ce);const u=de;if((0,plane._y)(ce,c,u)&&(0,vec3.a)(u,_)<a*a)return this.screenLocation.renderScreenPointArray[2]+n;break}case"ribbon":{const{paths:e,direction:t}=this.collisionType,i=this._getWorldToScreenObjectScale(),r=this._calculateObjectTransform(i,ae),a=o*this._camera.computeScreenPixelSizeAt(this.renderLocation),h=ray_g(this._camera,s,oe);if(null==h)return null;const d=(0,mat3.f)(ne,r),_=(0,vec3.t)(_e,t,d),u=this._calculateModelTransformPosition(ue);(0,plane.aY)(u,_,ce);const g=de;if(!(0,plane._y)(ce,h,g))break;for(const s of e){if(0===s.length)continue;const e=(0,vec3.e)(le,s[0],r);for(let t=1;t<s.length;t++){const i=(0,vec3.e)(he,s[t],r),o=(0,lineSegment.Ed)((0,lineSegment.i_)(e,i,se),g);if(null!=o&&o<a*a){const t=(0,vec3.g)(vectorStacks.Wq.get(),e,i);(0,vec3.i)(t,t,.5);const s=(0,screenUtils.s9)(vectorStacks.Wq.get());return this._camera.projectToRenderScreen(t,s),s[2]+n}(0,vec3.c)(e,i)}}break}default:(0,compilerUtils.aM)(this.collisionType)}return null}attach(e={manipulator3D:{}}){const t=this._stage;if(!t)return;const i=e.manipulator3D;null==i.engineLayerId?(this._engineLayer=new WebGLLayer.O(t,{pickable:!1,updatePolicy:UpdatePolicy.C.SYNC}),i.engineLayerId=this._engineLayer.id):t?.getObject&&(this._engineLayer=t.getObject(i.engineLayerId)),i.engineLayerReferences=(i.engineLayerReferences||0)+1,this._materialIdReferences=i.materialIdReferences,null==this._materialIdReferences&&(this._materialIdReferences=new Map,i.materialIdReferences=this._materialIdReferences),this._camera.copyFrom(this.view.state.camera),this._attached=!0,this._updateEngineObject(),(0,geometry_projection.canProjectWithoutEngine)(this._location.spatialReference,this.view.spatialReference)||(this.location=new Point.c({x:0,y:0,z:0,spatialReference:this.view.spatialReference}))}detach(e={manipulator3D:{}}){const t=e.manipulator3D;t.engineLayerReferences--;const i=0===t.engineLayerReferences;this._removeResourcesFromStage(),i&&(t.engineLayerId=null,(0,maybe.mG)(this._engineLayer)),this._engineResources=null,this._engineLayer=null,this._materialIdReferences=null,this._attached=!1}onViewChange(){this._camera.copyFrom(this.view.state.camera),this._screenLocationDirty=!0,this._updateEngineObject()}onElevationChange(e){(0,geometry_projection.projectPoint)(this.location,me,e.spatialReference)&&(0,aaBoundingRect.Ok)(e.extent,me)&&this._notifyLocationChanged()}_evaluateElevationAlignment(){if(null==this.elevationInfo)return;let e=null,t=0;const i=this.elevationInfo.offset??0;switch(this.elevationInfo.mode){case"on-the-ground":e=(0,ElevationProvider.Ej)(this.view.elevationProvider,this.location,"ground")??0;break;case"relative-to-ground":t=((0,ElevationProvider.Ej)(this.view.elevationProvider,this.location,"ground")??0)+i;break;case"relative-to-scene":t=((0,ElevationProvider.Ej)(this.view.elevationProvider,this.location,"scene")??0)+i;break;case"absolute-height":t=i}return t!==this._elevation.offset||e!==this._elevation.override?(this._elevation.offset=t,void(this._elevation.override=e)):void 0}_updateEngineObject(){if(!this._attached)return;if(!this.available)return void this._removeResourcesFromStage();const e=this._getWorldToScreenObjectScale(),t=ae;if(!0===this.autoScaleRenderObjects){const i=this._getFocusedSize(this._radius,this.focused)*e;this._calculateObjectTransform(i,t)}else this._calculateObjectTransform(e,t);const{objectsByState:i}=this._ensureEngineResources(),s=(this.focused?interactive_interfaces.Gu.Focused:interactive_interfaces.Gu.Unfocused)|(this.selected?interactive_interfaces.Gu.Selected:interactive_interfaces.Gu.Unselected),o=this._noDisplayCount>0;for(const{stateMask:n,objects:r}of i){if(o){for(const e of r)e.visible=!1;continue}const e=(n&interactive_interfaces.Gu.All)!==interactive_interfaces.Gu.None,i=(n&interactive_interfaces.Yp.All)!==interactive_interfaces.Yp.None,a=!e||(s&n)==(n&interactive_interfaces.Gu.All),c=!i||(this.state&n)==(n&interactive_interfaces.Yp.All);if(a&&c)for(const s of r)s.visible=!0,s.transformation=t;else for(const t of r)t.visible=!1}}_ensureEngineResources(){if(null==this._engineResources){const e=this._engineLayer,t=[],i=new Set;this.renderObjects.forEach((({geometry:{material:e}})=>{i.has(e)||(t.push(e),i.add(e))}));const s=new Map;this._renderObjects.forEach((e=>{const t=new Object3D.m({castShadow:!1,geometries:[e.geometry]}),i=s.get(e.stateMask)||[];i.push(t),s.set(e.stateMask,i)}));const o=[];s.forEach(((e,t)=>o.push({stateMask:t,objects:e}))),this._engineResources={objectsByState:o,layer:e,materials:t}}return this._addResourcesToStage(),this._engineResources}_addResourcesToStage(){const e=this._stage;if(this._engineResourcesAddedToStage||null==this._engineResources||!e)return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;s.forEach((t=>{const i=this._materialIdReferences,s=i.get(t.id)||0;0===s&&e.add(t),i.set(t.id,s+1)})),t.forEach((({objects:t})=>{i.addMany(t),e.addMany(t)})),this._engineResourcesAddedToStage=!0}_removeResourcesFromStage(){const e=this._stage;if(!this._engineResourcesAddedToStage||null==this._engineResources||!e)return;const{objectsByState:t,layer:i,materials:s}=this._engineResources;t.forEach((({objects:t})=>{i.removeMany(t),e.removeMany(t)})),s.forEach((t=>{const i=this._materialIdReferences,s=i.get(t.id);1===s?(e.remove(t),i.delete(t.id)):i.set(t.id,s-1)})),this._engineResourcesAddedToStage=!1}_getCollisionRadius(e){return this._getFocusedSize(this.radius,!0)*("touch"===e?this.touchMultiplier:1)}_getFocusedSize(e,t){return e*(t?this.focusMultiplier:1)}_getWorldToScreenObjectScale(){return this._worldSized?1:this.screenLocation.pixelSize}_calculateModelTransformPosition(e){const t=this._getWorldToScreenObjectScale(),i=this._calculateObjectTransform(t,re);return(0,vec3.s)(e,i[12],i[13],i[14])}_calculateModelTransformOffset(e){const t=this._calculateModelTransformPosition(e);return(0,vec3.f)(e,t,this.renderLocation)}_calculateObjectTransform(e,t){return(0,mat4.s)(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1),this._worldFrame&&(0,mat4.m)(t,t,this._worldFrame),(0,mat4.m)(t,t,this._modelTransform),t[12]+=this.renderLocation[0],t[13]+=this.renderLocation[1],t[14]+=this.renderLocation[2],t[15]=1,null!=this._applyObjectTransform&&this._applyObjectTransform(t),t}get test(){let e=!1;if(null!=this._engineResources)for(const t of this._engineResources.objectsByState){for(const i of t.objects)if(i.visible){e=!0;break}if(e)break}return{areAnyResourcesVisible:e}}}function ee(e){return 0!==e[12]||0!==e[13]||0!==e[14]}const ie=(0,screenUtils.Yv)(),se=(0,lineSegment.Su)(),oe=(0,ray.Su)(),ne=(0,mat3f64.a)(),re=(0,mat4f64.a)(),ae=(0,mat4f64.a)(),ce=(0,plane.Su)(),le=(0,vec3f64.c)(),he=(0,vec3f64.c)(),de=(0,vec3f64.c)(),_e=(0,vec3f64.c)(),ue=(0,vec3f64.c)(),ge=(0,vec3f64.c)(),me=new Point.c({x:0,y:0,z:0,spatialReference:null}),fe=()=>{};class RenderObject_e{constructor(e,s=interactive_interfaces.Gu.None){this.geometry=e,this.stateMask=s}}var graphicUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/graphics/graphicUtils.js");function manipulatorUtils_w(t,r=Material.C2.OccludeAndTransparent,n=!0){const o=(0,colorUtils.OM)(t),c=!(t[3]<1);return n?new ShadedColorMaterial_j({color:o,writeDepth:c,cullFace:basicInterfaces.CM.Back,renderOccluded:r,isDecoration:!0}):new ColorMaterial.U({color:o,writeDepth:c,cullFace:basicInterfaces.CM.Back,renderOccluded:r,isDecoration:!0})}function manipulatorUtils_b(t,r=Material.C2.OccludeAndTransparent){const n=(0,colorUtils.OM)(t);return new ColorMaterial.U({color:n,writeDepth:!0,cullFace:basicInterfaces.CM.Front,renderOccluded:r,isDecoration:!0})}const manipulatorUtils_O=Object.freeze({calloutLength:40,calloutWidth:1,discRadius:27,focusMultiplier:1.1});const manipulatorUtils_D=Object.freeze({autoScaleRenderObjects:!1,worldSized:!0});function manipulatorUtils_F(e,c,l,s){const u=(0,vec3.f)(vectorStacks.Wq.get(),e,l),m=manipulatorUtils_M(u,(0,vec3.b)(vectorStacks.Wq.get(),s,u),l,vectorStacks.SW.get());(0,mat4.i)(m,m);const p=(0,vec3.e)(vectorStacks.Wq.get(),c,m);return Math.atan2(p[1],p[0])}function manipulatorUtils_M(e,t,r,o){const a=(0,vec3.n)(vectorStacks.Wq.get(),e),l=(0,vec3.n)(vectorStacks.Wq.get(),t),s=(0,vec3.b)(vectorStacks.Wq.get(),a,l);return o[0]=a[0],o[1]=a[1],o[2]=a[2],o[3]=0,o[4]=l[0],o[5]=l[1],o[6]=l[2],o[7]=0,o[8]=s[0],o[9]=s[1],o[10]=s[2],o[11]=0,o[12]=r[0],o[13]=r[1],o[14]=r[2],o[15]=1,o}function manipulatorUtils_k(e,t){const r=e.getViewForGraphic(t);return null!=r&&"computeAttachmentOrigin"in r?r.computeAttachmentOrigin(t,e.spatialReference):null}function manipulatorUtils_v(e,t,r){const n=manipulatorUtils_k(e,r);null==n?function manipulatorUtils_A(e,t){if(null==t)return;const r="mesh"===t.type?t.anchor:(0,graphicUtils.cX)(t);null!=r&&(e.location=(0,hydratedFeatures.CG)(r))}(t,r.geometry):t.elevationAlignedLocation=n}var geometry3dUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/geometry3dUtils.js");function geometryUtils_r(t){if(null==t||"polyline"!==t.type&&"polygon"!==t.type)return 0;const o="polyline"===t.type?t.paths:t.rings;for(const r of o)for(let t=0;t<r.length-1;t++){const o=r[t],e=r[t+1],s=o[0]-e[0],p=o[1]-e[1];if(s*s+p*p>geometry3dUtils.Gg)return Math.atan2(e[1]-o[1],e[0]-o[0])}return 0}var isSupportedGraphicUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/editingTools/isSupportedGraphicUtils.js");function manipulatorUtils_n(e,n=(0,elevationInfoUtils.CI)(e)){return"on-the-ground"!==n.mode&&!(null==e.geometry||!e.geometry.hasZ)}var GrabbingState_N,ManipulatorType_A,signal=__webpack_require__("./node_modules/@arcgis/core/core/signal.js");!function(N){N[N.NONE=0]="NONE",N[N.ANY=1]="ANY",N[N.Z=2]="Z",N[N.XY=4]="XY"}(GrabbingState_N||(GrabbingState_N={})),function(A){A[A.TRANSLATE_Z=0]="TRANSLATE_Z",A[A.TRANSLATE_XY=1]="TRANSLATE_XY",A[A.SCALE=2]="SCALE",A[A.ROTATE=3]="ROTATE",A[A.SCALE_ROTATE=4]="SCALE_ROTATE"}(ManipulatorType_A||(ManipulatorType_A={}));class ManipulatorState_a{constructor(){this.grabbingState=GrabbingState_N.NONE,this.zManipulator=null,this.firstSelected=null,this.numSelected=0,this.firstGrabbedXY=null}update(a){this.grabbingState=GrabbingState_N.NONE,this.zManipulator=null,this.numSelected=0,this.firstSelected=null,this.firstGrabbedXY=null,a.forEachManipulator(((a,s)=>{if(s===ManipulatorType_A.TRANSLATE_Z&&(this.zManipulator=a),a instanceof Manipulator3D_$&&(a.selected&&(0===this.numSelected&&(this.firstSelected=a),this.numSelected++),null==this.firstGrabbedXY&&a.grabbing&&s===ManipulatorType_A.TRANSLATE_XY&&(this.firstGrabbedXY=a)),a.grabbing)switch(this.grabbingState|=GrabbingState_N.ANY,s){case ManipulatorType_A.TRANSLATE_Z:this.grabbingState|=GrabbingState_N.Z;break;case ManipulatorType_A.TRANSLATE_XY:this.grabbingState|=GrabbingState_N.XY}}))}}function lineGraphicVisualElementUtils_j(t){const{view:a,graphic:n}=t,i=new GraphicState_e({graphic:n}),l=function lineGraphicVisualElementUtils_M(e,n){const{view:i,graphic:r}=e,s=new OutlineVisualElement_w({view:i,geometry:lineGraphicVisualElementUtils_L(r)?r.geometry:null,elevationInfo:(0,elevationInfoUtils.CI)(r),attached:!1,isDecoration:!0}),p=new settings_z({getTheme:()=>i.effectiveTheme}),c=()=>{s.attached=n.displaying},h=(0,handleUtils.Ip)([(0,reactiveUtils.aE)((()=>p.visualElements.lineGraphics.outline),(e=>e.apply(s)),reactiveUtils._8),(0,reactiveUtils.aE)((()=>p.visualElements.lineGraphics.shadowStyle),(e=>e.apply(s)),reactiveUtils._8),(0,reactiveUtils.aE)((()=>n.displaying),c),(0,reactiveUtils.aE)((()=>n.isDraped),(e=>{s.isDraped=e})),n.on("changed",(()=>s.geometry=lineGraphicVisualElementUtils_L(r)?r.geometry:null)),(0,handleUtils.sX)(s)]);return c(),{visualElement:s,remove:()=>h.remove()}}(t,i),o=[l,lineGraphicVisualElementUtils_T(t,l.visualElement,i),a.maskOccludee(n),a.trackGraphicState(i)];return{visualElement:l.visualElement,remove:()=>(0,handleUtils.me)(o)}}function lineGraphicVisualElementUtils_T(s,p,c){const{graphic:h,view:u}=s,f=[],w=(0,elevationInfoUtils.CI)(h),S="on-the-ground"===w.mode||!w.offset&&"absolute-height"!==w.mode,j=new ManipulatorState_a,M=new settings_z({getTheme:()=>u.effectiveTheme}),T=M.visualElements,A=new ExtendedLineVisualElement_G({view:u,extensionType:T.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:Material.C2.OccludeAndTransparent,isDecoration:!0}),C=(0,mathUtils.EF)(T.heightPlaneAngleCutoff),O=new LaserlineVisualElement_c({view:u,attached:!1,angleCutoff:C,isDecoration:!0}),V=(0,signal.O)(1);f.push((0,reactiveUtils.aE)((()=>({lineShadowStyle:M.visualElements.lineGraphics.shadowStyle,pointShadowStyle:M.visualElements.pointGraphics.shadowStyle,alpha:V.value})),(({lineShadowStyle:e,pointShadowStyle:t,alpha:a})=>{e.apply(p,a),t.apply(A,a)}),reactiveUtils._8));const k=(0,signal.O)(1);f.push((0,reactiveUtils.aE)((()=>({heightPlane:M.visualElements.heightPlane,alpha:k.value})),(({heightPlane:e,alpha:t})=>e.apply(O,t)),reactiveUtils._8));const x=()=>{if(j.update(s),!c.displaying||S&&(c.isDraped||!lineGraphicVisualElementUtils_L(h)||!h.geometry.hasZ))return p.laserlineEnabled=!1,A.attached=!1,void(O.attached=!1);p.laserlineEnabled=!0;const e=j.grabbingState&GrabbingState_N.XY?T.laserlineAlphaMultiplier:1;V.value=e;const t=j.grabbingState&GrabbingState_N.Z?T.laserlineAlphaMultiplier:1;k.value=t,function lineGraphicVisualElementUtils_D(e,t){const a=1===t.numSelected?t.firstSelected:t.numSelected>1&&null!=t.firstGrabbedXY?t.firstGrabbedXY:null;null!=a?(e.setStartEndFromWorldDownAtLocation(a.renderLocation),e.attached=!0):e.attached=!1}(A,j),function lineGraphicVisualElementUtils_G(e,t,a,n){if(n.numSelected>0){(0,vec3.s)(lineGraphicVisualElementUtils_A,0,0,0);let t=0;e.forEachManipulator(((e,a)=>{a===ManipulatorType_A.TRANSLATE_XY&&e.selected&&e instanceof Manipulator3D_$&&((0,vec3.g)(lineGraphicVisualElementUtils_A,lineGraphicVisualElementUtils_A,e.renderLocation),t++)})),t>0?(a.heightManifoldTarget=(0,vec3.i)(lineGraphicVisualElementUtils_A,lineGraphicVisualElementUtils_A,1/t),a.attached=!0):a.attached=!1}else{const n=t.attachmentOrigin;null!=n&&e.view.renderCoordsHelper.toRenderCoords(n,lineGraphicVisualElementUtils_A)?(a.heightManifoldTarget=lineGraphicVisualElementUtils_A,a.attached=!0):a.attached=!1}}(s,p,O,j)};f.push((0,reactiveUtils.aE)((()=>M.visualElements.zVerticalLine),(e=>e.apply(A)),reactiveUtils._8)),f.push(c.on("changed",x),(0,reactiveUtils.aE)((()=>c.displaying),x),p.events.on("attachment-origin-changed",x),(0,handleUtils.sX)(A),(0,handleUtils.sX)(O));const P=[],U=()=>{(0,handleUtils.me)(P),P.length=0,s.forEachManipulator((e=>P.push(e.events.on("grab-changed",x)))),s.forEachManipulator((e=>P.push(e.events.on("select-changed",x)))),x()};return U(),f.push(s.onManipulatorsChanged(U),(0,handleUtils.s5)((()=>(0,handleUtils.Ip)(P)))),(0,handleUtils.Ip)(f)}function lineGraphicVisualElementUtils_L(e){return null!=e.geometry&&("polygon"===e.geometry.type||"polyline"===e.geometry.type)}const lineGraphicVisualElementUtils_A=(0,vec3f64.c)();var projectPointToVector=__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectPointToVector.js");function originGraphicVisualElementUtils_P(t){const{view:n,graphic:o}=t,i=new GraphicState_e({graphic:o}),a=[],r=function originGraphicVisualElementUtils_V(e,n,o){const{view:i,graphic:a}=e,r=new PointVisualElement_x({view:i,geometry:originGraphicVisualElementUtils_A(a),elevationInfo:(0,elevationInfoUtils.CI)(a),isDecoration:!0});return function originGraphicVisualElementUtils_L(e,t,n,o){const r=()=>{t.attached=n.displaying},s=new settings_z({getTheme:()=>e.view.effectiveTheme});(function originGraphicVisualElementUtils_M(e,t,o,i){const{view:a,graphic:r}=e;let s=null;const l=e=>{null!=s&&(s.remove(),s=null),o.isDraped&&null!=e&&(s=function originGraphicVisualElementUtils_C(e,t,n){const o=e.elevationProvider.spatialReference;(0,projectPointToVector.M)(t,originGraphicVisualElementUtils_R,o);const i=originGraphicVisualElementUtils_R[0],a=originGraphicVisualElementUtils_R[1];return e.elevationProvider.on("elevation-change",(e=>{(0,aaBoundingRect.If)(e.extent,i,a)&&n()}))}(a,e,(()=>{t.geometry=e})))},p=()=>{const e=originGraphicVisualElementUtils_A(r);l(e),t.geometry=e};i.push(o.on("changed",p),(0,handleUtils.s5)((()=>s))),p()})(e,t,n,o),s.visualElements.pointGraphics.outline.apply(t),o.push((0,reactiveUtils.aE)((()=>n.displaying),r,reactiveUtils._8))}(e,r,n,o),o.push((0,handleUtils.sX)(r)),r}(t,i,a);return function originGraphicVisualElementUtils_x(e,n,l,p){const{view:m,graphic:d}=e,E=new settings_z({getTheme:()=>m.effectiveTheme}),T=new ExtendedLineVisualElement_G({view:m,extensionType:E.visualElements.zVerticalLine.extensionType,innerWidth:1,attached:!1,writeDepthEnabled:!1,renderOccluded:Material.C2.OccludeAndTransparent,isDecoration:!0});l.push((0,reactiveUtils.aE)((()=>E.visualElements.zVerticalLine),(e=>e.apply(T)),reactiveUtils._8));const P=new LaserlineVisualElement_c({view:m,intersectsLineInfinite:!0,attached:!1,isDecoration:!0}),x=(0,mathUtils.EF)(E.visualElements.heightPlaneAngleCutoff),V=new LaserlineVisualElement_c({view:m,attached:!1,angleCutoff:x,isDecoration:!0}),L=(0,elevationInfoUtils.CI)(e.graphic),M=ElevationContext.E.fromElevationInfo(L),C="on-the-ground"===L.mode||!L.offset&&"absolute-height"!==L.mode,G=new ManipulatorState_a,B=(0,signal.O)(1);l.push((0,reactiveUtils.aE)((()=>({heightPlane:E.visualElements.heightPlane,alpha:B.value})),(({heightPlane:e,alpha:t})=>e.apply(V,t)),reactiveUtils._8));const I=(0,signal.O)(1);l.push((0,reactiveUtils.aE)((()=>({shadowStyle:E.visualElements.pointGraphics.shadowStyle,alpha:I.value})),(({shadowStyle:e,alpha:t})=>e.apply(P,t)),reactiveUtils._8));const k=()=>{G.update(e);const t=originGraphicVisualElementUtils_A(d),o=C&&(n.isDraped||null==t||!t.hasZ);let i=!0;if(o||null==t)i=!1;else{const e=(0,elevationAlignmentUtils.eG)(t,m.elevationProvider,M,m.renderCoordsHelper);(0,vec3.s)(originGraphicVisualElementUtils_R,t.x,t.y,e),(0,projectVectorToVector.Z)(originGraphicVisualElementUtils_R,t.spatialReference,originGraphicVisualElementUtils_R,m.renderCoordsHelper.spatialReference),T.setStartEndFromWorldDownAtLocation(originGraphicVisualElementUtils_R),P.intersectsWorldUpAtLocation=originGraphicVisualElementUtils_R}const a=G.grabbingState&GrabbingState_N.Z?E.visualElements.laserlineAlphaMultiplier:1;B.value=a;const r=(0,aaBoundingBox.FZ)(originGraphicVisualElementUtils_U);!o&&n.displaying&&p.calculateMapBounds(r)&&(0,projectVectorToVector.Z)((0,aaBoundingBox.Y5)(r,originGraphicVisualElementUtils_R),m.spatialReference,originGraphicVisualElementUtils_R,m.renderCoordsHelper.spatialReference)?(V.heightManifoldTarget=originGraphicVisualElementUtils_R,V.attached=!0):V.attached=!1;const l=G.grabbingState&GrabbingState_N.XY?E.visualElements.laserlineAlphaMultiplier:1;I.value=l;const f=i&&n.displaying&&!o;P.attached=f,T.attached=f};l.push((0,reactiveUtils.aE)((()=>[n.displaying,n.isDraped]),k),n.on("changed",k)),e.forEachManipulator((e=>{l.push(e.events.on("grab-changed",k))})),l.push((0,handleUtils.sX)(P)),l.push((0,handleUtils.sX)(T)),l.push((0,handleUtils.sX)(V)),k()}(t,i,a,r),a.push(n.trackGraphicState(i)),{visualElement:r,remove:()=>(0,handleUtils.me)(a)}}function originGraphicVisualElementUtils_A(e){const t=e.geometry;return null==t?null:"point"===t.type?t:"mesh"===t.type?t.anchor.clone():null}const originGraphicVisualElementUtils_R=(0,vec3f64.c)(),originGraphicVisualElementUtils_U=(0,aaBoundingBox.Su)();function visualElementUtils_i(i){switch(i.graphic.geometry.type){case"point":case"mesh":return originGraphicVisualElementUtils_P(i);case"polygon":case"polyline":return lineGraphicVisualElementUtils_j(i);default:return null}}const config_o=Math.ceil(70/3*2),config_x=5*Math.PI/12,config_b=1*Math.PI/3;var Handles=__webpack_require__("./node_modules/@arcgis/core/core/Handles.js");class Manipulation_t{constructor(){this._available=!0}set location(a){this._forEachManipulator3D((t=>t.location=a))}set elevationAlignedLocation(a){this._forEachManipulator3D((t=>t.elevationAlignedLocation=a))}set elevationInfo(a){this._forEachManipulator3D((t=>t.elevationInfo=a))}get renderLocation(){let a;return this._forEachManipulator3D((t=>{a||(a=t.renderLocation)})),a}get available(){return this._available}set available(a){this._available=a,this._forEachManipulator3D((t=>t.available=a))}get hovering(){return this.someManipulator((a=>a.hovering))}get grabbing(){return this.someManipulator((a=>a.grabbing))}get dragging(){return this.someManipulator((a=>a.dragging))}hasManipulator(a){return this.someManipulator((t=>t===a))}someManipulator(a){let t=!1;return this.forEachManipulator((i=>{!t&&a(i)&&(t=!0)})),t}_forEachManipulator3D(t){this.forEachManipulator(((i,o)=>{i instanceof Manipulator3D_$&&t(i,o)}))}}var dragEventPipeline3D_G,vector=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vector.js"),dragEventPipeline=(__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Intersector.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/IntersectorInterfaces.js"),__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/verticalOffsetUtils.js"),__webpack_require__("./node_modules/@arcgis/core/views/interactive/dragEventPipeline.js"));function dragEventPipeline3D_H(e,n){return dragEventPipeline3D_O(e,(()=>n))}function dragEventPipeline3D_O(r,t){const o=(0,vec3f64.c)(),l=(0,vec3f64.c)();let s=!1;return c=>{const u=t(c);if("start"===c.action){const t=(0,screenUtils.WO)(c.screenStart,(0,screenUtils.iS)(vectorStacks.kh.get())),l=ray_g(r.state.camera,t,dragEventPipeline3D_B);null!=l&&(s=(0,plane._y)(u,l,o))}if(!s)return null;const i=(0,screenUtils.WO)(c.screenEnd,(0,screenUtils.iS)(vectorStacks.kh.get())),a=ray_g(r.state.camera,i,dragEventPipeline3D_B);return null==a?null:(0,plane._y)(u,a,l)?{...c,renderStart:o,renderEnd:l,plane:u,ray:a}:null}}function dragEventPipeline3D_T(e,n,r,t=null,o=null){return function dragEventPipeline3D_C(e,n,t=0,o=null,l=null){let s=null;return c=>{if("start"===c.action&&(s=e.sceneIntersectionHelper.intersectElevationFromScreen((0,screenUtils.Yv)(c.screenStart.x,c.screenStart.y),n,t,l),null!=s&&null!=o&&!(0,geometry_projection.projectPoint)(s,s,o)))return null;if(null==s)return null;const u=e.sceneIntersectionHelper.intersectElevationFromScreen((0,screenUtils.Yv)(c.screenEnd.x,c.screenEnd.y),n,t,l);return null==u||null!=o&&!(0,geometry_projection.projectPoint)(u,u,o)?null:{...c,mapStart:s,mapEnd:u}}}(e,r,(0,elevationInfoUtils.Kq)(n,e,r),t,o)}function dragEventPipeline3D_D(e,n,r,t=null,o=null){return dragEventPipeline3D_T(e,r,(0,elevationInfoUtils.CI)(n),t,o)}function dragEventPipeline3D_P(e,n,r){let t=null;const o=new dragEventPipeline.aU;return o.next(dragEventPipeline3D_H(e,function dragEventPipeline3D_N(e,n){const r=dragEventPipeline3D_q,t=dragEventPipeline3D_z,o=(0,plane.Su)();e.renderCoordsHelper.worldUpAtPosition(n,r);const c=(0,vec3.b)(o,r,(0,vec3.f)(t,n,e.state.camera.eye));return(0,vec3.b)(c,c,r),(0,plane.aY)(n,c,o)}(e,n))).next(function dragEventPipeline3D_h(e,n){const r=(0,vec3f64.c)(),l=(0,vec3.l)(n);e.renderCoordsHelper.worldUpAtPosition(n,r);const p=(0,vec3f64.c)(),d=(0,vec3f64.c)(),m=o=>((0,vec3.f)(o,o,n),(0,vector.C_)(r,o,o),"global"===e.viewingMode&&(0,vec3.l)(o)*Math.sign((0,vec3.j)(r,o))<.001-l&&(0,vec3.f)(o,(0,vec3.i)(o,r,.001),n),(0,vec3.g)(o,o,n),o);return e=>(e.renderStart=m((0,vec3.c)(p,e.renderStart)),e.renderEnd=m((0,vec3.c)(d,e.renderEnd)),e)}(e,n)).next(dragEventPipeline3D_k(e,r)).next((e=>{e.mapEnd.x=e.mapStart.x,e.mapEnd.y=e.mapStart.y,t=e})),e=>(t=null,o.execute(e),t)}function dragEventPipeline3D_k(e,n){const r=e.renderCoordsHelper;return e=>{const t=r.fromRenderCoords(e.renderStart,n),o=r.fromRenderCoords(e.renderEnd,n);return null!=t&&null!=o?{...e,mapStart:t,mapEnd:o}:null}}!function(e){e[e.GROUND=0]="GROUND",e[e.OTHER=1]="OTHER"}(dragEventPipeline3D_G||(dragEventPipeline3D_G={}));const dragEventPipeline3D_q=(0,vec3f64.c)(),dragEventPipeline3D_z=(0,vec3f64.c)(),dragEventPipeline3D_B=(0,ray.Su)();function moveUtils_n(n,a,r,c){const s=(t,e)=>a({action:t,graphic:n,dxScreen:e.screenDeltaX,dyScreen:e.screenDeltaY});return r(((a,r,i)=>(r.next((t=>("start"===t.action&&s("start",t),t))).next((0,dragEventPipeline.Co)(n,c)).next((t=>{switch(t.action){case"start":case"update":(t.translationX||t.translationY||t.translationZ)&&s("update",t);break;case"end":s("end",t)}return t})),{steps:r,cancel:i=i.next((0,dragEventPipeline.W8)(n)).next((t=>(s("end",{screenDeltaX:0,screenDeltaY:0}),t)))})))}function moveUtils_a(t){if(null==t?.axis)return 1;const{mapStart:e,mapEnd:n,axis:a}=t,r=[n.x-e.x,n.y-e.y];return r[0]*a[0]+r[1]*a[1]>0?1:-1}class MoveXYAxisManipulation_C extends Manipulation_t{constructor(t){super(),this._handles=new Handles.c,this._arrowManipulatorInfos=new Array,this._angle=0,this._scale=1,this._radius=70,this._updateAfterDrag=!1,this.events=new Evented.c,this._tool=t.tool,this._view=t.view,this._opaqueMaterial=this._createMaterial(),this._transparentMaterial=this._createMaterial(.5),null!=t.radius&&(this._radius=t.radius),this._createManipulators(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}set orthogonalAvailable(t){this._arrowManipulatorInfos.length>=3&&(this._arrowManipulatorInfos[1].manipulator.available=t,this._arrowManipulatorInfos[3].manipulator.available=t)}destroy(){this._handles=(0,maybe.mG)(this._handles),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._arrowManipulatorInfos.length=0}forEachManipulator(t){for(const{manipulator:a}of this._arrowManipulatorInfos)t(a,ManipulatorType_A.TRANSLATE_XY)}createGraphicDragPipeline(t,a,r){const e=a.graphic,i=(0,elevationInfoUtils.CI)(e),o=e.geometry.spatialReference;return moveUtils_n(e,r,(a=>this.createDragPipeline(((r,e,i,o,s)=>(({steps:e,cancel:i}=t(r,e,i,o,s)),a(r,e,i))),i,o,e)),this._view.state.viewingMode)}createDragPipeline(t,a,r,i){return(0,handleUtils.Ip)(this._arrowManipulatorInfos.map((({manipulator:e},o)=>(0,dragEventPipeline.G4)(e,((e,s,n,l,p)=>{const u=s.next((t=>({...t,manipulatorType:ManipulatorType_A.TRANSLATE_XY}))).next((0,dragEventPipeline.ks)(this._view,e.elevationAlignedLocation)).next(dragEventPipeline3D_T(this._view,e.elevationAlignedLocation,a,r,i)).next((0,dragEventPipeline.iU)(e.location,this.angle+(o+1)*Math.PI*.5)).next((0,dragEventPipeline.qm)());t(e,u,n,l,p)})))))}get angle(){return this._angle}set angle(t){this._angle=t,this.dragging?this._updateAfterDrag=!0:this._updateManipulatorTransform()}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform()}get radius(){return this._radius}set radius(t){this._radius!==t&&(this._radius=t,this._updateManipulators())}_updateManipulators(){for(let t=0;t<this._arrowManipulatorInfos.length;t++)this._updateArrowManipulator(this._arrowManipulatorInfos[t],t);this._updateManipulatorTransform()}_updateArrowManipulator({manipulator:t,transform:a},r){const e=this._radius/70,i=54*e,o=i*Math.sqrt(3)/2,s=(0,GeometryUtil.mm)(this._opaqueMaterial,o,i/2,i/2,.02);(0,GeometryUtil.UF)(s,(0,mat4.d)(vectorStacks.SW.get(),(0,vec3.s)(vectorStacks.Wq.get(),0,-o/3,0))),t.renderObjects=[new RenderObject_e(s,interactive_interfaces.Gu.Focused),new RenderObject_e(s.instantiate({material:this._transparentMaterial}),interactive_interfaces.Gu.Unfocused)],t.radius=o/3*2*1.2;const u=(0,mat4.j)(vectorStacks.SW.get(),r*Math.PI/2),h=(0,mat4.d)(vectorStacks.SW.get(),(0,vec3.s)(vectorStacks.Wq.get(),0,100*e,0));(0,mat4.m)(a,u,h)}_createManipulators(){for(let t=0;t<4;t++){const a=this._createArrowManipulator(t);this._arrowManipulatorInfos.push(a)}this._updateManipulatorTransform()}_updateManipulatorTransform(){const t=this.angle,a=(0,mat4.c)(vectorStacks.SW.get(),t,(0,vec3f64.f)(0,0,1));if(null==a)return;const r=(0,mat4.E)(vectorStacks.SW.get(),(0,vec3.s)(vectorStacks.Wq.get(),this.displayScale,this.displayScale,this.displayScale)),e=(0,mat4.m)(vectorStacks.SW.get(),r,a);for(const i of this._arrowManipulatorInfos){const t=(0,mat4.m)(vectorStacks.SW.get(),e,i.transform);i.manipulator.modelTransform=t}}_createArrowManipulator(t){const a=new Manipulator3D_$({view:this._view,autoScaleRenderObjects:!1,worldOriented:!0,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:(0,vec3f64.f)(0,0,1)}}),r={manipulator:a,transform:(0,mat4f64.a)()};return this._updateArrowManipulator(r,t),this._handles.add(a.events.on("drag",(t=>{this._updateAfterDrag&&"end"===t.action&&!this.dragging&&(this._updateManipulatorTransform(),this._updateAfterDrag=!1)}))),r}_createMaterial(a=1){const r=new ColorMaterial.U({cullFace:basicInterfaces.CM.Back,renderOccluded:Material.C2.Transparent,isDecoration:!0});return this._handles.add((0,reactiveUtils.aE)((()=>Color.c.toUnitRGBA(this._view.effectiveTheme.accentColor)),(t=>{t[3]*=a,r.setParameters({color:t})}),reactiveUtils._8)),r}get test(){return{arrowManipulators:this._arrowManipulatorInfos.map((({manipulator:t})=>t))}}}class SnapToScene_e{constructor(){this._view=null,this._elevationInfo=null,this._lastDragEvent=null,this._next=null,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent&&null!=this._next){const n=this._lastDragEvent.mapEnd,e=this._snap(this._lastDragEvent.screenEnd);if(null!=e){const s={action:"update",mapStart:this._lastDragEvent.mapStart,mapEnd:!0===t?e:n,screenStart:this._lastDragEvent.screenEnd,screenEnd:this._lastDragEvent.screenEnd};this._next.execute(s)}}this._enabled=t}_snap(n){const e=null!=this._view?this._view.toMap(n,{exclude:[]}):null;return null!=e&&null!=this._view&&(e.z=(0,elevationInfoUtils.Kq)(e,this._view,this._elevationInfo)),e}createDragEventPipelineStep(t,e){this._view=t,this._elevationInfo=e,this._lastDragEvent=null;const s=new dragEventPipeline.aU;return this._next=s,[t=>{if(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled){const n=this._snap(t.screenEnd);return null!=n?{action:t.action,mapStart:t.mapStart,mapEnd:n,screenStart:t.screenStart,screenEnd:t.screenEnd}:null}return{action:t.action,mapStart:t.mapStart,mapEnd:t.mapEnd,screenStart:t.screenStart,screenEnd:t.screenEnd}},s]}}class MoveXYDiscManipulation_k extends Manipulation_t{constructor(t){super(),this._handles=new Handles.c,this._snapToScene=new SnapToScene_e,this._scale=1,this._radius=70,this._view=t.view,this._tool=t.tool,this._discMaterial=this._createMaterial(),this._discMaterialTransparent=this._createMaterial(.5),null!=t.snapToScene&&(this.snapToScene=t.snapToScene),null!=t.radius&&(this._radius=t.radius),this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this._handles=(0,maybe.mG)(this._handles),this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null}forEachManipulator(t){t(this._manipulator,ManipulatorType_A.TRANSLATE_XY)}get displayScale(){return this._scale}set displayScale(t){this._scale=t,this._updateManipulatorTransform()}get snapToScene(){return this._snapToScene.enabled}set snapToScene(t){this._snapToScene.enabled=t}get radius(){return this._radius}set radius(t){t!==this._radius&&(this._radius=t,this._updateManipulator())}createGraphicDragPipeline(t,e,i){const a=e.graphic,r=(0,elevationInfoUtils.CI)(a),s=a.geometry.spatialReference;return moveUtils_n(a,i,(e=>this.createDragPipeline(((i,a,r,s,o)=>(({steps:a,cancel:r}=t(i,a,r,s,o)),e(i,a,r))),r,s,a)),this._view.state.viewingMode)}createDragPipeline(t,e,i,a){const r=this._view;return(0,dragEventPipeline.G4)(this._manipulator,((s,o,n,l,p)=>{const c=o.next((0,dragEventPipeline.ks)(r,s.elevationAlignedLocation)).next(dragEventPipeline3D_T(r,s.elevationAlignedLocation,e,i,a)).next(...this._snapToScene.createDragEventPipelineStep(r,e)).next((t=>({...t,manipulatorType:ManipulatorType_A.TRANSLATE_XY}))).next((0,dragEventPipeline.qm)());t(s,c,n,l,p)}))}_updateManipulatorTransform(){const t=(0,mat4.E)(vectorStacks.SW.get(),(0,vec3.s)(vectorStacks.Wq.get(),this.displayScale,this.displayScale,this.displayScale));this._manipulator.modelTransform=t}_createManipulator(){const t=this._view;this._manipulator=new Manipulator3D_$({view:t,worldSized:!1,autoScaleRenderObjects:!1,focusMultiplier:1,touchMultiplier:1,collisionType:{type:"disc",direction:(0,vec3f64.f)(0,0,1)},worldOriented:!0}),this._updateManipulator()}_updateManipulator(){const t=(0,GeometryUtil.cf)(this._discMaterial,.02,1,128,(0,vec3f64.f)(0,0,1),(0,vec3f64.f)(0,0,0));t.transformation=(0,mat4.E)((0,mat4f64.a)(),(0,vec3f64.f)(this._radius,this._radius,this._radius)),this._manipulator.renderObjects=[new RenderObject_e(t,interactive_interfaces.Gu.Focused),new RenderObject_e(t.instantiate({material:this._discMaterialTransparent}),interactive_interfaces.Gu.Unfocused)],this._manipulator.radius=this._radius/70*80}_createMaterial(e=1){const i=new ColorMaterial.U({cullFace:basicInterfaces.CM.Back,renderOccluded:Material.C2.Transparent,isDecoration:!0});return this._handles.add((0,reactiveUtils.aE)((()=>Color.c.toUnitRGBA(this._view.effectiveTheme.accentColor)),(t=>{t[3]*=e,i.setParameters({color:t})}),reactiveUtils._8)),i}get test(){return{discManipulator:this._manipulator}}}class MoveZManipulation_A extends Manipulation_t{constructor(e){super(),this._radius=70,this.events=new Evented.c,this._tool=e.tool,this._view=e.view;const t=new settings_z({getTheme:()=>this._view.effectiveTheme});this._settings=t,null!=e.radius&&(this._radius=e.radius);const i=this._view.effectiveTheme.accentColor;this._materials={materialUnfocused:manipulatorUtils_w(this._createDarkenedColor(i,1,.25),Material.C2.Occlude),materialFocused:manipulatorUtils_w(this._createDarkenedColor(i,1,0),Material.C2.Occlude),materialOccludedUnfocused:manipulatorUtils_w(this._createDarkenedColor(i,.7,0),t.zManipulator.renderOccluded),materialOccludedFocused:manipulatorUtils_w(this._createDarkenedColor(i,.85,0),t.zManipulator.renderOccluded)},this._themeHandle=(0,reactiveUtils.aE)((()=>this._view.effectiveTheme.accentColor),(e=>{const t=this._createDarkenedColor(e,1,.25),r=this._createDarkenedColor(e,1,0),i=this._createDarkenedColor(e,.7,0),a=this._createDarkenedColor(e,.85,0),{materialUnfocused:o,materialFocused:s,materialOccludedUnfocused:n,materialOccludedFocused:l}=this._materials;o.setParameters({color:t}),s.setParameters({color:r}),n.setParameters({color:i}),l.setParameters({color:a})})),this._createManipulator(),this.forEachManipulator((e=>this._tool.manipulators.add(e)))}destroy(){this._themeHandle=(0,maybe.oR)(this._themeHandle),this._manipulator.applyObjectTransform=MoveZManipulation_H,this.forEachManipulator((e=>{this._tool.manipulators.remove(e),e.destroy()}))}forEachManipulator(e){e(this._manipulator,ManipulatorType_A.TRANSLATE_Z)}createGraphicDragPipeline(e,t,r){const i=t.graphic.geometry.spatialReference;return moveUtils_n(t.graphic,r,(t=>this.createDragPipeline(((r,i,a,o,s)=>(({steps:i,cancel:a}=e(r,i,a,o,s)),t(r,i,a))),i)),this._view.state.viewingMode)}createDragPipeline(e,t){const r=this._view;return(0,dragEventPipeline.G4)(this._manipulator,((i,a,o,s,n)=>{const l=a.next((e=>({...e,manipulatorType:ManipulatorType_A.TRANSLATE_Z}))).next(dragEventPipeline3D_P(r,i.renderLocation,t)).next((0,dragEventPipeline.qm)());e(i,l,o,s,n)}))}get radius(){return this._radius}set radius(e){e!==this._radius&&(this._radius=e,this._updateManipulator())}_updateManipulator(){const e=this._settings,t=this._radius/70,r=e.zManipulator.height*t,i=e.zManipulator.coneHeight*t,a=e.zManipulator.coneWidth*t,o=e.zManipulator.width*t,m=[(0,vec3f64.f)(0,0,0),(0,vec3f64.f)(0,0,r)],d=[(0,vec3f64.f)(0,0,0),(0,vec3f64.f)(0,0,r+i)],p=(e=>{const t=(0,mat4f64.a)();if((0,mat4.w)(t,t,[0,0,r]),(0,mat4.r)(t,t,Math.PI/2),e){const r=1+2*e/a;(0,mat4.b)(t,t,[r,r,r])}return t})(0),{materialUnfocused:h,materialFocused:f,materialOccludedUnfocused:_,materialOccludedFocused:w}=this._materials,v=(0,GeometryUtil.SS)(h,m,o/2,16,!1),M=(0,GeometryUtil.eK)(h,i,a/2,16,!1);M.transformation=p,this._manipulator.renderObjects=[new RenderObject_e(M,interactive_interfaces.Gu.Unfocused),new RenderObject_e(v,interactive_interfaces.Gu.Unfocused),new RenderObject_e(M.instantiate({material:f}),interactive_interfaces.Gu.Focused),new RenderObject_e(v.instantiate({material:f}),interactive_interfaces.Gu.Focused),new RenderObject_e(M.instantiate({material:_}),interactive_interfaces.Gu.Unfocused),new RenderObject_e(v.instantiate({material:_}),interactive_interfaces.Gu.Unfocused),new RenderObject_e(M.instantiate({material:w}),interactive_interfaces.Gu.Focused),new RenderObject_e(v.instantiate({material:w}),interactive_interfaces.Gu.Focused)],this._manipulator.radius=o/2+2,this._manipulator.collisionType={type:"line",paths:[d]}}_createManipulator(){const e=this._view,t=new Manipulator3D_$({view:e,autoScaleRenderObjects:!1,worldSized:!1,selectable:!1,cursor:"ns-resize",elevationInfo:this.elevationInfo,worldOriented:!0,collisionPriority:1.6});t.applyObjectTransform=t=>{const r=e.state.camera,a=MoveZManipulation_E;e.renderCoordsHelper.toRenderCoords(this._manipulator.elevationAlignedLocation,a);const o=(0,vec3.r)(r.eye,a),s=r.computeRenderPixelSizeAtDist(o),n=(0,vec3.f)(MoveZManipulation_R,a,r.eye);(0,vec3.n)(n,n);const l=MoveZManipulation_x;e.renderCoordsHelper.worldUpAtPosition(MoveZManipulation_E,l);const c=Math.abs((0,vec3.j)(n,l)),_=(0,vec3.b)(MoveZManipulation_R,n,l),j=(0,vec3.b)(MoveZManipulation_R,_,l),w=(0,mathUtils.qk)(c,.01,1),v=1-Math.sqrt(1-w*w)/w/r.fullWidth,g=this._settings,M=this._radius/70,U=g.zManipulator.width*M;(0,vec3.i)(j,(0,vec3.n)(j,j),(1/v-1)*o+s*U),t[12]-=MoveZManipulation_R[0],t[13]-=MoveZManipulation_R[1],t[14]-=MoveZManipulation_R[2]},this._manipulator=t,this._updateManipulator()}_createDarkenedColor(r,i,a){const o=(0,colorUtils.sP)(r,a);return o.a*=i,Color.c.toUnitRGBA(o)}get test(){return{manipulator:this._manipulator}}}const MoveZManipulation_E=(0,vec3f64.c)(),MoveZManipulation_R=(0,vec3f64.c)(),MoveZManipulation_x=(0,vec3f64.c)(),MoveZManipulation_H=()=>{};class MoveManipulation_u extends Manipulation_t{constructor(a){super(),this._handles=new Handles.c,this._interactive=!0;const{tool:t,view:n,snapToScene:s,radius:e}=a;this._view=n,this.xyManipulation=new MoveXYDiscManipulation_k({tool:t,view:n,snapToScene:s,radius:e}),this.xyAxisManipulation=new MoveXYAxisManipulation_C({tool:t,view:n,radius:e}),this.zManipulation=new MoveZManipulation_A({tool:t,view:n,radius:e}),this.xyManipulation.available=a.xyAvailable,this.xyAxisManipulation.available=a.xyAxisAvailable,this.zManipulation.available=a.zAvailable,this._autoHideXYAxis(),this.forEachManipulator((i=>this._handles.add(i.events.on("grab-changed",(()=>this._updateManipulatorInteractivity())))))}destroy(){this._handles.destroy(),this.xyManipulation.destroy(),this.xyAxisManipulation.destroy(),this.zManipulation.destroy()}createGraphicDragPipeline(i,t,n){return(0,handleUtils.Ip)([this.xyManipulation.createGraphicDragPipeline(((a,t,n,s,e)=>i(MoveManipulation_c.XY,a,t,n,s,e)),t,n),this.xyAxisManipulation.createGraphicDragPipeline(((a,t,n,s,e)=>i(MoveManipulation_c.XY_AXIS,a,t,n,s,e)),t,n),this.zManipulation.createGraphicDragPipeline(((a,t,n,s,e)=>i(MoveManipulation_c.Z,a,t,n,s,e)),t,n)])}createDragPipeline(i,t,n,s){return(0,handleUtils.Ip)([this.xyManipulation.createDragPipeline(((a,t,n,s,e)=>i(MoveManipulation_c.XY,a,t,n,s,e)),t,n,s),this.xyAxisManipulation.createDragPipeline(((a,t,n,s,e)=>i(MoveManipulation_c.XY_AXIS,a,t,n,s,e)),t,n,s),this.zManipulation.createDragPipeline(((a,t,n,s,e)=>i(MoveManipulation_c.Z,a,t,n,s,e)),n)])}set snapToScene(i){this.xyManipulation.snapToScene=i}set angle(i){this.xyAxisManipulation.angle=i}set interactive(i){this._interactive!==i&&(this._interactive=i,this._updateManipulatorInteractivity())}set radius(i){this.xyAxisManipulation.radius=i,this.xyManipulation.radius=i,this.zManipulation.radius=i}set displayScale(i){this.xyManipulation.displayScale=i,this.xyAxisManipulation.displayScale=i}forEachManipulator(i){this.xyManipulation.forEachManipulator((a=>i(a,ManipulatorType_A.TRANSLATE_XY))),this.xyAxisManipulation.forEachManipulator((a=>i(a,ManipulatorType_A.TRANSLATE_XY))),this.zManipulation.forEachManipulator((a=>i(a,ManipulatorType_A.TRANSLATE_Z)))}get _xyAxisVisible(){const i=this.xyManipulation.someManipulator((i=>i.focused))||this.xyAxisManipulation.someManipulator((i=>i.focused));return this._view.inputManager&&"touch"===this._view.inputManager.latestPointerType||i}_autoHideXYAxis(){const i=this.xyAxisManipulation,a=this.xyManipulation;if((0,has.c)("esri-mobile"))return;const n=[];a.forEachManipulator((i=>n.push(i))),i.forEachManipulator((i=>n.push(i)));const s=()=>{const a=[];this._xyAxisVisible||i.forEachManipulator((i=>a.push(i.disableDisplay()))),this._handles.remove(MoveManipulation_h),this._handles.add(a,MoveManipulation_h)};for(const t of n)this._handles.add(t.events.on("focus-changed",s));this._view.inputManager&&this._handles.add((0,reactiveUtils._I)((()=>this._view.inputManager?.latestPointerType),s)),s()}_updateManipulatorInteractivity(){const i=this.grabbing;this.forEachManipulator((a=>{a.interactive=!i&&this._interactive||a.grabbing}))}static radiusForSymbol(i){const a=null!=i&&"point-3d"===i.type&&i.symbolLayers;return a&&a.some((i=>"icon"===i.type))?config_o:70}}const MoveManipulation_h="disable-xy-axis-display";var MoveManipulation_c;!function(i){i[i.XY=0]="XY",i[i.XY_AXIS=1]="XY_AXIS",i[i.Z=2]="Z"}(MoveManipulation_c||(MoveManipulation_c={}));var GraphicManipulator=__webpack_require__("./node_modules/@arcgis/core/views/interactive/GraphicManipulator.js");class MoveXYGraphicManipulation_l extends Manipulation_t{constructor(t){super(),this._view=t.view,this._tool=t.tool,this._graphicState=t.graphicState,this._createManipulator(),this.forEachManipulator((t=>this._tool.manipulators.add(t)))}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()})),this._tool=null,this._view=null,this._manipulator=null,this._graphicState=null}forEachManipulator(t){t(this._manipulator,ManipulatorType_A.TRANSLATE_XY)}createGraphicDragPipeline(t){return moveUtils_n(this._graphicState.graphic,t,(t=>this.createDragPipeline(t)),this._view.state.viewingMode)}createDragPipeline(i){const e=this._view,r=this._graphicState.graphic,n=null!=r.geometry?r.geometry.spatialReference:null;return(0,dragEventPipeline.G4)(this._manipulator,((a,l,p,h,c)=>{const u=l.next(function dragEventPipeline3D_M(e,n,r,t){const o=n.toMap(e.screenStart,{include:[r]});return null!=o?dragEventPipeline3D_D(n,r,o,t):null}(c,e,r,n)).next((0,dragEventPipeline.YL)()).next((0,dragEventPipeline.qm)());i(a,u,p,h,c)}))}_createManipulator(){const t=this._view,i=this._graphicState.graphic;this._manipulator=new GraphicManipulator.O({graphic:i,view:t,selectable:!0,cursor:"move"})}}var isSupportedGraphic=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/editingTools/moveGraphic/isSupportedGraphic.js"),InteractiveToolBase=__webpack_require__("./node_modules/@arcgis/core/views/interactive/InteractiveToolBase.js"),EditGeometryOperations=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/EditGeometryOperations.js"),SketchTooltipOptions=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/SketchTooltipOptions.js"),SnappingContext=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingContext.js"),SnappingDragPipelineStep=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/SnappingDragPipelineStep.js"),Tooltip=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/Tooltip.js"),TranslateTooltipInfos=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/TranslateTooltipInfos.js"),euclideanLengthMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/euclideanLengthMeasurementUtils.js");class GraphicMoveTool_C{constructor(t){this.allGraphics=t,this.type="graphic-move-start"}}class GraphicMoveTool_V{constructor(t,i,e){this.dx=t,this.dy=i,this.allGraphics=e,this.type="graphic-move"}}class GraphicMoveTool_L{constructor(t){this.allGraphics=t,this.type="graphic-move-stop"}}let GraphicMoveTool_q=class extends(Evented.c.EventedMixin(InteractiveToolBase.g)){constructor(t){super(t),this._infos=new Map,this.graphics=new Collection.c,this.enableZ=!0,this.tooltipOptions=new SketchTooltipOptions.c,this.type="move-3d",this._updatingHandles=new UpdatingHandles.A,this._moveManipulation=null,this._tooltip=null,this._translateGraphicTooltipInfo=null,this._translateGraphicXYTooltipInfo=null,this._translateGraphicZTooltipInfo=null}initialize(){const{view:t}=this;this.addHandles([this.graphics.on("change",(t=>{t.removed.forEach((t=>this.removeHandles(t))),this._updateGraphicInfos(t),this._setupFastTransformUpdates(t.added),this._refreshManipulators()})),(0,reactiveUtils.aE)((()=>this.tooltipOptions.enabled),(i=>{this._tooltip=i?new Tooltip.o({view:t}):(0,maybe.mG)(this._tooltip)}),reactiveUtils.KG)]);const i=this.graphics.toArray();this._updateGraphicInfos({added:i,removed:[]}),this._setupFastTransformUpdates(i),this._refreshManipulators(),this.finishToolCreation()}destroy(){this._tooltip=(0,maybe.mG)(this._tooltip),this._moveManipulation=(0,maybe.mG)(this._moveManipulation),this._set("view",null),this._updatingHandles.destroy()}get updating(){return this._updatingHandles.updating}reset(){}_updateGraphicInfos({added:t,removed:i}){for(const e of t){if((0,isSupportedGraphic.s)(e)!==isSupportedGraphicUtils.g.SUPPORTED)continue;const t=new GraphicMoveTool_B(e),i=this.view.trackGraphicState(t.state);this._infos.set(t.graphic,{info:t,handle:i})}for(const e of i)this._infos.get(e)?.handle.remove(),this._infos.delete(e)}_setupFastTransformUpdates(t){for(const i of t){const{info:t}=this._infos.get(i);this.addHandles(meshFastUpdateUtils_o(t.state),i)}}_refreshManipulators(){if(this.removeHandles("manipulators"),this._moveManipulation=(0,maybe.mG)(this._moveManipulation),this.manipulators.removeAll(),0===this._infos.size)return;const t=Array.from(this._infos.values(),(({info:t})=>t));this._createManipulators(t),this._createVisualElements(t),this._updateMoveManipulation(t)}_createManipulators(t){for(const i of t){const e=i.state;i.manipulationXY=new MoveXYGraphicManipulation_l({tool:this,view:this.view,graphicState:e}),i.manipulationXY.forEachManipulator((t=>this.addHandles([t.events.on("immediate-click",(t=>{this.emit("immediate-click",{...t,graphic:e.graphic}),t.stopPropagation()})),t.events.on("grab-changed",(({action:t})=>{const{tooltipOptions:i,_tooltip:e}=this;null!=e&&("start"===t?(this._translateGraphicTooltipInfo??=new TranslateTooltipInfos.qC({tooltipOptions:i}),e.info=this._translateGraphicTooltipInfo,e.info.tooltipOptions=i,e.info.distance=quantityUtils.U7):e.clear())}))],"manipulators"))),this.addHandles(i.manipulationXY.createDragPipeline(((i,e,o,n)=>this._buildDragEventPipeline(t,MoveManipulation_c.XY,i,e,o,n))),"manipulators")}this._createMoveManipulation(t)}_createMoveManipulation(t){const i=new MoveManipulation_u({tool:this,view:this.view,snapToScene:!1,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:!0,radius:1===t.length?MoveManipulation_u.radiusForSymbol(t[0].graphic.symbol):70});this._moveManipulation=i,i.elevationInfo={mode:"absolute-height",offset:0},i.forEachManipulator((t=>{this.addHandles(t.events.on("immediate-click",(e=>{i.zManipulation.hasManipulator(t)||1!==this.graphics.length||this.emit("immediate-click",{...e,graphic:this.graphics.at(0)}),e.stopPropagation()})),"manipulators")}));const e=i=>e=>{this.addHandles(e.events.on("focus-changed",(({action:e})=>{const o=this._tooltip;null!=o&&("focus"===e?this._updateMoveTooltip(t,i):o.clear())})),"manipulators")};this._moveManipulation.xyManipulation.forEachManipulator(e(MoveManipulation_c.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(e(MoveManipulation_c.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(e(MoveManipulation_c.Z));const o=()=>this._updateMoveManipulation(t);for(const a of t)this.addHandles([a.state.on("changed",o),(0,reactiveUtils.aE)((()=>a.state.displaying),o)],"manipulators");const n=t[t.length-1];this.addHandles(n.state.on("changed",(()=>this._updateMoveManipulationAngle(n))),"manipulators"),this.addHandles(i.createDragPipeline(((i,e,o,n,a)=>this._buildDragEventPipeline(t,i,e,o,n,a)),(0,elevationInfoUtils.CI)(n.graphic),n.graphic.geometry.spatialReference,n.graphic),"manipulators"),this._updateMoveManipulationAngle(n)}_createVisualElements(t){for(const i of t){const e=i.graphic,n=visualElementUtils_i({view:this.view,graphic:e,forEachManipulator:t=>{i.manipulationXY?.forEachManipulator(t),this._moveManipulation?.forEachManipulator(t)},onManipulatorsChanged:()=>(0,handleUtils.uU)()});null!=n&&(i.geometryRepresentation=n.visualElement,i.geometryRepresentation instanceof OutlineVisualElement_w&&this.addHandles([i.geometryRepresentation.events.on("attachment-origin-changed",(()=>{i.state.isDraped||this._updateMoveManipulation(t)})),(0,reactiveUtils.aE)((()=>i.state.isDraped),(()=>this._updateMoveManipulation(t)))],"manipulators"),this.addHandles(n,"manipulators"))}}_updateMoveManipulationAngle(t){this._moveManipulation&&(this._moveManipulation.angle=geometryUtils_r(t.graphic.geometry))}_updateMoveManipulation(t){const i=(0,dehydratedPoint.A)(0,0,0,this.view.spatialReference);let e=0,o=!1;const n=this._moveManipulation;if(n){for(const n of t){if(!n.state.displaying)continue;const t=n.state.graphic;this.enableZ&&manipulatorUtils_n(t)&&(o=!0);const a=n.geometryRepresentation instanceof OutlineVisualElement_w&&!n.state.isDraped?n.geometryRepresentation.attachmentOrigin:manipulatorUtils_k(this.view,t);if(null!=a){const{x:t,y:o,z:n}=a;i.x+=t,i.y+=o,n&&(i.z??=0,i.z+=n),e++}}e>0?(i.x/=e,i.y/=e,i.z??=0,i.z/=e,n.location=i,n.xyManipulation.available=!0,n.xyAxisManipulation.available=!0,n.zManipulation.available=o):n.available=!1}}_buildDragEventPipeline(t,i,e,o,n,a){const s=[],r=[];let p=null,l=null;const h=()=>{for(const t of s)t.dragging=!1;s.length=0,r.length=0,p=null,l=null,this._moveManipulation&&(this._moveManipulation.interactive=!0)};if(1===t.length&&i===MoveManipulation_c.XY){const i=t[0].graphic;({steps:o,cancel:n}=this._buildSnappingPipelineSteps(i,(0,elevationInfoUtils.CI)(i),o,n,a))}return n=n.next((t=>l?.(t))).next((()=>(this.emit("graphic-move-stop",new GraphicMoveTool_L(r)),this.destroyed||h(),null))),{steps:o=o.next((i=>{if("start"===i.action){s.length=0,r.length=0;for(const i of t)i.dragging||!i.manipulationXY?.hasManipulator(e)&&i.manipulationXY?.grabbing||(s.push(i),r.push(i.graphic),i.dragging=!0);if(0!==r.length&&(this._moveManipulation&&(this._moveManipulation.interactive=!1),p=(0,dragEventPipeline.Cy)(r,this.view.state.viewingMode),l=(0,dragEventPipeline.sH)(r),this.emit("graphic-move-start",new GraphicMoveTool_C(r)),this.destroyed))return null}return 0!==r.length?i:null})).next((t=>p?.(t))).next((e=>(this._updateMoveTooltip(t,i,e),e))).next((t=>{switch(t.action){case"start":case"update":if(t.translationX||t.translationY||t.translationZ){const i=this.view.toScreen(t.mapStart),e=this.view.toScreen(t.mapEnd),o=e.x-i.x,n=e.y-i.y;if(this.emit("graphic-move",new GraphicMoveTool_V(o,n,r)),this.destroyed)return null}break;case"end":if(this.emit("graphic-move-stop",new GraphicMoveTool_L(r)),this.destroyed)return null;h()}return null})),cancel:n}}_updateMoveTooltip(t,i,e){const{tooltipOptions:o,_tooltip:n}=this;if(null==n)return;n.clear();const a=0===t.length?"absolute-height":t[0].state.isDraped?"on-the-ground":"absolute-height";switch(i){case MoveManipulation_c.XY:n.info=this._translateGraphicTooltipInfo??=new TranslateTooltipInfos.qC({tooltipOptions:o}),this._updateMoveTooltipDistance(n.info,e,((t,i)=>(0,automaticLengthMeasurementUtils.ik)(t,i,a)));break;case MoveManipulation_c.XY_AXIS:n.info=this._translateGraphicXYTooltipInfo??=new TranslateTooltipInfos.j1({tooltipOptions:o}),this._updateMoveTooltipDistance(n.info,e,((t,i)=>{const o=(0,automaticLengthMeasurementUtils.ik)(t,i,a);return(0,quantityUtils.aU)(o,moveUtils_a(e))}));break;case MoveManipulation_c.Z:n.info=this._translateGraphicZTooltipInfo??=new TranslateTooltipInfos.MH({tooltipOptions:o}),this._updateMoveTooltipDistance(n.info,e,euclideanLengthMeasurementUtils.Mb)}n.info.tooltipOptions=o}_updateMoveTooltipDistance(t,i,e){if(null!=i&&"end"!==i.action){const{mapStart:o,mapEnd:n}=i,s=e(o,n);t.distance=null!=s?s:quantityUtils.U7}else t.distance=quantityUtils.U7}_buildSnappingPipelineSteps(t,i,e,o,n){const a=t.geometry;if(null==a||"point"!==a.type&&"mesh"!==a.type)return{steps:e,cancel:o};const s=("point"===a.type?a:a.anchor).clone(),r=new SnappingContext.m({elevationInfo:i,pointer:n,editGeometryOperations:EditGeometryOperations.u.fromGeometry(s,this.view.state.viewingMode),visualizer:new SnappingVisualizer3D_O,excludeFeature:t}),p=this.snappingManager,{snappingStep:l,cancelSnapping:h}=(0,SnappingDragPipelineStep.s)({snappingContext:r,snappingManager:p,updatingHandles:this._updatingHandles});return o=o.next(h),{steps:e=e.next((i=>(s.z=(0,elevationInfoUtils.eV)(this.view,s,(0,elevationInfoUtils.CI)(t),{mode:"absolute-height",offset:0}),{...i,snapOrigin:r.coordinateHelper.pointToVector(s)}))).next(...l),cancel:o}}get test(){return{tooltip:this._tooltip}}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicMoveTool_q.prototype,"view",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicMoveTool_q.prototype,"graphics",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicMoveTool_q.prototype,"enableZ",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,type:SketchTooltipOptions.c})],GraphicMoveTool_q.prototype,"tooltipOptions",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],GraphicMoveTool_q.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicMoveTool_q.prototype,"type",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicMoveTool_q.prototype,"updating",null),GraphicMoveTool_q=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.editingTools.graphicMove3D.GraphicMoveTool")],GraphicMoveTool_q);class GraphicMoveTool_B{constructor(t){this.geometryRepresentation=null,this.manipulationXY=null,this.dragging=!1,this.state=new GraphicState_e({graphic:t})}get graphic(){return this.state.graphic}}var reshapeGraphic_isSupportedGraphic=__webpack_require__("./node_modules/@arcgis/core/views/3d/interactive/editingTools/reshapeGraphic/isSupportedGraphic.js"),Polyline=__webpack_require__("./node_modules/@arcgis/core/geometry/Polyline.js"),utils=__webpack_require__("./node_modules/@arcgis/core/symbols/support/utils.js"),OffsetEdgeVertex=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/operations/OffsetEdgeVertex.js");function edgeOffsetUtils_m(e,r,o){const n="on-the-ground"===o.mode?OffsetEdgeVertex.e.XY:OffsetEdgeVertex.e.XYZ;return new OffsetEdgeVertex.y(e,n,r,0)}function edgeOffsetUtils_a(e,r,n){const t=(0,vec3f64.c)();if(!e.renderCoordsHelper.toRenderCoords(r,t))return null;const s=edgeOffsetUtils_j(e,r,(0,plane.i4)(n.plane)),l=edgeOffsetUtils_j(e,r,n.edgeDirection);if(null==s||null==l)return null;const f=(0,vec3.b)((0,vec3f64.c)(),s,l);return(0,plane.aY)(t,f,(0,plane.Su)())}function edgeOffsetUtils_j(e,r,o){const t=(0,dehydratedPoint.A)(r.x+o[0],r.y+o[1],r.z+o[2],r.spatialReference),s=(0,vec3f64.c)(),i=(0,vec3f64.c)();return e.renderCoordsHelper.toRenderCoords(r,s)&&e.renderCoordsHelper.toRenderCoords(t,i)?(0,vec3.C)(i,s,i):null}var IViewEvents=__webpack_require__("./node_modules/@arcgis/core/views/input/IViewEvents.js"),editGeometry_interfaces=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/interfaces.js"),SketchTooltipInfo=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/SketchTooltipInfo.js");let ReshapeTooltipInfos_p=class extends SketchTooltipInfo.Q{constructor(o){super(o),this.type="reshape-edge-offset",this.distance=quantityUtils.U7,this.area=null,this.totalLength=null}};(0,tslib_es6._)([(0,property.qq)()],ReshapeTooltipInfos_p.prototype,"type",void 0),(0,tslib_es6._)([(0,property.qq)()],ReshapeTooltipInfos_p.prototype,"distance",void 0),(0,tslib_es6._)([(0,property.qq)()],ReshapeTooltipInfos_p.prototype,"area",void 0),(0,tslib_es6._)([(0,property.qq)()],ReshapeTooltipInfos_p.prototype,"totalLength",void 0),ReshapeTooltipInfos_p=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive.tooltip.ReshapeEdgeOffsetTooltipInfo")],ReshapeTooltipInfos_p);var fields=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/fields/fields.js"),automaticAreaMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/automaticAreaMeasurementUtils.js"),geodesicLengthMeasurementUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/geodesicLengthMeasurementUtils.js"),SpatialReference=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js");let kt=class extends(Evented.c.EventedMixin(Accessor.c)){constructor(t){super(t),this._selectedIndex=0,this._manipulatorHandles=new Handles.c,this._manipulatorInfos=[],this._numGrabbing=0,this._numDragging=0,this._reshapeEventState=qt.NONE,this._updatingHandles=new UpdatingHandles.A,this._recreatingManipulators=!1,this._settings=new settings_z({getTheme:()=>this.view.effectiveTheme}),this._translateGraphicTooltipInfo=null,this._translateGraphicXYTooltipInfo=null,this._translateGraphicZTooltipInfo=null,this._translateVertexTooltipInfo=null,this._translateVertexXYTooltipInfo=null,this._translateVertexZTooltipInfo=null,this._edgeOffsetTooltipInfo=null,this.outputGeometry=null,this._vertexLaserLineVisualElement=null}initialize(){const{graphic:t,view:e}=this,i=this._settings.manipulators,n=i.vertex;this._vertexManipulatorMaterial=manipulatorUtils_w((0,colorUtils.aS)(n.color),n.renderOccluded),this._vertexManipulatorOutlineMaterial=manipulatorUtils_b((0,colorUtils.aS)(n.outlineColor),n.renderOccluded),this._vertexManipulatorHoverOutlineMaterial=manipulatorUtils_b((0,colorUtils.aS)(n.hoverOutlineColor),n.renderOccluded);const o=i.edge;this._edgeManipulatorMaterial=manipulatorUtils_w((0,colorUtils.aS)(o.color),o.renderOccluded),this._edgeManipulatorOutlineMaterial=manipulatorUtils_b((0,colorUtils.aS)(o.outlineColor),o.renderOccluded);const r=i.edgeOffset;this._edgeOffsetManipulatorMaterial=manipulatorUtils_w((0,colorUtils.aS)(r.color),r.renderOccluded,!1),this._edgeOffsetManipulatorHoverMaterial=manipulatorUtils_w((0,colorUtils.aS)(r.hoverColor),r.renderOccluded,!1);const s=i.selected;this._selectedManipulatorMaterial=manipulatorUtils_w((0,colorUtils.aS)(s.color),s.renderOccluded),this._selectedManipulatorOutlineMaterial=manipulatorUtils_b((0,colorUtils.aS)(s.outlineColor),s.renderOccluded),this._selectedManipulatorHoverOutlineMaterial=manipulatorUtils_b((0,colorUtils.aS)(s.hoverOutlineColor),s.renderOccluded);const l=this._graphicState=new GraphicState_e({graphic:t});this._tooltip=new Tooltip.o({view:e}),this.addHandles([(0,reactiveUtils.aE)((()=>{const t=this._settings.manipulators;return{vertexSettings:t.vertex,edgeSettings:t.edge,edgeOffsetSettings:t.edgeOffset,selectedSettings:t.selected}}),(({vertexSettings:t,edgeSettings:e,edgeOffsetSettings:i,selectedSettings:a})=>{t.applyColor(this._vertexManipulatorMaterial),t.applyOutline(this._vertexManipulatorOutlineMaterial),t.applyHoverOutline(this._vertexManipulatorHoverOutlineMaterial),e.applyColor(this._edgeManipulatorMaterial),e.applyOutline(this._edgeManipulatorOutlineMaterial),i.applyColor(this._edgeOffsetManipulatorMaterial),i.applyHover(this._edgeOffsetManipulatorHoverMaterial),a.applyColor(this._selectedManipulatorMaterial),a.applyOutline(this._selectedManipulatorOutlineMaterial),a.applyHoverOutline(this._selectedManipulatorHoverOutlineMaterial)})),(0,reactiveUtils.aE)((()=>l.displaying),(t=>{for(const e of this._manipulatorInfos)e.manipulator.available=t})),(0,reactiveUtils.aE)((()=>({labels:this._segmentLabels,enabled:this._labelOptions.enabled,edgeOffsetEnabled:this.enableEdgeOffset})),(({labels:t,enabled:e,edgeOffsetEnabled:i})=>{null!=t&&(t.visible=e,t.edgeDistance=i?"far":"default")}),reactiveUtils._8),(0,reactiveUtils._I)((()=>!this._tooltipOptions.enabled),(()=>this._tooltip.clear()),reactiveUtils._8),this.view.trackGraphicState(l)])}destroy(){this._segmentLabels=(0,maybe.mG)(this._segmentLabels),this._tooltip=(0,maybe.mG)(this._tooltip),this._removeManipulators(),this._updatingHandles.destroy()}get inputGeometry(){return null!=this._editGeometryOperations?this._editGeometryOperations.data.geometry:null}set inputGeometry(t){this._recreateEditGeometryAndManipulators(t)}get updating(){return this._updatingHandles.updating}get manipulators(){return this.tool.manipulators}get view(){return this.tool.view}get graphic(){return this.tool.graphic}get enableZShape(){return this.tool.enableZShape}get enableZVertex(){return this.tool.enableZVertex}get enableMoveGraphic(){return this.tool.enableMoveGraphic}get enableMidpoints(){return this.tool.enableMidpoints}get enableEdgeOffset(){return this.tool.enableEdgeOffset}get _labelOptions(){return this.tool.labelOptions}get _tooltipOptions(){return this.tool.tooltipOptions}get _accentColor(){return this.view.effectiveTheme.accentColor}removeSelectedVertices(){const t=this._manipulatorInfos.filter((t=>t.manipulator.selected&&"vertex"===t.type));this._removeVertices(t)}onManipulatorSelectionChanged(){this.emit("manipulators-changed")}_removeManipulators(){this._manipulatorHandles.removeAll(),this._moveManipulation=(0,maybe.mG)(this._moveManipulation),this._graphicMoveManipulation=(0,maybe.mG)(this._graphicMoveManipulation),this.manipulators.removeAll(),this._manipulatorInfos=[],this._numGrabbing=0,this._numDragging=0}_createManipulators(t){if(null==this._editGeometryOperations)return;const e=(0,elevationInfoUtils.CI)(this.graphic);for(const i of this._editGeometryOperations.data.components){const a=t?.byComponentIndex.get(i.index);for(const t of i.vertices){const i=a?.has(t.index);this._createVertexOrEdgeManipulator(t,e,i)}for(const t of i.edges)this._createVertexOrEdgeManipulator(t,e)}this._createGraphicMoveManipulation(),this._createMoveManipulation(e),this._createVisualElements()}get canRedo(){return null!=this._editGeometryOperations&&this._editGeometryOperations.canRedo}get canUndo(){return null!=this._editGeometryOperations&&this._editGeometryOperations.canUndo}redo(){if(null==this._editGeometryOperations)return null;const t=this._editGeometryOperations.redo();return null!=t&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),t}undo(){if(null==this._editGeometryOperations)return null;this.emit("undo");const t=this._editGeometryOperations.undo();return null!=t&&(this.outputGeometry=this._editGeometryOperations.data.geometry,this._recreateManipulators()),t}_recreateManipulators(){this._recreatingManipulators||(this._recreatingManipulators=!0,this._removeManipulators(),this._tooltip.clear(),this._createManipulators(),this._recreatingManipulators=!1)}_recreateEditGeometryAndManipulators(t){const e={byComponentIndex:new Map};if(null!=t&&null!=this.inputGeometry&&(0,coordsUtils.SQ)(t,this.inputGeometry))for(const a of this._manipulatorInfos)if("vertex"===a.type&&a.manipulator.selected){const{index:t,component:{index:i}}=a.handle,{byComponentIndex:n}=e,o=n.get(i)||new Set;o.add(t),n.set(i,o)}if(this._recreatingManipulators=!0,this._removeManipulators(),this._tooltip.clear(),this._editGeometryOperations=(0,maybe.mG)(this._editGeometryOperations),this._segmentLabels=(0,maybe.mG)(this._segmentLabels),null==t)return void(this._recreatingManipulators=!1);const i="mesh"===t.type?t.anchor:t;this._editGeometryOperations=EditGeometryOperations.u.fromGeometry(i,this.view.state.viewingMode),this._createManipulators(e),this._segmentLabels=new SegmentLabels3D_a({context:{view:this.view,editGeometryOperations:this._editGeometryOperations,elevationInfo:(0,elevationInfoUtils.CI)(this.graphic),labelOptions:this._labelOptions,graphic:this.graphic,graphicState:this._graphicState},visible:this._labelOptions.enabled}),this._recreatingManipulators=!1}_perGraphicManipulatorDragAction(t,e){if("end"===e.action)return e;let i=0;const a=[],n=this._manipulatorInfos.some((t=>"vertex"===t.type&&t.manipulator.selected)),o=t===Wt.SELECTED_OR_ALL&&n;for(const r of this._manipulatorInfos)"vertex"===r.type&&(r.manipulator.grabbing||o&&!r.manipulator.selected||a.push(r),i++);if(0===a.length)return e;if(this._moveVertices(a,e),a.length===i){if(this._updateEventState(qt.MOVING),this.destroyed)return e;this.emit("move",{type:"move",dx:e.screenDeltaX,dy:e.screenDeltaY,mover:this.graphic})}else{if(this._updateEventState(qt.RESHAPING),this.destroyed)return e;this.emit("reshape",{type:"reshape",mover:this.graphic})}return e}_isMultiVertexSelection(){return this._manipulatorInfos.reduce(((t,e)=>"vertex"===e.type&&e.manipulator.selected?t+1:t),0)>1}_perVertexManipulatorDragAction(t){if(this._updateEventState(qt.RESHAPING),this.destroyed)return;const{mapDeltaX:e,mapDeltaY:i,mapDeltaZ:a}=t;if(!e&&!i&&!a)return;const n=[];for(const o of this._manipulatorInfos)"vertex"===o.type&&(o.manipulator.selected&&!o.manipulator.grabbing||o===t.info)&&n.push(o);this._moveVertices(n,t,editGeometry_interfaces.M.ACCUMULATE_STEPS),this.emit("reshape",{type:"reshape",mover:this.graphic})}_updateEventState(t){if(t===this._reshapeEventState)return!1;switch(t){case qt.NONE:if(0!==this._numGrabbing||0!==this._numDragging)return!1;switch(this._reshapeEventState){case qt.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic});break;case qt.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic})}break;case qt.MOVING:switch(this._reshapeEventState){case qt.NONE:this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic});break;case qt.RESHAPING:this.emit("reshape",{type:"reshape-stop",mover:this.graphic}),this.destroyed||this.emit("move",{type:"move-start",dx:0,dy:0,mover:this.graphic})}break;case qt.RESHAPING:switch(this._reshapeEventState){case qt.NONE:this.emit("reshape",{type:"reshape-start",mover:this.graphic});break;case qt.MOVING:this.emit("move",{type:"move-stop",dx:0,dy:0,mover:this.graphic}),this.destroyed||this.emit("reshape",{type:"reshape-start",mover:this.graphic})}}if(this.destroyed)return!1;const e=this._reshapeEventState!==t;return this._reshapeEventState=t,e}_createGraphicMoveManipulation(){const{tool:t,view:e}=this,i=this._graphicState;if(this._graphicMoveManipulation=new MoveXYGraphicManipulation_l({tool:t,view:e,graphicState:i}),this.enableMoveGraphic){let t=null;this._manipulatorHandles.add(this._graphicMoveManipulation.createDragPipeline(((e,i,a)=>{i.next((t=>this._trackNumDragging(t))).next((e=>("start"===e.action&&(t=this._editGeometryOperations.createUndoGroup()),e))).next((t=>this._perGraphicManipulatorDragAction(Wt.ALL,t))).next((t=>(this._updateTranslateGraphicTooltip(MoveManipulation_c.XY,t),t))).next((e=>{"end"===e.action&&(this._tooltip.clear(),t=(0,maybe.oR)(t))})),a.next((()=>this._onDragCancel(!0,(()=>t=(0,maybe.oR)(t)))))}))),this._graphicMoveManipulation.forEachManipulator((t=>this._manipulatorHandles.add(this._watchAndUpdateGrabState(t,!1))))}else this._graphicMoveManipulation.forEachManipulator((t=>{t.grabbable=!1,t.cursor=null}));this._graphicMoveManipulation.forEachManipulator((t=>this._manipulatorHandles.add(t.events.on("immediate-click",(t=>{this._manipulatorInfos.some((t=>t.manipulator.selected))?this._clearSelection():this.emit("immediate-click",{...t,graphic:this.graphic}),t.stopPropagation()})))))}_createMoveManipulation(t){const{graphic:e,tool:i,view:a}=this,n=this._graphicState;this._moveManipulation=new MoveManipulation_u({tool:i,view:a,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZShape&&manipulatorUtils_n(e),snapToScene:!1,radius:MoveManipulation_u.radiusForSymbol(e.symbol)}),this._moveManipulation.forEachManipulator((t=>this.addHandles([t.events.on("immediate-click",(i=>{this._moveManipulation.zManipulation.hasManipulator(t)||this._manipulatorInfos.some((t=>t.manipulator.selected))||this.emit("immediate-click",{...i,graphic:e}),i.stopPropagation()})),this._watchAndUpdateGrabState(t,!1)])));const o=t=>e=>{this.addHandles(e.events.on("focus-changed",(({action:e})=>{"focus"===e&&this._tooltipOptions.enabled?this._updateTranslateTooltip(t):this._tooltip.clear()})))};this._moveManipulation.xyManipulation.forEachManipulator(o(MoveManipulation_c.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(o(MoveManipulation_c.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(o(MoveManipulation_c.Z)),this._moveManipulation.elevationInfo={mode:"absolute-height",offset:0};const r=e.geometry.spatialReference;this.addHandles([this._moveManipulation.createDragPipeline(((a,n,o,r,s)=>{const{snappingStep:l,cancelSnapping:p}=(0,SnappingDragPipelineStep.s)({predicate:t=>!!t.info,snappingManager:i.snappingManager,snappingContext:new SnappingContext.m({editGeometryOperations:this._editGeometryOperations,elevationInfo:t,pointer:s,excludeFeature:e,visualizer:new SnappingVisualizer3D_O}),updatingHandles:this._updatingHandles,useZ:!1});return r=r.next((t=>(this._onDragCancel(),t))).next(p),{steps:o=o.next((t=>this._trackNumDragging(t))).next((t=>{const e=this._manipulatorInfos.filter((t=>"vertex"===t.type&&t.manipulator.selected));return t.manipulatorType===ManipulatorType_A.TRANSLATE_XY&&1===e.length?{...t,info:e[0],snapOrigin:e[0].handle.pos}:t})).next((0,dragEventPipeline.o3)(this.view,t,e)).next(...l).next((0,dragEventPipeline.YL)()).next((t=>this._perGraphicManipulatorDragAction(Wt.SELECTED_OR_ALL,t))).next((t=>(this._updateTranslateTooltip(a,t),t))),cancel:r}}),t,r,e),(0,reactiveUtils.aE)((()=>n.displaying),(()=>this._updateMoveManipulationPosition()),reactiveUtils._8),n.on("changed",(()=>{this._recreatingManipulators||this._updateMoveManipulationPosition()})),(0,reactiveUtils.aE)((()=>n.isDraped),(t=>{this._updateMoveManipulationPosition();const e="align-move-manipulation";t?this.addHandles(this.view.elevationProvider.on("elevation-change",(()=>this._updateMoveManipulationPosition())),e):this.removeHandles(e)}),reactiveUtils._8)])}_createVisualElements(){const{graphic:t,view:e}=this,i=visualElementUtils_i({view:e,graphic:t,forEachManipulator:t=>{if(!this.destroyed&&!this._recreatingManipulators){this._graphicMoveManipulation.forEachManipulator(t),this._moveManipulation.forEachManipulator(t);for(const e of this._manipulatorInfos)t(e.manipulator,ManipulatorType_A.TRANSLATE_XY)}},onManipulatorsChanged:t=>this.on("manipulators-changed",t)});null!=i&&(this._outlineVisualElement=i.visualElement instanceof OutlineVisualElement_w?i.visualElement:null),null!=this._outlineVisualElement&&this._manipulatorHandles.add(this._outlineVisualElement.events.on("attachment-origin-changed",(()=>{this._graphicState.isDraped||this._updateMoveManipulationPosition()}))),this._manipulatorHandles.add(i)}_createEdgeOffsetManipulator(t,e=(0,elevationInfoUtils.CI)(this.graphic)){const i=this._settings.manipulators.edgeOffset,a=i.size/2,n=a+i.collisionPadding,o=a/n,s=o*Math.sqrt(3)/2;null==this._edgeOffsetManipulatorGeometryInside&&(this._edgeOffsetManipulatorGeometryInside=(0,GeometryUtil.mm)(this._edgeOffsetManipulatorMaterial,s,o/2,o/2,i.height,i.offset)),null==this._edgeOffsetManipulatorGeometryOutside&&(this._edgeOffsetManipulatorGeometryOutside=(0,GeometryUtil.mm)(this._edgeOffsetManipulatorMaterial,-s,o/2,o/2,i.height,-i.offset));const l=[new RenderObject_e(this._edgeOffsetManipulatorGeometryInside.instantiate(),interactive_interfaces.Gu.Unfocused),new RenderObject_e(this._edgeOffsetManipulatorGeometryInside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),interactive_interfaces.Gu.Focused),new RenderObject_e(this._edgeOffsetManipulatorGeometryOutside.instantiate(),interactive_interfaces.Gu.Unfocused),new RenderObject_e(this._edgeOffsetManipulatorGeometryOutside.instantiate({material:this._edgeOffsetManipulatorHoverMaterial}),interactive_interfaces.Gu.Focused)],p=new Manipulator3D_$({view:this.view,renderObjects:l,elevationInfo:"on-the-ground"!==e.mode||(0,utils.IX)(this.graphic.symbol)?{mode:"absolute-height",offset:0}:e,worldOriented:!1,focusMultiplier:1,radius:n,available:!(!this.graphic.visible||!this.graphic.layer?.visible),collisionType:{type:"disc",direction:(0,vec3f64.f)(0,0,1)},collisionPriority:1,metadata:{deleting:!1}}),h=new Manipulator3D_$({view:this.view,worldSized:!0,worldOriented:!1,available:!(!this.graphic.visible||!this.graphic.layer?.visible),collisionPriority:-10,cursor:this.enableMoveGraphic?"move":"default",metadata:{deleting:!1}}),u={manipulator:p,handle:t,locationUpdateHandle:null,type:"edge",selectedIndex:0,edgeManipulator:h,elevationInfo:e,visibilityHandle:null};this._autoHideEdgeOffsetManipulator(u,i.minSquaredEdgeLength),this._updateEdgeOffsetManipulator(u);const c=[];for(const r of[u.handle.leftVertex,u.handle.rightVertex]){const t=this._getManipulatorInfoFromHandle(r);null!=t&&c.push(t.manipulator.events.on("location-update",(()=>this._updateEdgeOffsetManipulator(u))))}u.locationUpdateHandle=(0,handleUtils.Ip)(c),this._manipulatorHandles.add(u.locationUpdateHandle,p),this._manipulatorHandles.add([this._watchAndUpdateGrabState(p,!0),this._watchAndUpdateGrabState(h,!0)],p),this._manipulatorHandles.add((0,dragEventPipeline.G4)(p,this._createEdgeOffsetPipeline(u,e)),p),this._manipulatorHandles.add((0,dragEventPipeline.G4)(h,((t,i,a,n)=>{if("touch"===n)this._createEdgeOffsetPipeline(u,e)(t,i,a);else if(this.enableMoveGraphic){const n=this.graphic,o=null!=n.geometry?n.geometry.spatialReference:null;i.next((t=>this._trackNumDragging(t))).next((0,dragEventPipeline.ks)(this.view,t.elevationAlignedLocation)).next(dragEventPipeline3D_T(this.view,t.elevationAlignedLocation,e,o,n)).next((0,dragEventPipeline.qm)()).next((0,dragEventPipeline.YL)()).next((t=>this._perGraphicManipulatorDragAction(Wt.ALL,t))).next((t=>(this._updateTranslateGraphicTooltip(MoveManipulation_c.XY,t),t))).next((t=>{"end"===t.action&&this._tooltip.clear()})),a.next((()=>this._onDragCancel(!t.metadata.deleting)))}})),p);const m=t=>{this._manipulatorInfos.some((t=>t.manipulator.selected))?this._clearSelection():this.emit("immediate-click",{...t,graphic:this.graphic}),t.stopPropagation()};return this._manipulatorHandles.add([p.events.on("immediate-click",m),h.events.on("immediate-click",m),p.events.on("focus-changed",(({action:t})=>{const{_tooltipOptions:e,_tooltip:i}=this;"focus"===t&&e.enabled?(i.info=this._edgeOffsetTooltipInfo??=new ReshapeTooltipInfos_p({tooltipOptions:e}),i.info.distance=quantityUtils.U7,i.info.tooltipOptions=e,this._updateTooltipAreaOrTotalLength(i.info)):i.clear()}))],p),this._manipulatorInfos.push(u),this.manipulators.add(p),this.manipulators.add(h),this.emit("manipulators-changed"),u}_autoHideEdgeOffsetManipulator(t,e){const i=t.manipulator,a=t.edgeManipulator,n=()=>{t.visibilityHandle=(0,maybe.oR)(t.visibilityHandle);const n=this._getManipulatorInfoFromHandle(t.handle.leftVertex),o=this._getManipulatorInfoFromHandle(t.handle.rightVertex),l=null!=n&&null!=o&&function edgeOffsetUtils_h(r,o,n){const c=n.projectToRenderScreen(r,(0,screenUtils.UZ)()),i=n.projectToRenderScreen(o,(0,screenUtils.UZ)());return null!=c&&null!=i?(0,vec3.m)((0,vec3.f)(c,c,i)):0}(n.manipulator.renderLocation,o.manipulator.renderLocation,this.view.state.camera)<e;(!i.focused&&!a.focused||l)&&(i.grabbable=!l,a.grabbable=!l,t.visibilityHandle=(0,handleUtils.Ip)([i.disableDisplay(),(0,handleUtils.uU)((()=>{i.grabbable=!0,a.grabbable=this.enableMoveGraphic}))]))};this._manipulatorHandles.add([i.events.on("focus-changed",n),a.events.on("focus-changed",n),(0,handleUtils.uU)((()=>{(0,maybe.oR)(t.visibilityHandle),a.metadata.deleting=!0,this.manipulators.remove(a)}))],i),n()}_updateEdgeOffsetManipulator(t){this._updateManipulatorPosition(t);const{coordinateHelper:e}=this._editGeometryOperations.data,i=edgeOffsetUtils_a(this.view,t.manipulator.elevationAlignedLocation,edgeOffsetUtils_m(e,t.handle,t.manipulator.elevationInfo)),a=this._getManipulatorInfoFromHandle(t.handle.leftVertex),n=this._getManipulatorInfoFromHandle(t.handle.rightVertex);if(null==a||null==n)return;const o=a.manipulator.renderLocation,r=n.manipulator.renderLocation,s=null!=i?function edgeOffsetUtils_C(e,t,s){const u=(0,plane.i4)(e),d=(0,vec3.C)((0,vec3f64.c)(),t,s),l=(0,vec3.b)((0,vec3f64.c)(),d,u),f=(0,vec3.b)((0,vec3f64.c)(),d,l);return(0,mat4f64.f)(d[0],d[1],d[2],0,l[0],l[1],l[2],0,f[0],f[1],f[2],0,0,0,0,1)}(i,o,r):mat4f64.I;t.manipulator.modelTransform=s,t.edgeManipulator.elevationAlignedLocation=t.manipulator.elevationAlignedLocation,t.edgeManipulator.modelTransform=s;const l=(0,vec3.l)((0,vec3.f)(Xt,o,r))/2;t.edgeManipulator.collisionType={type:"line",paths:[[[-l,0,0],[l,0,0]]]}}_createEdgeOffsetPipeline(t,e){return(i,a,n)=>{this._clearSelection();const{step:o,cleanup:r}=this._initializeEdgeOffset(t,e);a.next((t=>this._trackNumDragging(t))).next((0,dragEventPipeline.ks)(this.view,i.elevationAlignedLocation)).next(o).next(function dragEventPipeline3D_U(e){return dragEventPipeline3D_O(e,(e=>e.plane))}(this.view)).next(dragEventPipeline3D_k(this.view,this._editGeometryOperations.data.spatialReference)).next((0,dragEventPipeline.YL)()).next(this._applyComputeEdgeOffsetDistanceStep()).next(this._applyEdgeOffsetStep(t)).next(this._showEdgeOffsetTooltip()).next((t=>{"end"===t.action&&r()})),n.next((()=>{i.metadata.deleting||(r(),this._onDragCancel())}))}}_initializeEdgeOffset(t,e){const{view:i}=this,n=this._editGeometryOperations,o=edgeOffsetUtils_m(n.data.coordinateHelper,t.handle,e),s=n.createUndoGroup(),p=edgeOffsetUtils_a(i,t.manipulator.elevationAlignedLocation,o);if(o.requiresSplitEdgeLeft){const e=this._getManipulatorInfoFromHandle(t.handle.leftVertex.leftEdge);null!=e&&this._splitEdgeManipulator(e,1)}if(o.requiresSplitEdgeRight){const e=this._getManipulatorInfoFromHandle(t.handle.rightVertex.rightEdge);null!=e&&this._splitEdgeManipulator(e,0)}const d=()=>new Polyline.c({paths:[[t.handle.leftVertex.pos,t.handle.rightVertex.pos]],spatialReference:n.data.spatialReference}),u=this._settings,c=new OutlineVisualElement_w({view:i,isDraped:this._graphicState.isDraped,geometry:d(),elevationInfo:t.elevationInfo,width:u.visualElements.lineGraphics.outline.width,attached:!1,isDecoration:!0});let g;const f=()=>{this._cleanEdgeOffsetCollapsedEdges(t),g=(0,maybe.oR)(g)},v=this.on("undo",f);return g=(0,handleUtils.Ip)([(0,reactiveUtils.aE)((()=>(0,colorUtils.aS)(this._accentColor)),(t=>c.color=t),reactiveUtils._8),(0,handleUtils.sX)(c),(0,reactiveUtils.aE)((()=>this._graphicState.isDraped),(t=>c.isDraped=t)),this._graphicState.on("changed",(()=>c.geometry=d())),s,v]),c.attached=!0,{step:t=>null==o||null==p?(f(),null):{...t,operation:o,plane:p},cleanup:f}}_applyEdgeOffsetStep(t){return e=>{if(this.destroyed||null==e.operation)return e;this._updateEventState(qt.RESHAPING);const{mapDeltaX:i,mapDeltaY:a,mapDeltaZ:n}=e;return(i||a||n)&&(this._offsetEdge(t,e),this.emit("reshape",{type:"reshape",mover:this.graphic})),e}}_applyComputeEdgeOffsetDistanceStep(){return t=>{const{operation:e,mapEnd:i}=t;return null==e||null==i?t:("start"===t.action&&e.selectArrowFromStartPoint(i),{...t,signedDistance:e.signedDistanceToPoint(i)})}}_showEdgeOffsetTooltip(){return t=>{const{mapEnd:e,signedDistance:i,operation:a}=t,{_tooltip:n,_tooltipOptions:o}=this;return o.enabled&&null!=i?(n.info=this._edgeOffsetTooltipInfo??=new ReshapeTooltipInfos_p({tooltipOptions:o}),n.info.tooltipOptions=o,n.info.distance="end"===t.action?quantityUtils.U7:function Ft(t,e,i,a,n){if(t){const t=n.toXYZ(n.pointToVector(i)),o=(0,plane.C_)(a,t,vectorStacks.Wq.get()),r=(0,geodesicLengthMeasurementUtils.IP)(o,t,n.spatialReference);if(null!=r)return(0,quantityUtils.Mz)(r.value*Math.sign(e),r.unit)}return(0,quantityUtils.Mz)(e*(0,unitUtils.k8)(i.spatialReference),"meters")}(this._graphicState.isDraped,i*a.selectedArrow,e,a.plane,this._editGeometryOperations.data.coordinateHelper),this._updateTooltipAreaOrTotalLength(n.info),t):(n.clear(),t)}}_cleanEdgeOffsetCollapsedEdges(t){const e=t.handle.leftVertex.leftEdge?.leftVertex,i=t.handle.leftVertex,a=t.handle.rightVertex.rightEdge?.rightVertex,n=t.handle.rightVertex,o=this._editGeometryOperations.data.coordinateHelper,r=[];if(e&&o.distance(e.pos,i.pos)<Zt){const t=this._getManipulatorInfoFromHandle(i);null!=t&&r.push(t)}if(o.distance(i.pos,n.pos)<Zt||a&&o.distance(a.pos,n.pos)<Zt){const t=this._getManipulatorInfoFromHandle(n);null!=t&&r.push(t)}r.length&&this._removeVertices(r)}_computeVertexManipulatorSizeAndOutline(t){const e=t.size/2,i=e+t.collisionPadding;return{size:e/i,outlineSize:(e+t.outlineSize)/i}}_createVertexOrEdgeManipulator(t,e=(0,elevationInfoUtils.CI)(this.graphic),i=!1){const{view:a}=this,n=this._settings;if("edge"===t.type){if(this.enableEdgeOffset)return this._createEdgeOffsetManipulator(t,e);if(!this.enableMidpoints)return null}if(null==this._vertexManipulatorGeometry||null==this._vertexManipulatorOutlineGeometry){const{size:t,outlineSize:e}=this._computeVertexManipulatorSizeAndOutline(n.manipulators.vertex);this._vertexManipulatorGeometry=(0,GeometryUtil.R1)(this._vertexManipulatorMaterial,t,16,16),this._vertexManipulatorOutlineGeometry=(0,GeometryUtil.R1)(this._vertexManipulatorOutlineMaterial,e,16,16)}if(null==this._edgeManipulatorGeometry||null==this._edgeManipulatorOutlineGeometry){const{size:t,outlineSize:e}=this._computeVertexManipulatorSizeAndOutline(n.manipulators.edge);this._edgeManipulatorGeometry=(0,GeometryUtil.R1)(this._edgeManipulatorMaterial,t,16,16),this._edgeManipulatorOutlineGeometry=(0,GeometryUtil.R1)(this._edgeManipulatorOutlineMaterial,e,16,16)}const{geometry:o}=this.graphic,s=o?.type,l="point"===s||"mesh"===s?[]:[new RenderObject_e(this._vertexManipulatorGeometry.instantiate(),Yt.Vertex|interactive_interfaces.Gu.Unselected),new RenderObject_e(this._vertexManipulatorOutlineGeometry.instantiate(),Yt.Vertex|interactive_interfaces.Gu.Unfocused|interactive_interfaces.Gu.Unselected),new RenderObject_e(this._vertexManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),Yt.Vertex|interactive_interfaces.Gu.Focused|interactive_interfaces.Gu.Unselected),new RenderObject_e(this._vertexManipulatorGeometry.instantiate({material:this._selectedManipulatorMaterial}),interactive_interfaces.Gu.Selected),new RenderObject_e(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorOutlineMaterial}),interactive_interfaces.Gu.Selected|interactive_interfaces.Gu.Unfocused),new RenderObject_e(this._vertexManipulatorOutlineGeometry.instantiate({material:this._selectedManipulatorHoverOutlineMaterial}),interactive_interfaces.Gu.Selected|interactive_interfaces.Gu.Focused)];this.enableMidpoints&&l.push(new RenderObject_e(this._edgeManipulatorGeometry.instantiate({material:this._vertexManipulatorMaterial}),Yt.Edge|interactive_interfaces.Gu.Focused|interactive_interfaces.Gu.Unselected),new RenderObject_e(this._edgeManipulatorOutlineGeometry.instantiate({material:this._vertexManipulatorHoverOutlineMaterial}),Yt.Edge|interactive_interfaces.Gu.Focused|interactive_interfaces.Gu.Unselected),new RenderObject_e(this._edgeManipulatorGeometry.instantiate(),Yt.Edge|interactive_interfaces.Gu.Unfocused|interactive_interfaces.Gu.Unselected),new RenderObject_e(this._edgeManipulatorOutlineGeometry.instantiate(),Yt.Edge|interactive_interfaces.Gu.Unfocused|interactive_interfaces.Gu.Unselected));const p=new Manipulator3D_$({view:a,renderObjects:l,elevationInfo:e,focusMultiplier:1,touchMultiplier:1,available:!(!this.graphic.visible||!this.graphic.layer?.visible),metadata:{deleting:!1}});p.selected=i,this._setTypeSpecificManipulatorSettings(p,t,e);const d="edge"===t.type?{manipulator:p,handle:t,locationUpdateHandle:null,type:"edge",selectedIndex:0}:{manipulator:p,handle:t,type:"vertex",selectedIndex:0};if(this._manipulatorInfos.push(d),this.manipulators.add(p),this._updateManipulatorPosition(d),"edge"===d.type){const t=[];for(const e of[d.handle.leftVertex,d.handle.rightVertex]){const i=this._getManipulatorInfoFromHandle(e);null!=i&&t.push(i.manipulator.events.on("location-update",(()=>this._updateManipulatorPosition(d))))}d.locationUpdateHandle=(0,handleUtils.Ip)(t),this._manipulatorHandles.add(d.locationUpdateHandle,p)}this._manipulatorHandles.add(this._watchAndUpdateGrabState(p,!0),p);const u=(0,dragEventPipeline.G4)(p,((t,i,a,n)=>{let o=null;const{snappingStep:r,cancelSnapping:s}=(0,SnappingDragPipelineStep.s)({predicate:()=>!this._isMultiVertexSelection(),snappingManager:this.tool.snappingManager,snappingContext:new SnappingContext.m({editGeometryOperations:this._editGeometryOperations,elevationInfo:e,pointer:n,excludeFeature:this.graphic,visualizer:new SnappingVisualizer3D_O}),updatingHandles:this._updatingHandles,useZ:!1});a=a.next((e=>(this._onDragCancel(!t.metadata.deleting,(()=>o=(0,maybe.oR)(o))),e))).next(s),i.next((t=>this._trackNumDragging(t))).next((t=>{if("start"===t.action&&(o=this._editGeometryOperations.createUndoGroup()),"edge"===d.type){const e=this._splitEdgeManipulator(d);return{...t,info:e,snapOrigin:e.handle.pos}}return{...t,info:d,snapOrigin:d.handle.pos}})).next((0,dragEventPipeline.ks)(this.view,t.elevationAlignedLocation)).next(dragEventPipeline3D_D(this.view,this.graphic,t.elevationAlignedLocation,t.location.spatialReference,this.graphic)).next((0,dragEventPipeline.o3)(this.view,e,this.graphic)).next(...r).next((0,dragEventPipeline.YL)()).next((e=>{this._perVertexManipulatorDragAction(e),"end"===e.action&&(o=(0,maybe.oR)(o)),this._updateTranslateVertexTooltip(t,MoveManipulation_c.XY,e)}))}));return this._manipulatorHandles.add([u,p.events.on("immediate-click",(t=>this._manipulatorClickCallback(t,d))),p.events.on("select-changed",(()=>{d.selectedIndex=++this._selectedIndex,this._updateMoveManipulationPosition()})),p.events.on("focus-changed",(({action:t})=>{"focus"===t&&"edge"!==d.type?this._updateTranslateVertexTooltip(p,MoveManipulation_c.XY):this._tooltip.clear()}))],p),this.emit("manipulators-changed"),d}_trackNumDragging(t){switch(t.action){case"start":this._numDragging++;break;case"end":this._numDragging--}return t}_onDragCancel(t=!0,e){switch(this._numDragging--,t&&(this.undo(),this.outputGeometry=null!=this._editGeometryOperations?this._editGeometryOperations.data.geometry:null),null!=this.tool.snappingManager&&this.tool.snappingManager.doneSnapping(),this._tooltip.clear(),this._reshapeEventState){case qt.NONE:break;case qt.MOVING:this.emit("move",{type:"move",dx:0,dy:0,mover:this.graphic});break;case qt.RESHAPING:this.emit("reshape",{type:"reshape",mover:this.graphic})}e&&e(),this.destroyed||this._updateEventState(qt.NONE)}_setTypeSpecificManipulatorSettings(t,e,i){const{graphic:a}=this,n=this._settings;switch(e.type){case"vertex":{t.state=Yt.Vertex,t.selectable=!0,t.cursor="move",t.collisionPriority=2;const{size:e,collisionPadding:o}=n.manipulators.vertex;t.radius=e/2+o,t.elevationInfo=i;const{geometry:r}=a,s=r?.type;t.interactive=null!=s&&"point"!==s&&"mesh"!==s;break}case"edge":{t.state=Yt.Edge,t.selectable=!1,t.cursor="copy",t.collisionPriority=-1;const{size:e,collisionPadding:o}=n.manipulators.edge;t.radius=e/2+o,t.elevationInfo="on-the-ground"!==i.mode||(0,utils.IX)(a.symbol)?{mode:"absolute-height",offset:0}:i;break}}}_watchAndUpdateGrabState(t,e){return t.events.on("grab-changed",(i=>this._onGrabStateChanged(t,e,i.action,i.pointerType)))}_onGrabStateChanged(t,e,i,a="mouse"){if(!this._recreatingManipulators){if("start"===i)e&&this._updateSelection(t),this._numGrabbing++;else if(this._numGrabbing--,this._updateEventState(qt.NONE),this.destroyed)return;this._moveManipulation.interactive=!this._numGrabbing,("touch"!==a||this.enableEdgeOffset)&&(this._manipulatorInfos.forEach((t=>{const{manipulator:e}=t,{geometry:i}=this.graphic,a=i?.type;e.interactive=e.grabbing||!this._numGrabbing&&null!=a&&"point"!==a&&"mesh"!==a,"edgeManipulator"in t&&(t.edgeManipulator.interactive=t.edgeManipulator.grabbing||!this._numGrabbing)})),this._graphicMoveManipulation.forEachManipulator((t=>{t.interactive=t.grabbing||!this._numGrabbing})))}}_clearSelection(){for(const t of this._manipulatorInfos)t.manipulator.grabbing||(t.manipulator.selected=!1)}_updateSelection(t){t.grabbing&&!t.selected&&t.selectable&&(this._clearSelection(),t.selected=!0,this.emit("manipulators-changed"))}_removeManipulator(t){null!=t&&(t.manipulator.metadata.deleting=!0,this.manipulators.remove(t.manipulator),this._manipulatorHandles.remove(t.manipulator),(0,arrayUtils.sH)(this._manipulatorInfos,t),this.emit("manipulators-changed"))}_getManipulatorInfoFromHandle(t){if(t)for(const e of this._manipulatorInfos)if(t===e.handle)return e;return null}_updateManipulatorPosition(t){if(null==t)return;const e=this._editGeometryOperations;if("vertex"===t.type)t.manipulator.location=e.data.coordinateHelper.vectorToDehydratedPoint(t.handle.pos,zt),t.manipulator.grabbing&&null!=this._vertexLaserLineVisualElement&&(this._vertexLaserLineVisualElement.visualElement.intersectsWorldUpAtLocation=t.manipulator.renderLocation);else if("edge"===t.type){const i=this._getManipulatorInfoFromHandle(t.handle.leftVertex),a=this._getManipulatorInfoFromHandle(t.handle.rightVertex);if(null==i||null==a)return;const n=i.manipulator,o=a.manipulator;if(null!=t.manipulator.elevationInfo&&"on-the-ground"===t.manipulator.elevationInfo.mode){const i=n.location,a=o.location,r=.5,s=i.x+r*(a.x-i.x),l=i.y+r*(a.y-i.y),p=i.hasZ&&a.hasZ?0:void 0;t.manipulator.location=(0,dehydratedPoint.A)(s,l,p,e.data.spatialReference)}else(0,vec3.p)(Xt,n.renderLocation,o.renderLocation,.5),t.manipulator.renderLocation=Xt}}_splitEdgeManipulator(t,e=.5){const i=this._editGeometryOperations,a=i.splitEdge(t.handle,e).createdVertex;t.locationUpdateHandle=(0,maybe.oR)(t.locationUpdateHandle);const n=(0,elevationInfoUtils.CI)(this.graphic);let o;this.enableEdgeOffset?(this._removeManipulator(t),o=this._createVertexOrEdgeManipulator(a)):(o=t,o.handle=a,o.type="vertex",this._setTypeSpecificManipulatorSettings(t.manipulator,t.handle,n)),a.leftEdge&&this._createVertexOrEdgeManipulator(a.leftEdge),a.rightEdge&&this._createVertexOrEdgeManipulator(a.rightEdge),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(o),this.enableEdgeOffset||this._updateTranslateVertexTooltip(o.manipulator,MoveManipulation_c.XY),this._updateSelection(t.manipulator);const r=this._updateEventState(qt.RESHAPING),s=i.data.coordinateHelper.vectorToArray(o.handle.pos),l=i.data.components.indexOf(a.component);return this.emit("vertex-add",{type:"vertex-add",vertices:[{coordinates:s,componentIndex:l,vertexIndex:a.index}],added:s}),r&&this._updateEventState(qt.NONE),o}_updateMoveManipulationPosition(){const t=(0,vec3.s)(Xt,0,0,0);let e=0,i=!1,a=null,n=null;for(const o of this._manipulatorInfos)"vertex"===o.type&&(o.manipulator.selected?(e++,(0,vec3.g)(t,t,o.manipulator.renderLocation),null==a||o.selectedIndex>a.selectedIndex?(n=a,a=o):(null==n||o.selectedIndex>n.selectedIndex)&&(n=o)):i=!0);if(0===e){const t=this._graphicState.displaying&&this.enableMoveGraphic;this._moveManipulation.xyManipulation.available=t,this._moveManipulation.xyAxisManipulation.available=t,this._moveManipulation.xyAxisManipulation.orthogonalAvailable=t,this._moveManipulation.zManipulation.available=t&&this.enableZShape&&manipulatorUtils_n(this.graphic),this._moveManipulation.angle=geometryUtils_r(this.graphic.geometry),this._moveManipulation.radius=MoveManipulation_u.radiusForSymbol(this.graphic.symbol)}else{const t=this._graphicState.displaying;this._moveManipulation.xyManipulation.available=t,this._moveManipulation.xyAxisManipulation.available=t,this._moveManipulation.zManipulation.available=t&&this.enableZVertex&&manipulatorUtils_n(this.graphic),this._moveManipulation.xyAxisManipulation.orthogonalAvailable=t&&1!==e;let i=0;if(null!=a){const t=a.handle.pos,e=null!=n?n.handle.pos:a.handle.leftEdge&&a.handle.leftEdge.leftVertex?a.handle.leftEdge.leftVertex.pos:null,o=null==n&&a.handle.rightEdge&&a.handle.rightEdge.rightVertex?a.handle.rightEdge.rightVertex.pos:null;e&&o?this._moveManipulation.xyAxisManipulation.available=!1:e?i=Rt(e,t):o&&(i=Rt(t,o))}this._moveManipulation.angle=i,this._moveManipulation.radius=config_o}0!==e&&i?((0,vec3.i)(t,t,1/e),zt.spatialReference=this._editGeometryOperations.data.spatialReference,zt.hasZ=!0,this.view.renderCoordsHelper.fromRenderCoords(t,zt),this._moveManipulation.elevationAlignedLocation=zt):null==this._outlineVisualElement||this._graphicState.isDraped||null==this._outlineVisualElement.attachmentOrigin?manipulatorUtils_v(this.view,this._moveManipulation,this.graphic):this._moveManipulation.elevationAlignedLocation=this._outlineVisualElement.attachmentOrigin}_removeVertices(t){const e=new Array,i=this._editGeometryOperations;for(const a of t)if("vertex"===a.type&&i.canRemoveVertex(a.handle.component)){e.push(a.handle),this._removeManipulator(a),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.leftEdge)),this._removeManipulator(this._getManipulatorInfoFromHandle(a.handle.rightEdge));const t=i.removeVertices([a.handle]),n=t.removedVertices?.[0].createdEdge;n&&this._createVertexOrEdgeManipulator(n)}if(e.length>0){const t=e.map((t=>{const e=i.data.components.indexOf(t.component);return{coordinates:i.data.coordinateHelper.vectorToArray(t.pos),componentIndex:e,vertexIndex:t.index}}));this.outputGeometry=i.data.geometry;const a=this._updateEventState(qt.RESHAPING);if(this.destroyed)return;if(this.emit("vertex-remove",{type:"vertex-remove",removed:t.map((t=>t.coordinates)),vertices:t}),this.destroyed)return;if(a&&(this._updateEventState(qt.NONE),this.destroyed))return;this._updateMoveManipulationPosition()}}_moveVertices(t,e,i=("start"===e.action?editGeometry_interfaces.M.NEW_STEP:editGeometry_interfaces.M.ACCUMULATE_STEPS)){const a=this._editGeometryOperations;a.moveVertices(t.map((t=>t.handle)),e.mapDeltaX,e.mapDeltaY,e.mapDeltaZ,i),this.outputGeometry=a.data.geometry;for(const n of t)this._updateManipulatorPosition(n)}_offsetEdge(t,e){if(null==e.operation||null==e.signedDistance)return;const i=this._editGeometryOperations,a=e.operation.clone();a.distance=e.signedDistance,i.updateVertices([t.handle.leftVertex,t.handle.rightVertex],a),this.outputGeometry=i.data.geometry,this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(t.handle.leftVertex)),this._updateManipulatorPosition(this._getManipulatorInfoFromHandle(t.handle.rightVertex))}_manipulatorClickCallback(t,e){t.shiftKey||this._clearSelection(),"vertex"===e.type&&(e.manipulator.selected=!e.manipulator.selected,t.button===IViewEvents.O.Right&&this._removeVertices([e])),"edge"===e.type&&t.button===IViewEvents.O.Left&&this._splitEdgeManipulator(e),t.stopPropagation()}_updateTranslateTooltip(t,e){const i=this._manipulatorInfos.filter((t=>"vertex"===t.type&&t.manipulator.selected));1===i.length?this._updateTranslateVertexTooltip(i[0].manipulator,t,e):this._updateTranslateGraphicTooltip(t,e)}_updateTranslateGraphicTooltip(t,e){const{_tooltipOptions:i,_tooltip:a}=this;if(!i.enabled)return;const n=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(t){case MoveManipulation_c.XY:a.info=this._translateGraphicTooltipInfo??=new TranslateTooltipInfos.qC({tooltipOptions:i}),this._updateTranslateTooltipDistance(a.info,e,((t,e)=>(0,automaticLengthMeasurementUtils.ik)(t,e,n)));break;case MoveManipulation_c.XY_AXIS:a.info=this._translateGraphicXYTooltipInfo??=new TranslateTooltipInfos.j1({tooltipOptions:i}),this._updateTranslateTooltipDistance(a.info,e,((t,i)=>{const a=(0,automaticLengthMeasurementUtils.ik)(t,i,n);return(0,quantityUtils.aU)(a,moveUtils_a(e))}));break;case MoveManipulation_c.Z:a.info=this._translateGraphicZTooltipInfo??=new TranslateTooltipInfos.MH({tooltipOptions:i}),this._updateTranslateTooltipDistance(a.info,e,euclideanLengthMeasurementUtils.Mb)}a.info.tooltipOptions=i}_updateTranslateVertexTooltip(t,e,i){const{_tooltipOptions:a,_tooltip:n}=this;if(!a.enabled)return;const o=this._graphicState.isDraped?"on-the-ground":"absolute-height";switch(e){case MoveManipulation_c.XY:n.info=this._translateVertexTooltipInfo??=new TranslateTooltipInfos.uU({tooltipOptions:a}),this._updateTranslateTooltipDistance(n.info,i,((t,e)=>(0,automaticLengthMeasurementUtils.ik)(t,e,o))),this._updateTooltipAreaOrTotalLength(n.info);break;case MoveManipulation_c.XY_AXIS:n.info=this._translateVertexXYTooltipInfo??=new TranslateTooltipInfos.I$({tooltipOptions:a}),this._updateTranslateTooltipDistance(n.info,i,((t,e)=>{const a=(0,automaticLengthMeasurementUtils.ik)(t,e,o);return(0,quantityUtils.aU)(a,moveUtils_a(i))})),this._updateTooltipAreaOrTotalLength(n.info);break;case MoveManipulation_c.Z:n.info=this._translateVertexZTooltipInfo??=new TranslateTooltipInfos.Oq({tooltipOptions:a}),this._updateTranslateTooltipDistance(n.info,i,euclideanLengthMeasurementUtils.Mb)}const r=(0,euclideanLengthMeasurementUtils.GK)(t.elevationAlignedLocation);null!=r&&(n.info.elevation=(0,fields.mm)({actual:r})),n.info.tooltipOptions=a}_updateTranslateTooltipDistance(t,e,i){if(null!=e&&"end"!==e.action){const{mapStart:a,mapEnd:n}=e,o=i(a,n);t.distance=null!=o?o:quantityUtils.U7}else t.distance=quantityUtils.U7}_updateTooltipAreaOrTotalLength(t){const{geometry:e}=this.graphic;if(null==e)return t.area=null,void(t.totalLength=null);const i=this._graphicState.isDraped?"on-the-ground":"absolute-height";t.area="polygon"===e.type?(0,automaticAreaMeasurementUtils.m)(e,i):null,t.totalLength="polyline"===e.type?(0,automaticLengthMeasurementUtils.M1)(e,i):null}get test(){return{segmentLabels:this._segmentLabels,tooltip:this._tooltip}}};function Rt(t,e){return Math.atan2(e[1]-t[1],e[0]-t[0])+Math.PI/2}(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"_editGeometryOperations",void 0),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"_segmentLabels",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],kt.prototype,"tool",void 0),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"_tooltip",void 0),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"inputGeometry",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"outputGeometry",void 0),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],kt.prototype,"updating",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"manipulators",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"view",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"graphic",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"enableZShape",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"enableZVertex",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"enableMoveGraphic",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"enableMidpoints",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"enableEdgeOffset",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"_labelOptions",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"_tooltipOptions",null),(0,tslib_es6._)([(0,property.qq)()],kt.prototype,"_accentColor",null),kt=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.editingTools.reshapeGraphic.ReshapeOperation")],kt);const zt=(0,dehydratedPoint.A)(0,0,void 0,SpatialReference.c.WGS84),Xt=(0,vec3f64.c)(),Zt=1e-6;var Yt,qt,Wt;!function(t){t.Vertex=interactive_interfaces.Yp.Custom1,t.Edge=interactive_interfaces.Yp.Custom2}(Yt||(Yt={})),function(t){t[t.NONE=0]="NONE",t[t.MOVING=1]="MOVING",t[t.RESHAPING=2]="RESHAPING"}(qt||(qt={})),function(t){t[t.ALL=0]="ALL",t[t.SELECTED_OR_ALL=1]="SELECTED_OR_ALL"}(Wt||(Wt={}));var SketchLabelOptions=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/SketchLabelOptions.js");let GraphicReshapeTool_u=class extends(Evented.c.EventedMixin(InteractiveToolBase.g)){constructor(e){super(e),this._internalGeometryUpdate=!1,this.enableZShape=!0,this.enableZVertex=!0,this.enableMoveGraphic=!0,this.enableMidpoints=!0,this.enableEdgeOffset=!1,this.type="reshape-3d",this.labelOptions=new SketchLabelOptions.c,this.tooltipOptions=new SketchTooltipOptions.c,this.snappingManager=null,this.automaticManipulatorSelection=!1}initialize(){const e=this._reshapeOperation=new kt({tool:this});this.addHandles([e.on("reshape",(e=>{"reshape"===e.type&&this._onReshapeGeometryChanged(),this.emit("reshape",e)})),e.on("move",(e=>{"move"===e.type&&this._onReshapeGeometryChanged(),this.emit("move",e)})),e.on("vertex-add",(e=>{this._onReshapeGeometryChanged(),this.emit("vertex-add",e)})),e.on("vertex-remove",(e=>{this._onReshapeGeometryChanged(),this.emit("vertex-remove",e)})),e.on("immediate-click",(e=>this.emit("immediate-click",e))),this.view.on("pointer-down",["Shift"],(e=>e.stopPropagation())),(0,reactiveUtils.aE)((()=>this.graphic),(()=>this._updateGraphic()),reactiveUtils.KG)]),this.finishToolCreation()}destroy(){this._reshapeOperation=(0,maybe.mG)(this._reshapeOperation)}get updating(){return this._reshapeOperation?.updating??!1}_updateGeometry(){const e=(0,reshapeGraphic_isSupportedGraphic.I)(this.graphic);this._reshapeOperation.inputGeometry=null!=e?e.clone():null}_updateGraphic(){if(this.removeHandles("onGraphicGeometryChange"),this._updateGeometry(),(0,reshapeGraphic_isSupportedGraphic.s)(this.graphic)!==isSupportedGraphicUtils.g.SUPPORTED)return;const e=(0,reactiveUtils.aE)((()=>this.graphic?.geometry),(()=>{!1===this._internalGeometryUpdate&&this._updateGeometry()}),reactiveUtils.du);this.addHandles(e,"onGraphicGeometryChange")}onManipulatorSelectionChanged(){this._reshapeOperation&&this._reshapeOperation.onManipulatorSelectionChanged()}_updateGeometryInternally(e){this._internalGeometryUpdate=!0;const{graphic:t}=this,{geometry:o}=t;"mesh"===o?.type&&"point"===e.type?(t.geometry=o.centerAt(e),t.notifyGeometryChanged()):t.geometry=e,this._internalGeometryUpdate=!1}_onReshapeGeometryChanged(){const{outputGeometry:e}=this._reshapeOperation;null!=this.graphic&&e&&this._updateGeometryInternally(e.clone())}get canUndo(){return this._reshapeOperation.canUndo??!1}undo(){null!=this.snappingManager&&this.snappingManager.doneSnapping();const e=this._reshapeOperation.undo(),{outputGeometry:t}=this._reshapeOperation;e&&t&&this._updateGeometryInternally(t.clone())}get canRedo(){return this._reshapeOperation.canRedo??!1}redo(){null!=this.snappingManager&&this.snappingManager.doneSnapping();const e=this._reshapeOperation.redo(),{outputGeometry:t}=this._reshapeOperation;e&&t&&this._updateGeometryInternally(t.clone())}onInputEvent(e){"key-down"!==e.type||"Delete"!==e.key&&"Backspace"!==e.key||this._reshapeOperation.removeSelectedVertices()}reset(){}get test(){return{snappingManager:this.snappingManager,reshapeOperation:this._reshapeOperation}}};(0,tslib_es6._)([(0,property.qq)()],GraphicReshapeTool_u.prototype,"_reshapeOperation",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"view",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],GraphicReshapeTool_u.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"enableZShape",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"enableZVertex",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"enableMoveGraphic",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"enableMidpoints",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicReshapeTool_u.prototype,"enableEdgeOffset",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicReshapeTool_u.prototype,"type",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,type:SketchLabelOptions.c})],GraphicReshapeTool_u.prototype,"labelOptions",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,type:SketchTooltipOptions.c})],GraphicReshapeTool_u.prototype,"tooltipOptions",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],GraphicReshapeTool_u.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicReshapeTool_u.prototype,"updating",null),(0,tslib_es6._)([(0,property.qq)()],GraphicReshapeTool_u.prototype,"automaticManipulatorSelection",void 0),GraphicReshapeTool_u=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.editingTools.graphicReshape3D.GraphicReshapeTool")],GraphicReshapeTool_u);var Cyclical=__webpack_require__("./node_modules/@arcgis/core/core/Cyclical.js"),scheduling=__webpack_require__("./node_modules/@arcgis/core/core/scheduling.js");let TransformTooltipInfos_r=class extends SketchTooltipInfo.Q{constructor(o){super(o),this.type="transform-rotate",this.rotation=null,this.rotationPrecision=null,this.orientation=null,this.orientationPrecision=null,this.rotationType="geographic"}};(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_r.prototype,"type",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_r.prototype,"rotation",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_r.prototype,"rotationPrecision",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_r.prototype,"orientation",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_r.prototype,"orientationPrecision",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_r.prototype,"rotationType",void 0),TransformTooltipInfos_r=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive.tooltip.TransformRotateTooltipInfo")],TransformTooltipInfos_r);let TransformTooltipInfos_s=class extends SketchTooltipInfo.Q{constructor(o){super(o),this.type="transform-scale",this.size=null,this.sizeUnit=null,this.sizePrecision=null}};(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_s.prototype,"type",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_s.prototype,"scale",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_s.prototype,"size",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_s.prototype,"sizeUnit",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_s.prototype,"sizePrecision",void 0),TransformTooltipInfos_s=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive.tooltip.TransformScaleTooltipInfo")],TransformTooltipInfos_s);let TransformTooltipInfos_p=class extends SketchTooltipInfo.Q{constructor(o){super(o),this.type="transform-absolute",this.orientation=null,this.orientationPrecision=null,this.rotationType="geographic",this.size=null,this.sizePrecision=null,this.sizeUnit=null}};var yt;(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_p.prototype,"type",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_p.prototype,"orientation",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_p.prototype,"orientationPrecision",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_p.prototype,"rotationType",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_p.prototype,"size",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_p.prototype,"sizePrecision",void 0),(0,tslib_es6._)([(0,property.qq)()],TransformTooltipInfos_p.prototype,"sizeUnit",void 0),TransformTooltipInfos_p=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive.tooltip.TransformAbsoluteTooltipInfo")],TransformTooltipInfos_p),function(t){t.ScaleIn=interactive_interfaces.Yp.Custom2,t.ScaleOut=interactive_interfaces.Yp.Custom3,t.RotateLeft=interactive_interfaces.Yp.Custom4,t.RotateRight=interactive_interfaces.Yp.Custom5,t.Unlocked=interactive_interfaces.Yp.Custom7,t.DelayedFocused=interactive_interfaces.Yp.Custom8,t.TouchInput=interactive_interfaces.Yp.Custom12}(yt||(yt={}));let Tt=class extends Accessor.c{get angle(){return this.adapter.angle}get scale(){return this.adapter.scale}set location(t){this._ringManipulator.location=t}set elevationAlignedLocation(t){this._ringManipulator.elevationAlignedLocation=t}get grabbing(){return this._ringManipulator.grabbing}set interactive(t){this._ringManipulator.interactive=t}get updating(){return!!this._activeAnimation}constructor(t){super(t),this.mode=null,this._scaleRotateDragData=null,this._activeAnimation=null,this._ringIndicatorDelayMs=200,this._absoluteTooltipInfo=null,this._scaleTooltipInfo=null,this._rotateTooltipInfo=null,this.events=new Evented.c,this.getFocused=()=>this._ringManipulator.focused,this.getScale=()=>"scale"===this._scaleRotateDragData?.mode?this.adapter.scale:1}initialize(){this._tooltip=new Tooltip.o({view:this.tool.view}),this._createManipulator(),this._updateDragState(),this._updateManipulatorTransform(),this.addHandles([(0,reactiveUtils._I)((()=>!this.tooltipOptions.enabled),(()=>this._tooltip.clear()),reactiveUtils._8),(0,reactiveUtils.aE)((()=>{const{adapter:t}=this,{info:e}=this._tooltip;return e===this._absoluteTooltipInfo&&this.getFocused()?[e,t.size,t.orientationClockwise]:[null]}),(([t])=>{t&&this._updateFocusTooltip()}))])}destroy(){this._activeAnimation?.frameTask.remove(),this._activeAnimation=null,this.tool.manipulators.remove(this._ringManipulator),this._ringManipulator=null,this._tooltip=(0,maybe.mG)(this._tooltip)}startAnimation(t){this.cancelActiveAnimation(),t.start();const e=(0,scheduling.M3)({update:({deltaTime:e})=>{t.update(e)&&this.cancelActiveAnimation()}});this._activeAnimation={...t,frameTask:e}}cancelActiveAnimation(){this._activeAnimation?.frameTask.remove(),this._activeAnimation=(0,maybe.mG)(this._activeAnimation)}forEachManipulator(t){t(this._ringManipulator,ManipulatorType_A.SCALE_ROTATE)}_createManipulator(){const t=this._createRingManipulator();this._ringManipulator=t,this.tool.manipulators.add(t);const e=this.tool.graphicState.graphic,a=(0,dragEventPipeline.G4)(t,((t,a,o)=>{this._scaleRotateDragData=null;const n=this.adapter.startInteraction(),l={mode:"none",origin:(0,vec3f64.g)(t.renderLocation),initialAngle:this.adapter.angle,angle:0,angleDir:0,scaleDir:0};this._scaleRotateDragData=l,this._updateDragState();const c=vectorStacks.Wq.get();this.tool.view.renderCoordsHelper.worldUpAtPosition(t.renderLocation,c),a.next(dragEventPipeline3D_H(this.tool.view,(0,plane.aY)(t.renderLocation,c,(0,plane.Su)()))).next((t=>{const a=(0,plane.i4)(t.plane),o=manipulatorUtils_F(t.renderStart,t.renderEnd,l.origin,a),c=Cyclical.oH.shortestSignedDiff(l.angle,o);l.angleDir=(0,mathUtils.qk)(l.angleDir+c,-.3,.3),l.angle=o;const p=function bt(t,e){const a=(0,vec3.f)(vectorStacks.Wq.get(),e.renderStart,t.origin),i=(0,vec3.f)(vectorStacks.Wq.get(),e.renderEnd,t.origin),o=(0,vec3.l)(a),s=(0,vec3.l)(i);return 0===o?0:s/o}(l,t),h=p-this.adapter.scale;if(l.scaleDir=(0,mathUtils.qk)(l.scaleDir+h,-.2,.2),this._onScaleChanged(),"none"===l.mode){const a=this.mode||function wt(t,e,a,i){const{renderStart:o,renderEnd:s}=t,r=jt(o,i,vectorStacks.Wq.get()),n=jt(s,i,vectorStacks.Wq.get());if((0,vec3.a)(r,n)<100)return null;const l=(0,vec3.f)(vectorStacks.Wq.get(),o,a),c=(0,vec3.b)(vectorStacks.Wq.get(),l,(0,plane.i4)(e)),p=o,h=(0,vec3.g)(vectorStacks.Wq.get(),p,c),u=jt(a,i,vectorStacks.Wq.get()),d=r,g=jt(h,i,vectorStacks.Wq.get()),m=(0,vec3.f)(vectorStacks.Wq.get(),g,d),f=(0,vec3.f)(vectorStacks.Wq.get(),r,u),_=(0,ray.em)(d,m),D=(0,ray.em)(u,f);return(0,ray.Ed)(_,n)<(0,ray.Ed)(D,n)?"rotate":"scale"}(t,t.plane,l.origin,this.tool.view.state.camera);if(null!=a){switch(a){case"rotate":this.tool.emit("graphic-rotate-start",{graphic:e,angle:0}),this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()});break;case"scale":this.tool.emit("graphic-scale-start",{graphic:e,xScale:1,yScale:1}),this.tool.emit("record-undo",{record:this.adapter.createUndoRecord()})}l.mode=a}}switch(l.mode){case"rotate":n.state.angle=l.initialAngle+o;break;case"scale":n.state.scale=p,this._onScaleChanged()}switch(this._updateDragState(),this._updateManipulatorTransform(),t.action){case"start":case"update":switch(l.mode){case"rotate":this.tool.emit("graphic-rotate",{graphic:e,angle:(0,mathUtils.UB)(l.angle)});break;case"scale":this.tool.emit("graphic-scale",{graphic:e,xScale:p,yScale:p})}break;case"end":switch(l.mode){case"rotate":this.tool.emit("graphic-rotate-stop",{graphic:e,angle:(0,mathUtils.UB)(l.angle)});break;case"scale":this.tool.emit("graphic-scale-stop",{graphic:e,xScale:p,yScale:p})}}return"end"===t.action&&(this.startAnimation(It(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState(),n.done()),t})).next(this._updateTooltipPipelineStep(l)),o.next((()=>{if(n.cancel(),null!=this._scaleRotateDragData){switch(this._scaleRotateDragData.mode){case"none":break;case"rotate":this.tool.emit("graphic-rotate-stop",{graphic:e,angle:0});break;case"scale":this.tool.emit("graphic-scale-stop",{graphic:e,xScale:1,yScale:1})}this.startAnimation(It(this,(()=>this._onScaleChanged()))),this._scaleRotateDragData=null,this._updateDragState()}this._updateFocusTooltip()}))}));this.addHandles([a,t.events.on("focus-changed",(t=>{"focus"===t.action?this.startAnimation(function Ot(t,e,a){let i=0,o=null;const s=()=>!1;return{start:()=>{o=t.getFocused,t.getFocused=s,i=0,e()},update:t=>(i+=t,!o?.()||i>=a.delayMs?GraphicScaleRotateTransform_Rt.STOP:GraphicScaleRotateTransform_Rt.CONTINUE),destroy:()=>{o&&(t.getFocused=o),e()}}}(this,(()=>this._updateDelayedFocusedState()),{delayMs:this._ringIndicatorDelayMs})):this._updateDelayedFocusedState()})),t.events.on("immediate-click",(t=>{t.stopPropagation()})),(0,reactiveUtils.aE)((()=>this.tool.graphicState?.displaying),(t=>this._ringManipulator.available=t),reactiveUtils._8)])}_updateTooltipPipelineStep(t){return e=>{const a=this.tooltipOptions;if(!a.enabled)return e;if("end"===e.action)return this._updateFocusTooltip(),e;const i=this._tooltip,o=this.tooltipOptions.visualVariables;switch(t.mode){case"scale":{i.info=this._scaleTooltipInfo??=new TransformTooltipInfos_s({tooltipOptions:a});const{size:t,scale:e}=this.adapter,s=o?.size,r=i.info;r.tooltipOptions=a,r.scale={value:e},r.size=null!=t?(0,quantityUtils.Mz)(t,"meters"):void 0,r.sizePrecision=GraphicScaleRotateTransform_kt(s?.valueType),r.sizeUnit=s?.unit;break}case"rotate":{i.info=this._rotateTooltipInfo??=new TransformTooltipInfos_r({tooltipOptions:a});const{orientationClockwise:t,relativeAngleClockwise:e}=this.adapter,s=o?.rotation,r=GraphicScaleRotateTransform_kt(s?.valueType),n=i.info;n.tooltipOptions=a,n.rotation=null!=e?(0,quantityUtils.iU)(e,"radians","geographic"):void 0,n.rotationPrecision=r,n.rotationType=s?.rotationType??"geographic",n.orientation=null!=t?(0,quantityUtils.iU)(t,"radians","geographic"):void 0,n.orientationPrecision=r;break}}return e}}_updateFocusTooltip(){const{tooltipOptions:t,_tooltip:e}=this;if(t.enabled)if(this.getFocused()){const a=t.visualVariables,i=a?.rotation,o=a?.size,s=this.mode,{size:r,orientationClockwise:n}=this.adapter,p=null!=n&&(null==s||"rotate"===s),h=null!=r&&(null==s||"scale"===s);e.info=this._absoluteTooltipInfo??=new TransformTooltipInfos_p({tooltipOptions:t});const u=e.info;u.tooltipOptions=t,u.orientation=p?(0,quantityUtils.iU)(n,"radians","geographic"):void 0,u.orientationPrecision=GraphicScaleRotateTransform_kt(i?.valueType),u.rotationType=i?.rotationType??"geographic",u.size=h?(0,quantityUtils.Mz)(r,"meters"):void 0,u.sizeUnit=o?.unit,u.sizePrecision=GraphicScaleRotateTransform_kt(o?.valueType)}else e.clear()}_onScaleChanged(){this.events.emit("scale-changed"),this._updateManipulatorTransform()}_updateDelayedFocusedState(){this._ringManipulator.updateStateEnabled(yt.DelayedFocused,this.getFocused()),this._updateFocusTooltip()}_updateDragState(){if(this._ringManipulator.updateStateEnabled(yt.Unlocked,!(null!=this._scaleRotateDragData&&"none"!==this._scaleRotateDragData?.mode)),null!=this._scaleRotateDragData)switch(this._scaleRotateDragData.mode){case"rotate":this._ringManipulator.updateStateEnabled(yt.ScaleIn|yt.ScaleOut,!1),this._ringManipulator.updateStateEnabled(yt.RotateLeft,this._scaleRotateDragData.angleDir<0),this._ringManipulator.updateStateEnabled(yt.RotateRight,this._scaleRotateDragData.angleDir>=0);break;case"scale":this._ringManipulator.updateStateEnabled(yt.RotateLeft|yt.RotateRight,!1),this._ringManipulator.updateStateEnabled(yt.ScaleIn,this._scaleRotateDragData.scaleDir<0),this._ringManipulator.updateStateEnabled(yt.ScaleOut,this._scaleRotateDragData.scaleDir>=0)}else this._ringManipulator.updateStateEnabled(yt.ScaleIn|yt.ScaleOut|yt.RotateLeft|yt.RotateRight,!1)}_updateManipulatorTransform(){const t=(0,mat4.c)(vectorStacks.SW.get(),this.adapter.angle,(0,vec3f64.f)(0,0,1));if(null==t)return;const e=this.getScale(),a=(0,mat4.E)(vectorStacks.SW.get(),(0,vec3.s)(vectorStacks.Wq.get(),e,e,e));this._ringManipulator.modelTransform=(0,mat4.m)(vectorStacks.SW.get(),a,t)}_createRingManipulator(){const t=(t,e,a)=>{const i=[],o=Math.ceil(128*(e-t)/(2*Math.PI));for(let s=0;s<o+1;s++){const r=t+s*(e-t)/o;i.push((0,vec3f64.f)(a*Math.cos(r),a*Math.sin(r),0))}return i},e=e=>t(0,2*Math.PI,e),i=this._createMaterial(1),o=(t,e,o=i)=>(0,GeometryUtil.Sg)(o,(t=>[[-t/2,0],[t/2,0],[t/2,.25],[-t/2,.25]])(e),t,[],[],!1),s=e(160),r=o(s,24),n={left:new Array,right:new Array},l=[];for(let j=0;j<2;j++){const e=j*Math.PI-Math.PI/4,a=Math.PI/2-config_x,s=e+a,r=e+Math.PI/2-a,c=t(s,r,190),p=o(c,9);l.push(c),l.push(t(s,r,201)),n.left.push(p),n.right.push(p.instantiate());for(let t=0;t<2;t++){const e=0===t,a=(0,mat4f64.a)();if(e){(0,mat4.b)(a,a,[1,-1,1]),(0,mat4.k)(a,a,-s,[0,0,1]);const t=Math.round(.2*(c.length-1));a[12]=c[t][0],a[13]=c[t][1],a[14]=c[t][2]}else{(0,mat4.k)(a,a,r,[0,0,1]);const t=Math.round(.8*(c.length-1));a[12]=c[t][0],a[13]=c[t][1],a[14]=c[t][2]}const o=(0,GeometryUtil.mm)(i,60,0,23,.5);(0,GeometryUtil.UF)(o,a),(e?n.left:n.right).push(o)}}const c=[];for(let v=0;v<2;v++){const e=v*Math.PI-Math.PI/4,a=Math.PI/2-config_b,i=e+a,s=e+Math.PI/2-a,r=t(i,s,213);c.push(o(r,9))}const p=this._createMaterial(.66),h=this._createMaterial(.5),u=this._createMaterial(.33),d=e(190),g=e(213),m=o(d,9,p),f=o(g,9,u),_=e(130),D=e(107),S=o(_,9,p),T=o(D,9,u);let b=[new RenderObject_e(r,yt.DelayedFocused),new RenderObject_e(r.instantiate({material:h}),interactive_interfaces.Gu.None)];this.mode&&"scale"!==this.mode||(b=b.concat([...c.map((t=>new RenderObject_e(t,yt.DelayedFocused|yt.Unlocked))),new RenderObject_e(m,yt.DelayedFocused|yt.ScaleIn),new RenderObject_e(f,yt.DelayedFocused|yt.ScaleIn),new RenderObject_e(S,yt.DelayedFocused|yt.ScaleOut),new RenderObject_e(T,yt.DelayedFocused|yt.ScaleOut)])),this.mode&&"rotate"!==this.mode||(b=b.concat([...n.right.map((t=>new RenderObject_e(t.instantiate(),yt.DelayedFocused|yt.Unlocked))),...n.left.map((t=>new RenderObject_e(t,yt.DelayedFocused|yt.RotateLeft))),...n.right.map((t=>new RenderObject_e(t,yt.DelayedFocused|yt.RotateRight)))]));const w=[s,...l];return new Manipulator3D_$({view:this.tool.view,renderObjects:b,autoScaleRenderObjects:!1,worldOriented:!0,radius:24,focusMultiplier:1,touchMultiplier:1.5,elevationInfo:(0,elevationInfoUtils.CI)(this.tool.graphicState.graphic),collisionType:{type:"ribbon",paths:w,direction:(0,vec3f64.f)(0,0,1)}})}_createMaterial(t){const e=new ColorMaterial.U({cullFace:basicInterfaces.CM.Back,renderOccluded:Material.C2.Transparent,isDecoration:!0});return this.addHandles((0,reactiveUtils.aE)((()=>({color:(0,colorUtils.m_)(this.tool.view.effectiveTheme.accentColor,t)})),(t=>e.setParameters(t)),reactiveUtils._8)),e}get test(){return{ringManipulator:this._ringManipulator,setRingIndicatorDelayMs:t=>this._ringIndicatorDelayMs=t,tooltip:this._tooltip}}};function jt(t,e,a){return e.projectToScreen(t,At),(0,vec3.s)(a,At[0],At[1],0)}var GraphicScaleRotateTransform_Rt;function It(t,e){let a=null,i=1;const o=()=>i;return{start:()=>{i=t.getScale(),a=t.getScale,t.getScale=o,e()},update:t=>(i+=((i+1)/2-i)*Math.min(3*t,1),e(),Math.abs(i-1)<.01?GraphicScaleRotateTransform_Rt.STOP:GraphicScaleRotateTransform_Rt.CONTINUE),destroy:()=>{a&&(t.getScale=a),e()}}}function GraphicScaleRotateTransform_kt(t){switch(t){case"integer":case"long":return 0;default:return null}}(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],Tt.prototype,"tool",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],Tt.prototype,"adapter",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],Tt.prototype,"tooltipOptions",void 0),(0,tslib_es6._)([(0,property.qq)()],Tt.prototype,"mode",void 0),(0,tslib_es6._)([(0,property.qq)()],Tt.prototype,"_activeAnimation",void 0),(0,tslib_es6._)([(0,property.qq)()],Tt.prototype,"updating",null),Tt=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.editingTools.transformGraphic.GraphicScaleRotateTransform")],Tt),function(t){t[t.CONTINUE=0]="CONTINUE",t[t.STOP=1]="STOP"}(GraphicScaleRotateTransform_Rt||(GraphicScaleRotateTransform_Rt={}));const At=(0,screenUtils.Yv)();var axisAngleDegrees=__webpack_require__("./node_modules/@arcgis/core/geometry/support/axisAngleDegrees.js"),MeshTransform=__webpack_require__("./node_modules/@arcgis/core/geometry/support/MeshTransform.js");function undoRecords_t(e){return null!=e.geometry&&"mesh"===e.geometry.type?function undoRecords_r(e){return e.vertexSpace.isRelative?function undoRecords_o(t,r,n){let o=r?.clone(),i=(0,vec3f64.g)(n.origin),u=null,s=null;return{undo:r=>{u=t.transform?.clone(),s=(0,vec3f64.g)(n.origin),t.transform=o,t.vertexSpace.origin=i,r.notifyMeshTransformChanged()},redo:r=>{o=t.transform?.clone(),i=(0,vec3f64.g)(n.origin),t.transform=u,t.vertexSpace.origin=s,r.notifyMeshTransformChanged()}}}(e,e.transform,e.vertexSpace):function undoRecords_i(e){let t,r=e.vertexAttributes.clonePositional();return{undo:n=>{t=e.vertexAttributes.clonePositional(),e.vertexAttributes=r,n.notifyGeometryChanged()},redo:n=>{r=e.vertexAttributes.clonePositional(),e.vertexAttributes=t,n.notifyGeometryChanged()}}}(e)}(e.geometry):function undoRecords_n(e){let t=e.geometry,r=null;return{undo(e){r=e.geometry,e.geometry=t},redo(e){t=e.geometry,e.geometry=r}}}(e)}let ScaleRotateMeshAdapter_v=class extends Accessor.c{constructor(t){super(t),this._interactionState=null}initialize(){this.addHandles([(0,reactiveUtils._I)((()=>{const t=this._interactionState;return t&&t.angle!==t.previousAngle?{interactionState:t,angle:t.state.angle}:null}),(({interactionState:t})=>{this._updateMeshRotation(t)}),reactiveUtils.du),(0,reactiveUtils._I)((()=>{const t=this._interactionState;return t&&t.scale!==t.previousScale?{interactionState:t,scale:t.state.scale}:null}),(({interactionState:t})=>{this._updateMeshSize(t)}),reactiveUtils.du)])}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){const t=this.geometry.transform;if(null==t)return this._interactionState?.angle??0;const e=(0,axisAngleDegrees.Yz)(t.rotation)[2];return Math.abs(e)>.999999?(0,mathUtils.EF)((0,axisAngleDegrees.i4)(t.rotation))*Math.sign(e):0}get angleClockwise(){return-this.angle}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}startInteraction(){const t=new ScaleRotateMeshAdapter_f({angle:this.angle});this._interactionState=t;const e=()=>{this._interactionState=null};return{state:t,done:e,cancel:()=>{t.cancel(),e()}}}createUndoRecord(){return undoRecords_t(this.graphic)}_updateMeshRotation(t){const{angle:e,previousAngle:o}=t;t.previousAngle=e;const{geometry:r}=this,{vertexSpace:n}=r,s=(0,mathUtils.UB)(e-o);if(n.isGeoreferenced){const t=!n.isRelative&&this.viewingMode===ViewingMode.UZ.Global,e=this.geometry.anchor;this.geometry.rotate(0,0,s,{origin:e,geographic:t}),this.graphic.notifyGeometryChanged()}else{r.transform??=new MeshTransform.c;const{transform:t}=r,e=(0,axisAngleDegrees.GA)(0,0,s,ScaleRotateMeshAdapter_S);t.rotation=(0,axisAngleDegrees.Jn)(t.rotation,e,t.rotation),this.graphic.notifyMeshTransformChanged()}}_updateMeshSize(t){const{scale:e,previousScale:o}=t;t.previousScale=e;const{geometry:i}=this,{vertexSpace:r}=i,n=e/o;if(r.isGeoreferenced){const t=!r.isRelative&&this.viewingMode===ViewingMode.UZ.Global,e=this.geometry.anchor;this.geometry.scale(n,{origin:e,geographic:t}),this.graphic.notifyGeometryChanged()}else{i.transform??=new MeshTransform.c;const{transform:t}=i;t.scale=(0,vec3.i)(t.scale,t.scale,n),this.graphic.notifyMeshTransformChanged()}}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],ScaleRotateMeshAdapter_v.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],ScaleRotateMeshAdapter_v.prototype,"geometry",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],ScaleRotateMeshAdapter_v.prototype,"viewingMode",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_v.prototype,"initialAngle",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_v.prototype,"angle",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_v.prototype,"angleClockwise",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_v.prototype,"relativeAngle",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_v.prototype,"relativeAngleClockwise",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_v.prototype,"scale",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_v.prototype,"_interactionState",void 0),ScaleRotateMeshAdapter_v=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],ScaleRotateMeshAdapter_v);let ScaleRotateMeshAdapter_f=class extends Accessor.c{get state(){const{angle:t,scale:e}=this;return{angle:t,scale:e}}constructor(t){super(t),this.angle=0,this.initialAngle=0,this.previousAngle=0,this.previousScale=1,this.scale=1,this.initialAngle=t.angle,this.previousAngle=t.angle}cancel(){this.angle=this.initialAngle,this.scale=1}};(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_f.prototype,"angle",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_f.prototype,"initialAngle",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_f.prototype,"previousAngle",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_f.prototype,"previousScale",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_f.prototype,"scale",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateMeshAdapter_f.prototype,"state",null),ScaleRotateMeshAdapter_f=(0,tslib_es6._)([(0,subclass.c)("InteractionState")],ScaleRotateMeshAdapter_f);const ScaleRotateMeshAdapter_S=(0,axisAngleDegrees.Su)();let ScaleRotateObjectSymbol3DAdapter_a=class extends Accessor.c{constructor(t){super(t),this.sizeAxis=null,this._interactionState=null}initialize(){this.addHandles((0,reactiveUtils._I)((()=>null!=this._interactionState?this._interactionState.state:null),(t=>{this._updateSymbol(t)}),reactiveUtils.du))}get initialAngle(){return this._interactionState?.initialAngle??0}get angle(){return null!=this._interactionState?this._interactionState.angle:null!=this._orientationReferenceSymbolLayer?function ScaleRotateObjectSymbol3DAdapter_c(t){return-(0,mathUtils.EF)(t)}(this._orientationReferenceSymbolLayer.heading??0):0}get angleClockwise(){return-this.angle}get orientation(){return this.angle}get orientationClockwise(){return this.angleClockwise}get relativeAngle(){return this.angle-this.initialAngle}get relativeAngleClockwise(){return-this.relativeAngle}get scale(){return this._interactionState?.scale??1}get size(){const t=this._sizeReferenceSymbolLayer;if(null==t)return null;const e=this.findLayerView(),i=this._graphicSymbol;if(null==e||null==i||"point-3d"!==i.type)return null;const l=e.getSymbolLayerSize(i,t);if("size"in l&&null!=l.size)return l.size;const n=this.sizeAxis;return!("width"in l)||null==l.width||null!=n&&"width"!==n&&"all"!==n&&"width-and-depth"!==n?!("depth"in l)||null==t.depth||null!=n&&"depth"!==n&&"all"!==n&&"width-and-depth"!==n?!("height"in l)||null==t.height||null!=n&&"height"!==n&&"all"!==n?null:l.height:l.depth:l.width}get _sizeReferenceSymbolLayer(){const t=this._graphicSymbol;return null==t||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type))}get _orientationReferenceSymbolLayer(){const t=this._graphicSymbol;return null==t||0===t.symbolLayers.length?null:t.symbolLayers.find((t=>"object"===t.type&&null!=t.heading))}get _graphicSymbol(){return null!=this.graphic?.symbol&&"point-3d"===this.graphic.symbol.type?this.graphic.symbol:null}set _graphicSymbol(t){this.graphic.symbol=t}startInteraction(){const t=this._graphicSymbol,e=this.findLayerView();if(null!=this._interactionState||null==t||null==e)return ScaleRotateObjectSymbol3DAdapter_h;const i=t.symbolLayers.map((i=>"object"===i.type?e.getSymbolLayerSize(t,i):null)).toArray(),l=t.clone(),n=this.angle,o=new ScaleRotateObjectSymbol3DAdapter_p({originalSymbol:l,angle:n,initialSizes:i});this._interactionState=o;const r=()=>{this._interactionState=null};return{state:o,done:r,cancel:()=>{this._graphicSymbol=l,r()}}}createUndoRecord(){let t=this.graphic.symbol,e=null;return{undo:i=>{e=i.symbol,i.symbol=t},redo:i=>{t=i.symbol,i.symbol=e}}}_updateSymbol({scale:t,angle:e,originalSymbol:l,initialSizes:n}){const o=this._graphicSymbol;if(null==o||"point-3d"!==o.type)return;const r=o.clone(),s=-(0,mathUtils.UB)(e-this.initialAngle);let a=!1;this._forEachObjectSymbolLayerPair(l,r,((e,i,l)=>{const o=(e.heading??0)+s;i.heading!==o&&(i.heading=o,a=!0);const r=n[l];if(null!=r&&"width"in r){r.width=this.sizeFilter(r.width),r.height=this.sizeFilter(r.height),r.depth=this.sizeFilter(r.depth);const e=r.width*t;i.width!==e&&(i.width=e,a=!0);const l=r.depth*t;i.depth!==l&&(i.depth=l,a=!0);const n=r.height*t;i.height!==n&&(i.height=n,a=!0)}})),a&&(this._graphicSymbol=r)}_forEachObjectSymbolLayerPair(t,e,i){t.symbolLayers.forEach(((t,l)=>{const n=e.symbolLayers.at(l);"object"===t.type&&"object"===n.type&&i(t,n,l)}))}};(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"initialAngle",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"angle",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"angleClockwise",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"orientation",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"orientationClockwise",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"relativeAngle",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"relativeAngleClockwise",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"scale",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"size",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"sizeAxis",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],ScaleRotateObjectSymbol3DAdapter_a.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"_interactionState",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],ScaleRotateObjectSymbol3DAdapter_a.prototype,"findLayerView",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],ScaleRotateObjectSymbol3DAdapter_a.prototype,"sizeFilter",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"_sizeReferenceSymbolLayer",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"_orientationReferenceSymbolLayer",null),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_a.prototype,"_graphicSymbol",null),ScaleRotateObjectSymbol3DAdapter_a=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateObjectSymbol3DAdapter")],ScaleRotateObjectSymbol3DAdapter_a);const ScaleRotateObjectSymbol3DAdapter_h={state:{angle:0,scale:0},done:()=>{},cancel:()=>{}};let ScaleRotateObjectSymbol3DAdapter_p=class extends Accessor.c{get state(){const{originalSymbol:t,angle:e,initialAngle:i,scale:l,initialSizes:n}=this;return{originalSymbol:t,angle:e,initialAngle:i,scale:l,initialSizes:n}}constructor(t){super(t),this.angle=0,this.initialAngle=0,this.scale=1,this.initialAngle=t.angle}};(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"originalSymbol",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"angle",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"initialAngle",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"initialSizes",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"scale",void 0),(0,tslib_es6._)([(0,property.qq)()],ScaleRotateObjectSymbol3DAdapter_p.prototype,"state",null),ScaleRotateObjectSymbol3DAdapter_p=(0,tslib_es6._)([(0,subclass.c)("InteractionState")],ScaleRotateObjectSymbol3DAdapter_p);let GraphicTransformTool_Y=class extends(Evented.c.EventedMixin(InteractiveToolBase.g)){constructor(t){super(t),this.enableZ=!0,this.enableRotation=!0,this.enableScaling=!0,this.tooltipOptions=new SketchTooltipOptions.c,this.type="transform-3d",this._updatingHandles=new UpdatingHandles.A,this._scaleRotate=null,this._tooltip=null,this._translateGraphicTooltipInfo=null,this._translateGraphicXYTooltipInfo=null,this._translateGraphicZTooltipInfo=null}initialize(){const{graphic:t,view:e}=this;this.graphicState=new GraphicState_e({graphic:t}),this.addHandles((0,reactiveUtils.aE)((()=>this.tooltipOptions.enabled),(t=>{this._tooltip=t?new Tooltip.o({view:e}):(0,maybe.mG)(this._tooltip)}),reactiveUtils.KG)),this._moveManipulation=new MoveManipulation_u({tool:this,view:e,snapToScene:this.snapToScene,xyAvailable:!0,xyAxisAvailable:!0,zAvailable:this.enableZ&&manipulatorUtils_n(t),radius:MoveManipulation_u.radiusForSymbol(t.symbol)}),this._moveManipulation.forEachManipulator((i=>this.addHandles(i.events.on("immediate-click",(i=>{this.emit("immediate-click",{...i,graphic:t}),i.stopPropagation()})))));const n=t=>i=>{this.addHandles(i.events.on("focus-changed",(({action:i})=>{const e=this._tooltip;null!=e&&("focus"===i?this._updateMoveTooltip(t):e.clear())})))};this._moveManipulation.xyManipulation.forEachManipulator(n(MoveManipulation_c.XY)),this._moveManipulation.xyAxisManipulation.forEachManipulator(n(MoveManipulation_c.XY_AXIS)),this._moveManipulation.zManipulation.forEachManipulator(n(MoveManipulation_c.Z));const s=(0,elevationInfoUtils.CI)(t);this._moveManipulation.elevationInfo=s,this.addHandles(meshFastUpdateUtils_o(this.graphicState));const{geometry:p}=t;if(this._moveManipulation.createGraphicDragPipeline(((i,a,o,n,r)=>{if(null!=p&&i===MoveManipulation_c.XY){const{snappingStep:i,cancelSnapping:a}=(0,SnappingDragPipelineStep.s)({snappingContext:new SnappingContext.m({elevationInfo:s,pointer:r,editGeometryOperations:EditGeometryOperations.u.fromGeometry(new Point.c({spatialReference:p.spatialReference}),e.state.viewingMode),visualizer:new SnappingVisualizer3D_O,excludeFeature:t}),snappingManager:this.snappingManager,updatingHandles:this._updatingHandles,useZ:!1});n=n.next(a),o=o.next((0,dragEventPipeline.UR)(this.view,s)).next(...i)}return{steps:o=o.next((t=>(this._updateMoveTooltip(i,t),t))),cancel:n}}),this.graphicState,(t=>{const{action:i,graphic:e,dxScreen:a,dyScreen:o}=t,n={graphic:e,dxScreen:a,dyScreen:o};switch(i){case"start":this.emit("graphic-translate-start",n),this.emit("record-undo",{record:this._createGeometryUndoRecord()});break;case"update":this.emit("graphic-translate",n);break;case"end":this.emit("graphic-translate-stop",n)}})),this._moveManipulation.angle=null!=this._scaleRotate?this._scaleRotate.angle:0,this._scaleRotateAdapter=this._createScaleRotateAdapter(),this.addHandles((0,reactiveUtils.aE)((()=>this._scaleRotateAdapter.angle),(()=>this._updateMoveAngle()))),this.enableScaling||this.enableRotation){const t=this.enableScaling&&this.enableRotation?null:this.enableScaling?"scale":"rotate";this._scaleRotate=new Tt({tool:this,mode:t,adapter:this._scaleRotateAdapter,tooltipOptions:this.tooltipOptions}),this.addHandles(this._scaleRotate.events.on("scale-changed",(()=>this._onScaleChanged())))}this.addHandles([visualElementUtils_i({view:this.view,graphic:this.graphic,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>(0,handleUtils.uU)()}),this.graphicState.on("changed",(()=>this._onGeometryChanged())),this._hideManipulatorsForGraphicState(),(0,reactiveUtils.aE)((()=>e.scale),(()=>this._updateMoveAngle()))].filter(arrayUtils.G6)),this.addHandles(this.view.trackGraphicState(this.graphicState)),this._onGeometryChanged(),this._updateMoveAngle(),this._forEachManipulator((t=>{t instanceof Manipulator3D_$&&this.addHandles(t.events.on("grab-changed",(()=>this._updateManipulatorsInteractive())))})),this.finishToolCreation()}destroy(){this._tooltip=(0,maybe.mG)(this._tooltip),this._moveManipulation.destroy(),this._scaleRotate=(0,maybe.mG)(this._scaleRotate),this._scaleRotateAdapter=(0,maybe.mG)(this._scaleRotateAdapter),this._updatingHandles.destroy(),this._set("view",null),this._set("graphic",null)}_updateManipulatorsInteractive(){null!=this._scaleRotate&&(this._scaleRotate.interactive=!this._moveManipulation.grabbing,this._moveManipulation.interactive=!this._scaleRotate.grabbing)}_createScaleRotateAdapter(){return null!=this.graphic.geometry&&"mesh"===this.graphic.geometry.type?new ScaleRotateMeshAdapter_v({graphic:this.graphic,geometry:this.graphic.geometry,viewingMode:this.view.state.viewingMode}):new ScaleRotateObjectSymbol3DAdapter_a({graphic:this.graphic,sizeFilter:t=>this._enforceNonZeroSize(t),findLayerView:()=>this.view.allLayerViews.find((t=>t.layer===this.graphic.layer)),sizeAxis:this.tooltipOptions?.visualVariables?.size?.axis??null})}_forEachManipulator(t){this._moveManipulation?.forEachManipulator(t),this._scaleRotate?.forEachManipulator(t)}_hideManipulatorsForGraphicState(){return(0,reactiveUtils.aE)((()=>this.graphicState.displaying),(t=>{this._forEachManipulator((i=>i.available=t)),this._moveManipulation.zManipulation.available=t&&this.enableZ&&manipulatorUtils_n(this.graphic)}))}_createGeometryUndoRecord(){return undoRecords_t(this.graphic)}set snapToScene(t){this._moveManipulation&&(this._moveManipulation.snapToScene=t),this._set("snapToScene",t)}get updating(){return this._updatingHandles.updating||!!this._scaleRotate?.updating}set location(t){this._moveManipulation.location=t,this._scaleRotate&&(this._scaleRotate.location=t)}set elevationAlignedLocation(t){this._moveManipulation.elevationAlignedLocation=t,this._scaleRotate&&(this._scaleRotate.elevationAlignedLocation=t)}reset(){}onHide(){this._scaleRotate?.cancelActiveAnimation()}_onScaleChanged(){null!=this._scaleRotate&&(this._moveManipulation.displayScale=this._scaleRotate.getScale())}_updateMoveAngle(){this.view.state.viewingMode===ViewingMode.UZ.Local||this.view.scale<1e6?this._moveManipulation.angle=this._scaleRotateAdapter.angle:this._moveManipulation.angle=0}_onGeometryChanged(){manipulatorUtils_v(this.view,this,this.graphic)}_enforceNonZeroSize(t){return t||this.view.state.camera.computeRenderPixelSizeAt(this._moveManipulation.renderLocation)}_updateMoveTooltip(t,i){const{tooltipOptions:e,_tooltip:a}=this;if(null==a)return;a.clear();const o=this.graphicState.isDraped?"on-the-ground":"absolute-height";switch(t){case MoveManipulation_c.XY:a.info=this._translateGraphicTooltipInfo??=new TranslateTooltipInfos.qC({tooltipOptions:e}),this._updateMoveTooltipDistance(a.info,i,((t,i)=>(0,automaticLengthMeasurementUtils.ik)(t,i,o)));break;case MoveManipulation_c.XY_AXIS:a.info=this._translateGraphicXYTooltipInfo??=new TranslateTooltipInfos.j1({tooltipOptions:e}),this._updateMoveTooltipDistance(a.info,i,((t,e)=>{const a=(0,automaticLengthMeasurementUtils.ik)(t,e,o);return(0,quantityUtils.aU)(a,moveUtils_a(i))}));break;case MoveManipulation_c.Z:a.info=this._translateGraphicZTooltipInfo??=new TranslateTooltipInfos.MH({tooltipOptions:e}),this._updateMoveTooltipDistance(a.info,i,euclideanLengthMeasurementUtils.Mb)}a.info.tooltipOptions=e}_updateMoveTooltipDistance(t,i,e){if(null!=i&&"end"!==i.action){const{mapStart:a,mapEnd:o}=i,n=e(a,o);t.distance=null!=n?n:quantityUtils.U7}else t.distance=quantityUtils.U7}get test(){return{discManipulator:this._moveManipulation.xyManipulation.test.discManipulator,zManipulator:this._moveManipulation.zManipulation.test.manipulator,ringManipulator:null!=this._scaleRotate?this._scaleRotate.test.ringManipulator:null,arrowManipulators:this._moveManipulation.xyAxisManipulation.test.arrowManipulators,setRingIndicatorDelayMs:t=>null!=this._scaleRotate?this._scaleRotate.test.setRingIndicatorDelayMs(t):null,scaleRotateAdapter:this._scaleRotateAdapter,scaleRotateTransform:this._scaleRotate,tooltip:this._tooltip}}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicTransformTool_Y.prototype,"view",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicTransformTool_Y.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],GraphicTransformTool_Y.prototype,"enableZ",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicTransformTool_Y.prototype,"enableRotation",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicTransformTool_Y.prototype,"enableScaling",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,type:SketchTooltipOptions.c})],GraphicTransformTool_Y.prototype,"tooltipOptions",void 0),(0,tslib_es6._)([(0,property.qq)()],GraphicTransformTool_Y.prototype,"graphicState",void 0),(0,tslib_es6._)([(0,property.qq)({value:!1})],GraphicTransformTool_Y.prototype,"snapToScene",null),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],GraphicTransformTool_Y.prototype,"snappingManager",void 0),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],GraphicTransformTool_Y.prototype,"type",void 0),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],GraphicTransformTool_Y.prototype,"updating",null),GraphicTransformTool_Y=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.editingTools.graphicTransform3D.GraphicTransformTool")],GraphicTransformTool_Y);var Clonable=__webpack_require__("./node_modules/@arcgis/core/core/Clonable.js"),JSONSupport=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js"),cast=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/cast.js"),persistable=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js");let SlicePlane_c=class extends((0,Clonable.q)(JSONSupport.am)){constructor(o){super(o),this.type="plane",this.position=null,this.heading=0,this.tilt=0,this.width=10,this.height=10}equals(o){return this.heading===o.heading&&this.tilt===o.tilt&&(0,maybe.O4)(this.position,o.position)&&this.width===o.width&&this.height===o.height}};(0,tslib_es6._)([(0,property.qq)({readOnly:!0,json:{read:!1,write:!0}})],SlicePlane_c.prototype,"type",void 0),(0,tslib_es6._)([(0,property.qq)({type:Point.c}),(0,persistable.O)()],SlicePlane_c.prototype,"position",void 0),(0,tslib_es6._)([(0,property.qq)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,persistable.O)(),(0,cast.W)((o=>Cyclical.sD.normalize((0,ensureType.Oe)(o),0,!0)))],SlicePlane_c.prototype,"heading",void 0),(0,tslib_es6._)([(0,property.qq)({type:Number,nonNullable:!0,range:{min:0,max:360}}),(0,persistable.O)(),(0,cast.W)((o=>Cyclical.sD.normalize((0,ensureType.Oe)(o),0,!0)))],SlicePlane_c.prototype,"tilt",void 0),(0,tslib_es6._)([(0,property.qq)({type:Number,nonNullable:!0}),(0,persistable.O)()],SlicePlane_c.prototype,"width",void 0),(0,tslib_es6._)([(0,property.qq)({type:Number,nonNullable:!0}),(0,persistable.O)()],SlicePlane_c.prototype,"height",void 0),SlicePlane_c=(0,tslib_es6._)([(0,subclass.c)("esri.analysis.SlicePlane")],SlicePlane_c);__webpack_require__("./node_modules/@arcgis/core/geometry/support/Axis.js");var boundedPlane=__webpack_require__("./node_modules/@arcgis/core/chunks/boundedPlane.js");(0,vec4f64.f)(0,0,0,.04);(0,has.c)("mac");const sliceToolConfig_a=1.15,sliceToolConfig_c=1.15,sliceToolConfig_l=(Math.cos((0,mathUtils.EF)(45)),Math.cos((0,mathUtils.EF)(5)),3),sliceToolConfig_n=11,sliceToolConfig_x=22.5,sliceToolConfig_g=.3;(0,mat4f64.a)();var DefaultBufferWriter=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultBufferWriter.js"),DefaultLayouts=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/DefaultLayouts.js"),TriangleMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/materials/TriangleMaterial.js"),SlicePlaneMaterial_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/SlicePlaneMaterial.glsl.js");shaderModules_interfaces.a;class SlicePlaneMaterialTechnique_u extends ShaderTechnique.O{initializeProgram(e){return new Program.G(e.rctx,SlicePlaneMaterialTechnique_u.shader.get().build(this.configuration),DefaultVertexAttributeLocations.q)}initializePipeline(){return(0,renderState._w)({blending:(0,renderState.ac)(enums.w$.ONE,enums.w$.ONE,enums.w$.ONE_MINUS_SRC_ALPHA,enums.w$.ONE_MINUS_SRC_ALPHA),depthTest:{func:enums.et.LESS},colorWrite:renderState.kp})}}SlicePlaneMaterialTechnique_u.shader=new ReloadableShaderModule.O(SlicePlaneMaterial_glsl.S,(()=>__webpack_require__.e(62380).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/SlicePlaneMaterial.glsl.js"))));TriangleMaterial.O;GLMaterial.c;__webpack_require__("./node_modules/@arcgis/core/core/typedArrayUtil.js");__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectVectorToDehydratedPoint.js"),__webpack_require__("./node_modules/@arcgis/core/geometry/projection/projectVectorToPoint.js"),__webpack_require__("./node_modules/@arcgis/core/geometry/support/coordinateSystem.js");var pi;__webpack_require__("./node_modules/@arcgis/core/geometry/Extent.js");function Ti(i){const t=(0,vec3.l)(i.basis1),e=(0,vec3.l)(i.basis2);return sliceToolConfig_g*Math.min(t,e)}function hi(i){return Ti(i)}function Ii(i){return 0!==i.direction[0]&&0!==i.direction[1]}!function(i){i[i.POSITIVE_X=0]="POSITIVE_X",i[i.POSITIVE_Y=1]="POSITIVE_Y",i[i.NEGATIVE_X=2]="NEGATIVE_X",i[i.NEGATIVE_Y=3]="NEGATIVE_Y"}(pi||(pi={}));const Vi=interactive_interfaces.Yp.Custom1;var Ci,_i;!function(i){i[i.HEADING=1]="HEADING",i[i.TILT=2]="TILT"}(Ci||(Ci={})),function(i){i[i.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",i[i.HORIZONTAL=1]="HORIZONTAL",i[i.VERTICAL=2]="VERTICAL",i[i.TILTED=3]="TILTED"}(_i||(_i={}));const Mi=interactive_interfaces.Yp.Custom2,yi=((0,ray.Su)(),Math.PI/2),Ni=interactive_interfaces.Yp.Custom1,Hi=interactive_interfaces.Yp.Custom2;var ShiftManipulator_H,quat=__webpack_require__("./node_modules/@arcgis/core/chunks/quat.js");!function(e){e[e.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",e[e.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"}(ShiftManipulator_H||(ShiftManipulator_H={}));class ShiftManipulator_I extends Manipulator3D_${constructor(n,s){const a=new RibbonLineMaterial.O({width:1,renderOccluded:Material.C2.OccludeAndTransparent,isDecoration:!0}),i=new ColorMaterial.U({cullFace:basicInterfaces.CM.Back,renderOccluded:Material.C2.Opaque,isDecoration:!0}),c=new ColorMaterial.U({cullFace:basicInterfaces.CM.Back,renderOccluded:Material.C2.Opaque,isDecoration:!0}),l=new ColorMaterial.U({cullFace:basicInterfaces.CM.Back,renderOccluded:Material.C2.Opaque,isDecoration:!0}),m=new ColorMaterial.U({writeDepth:!1,cullFace:basicInterfaces.CM.Front,renderOccluded:Material.C2.Transparent,isDecoration:!0});super({view:n,...ShiftManipulator_S({offsetMode:s,tubeMaterial:i,tipMaterial:c,capMaterial:l,outlineMaterial:m,calloutMaterial:a})}),this._themeHandle=(0,reactiveUtils.aE)((()=>n.effectiveTheme.accentColor),(r=>{const o=(0,colorUtils.u8)(r),n=Color.c.toUnitRGBA(r),s=Color.c.toUnitRGBA(o),u=Color.c.toUnitRGBA(Color.c.blendColors(o,r,.4)),p=Color.c.toUnitRGBA(Color.c.blendColors(o,r,.14));a.setParameters({color:n}),i.setParameters({color:p}),c.setParameters({color:s}),l.setParameters({color:u}),m.setParameters({color:n})}),reactiveUtils._8)}destroy(){this._themeHandle.remove(),super.destroy()}}function ShiftManipulator_S({offsetMode:e,tubeMaterial:t,tipMaterial:r,capMaterial:o,outlineMaterial:n,calloutMaterial:s}){const a=e===ShiftManipulator_H.CENTER_ON_CALLOUT?40:0,i=[(0,vec3f64.f)(a,0,-24),(0,vec3f64.f)(a,0,24)],c=function ShiftManipulator_J(e,t){const r=(0,vec3.f)((0,vec3f64.c)(),e[e.length-1],e[e.length-2]);if((0,vec3.n)(r,r),(0,vec3.i)(r,r,sliceToolConfig_x),(0,vec3.g)(r,r,e[e.length-1]),t){const t=(0,vec3.f)((0,vec3f64.c)(),e[0],e[1]);return(0,vec3.n)(t,t),(0,vec3.i)(t,t,sliceToolConfig_x),(0,vec3.g)(t,t,e[0]),[t,...e,r]}return[...e,r]}(i,!0),l=ShiftManipulator_W({vertices:i,padding:0,materials:{tube:t,tip:r,cap:o}}),m=ShiftManipulator_W({vertices:i,padding:2.25,materials:{tube:n,tip:n,cap:n}}),u=(0,GeometryUtil.oF)(s,[[a,0,0],[a-40,0,0]]),p=(0,GeometryUtil.oF)(s,[[a,0,0],[a-40,0,0]]);return{renderObjects:[...l.normal.map((e=>new RenderObject_e(e,interactive_interfaces.Gu.Unfocused|Vi))),...m.normal.map((e=>new RenderObject_e(e,interactive_interfaces.Gu.Unfocused|Vi))),new RenderObject_e(u,interactive_interfaces.Gu.Unfocused|Vi|Mi),...l.focused.map((e=>new RenderObject_e(e,interactive_interfaces.Gu.Focused|Vi))),...m.focused.map((e=>new RenderObject_e(e,interactive_interfaces.Gu.Focused|Vi))),new RenderObject_e(p,interactive_interfaces.Gu.Focused|Vi|Mi)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[c]},collisionPriority:1,radius:sliceToolConfig_n,state:Vi}}function ShiftManipulator_W({vertices:e,padding:t,materials:r}){const o=o=>{const M=e.slice(0),C=(0,vec3.f)(vectorStacks.Wq.get(),M[0],M[1]);(0,vec3.n)(C,C);const T=(0,vec3.f)(vectorStacks.Wq.get(),M[M.length-1],M[M.length-2]);if((0,vec3.n)(T,T),t>0){const e=(0,vec3.i)((0,vec3f64.c)(),T,-t);M[M.length-1]=(0,vec3.g)(e,e,M[M.length-1]);const r=(0,vec3.i)((0,vec3f64.c)(),C,-t);M[0]=(0,vec3.g)(r,r,M[0])}const E=o?sliceToolConfig_c:1,N=sliceToolConfig_x*E,k=sliceToolConfig_n*E,F=(0,mat4.g)(vectorStacks.SW.get());if(t>0){const e=N/4,r=(0,vec3.s)(vectorStacks.Wq.get(),0,e,0),o=1+t/e;(0,mat4.w)(F,F,r),(0,mat4.b)(F,F,(0,vec3.s)(vectorStacks.Wq.get(),o,o,o)),(0,mat4.w)(F,F,(0,vec3.i)(r,r,-1/o))}const y=(0,mat4.g)((0,mat4f64.a)()),B=(0,vec3f64.f)(0,1,0),L=(0,mat4.F)((0,mat4f64.a)(),(0,quat.r)(vectorStacks.QX.get(),B,T));L[12]=M[M.length-1][0],L[13]=M[M.length-1][1],L[14]=M[M.length-1][2],(0,mat4.m)(L,L,F);const P=r.tube,G=function ShiftManipulator_z(e,t,r){const o=[],n=12;for(let s=0;s<n;s++){const t=s/n*2*Math.PI;o.push([Math.cos(t)*e,Math.sin(t)*e])}return(0,GeometryUtil.Sg)(r,o,t,[],[],!1)}(sliceToolConfig_l*(o?sliceToolConfig_a:1)+t,M,P);G.transformation=y;const q=[G],x=r.tip,H=(0,GeometryUtil.eK)(x,N,k,24,!1,!1,!0);H.transformation=L,q.push(H);const I=r.cap,S=(0,GeometryUtil.eK)(I,N,k,24,!1,!0,!1);S.transformation=L,q.push(S);const W=(0,mat4.F)((0,mat4f64.a)(),(0,quat.r)(vectorStacks.QX.get(),B,C));return W[12]=M[0][0],W[13]=M[0][1],W[14]=M[0][2],(0,mat4.m)(W,W,F),q.push(H.instantiate({transformation:W})),q.push(S.instantiate({transformation:W})),q};return{normal:o(!1),focused:o(!0)}}var editPlaneUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/support/editPlaneUtils.js");class ExtentMove_T{constructor(t,e,o,i){this._tool=t,this._graphicState=e,this._editGeometryOperations=o,this._bounds=i,this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null;const a=this._tool,n=a.view;this.moveXYGraphicManipulation=new MoveXYGraphicManipulation_l({view:n,tool:a,graphicState:this._graphicState}),a.addHandles(this._createMoveXYGraphicDragPipeline()),this.moveZManipulator=new ShiftManipulator_I(n,ShiftManipulator_H.CENTER_ON_CALLOUT),this.moveZManipulator.state|=Mi,a.manipulators.add(this.moveZManipulator),a.addHandles([this._createMoveZDragPipeline()]),a.addHandles([a.on("graphic-translate-stop",(()=>{this._moveXYTooltipInfo=null,this._moveZTooltipInfo=null}))])}destroy(){this.moveXYGraphicManipulation.destroy(),this._tool.manipulators.remove(this.moveZManipulator),this.moveZManipulator.destroy()}forEachManipulator(t){this.moveXYGraphicManipulation.forEachManipulator(t),t(this.moveZManipulator,ManipulatorType_A.TRANSLATE_Z)}updateManipulators(t,i){const r=this.moveZManipulator,s=(0,mat4.o)(vectorStacks.SW.get(),t,Math.PI);s[12]=0,s[13]=0,s[14]=0,r.modelTransform=s,r.renderLocation=(0,vec3.f)(vectorStacks.Wq.get(),i.origin,i.basis1)}getUpdatedTooltipInfo(){return this.moveXYGraphicManipulation.grabbing||this.moveXYGraphicManipulation.dragging?this._computeMoveXYTooltipInfo():this.moveZManipulator.focused?this._computeMoveZTooltipInfo():null}_computeMoveXYTooltipInfo(){const t=this._tool.tooltipOptions;return this._moveXYTooltipInfo??=new TranslateTooltipInfos.qC({tooltipOptions:t})}_computeMoveZTooltipInfo(){const e=this._tool,o=e.tooltipOptions,i=this._moveZTooltipInfo??=new TranslateTooltipInfos.MH({tooltipOptions:o});if(this.moveZManipulator.dragging){const t=this._bounds,e=t.mapBoundsStart.origin,o=t.mapBounds.origin,a=(0,euclideanLengthMeasurementUtils.Mx)(e,o,this._tool.view.spatialReference);if(null==a)return null;i.distance=a}else i.distance=(0,quantityUtils.Mz)(0,e.moveUnit);return i}_updateMoveTooltip(t,e){if(e===MoveManipulation_c.XY||e===MoveManipulation_c.XY_AXIS){const e=(0,automaticLengthMeasurementUtils.ik)(t.mapStart,t.mapEnd,this._graphicState.isDraped?"on-the-ground":"absolute-height");null!=e&&null!=this._moveXYTooltipInfo&&(this._moveXYTooltipInfo.distance=e)}return t}_createMoveXYGraphicDragPipeline(){return this.moveXYGraphicManipulation.createDragPipeline(((t,e,o)=>this._applyGraphicMoveSteps(e,o,MoveManipulation_c.XY)))}_createMoveZDragPipeline(){const t=this._editGeometryOperations.data.spatialReference;return(0,dragEventPipeline.G4)(this.moveZManipulator,((e,o,a)=>{const n=(0,vec3f64.g)(e.renderLocation),r=o.next(dragEventPipeline3D_P(this._tool.view,n,t)).next((0,dragEventPipeline.qm)());this._applyGraphicMoveSteps(r,a,MoveManipulation_c.Z)}))}_applyGraphicMoveSteps(t,e,o){const i=this._tool,a=i.graphic,n=t.next((t=>("start"===t.action&&(i.inputState={type:"move"},this._bounds.backupMapBounds(),i.emit("graphic-translate-start",{graphic:a,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY})),t))).next((0,dragEventPipeline.YL)()).next(this._moveDragUpdateGeometry()).next((t=>{const e={graphic:a,dxScreen:t.screenDeltaX,dyScreen:t.screenDeltaY};switch(t.action){case"start":case"update":(t.mapEnd.x-t.mapStart.x||t.mapEnd.y-t.mapStart.y||(t.mapEnd.z??0)-(t.mapStart.z??0))&&i.emit("graphic-translate",e);break;case"end":i.inputState=null,i.emit("graphic-translate-stop",e)}return t})).next((t=>this._updateMoveTooltip(t,o)));return e.next((()=>{null!=i.inputState&&i.emit("graphic-translate-stop",{graphic:a,dxScreen:0,dyScreen:0}),i.cancel()})),n}_moveDragUpdateGeometry(){const t=this._tool;return e=>{if(null==t.inputState||"move"!==t.inputState.type)return e;const o=[];for(const t of this._editGeometryOperations.data.components)o.push(...t.vertices);const i="start"===e.action?editGeometry_interfaces.M.NEW_STEP:editGeometry_interfaces.M.ACCUMULATE_STEPS,a=this._editGeometryOperations.moveVertices(o,e.mapDeltaX,e.mapDeltaY,e.mapDeltaZ,i);return(0,editPlaneUtils.iQ)(a,this._bounds.mapBounds),t.graphic.geometry=this._editGeometryOperations.data.geometry,e}}}const generateTextures_t="theme-style";function generateTextures_e(t,e){return function generateTextures_a(t,e){const n=new Image(e,e);return n.src=t,n}(function generateTextures_r(t){const e=(new XMLSerializer).serializeToString(t);return`data:image/svg+xml;base64,${btoa(e)}`}(function generateTextures_n(e,{accentColor:n,contrastColor:o}){const r=n.toHex(),a=n.a,s=o.toHex(),i=o.a,c=e.getElementsByTagNameNS("http://www.w3.org/2000/svg","style").namedItem(generateTextures_t);return c&&(c.innerHTML=`\n      .contrast-fill { fill: ${s}; fill-opacity: ${i}; }\n      .contrast-stroke { stroke: ${s}; stroke-opacity: ${i};  }\n      .accent-fill { fill: ${r}; fill-opacity: ${a}; }\n      .accent-stroke { stroke: ${r}; stroke-opacity:  ${a}; }`),e}(function generateTextures_o(t){const e=t.split(",")[1],n=atob(e);return(new DOMParser).parseFromString(n,"image/svg+xml")}(t),e)),e.size)}var Texture=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/Texture.js");var GLTextureMaterial=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/GLTextureMaterial.js"),StencilUtils=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/lib/StencilUtils.js"),ImageMaterial_glsl=__webpack_require__("./node_modules/@arcgis/core/chunks/ImageMaterial.glsl.js");class ImageMaterialTechnique_N extends ShaderTechnique.O{initializeProgram(e){return new Program.G(e.rctx,ImageMaterialTechnique_N.shader.get().build(this.configuration),ImageMaterialTechnique_)}_setPipelineState(e,r){const o=this.configuration,i=e===TransparencyPassType.H.NONE,s=e===TransparencyPassType.H.FrontFace;return(0,renderState._w)({blending:o.output!==ShaderOutput.m.Color&&o.output!==ShaderOutput.m.Alpha||!o.transparent?null:i?ImageMaterialTechnique_E:(0,OrderIndependentTransparency.y2)(e),culling:(0,renderState.AD)(o.cullFace),depthTest:{func:(0,OrderIndependentTransparency.kd)(e)},depthWrite:i?o.writeDepth?renderState.AT:null:(0,OrderIndependentTransparency.A9)(e),colorWrite:renderState.kp,stencilWrite:o.hasOccludees?StencilUtils.wd:null,stencilTest:o.hasOccludees?r?StencilUtils._o:StencilUtils.Oy:null,polygonOffset:i||s?null:(0,OrderIndependentTransparency.S0)(o.enableOffset)})}initializePipeline(){return this._occludeePipelineState=this._setPipelineState(this.configuration.transparencyPassType,!0),this._setPipelineState(this.configuration.transparencyPassType,!1)}getPipeline(e){return e?this._occludeePipelineState:super.getPipeline()}}ImageMaterialTechnique_N.shader=new ReloadableShaderModule.O(ImageMaterial_glsl.I,(()=>__webpack_require__.e(62284).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/views/3d/webgl-engine/shaders/ImageMaterial.glsl.js"))));const ImageMaterialTechnique_E=(0,renderState.KO)(enums.w$.ONE,enums.w$.ONE_MINUS_SRC_ALPHA);class ImageMaterialTechnique_C extends DefaultTechniqueConfiguration.Q{constructor(){super(...arguments),this.output=ShaderOutput.m.Color,this.cullFace=basicInterfaces.CM.None,this.hasSlicePlane=!1,this.transparent=!1,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.transparencyPassType=TransparencyPassType.H.NONE,this.multipassEnabled=!1,this.cullAboveGround=!1,this.perspectiveInterpolation=!0}}(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)({count:ShaderOutput.m.COUNT})],ImageMaterialTechnique_C.prototype,"output",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)({count:basicInterfaces.CM.COUNT})],ImageMaterialTechnique_C.prototype,"cullFace",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ImageMaterialTechnique_C.prototype,"hasSlicePlane",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ImageMaterialTechnique_C.prototype,"transparent",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ImageMaterialTechnique_C.prototype,"enableOffset",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ImageMaterialTechnique_C.prototype,"writeDepth",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ImageMaterialTechnique_C.prototype,"hasOccludees",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)({count:TransparencyPassType.H.COUNT})],ImageMaterialTechnique_C.prototype,"transparencyPassType",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ImageMaterialTechnique_C.prototype,"multipassEnabled",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ImageMaterialTechnique_C.prototype,"cullAboveGround",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)()],ImageMaterialTechnique_C.prototype,"perspectiveInterpolation",void 0),(0,tslib_es6._)([(0,ShaderTechniqueConfiguration.y)({constValue:!1})],ImageMaterialTechnique_C.prototype,"occlusionPass",void 0);const ImageMaterialTechnique_=new Map([[VertexAttribute.K.POSITION,0],[VertexAttribute.K.UV0,2],[VertexAttribute.K.PERSPECTIVEDIVIDE,3]]);class ImageMaterial_g extends TriangleMaterial.O{constructor(t){super(t,new ImageMaterial_T),this.supportsEdges=!0,this._vertexAttributeLocations=ImageMaterialTechnique_,this._configuration=new ImageMaterialTechnique_C}getConfiguration(t,e){return this._configuration.output=t,this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.transparent=this.parameters.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=this.parameters.hasOccludees,this._configuration.transparencyPassType=e.transparencyPassType,this._configuration.enableOffset=e.camera.relativeElevation<OrderIndependentTransparency.ye,this._configuration.multipassEnabled=e.multipassEnabled,this._configuration.cullAboveGround=e.multipassTerrain.cullAboveGround,this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation,this._configuration}produces(t,r){return(r===ShaderOutput.m.Color||r===ShaderOutput.m.Alpha||r===ShaderOutput.m.Highlight)&&(t===RenderSlot.y.DRAPED_MATERIAL||(r===ShaderOutput.m.Highlight?t===RenderSlot.y.OPAQUE_MATERIAL:t===(this.parameters.transparent?this.parameters.writeDepth?RenderSlot.y.TRANSPARENT_MATERIAL:RenderSlot.y.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL:RenderSlot.y.OPAQUE_MATERIAL)))}createGLMaterial(t){return new ImageMaterial_E(t)}createBufferWriter(){const t=DefaultLayouts.i0.clone();return this.parameters.perspectiveInterpolation&&t.f32(VertexAttribute.K.PERSPECTIVEDIVIDE),new ImageMaterial_A(t)}}class ImageMaterial_E extends GLTextureMaterial.Q{constructor(t){super({...t,...t.material.parameters})}_updateParameters(t){return this.updateTexture(this._material.parameters.textureId),this._material.setParameters(this.textureBindParameters),this.ensureTechnique(ImageMaterialTechnique_N,t)}_updateOccludeeState(t){t.hasOccludees!==this._material.parameters.hasOccludees&&(this._material.setParameters({hasOccludees:t.hasOccludees}),this._updateParameters(t))}beginSlot(t){return this._output!==ShaderOutput.m.Color&&this._output!==ShaderOutput.m.Alpha||this._updateOccludeeState(t),this._updateParameters(t)}}class ImageMaterial_A extends DefaultBufferWriter.S{write(e,r,s,i,a){for(const n of this.vertexBufferLayout.fields.keys()){const l=s.attributes.get(n);if(l)if(n===VertexAttribute.K.PERSPECTIVEDIVIDE){(0,Util.Uc)(1===l.size);const e=i.getField(n,BufferView.AZ);e&&(0,bufferWriterUtils.s1)(l,e,a)}else(0,bufferWriterUtils.gt)(n,l,e,r,i,a)}}}class ImageMaterial_T extends Material.oL{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=basicInterfaces.CM.None,this.hasOccludees=!1,this.opacity=1,this.textureId=null,this.initTextureTransparent=!0,this.perspectiveInterpolation=!1}}class RotateManipulator_g extends Manipulator3D_${constructor(n,s){const a=new ImageMaterial_g({transparent:!0,writeDepth:!1,renderOccluded:Material.C2.Opaque,isDecoration:!0}),c=manipulatorUtils_O.calloutWidth,m=new RibbonLineMaterial.O({width:c,renderOccluded:Material.C2.OccludeAndTransparent,isDecoration:!0});super({view:n,...RotateManipulator_j({imageMaterial:a,calloutMaterial:m})}),this._currentTexture=null,this._themeHandle=(0,reactiveUtils.aE)((()=>n.effectiveTheme.accentColor),(i=>{const o=(0,colorUtils.iw)(i,.5),n=(0,colorUtils.u8)(i),l=this._currentTexture,c=s(o,n);a.setParameters({textureId:c.texture.id}),m.setParameters({color:Color.c.toUnitRGBA(i)}),this._currentTexture=c,l?.release()}),reactiveUtils._8)}destroy(){this._themeHandle.remove(),this._currentTexture?.release(),super.destroy()}}function RotateManipulator_j({imageMaterial:e,calloutMaterial:t}){const{focusMultiplier:r,calloutLength:i,discRadius:o}=manipulatorUtils_O,s=o*r,d=(e,t)=>{const r=[0,1,2,2,3,0];return new Geometry.K(t,[[VertexAttribute.K.POSITION,new Attribute.O([i-e,-e,0,i+e,-e,0,i+e,e,0,i-e,e,0],r,3,!0)],[VertexAttribute.K.UV0,new Attribute.O([0,0,1,0,1,1,0,1],r,2,!0)]])},f=(0,GeometryUtil.oF)(t,[[0,0,0],[i-o,0,0]]),b=(0,GeometryUtil.oF)(t,[[0,0,0],[i-s,0,0]]),g=Vi;return{autoScaleRenderObjects:!1,collisionPriority:1,collisionType:{type:"disc",direction:[0,0,1],offset:[i,0,0]},focusMultiplier:r,radius:o,renderObjects:[new RenderObject_e(d(o,e),interactive_interfaces.Gu.Unfocused|g),new RenderObject_e(f,interactive_interfaces.Gu.Unfocused|g),new RenderObject_e(d(s,e),interactive_interfaces.Gu.Focused|g),new RenderObject_e(b,interactive_interfaces.Gu.Focused|g)],state:g}}var UpdateVertices=__webpack_require__("./node_modules/@arcgis/core/views/interactive/editGeometry/operations/UpdateVertices.js"),ExtentTooltipInfos=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/ExtentTooltipInfos.js");class ExtentRotate_T{constructor(t,e,o){this._tool=t,this._editGeometryOperations=e,this._bounds=o,this._rotateTooltipInfo=null,this._startAngle=0,this._endAngle=0;const r=this._tool,a=r.view,i=!a._stage?.renderView.renderingContext.driverTest.svgPremultipliesAlpha.result;this.rotateManipulator=new RotateManipulator_g(a,((t,e)=>function Factory_l(r,l){const{accentColor:n,contrastColor:c,preMultiplyAlpha:i}=l;return r.fromData(`heading-rotate:[accent:${n},contrast:${c},size:64]`,(()=>new Texture.w(generateTextures_e("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1NiIgaGVpZ2h0PSI1NiIgZmlsbD0ibm9uZSIgdmVyc2lvbj0iMi4wIj48c3R5bGUgaWQ9InRoZW1lLXN0eWxlIj4uY29udHJhc3QtZmlsbHtmaWxsOiNmZmZ9LmNvbnRyYXN0LXN0cm9rZXtzdHJva2U6I2ZmZn0uYWNjZW50LWZpbGx7ZmlsbDojZmY3ZjAwO2ZpbGwtb3BhY2l0eTouNX08L3N0eWxlPjxwYXRoIGQ9Ik0yOCAwYTI4IDI4IDAgMSAxIDAgNTYgMjggMjggMCAwIDEgMC01NnoiIGNsYXNzPSJhY2NlbnQtZmlsbCIvPjxwYXRoIHN0cm9rZS13aWR0aD0iNC45OSIgZD0iTTIwLjA1IDQwLjg2YTE1LjA1IDE1LjA1IDAgMCAwIDE3LjE0LTEuNSAxNS4wNSAxNS4wNSAwIDAgMCA0LjQ3LTE2LjY1IDE1LjA1IDE1LjA1IDAgMCAwLTIyLjcyLTcuMTUgMTUuMDUgMTUuMDUgMCAwIDAtNS41IDcuMTUiIGNsYXNzPSJjb250cmFzdC1zdHJva2UiLz48cGF0aCBkPSJtMTAuOTcgMzUuNTcgNS4zOCAxMi4wNyA3Ljc5LTEzLjQ3LTEzLjE3IDEuNHoiIGNsYXNzPSJjb250cmFzdC1maWxsIi8+PC9zdmc+",{accentColor:n,contrastColor:c,size:64}),{mipmap:!0,reloadable:!0,preMultiplyAlpha:i})))}(a.textures,{accentColor:t,contrastColor:e,preMultiplyAlpha:i}))),r.addHandles([this.rotateManipulator.events.on("grab-changed",(t=>this._onRotateGrab(t))),this._createRotateDragPipeline(this.rotateManipulator)]),r.manipulators.add(this.rotateManipulator),r.addHandles([r.on("graphic-rotate-start",(t=>{this._startAngle=t.angle})),r.on("graphic-rotate",(t=>{this._endAngle=t.angle})),r.on("graphic-rotate-stop",(()=>{this._startAngle=0,this._endAngle=0}))])}destroy(){this._tool.manipulators.remove(this.rotateManipulator),this.rotateManipulator.destroy()}forEachManipulator(t){t(this.rotateManipulator,ManipulatorType_A.ROTATE)}updateManipulators(t,r){const a=this._bounds.mapBounds.plane[2]<0?Math.PI:0,i=(0,mat4.r)(vectorStacks.SW.get(),t,a);i[12]=0,i[13]=0,i[14]=0,this.rotateManipulator.modelTransform=i,this.rotateManipulator.renderLocation=(0,vec3.g)(vectorStacks.Wq.get(),r.origin,r.basis1)}getUpdatedTooltipInfo(){return this.rotateManipulator.focused?this._computeRotateTooltipInfo():null}_computeRotateTooltipInfo(){const t=this._tool.tooltipOptions,e=this._rotateTooltipInfo??=new ExtentTooltipInfos.M({tooltipOptions:t});return e.angle=this._startAngle-this._endAngle,e}_onRotateGrab({action:t,screenPoint:e}){const o=this._tool,r=this._bounds;if("start"!==t||!e)return;const a=function ci(i,t,e,n){const o=t.worldUpAtPosition(i.origin,vectorStacks.Wq.get()),s=vectorStacks.Wq.get();switch(e){case Ci.HEADING:(0,vec3.c)(s,o);break;case Ci.TILT:(0,vec3.c)(s,i.basis1)}return(0,plane.aY)(i.origin,s,n)}(r.displayBounds,o.view.renderCoordsHelper,Ci.HEADING,(0,plane.Su)()),i=ray_m(o.view.state.camera,e);(0,plane._y)(a,i,vectorStacks.Wq.get())&&(r.backupMapBounds(),o.inputState={type:"rotate",rotatePlane:a})}_createRotateDragPipeline(e){const o=this._tool,r=o.graphic;return(0,dragEventPipeline.G4)(e,((e,a,i)=>{const n=o.inputState;null!=n&&(a.next((t=>("start"===t.action&&o.emit("graphic-rotate-start",{graphic:r,angle:0}),t))).next(dragEventPipeline3D_H(o.view,n.rotatePlane)).next(this._rotateDragRenderPlaneToRotate(n)).next(this._rotateDragUpdateGeometry()).next((e=>{const a={graphic:r,angle:(0,mathUtils.UB)(e.rotateAngle)};switch(e.action){case"start":case"update":o.emit("graphic-rotate",a);break;case"end":o.inputState=null,o.emit("graphic-rotate-stop",a)}return e})),i.next((()=>{null!=o.inputState&&o.emit("graphic-rotate-stop",{graphic:r,angle:0}),o.cancel()})))}))}_rotateDragRenderPlaneToRotate(t){return e=>{const o=(0,plane.i4)(t.rotatePlane),r=manipulatorUtils_F(e.renderStart,e.renderEnd,this._bounds.displayBounds.origin,o);return{...e,rotateAxis:o,rotateAngle:r}}}_rotateDragUpdateGeometry(){const t=this._tool,e=this._bounds;return o=>{const n=(0,vec3.c)((0,vec3f64.c)(),e.mapBoundsStart.origin),s=[];for(const t of this._editGeometryOperations.data.components)s.push(...t.vertices);const p="start"===o.action?editGeometry_interfaces.M.NEW_STEP:editGeometry_interfaces.M.ACCUMULATE_STEPS,l=this._editGeometryOperations.rotateVertices(s,n,o.rotateAngle,p,UpdateVertices.c.REPLACE);return(0,boundedPlane.c)(e.mapBoundsStart,e.mapBounds),(0,editPlaneUtils.iQ)(l,e.mapBounds),t.graphic.geometry=this._editGeometryOperations.data.geometry,o}}}class ResizeManipulator_v extends Manipulator3D_${constructor(o,i){const s=Ii(i),m=s?4:1,f=2*m,u={renderOccluded:Material.C2.OccludeAndTransparent,isDecoration:!0},j=new RibbonLineMaterial.O({...u,width:m}),b=new RibbonLineMaterial.O({...u,width:f}),v=new RibbonLineMaterial.O({...u,width:1});super({view:o,...manipulatorUtils_D,...ResizeManipulator_M({isCorner:s,unfocusedMaterial:j,focusedMaterial:b,outlineMaterial:v})}),this._themeHandle=(0,reactiveUtils.aE)((()=>o.effectiveTheme.accentColor),(r=>{const t=Color.c.toUnitRGBA(r);j.setParameters({color:t}),b.setParameters({color:t}),v.setParameters({color:t})}),reactiveUtils._8)}destroy(){this._themeHandle.remove(),super.destroy()}}function ResizeManipulator_M({isCorner:e,unfocusedMaterial:r,focusedMaterial:t,outlineMaterial:n}){const a=e?[(0,vec3f64.f)(1,0,0),(0,vec3f64.f)(0,0,0),(0,vec3f64.f)(0,1,0)]:[(0,vec3f64.f)(1,0,0),(0,vec3f64.f)(-1,0,0)];return{renderObjects:[new RenderObject_e((0,GeometryUtil.oF)(r,a),interactive_interfaces.Gu.Unfocused|Ni),new RenderObject_e((0,GeometryUtil.oF)(t,a),interactive_interfaces.Gu.Focused|Ni),new RenderObject_e((0,GeometryUtil.oF)(n,a),Hi)],collisionType:{type:"line",paths:[a]},radius:e?6:4,state:Ni}}class extentUtils_{constructor(s,t,o){this._tool=s,this._onDisplayBoundsChanged=t,this.mapBounds=(0,boundedPlane.a)(),this.mapBoundsStart=(0,boundedPlane.a)(),this.displayBounds=(0,boundedPlane.a)(),this._calculateMapBounds(o)}get displayBoundsMargin(){const{view:s,graphic:t}=this._tool,o=s.pointsOfInterest?.centerOnSurfaceFrequent.location??t.geometry?.extent?.center;return o?extentUtils_R*s.pixelSizeAt(o):0}backupMapBounds(){(0,boundedPlane.c)(this.mapBounds,this.mapBoundsStart)}updateDisplayBounds(){this._calculateDisplayBounds(),this._onDisplayBoundsChanged()}_calculateMapBounds(s){const{view:e,attachmentOrigin:n}=this._tool,a=s.geometry,r=function geometryUtils_o(n){const o=geometryUtils_r(n);return(0,vec2f64.f)(Math.cos(o),Math.sin(o))}(a);(0,vec2.a)(r,r,-1);const c=e.spatialReference,l=a.spatialReference,p=n?e.pixelSizeAt(n)*(0,unitUtils.eg)(c)/(0,unitUtils.k8)(l):0;(0,editPlaneUtils.aU)(r,s,extentUtils_U*p,this.mapBounds)}_calculateDisplayBounds(){const{view:s,attachmentOrigin:t,graphic:o}=this._tool;if(!o.geometry)return;const i=t?.z??(0,elevationAlignmentUtils.eG)(this.mapBounds.origin,s.elevationProvider,ElevationContext.E.fromElevationInfo((0,elevationInfoUtils.CI)(o)),s.renderCoordsHelper),e=(0,boundedPlane.c)(this.mapBounds);e.origin[2]=i??0,function extentUtils_M(s,t,o,i=0,g){g||(g=(0,boundedPlane.a)()),t.toRenderCoords(s.origin,o,g.origin);const m=vectorStacks.Wq.get();(0,vec3.g)(m,s.origin,s.basis1),(0,vec3.g)(m,m,s.basis2),t.toRenderCoords(m,o,m);const f=vectorStacks.Wq.get();(0,vec3.g)(f,s.origin,s.basis1),(0,vec3.f)(f,f,s.basis2),t.toRenderCoords(f,o,f);const y=vectorStacks.Wq.get();(0,vec3.f)(y,s.origin,s.basis1),(0,vec3.f)(y,y,s.basis2),t.toRenderCoords(y,o,y);const B=vectorStacks.Wq.get();(0,vec3.f)(B,s.origin,s.basis1),(0,vec3.g)(B,B,s.basis2),t.toRenderCoords(B,o,B);const j=(0,vec3.p)(vectorStacks.Wq.get(),m,f,.5);(0,vec3.f)(j,j,g.origin);const v=(0,vec3.p)(vectorStacks.Wq.get(),y,B,.5);(0,vec3.f)(v,g.origin,v),(0,vec3.p)(g.basis1,j,v,.5);const C=(0,vec3.p)(vectorStacks.Wq.get(),B,m,.5);(0,vec3.f)(C,C,g.origin);const _=(0,vec3.p)(vectorStacks.Wq.get(),f,y,.5);(0,vec3.f)(_,g.origin,_),(0,vec3.p)(g.basis2,C,_,.5);const R=(0,vec3.b)(vectorStacks.Wq.get(),g.basis1,g.basis2),U=(0,vec3.b)(R,R,g.basis1);return(0,vec3.n)(U,U),(0,vec3.i)(g.basis2,U,(0,vec3.j)(g.basis2,U)),(0,vec3.i)(g.basis1,g.basis1,1+i/(0,vec3.l)(g.basis1)),(0,vec3.i)(g.basis2,g.basis2,1+i/(0,vec3.l)(g.basis2)),(0,boundedPlane.u)(g),g}(e,s.renderCoordsHelper,o.geometry.spatialReference,this.displayBoundsMargin,this.displayBounds)}}const extentUtils_R=10,extentUtils_U=80;function extentUtils_S(t,o,i,e){const a=vectorStacks.Wq.get();(0,vec3.f)(a,(0,vec3.f)(a,t.origin,t.basis1),t.basis2);const r=vectorStacks.Wq.get();(0,vec3.q)(r,a,t.basis1,2);const c=vectorStacks.Wq.get();(0,vec3.q)(c,r,t.basis2,2);const l=vectorStacks.Wq.get();(0,vec3.q)(l,a,t.basis2,2),a[2]=r[2]=c[2]=l[2]=o;const p=e?"on-the-ground":"absolute-height",u=(0,quantityUtils.kv)((0,automaticLengthMeasurementUtils.k6)(a,r,i,p),(0,automaticLengthMeasurementUtils.k6)(l,c,i,p)),d=(0,quantityUtils.kv)((0,automaticLengthMeasurementUtils.k6)(r,c,i,p),(0,automaticLengthMeasurementUtils.k6)(a,l,i,p));return null==d||null==u?null:[u,d]}class ExtentScale_j{get zMax(){if(!this._zMaxDirty)return this._zMax;const t=this._editGeometryOperations.data;if(t.geometry.hasZ){const e=t.coordinateHelper;this._zMax=Number.NEGATIVE_INFINITY;for(const s of t.components)for(const t of s.vertices){const s=e.getZ(t.pos)??0;this._zMax=Math.max(s,this._zMax)}}else this._zMax=0;return this._zMaxDirty=!1,this._zMax}constructor(e,a,i,r,o){this._tool=e,this._graphicState=a,this._editGeometryOperations=i,this._bounds=r,this._preserveAspectRatioStep=o,this._resizeHandles=[{direction:[1,0]},{direction:[1,1]},{direction:[0,1]},{direction:[-1,1]},{direction:[-1,0]},{direction:[-1,-1]},{direction:[0,-1]},{direction:[1,-1]}],this._scaleTooltipInfo=null,this._displayBoundsStart=(0,boundedPlane.a)(),this._displayBoundsMarginStart=0,this._startScale=(0,vec2f64.a)(),this._endScale=(0,vec2f64.a)(),this._sizeStart=null,this._zMax=0,this._zMaxDirty=!0;const n=this._tool,c=n.view;this.resizeManipulators=this._resizeHandles.map((t=>{const e=new ResizeManipulator_v(c,t);return n.addHandles([e.events.on("grab-changed",(t=>this._onResizeGrab(t))),this._createResizeDragPipeline(e,t)]),e})),n.manipulators.addMany(this.resizeManipulators),n.addHandles([n.on("graphic-scale-start",(e=>{(0,vec2.s)(this._startScale,e.xScale,e.yScale),(0,vec2.s)(this._endScale,e.xScale,e.yScale)})),n.on("graphic-scale",(e=>{(0,vec2.s)(this._endScale,e.xScale,e.yScale)})),n.on("graphic-scale-stop",(()=>{(0,vec2.s)(this._startScale,0,0),(0,vec2.s)(this._endScale,0,0)})),this._graphicState.on("changed",(()=>{"resize"!==n.inputState?.type&&(this._zMaxDirty=!0)}))])}destroy(){this.forEachManipulator((t=>{this._tool.manipulators.remove(t),t.destroy()}))}forEachManipulator(t){this.resizeManipulators.forEach((e=>t(e,ManipulatorType_A.SCALE)))}updateManipulators(t,e){this.resizeManipulators.forEach(((s,a)=>{!function di(i,t,e,n){const o=(0,vec3.l)(n.basis1),s=(0,vec3.l)(n.basis2),l=Ti(n),d=hi(n),g=(0,vec3.s)(vectorStacks.Wq.get(),0,0,0);(0,vec3.g)(g,(0,vec3.i)(vectorStacks.Wq.get(),n.basis1,t.direction[0]),(0,vec3.i)(vectorStacks.Wq.get(),n.basis2,t.direction[1])),(0,vec3.g)(g,n.origin,g);let m=0,p=1;if(Ii(t))1===t.direction[0]&&-1===t.direction[1]?m=yi:1===t.direction[0]&&1===t.direction[1]?m=Math.PI:-1===t.direction[0]&&1===t.direction[1]&&(m=3*Math.PI/2),p=d;else{const i=0!==t.direction[0]?1:2;m=1===i?yi:0,p=(1===i?s:o)-l}const T=(0,mat4.j)(vectorStacks.SW.get(),m);(0,mat4.b)(T,T,(0,vec3.s)(vectorStacks.Wq.get(),p,p,p)),(0,mat4.m)(T,e,T),T[12]=0,T[13]=0,T[14]=0,i.modelTransform=T,i.renderLocation=g}(s,this._resizeHandles[a],t,e)}))}getUpdatedTooltipInfo(){return this.resizeManipulators.some((t=>t.focused))?this._computeScaleTooltipInfo():null}_computeScaleTooltipInfo(){const t=this._tool,e=t.tooltipOptions,s=this._scaleTooltipInfo??=new ExtentTooltipInfos.S({tooltipOptions:e}),a=t.graphic.geometry;if(null==a)return null;const i=extentUtils_S(this._bounds.mapBounds,this.zMax,a.spatialReference,this._graphicState.isDraped);return null==i?null:(s.xSize=i[0],s.ySize=i[1],null!=this._sizeStart&&this.resizeManipulators.some((t=>t.dragging))?(s.xScale=i[0].value/this._sizeStart[0].value,s.yScale=i[1].value/this._sizeStart[1].value):(s.xScale=1,s.yScale=1),s)}_onResizeGrab({action:t,screenPoint:e}){const s=this._tool,a=this._bounds;if("start"!==t||!e||!s.graphic.geometry)return;const i=ray_m(s.view.state.camera,e);(0,plane._y)(a.displayBounds.plane,i,vectorStacks.Wq.get())&&(a.backupMapBounds(),(0,boundedPlane.c)(a.displayBounds,this._displayBoundsStart),this._displayBoundsMarginStart=a.displayBoundsMargin,this._sizeStart=extentUtils_S(a.mapBoundsStart,this.zMax,s.graphic.geometry.spatialReference,this._graphicState.isDraped),s.inputState={type:"resize"})}_createResizeDragPipeline(t,e){const s=this._tool,a=s.graphic;return(0,dragEventPipeline.G4)(t,((t,i,r)=>{null!=s.inputState&&(i.next((t=>("start"===t.action&&s.emit("graphic-scale-start",{graphic:a,xScale:1,yScale:1}),t))).next(dragEventPipeline3D_H(s.view,this._displayBoundsStart.plane)).next((t=>({...t,handle:e}))).next(this._resizeDragRenderPlaneToFactors()).next(...this._preserveAspectRatioStep()).next(this._resizeDragUpdateGeometry()).next((t=>{const e={graphic:a,xScale:t.factor1,yScale:t.factor2};switch(t.action){case"start":case"update":s.emit("graphic-scale",e);break;case"end":s.inputState=null,s.emit("graphic-scale-stop",e)}return t})),r.next((()=>{null!=s.inputState&&s.emit("graphic-scale-stop",{graphic:a,xScale:1,yScale:1}),s.cancel()})))}))}_resizeDragRenderPlaneToFactors(){const t=this._bounds;return e=>{const s=this._displayBoundsStart,c=e.handle.direction,p=t.displayBoundsMargin,l=this._displayBoundsMarginStart,h=(0,vec3.c)(vectorStacks.Wq.get(),s.origin);(0,vec3.q)(h,h,s.basis1,-c[0]),(0,vec3.q)(h,h,s.basis2,-c[1]);const u=(0,vec3.f)(vectorStacks.Wq.get(),e.renderEnd,h),m=(0,vec3.f)(vectorStacks.Wq.get(),e.renderStart,h),g=Ii(e.handle),f=hi(s),y=hi(t.displayBounds)/f,z=(t,e)=>{if(0===t)return 1;let s=(0,vec3.l)(e),a=.5*t*(0,vec3.j)(e,u)/s;const i=a<0?-1:1;g&&(a+=(s-.5*t*(0,vec3.j)(e,m)/s)*i*y);const r=s<1.5*l?1:ExtentScale_E;return s=Math.max(s-l,ExtentScale_E),i>0&&(a-=p),i*Math.max(i*(a/s),r)};return{...e,factor1:z(c[0],s.basis1),factor2:z(c[1],s.basis2)}}}_resizeDragUpdateGeometry(){const r=this._tool,o=this._bounds;return n=>{const p=(0,vec3.c)((0,vec3f64.c)(),o.mapBoundsStart.origin);(0,vec3.q)(p,p,o.mapBoundsStart.basis1,-n.handle.direction[0]),(0,vec3.q)(p,p,o.mapBoundsStart.basis2,-n.handle.direction[1]);const h=(0,vec2.s)((0,vec2f64.a)(),o.mapBoundsStart.basis1[0],o.mapBoundsStart.basis1[1]);(0,vec2.e)(h,h);const d=[];for(const t of this._editGeometryOperations.data.components)d.push(...t.vertices);const u="start"===n.action?editGeometry_interfaces.M.NEW_STEP:editGeometry_interfaces.M.ACCUMULATE_STEPS,m=this._editGeometryOperations.scaleVertices(d,p,h,n.factor1,n.factor2,u,UpdateVertices.c.REPLACE);return(0,boundedPlane.c)(o.mapBoundsStart,o.mapBounds),(0,editPlaneUtils.iQ)(m,o.mapBounds),r.graphic.geometry=this._editGeometryOperations.data.geometry,n}}}const ExtentScale_E=1e-6;class PreserveAspectRatio_e{constructor(){this._lastDragEvent=null,this._next=null,this._enabled=!1}get enabled(){return this._enabled}set enabled(t){if(this._enabled!==t&&null!=this._lastDragEvent&&null!=this._next){const a={...this._lastDragEvent,action:"update"};t&&this._adjustScaleFactors(a),this._next.execute(a)}this._enabled=t}createDragEventPipelineStep(){this._lastDragEvent=null;const t=new dragEventPipeline.aU;return this._next=t,[t=>(this._lastDragEvent="end"!==t.action?{...t}:null,this._enabled&&this._adjustScaleFactors(t),t),t]}_adjustScaleFactors(a){const e=Ii(a.handle)?Math.max(Math.abs(a.factor1),Math.abs(a.factor2)):0===a.handle.direction[0]?Math.abs(a.factor2):Math.abs(a.factor1);a.factor1=a.factor1<0?-e:e,a.factor2=a.factor2<0?-e:e}get test(){return{_adjustScaleFactors:t=>this._adjustScaleFactors(t)}}}let ExtentTransformTool_U=class extends(Evented.c.EventedMixin(InteractiveToolBase.g)){constructor(t){super(t),this.enableZ=!0,this.enableScaling=!0,this.enableRotation=!0,this.tooltipOptions=new SketchTooltipOptions.c,this._preserveAspectRatio=new PreserveAspectRatio_e,this.grabbing=!1,this.inputState=null,this._attachmentOrigin=null,this.type="transform-3d",this._outlineVisualElement=null}initialize(){const{view:t,graphic:e}=this,s=this._graphicState=new GraphicState_e({graphic:e}),n=e.geometry,r=this._editGeometryOperations=EditGeometryOperations.u.fromGeometry(n,t.state.viewingMode),l=this._bounds=new extentUtils_(this,(()=>this._updateManipulators()),r.data);this._extentMove=new ExtentMove_T(this,s,r,l),this._extentScale=new ExtentScale_j(this,s,r,l,(()=>this._preserveAspectRatio.createDragEventPipelineStep())),this._extentRotate=new ExtentRotate_T(this,r,l),this.addHandles([(0,reactiveUtils.aE)((()=>this.enableZ),(()=>this._updateManipulatorAvailability(this._extentMove.moveZManipulator,ManipulatorType_A.TRANSLATE_Z))),(0,reactiveUtils.aE)((()=>this.enableScaling),(()=>this._extentScale.forEachManipulator((t=>this._updateManipulatorAvailability(t,ManipulatorType_A.SCALE))))),(0,reactiveUtils.aE)((()=>this.enableRotation),(()=>this._updateManipulatorAvailability(this._extentRotate.rotateManipulator,ManipulatorType_A.ROTATE)))]),this._updateAllManipulatorAvailability();const p=visualElementUtils_i({view:t,graphic:e,forEachManipulator:t=>this._forEachManipulator(t),onManipulatorsChanged:()=>(0,handleUtils.uU)()});if(null!=p){const{visualElement:t}=p;t instanceof OutlineVisualElement_w&&(this._outlineVisualElement=t,this.addHandles(t.events.on("attachment-origin-changed",(()=>this._bounds.updateDisplayBounds())))),this.addHandles(p)}this.addHandles([s.on("changed",(()=>this._onGeometryChanged())),(0,reactiveUtils.aE)((()=>s.displaying),(()=>this._updateAllManipulatorAvailability())),(0,reactiveUtils.aE)((()=>s.isDraped),(()=>this._graphicDrapedChanged()),reactiveUtils._8),(0,reactiveUtils.aE)((()=>t.pointsOfInterest?.centerOnSurfaceFrequent.location),(()=>l.updateDisplayBounds())),t.trackGraphicState(s)]);this._forEachManipulator((t=>{this.addHandles(t.events.on("grab-changed",(()=>{this.grabbing=t.grabbing,this._updateAllManipulatorAvailability()})))}));this._forEachManipulator(((t,i)=>{this.addHandles(t.events.on("immediate-click",(t=>{i===ManipulatorType_A.TRANSLATE_XY&&this.emit("immediate-click",{...t,graphic:e}),t.stopPropagation()})))})),this._initializeTooltip(),this.finishToolCreation()}destroy(){this._extentMove.destroy(),this._extentScale.destroy(),this._extentRotate.destroy(),this._editGeometryOperations.destroy(),this._tooltip.destroy(),this._set("view",null),this._set("graphic",null)}_initializeTooltip(){const{view:t}=this,e=this._tooltip=new Tooltip.o({view:t}),i=()=>{e.info=this._getUpdatedTooltipInfo()};this.addHandles([this.on("graphic-translate-start",i),this.on("graphic-translate",i),this.on("graphic-translate-stop",(()=>{this._tooltip.clear()})),this.on("graphic-rotate-start",i),this.on("graphic-rotate",i),this.on("graphic-rotate-stop",i),this.on("graphic-scale-start",i),this.on("graphic-scale",i),this.on("graphic-scale-stop",i)]),this._forEachManipulator((t=>{this.addHandles([t.events.on("focus-changed",i),t.events.on("grab-changed",i),t.events.on("drag",(t=>{"cancel"===t.action?this._tooltip.clear():i()}))])}))}_getUpdatedTooltipInfo(){return this.tooltipOptions.enabled?this._extentMove.getUpdatedTooltipInfo()??this._extentScale.getUpdatedTooltipInfo()??this._extentRotate.getUpdatedTooltipInfo():null}_onGeometryChanged(){this._bounds.updateDisplayBounds()}_graphicDrapedChanged(){this.removeHandles(ExtentTransformTool_G),this._bounds.updateDisplayBounds(),this._graphicState.isDraped&&this.addHandles(this.view.elevationProvider.on("elevation-change",(t=>{null!=this._attachmentOrigin&&(0,aaBoundingRect.If)(t.extent,this._attachmentOrigin.x,this._attachmentOrigin.y)&&this._bounds.updateDisplayBounds()})),ExtentTransformTool_G)}_updateManipulators(){if(!this.visible)return;const t=this._bounds.displayBounds,e=function ai(i,t){return manipulatorUtils_M(i.basis1,i.basis2,i.origin,t)}(t,vectorStacks.SW.get());this._extentMove.updateManipulators(e,t),this._extentScale.updateManipulators(e,t),this._extentRotate.updateManipulators(e,t)}_updateAllManipulatorAvailability(){this._forEachManipulator(((t,e)=>this._updateManipulatorAvailability(t,e)))}_updateManipulatorAvailability(t,e){const i=this.grabbing&&!t.grabbing;if(t.interactive=!i,t instanceof Manipulator3D_$){const a=this._graphicState.displaying,o=this.enableZ&&manipulatorUtils_n(this.graphic);switch(e){case ManipulatorType_A.ROTATE:t.available=a&&this.enableRotation;break;case ManipulatorType_A.SCALE:t.available=a&&(this.enableScaling||this.enableRotation||o),t.interactive=!i&&this.enableScaling,t.state=this.enableScaling?Ni:Hi;break;case ManipulatorType_A.TRANSLATE_Z:t.available=a&&o;break;default:t.available=a}}}_forEachManipulator(t){this._extentMove.forEachManipulator(t),this._extentScale.forEachManipulator(t),this._extentRotate.forEachManipulator(t)}get preserveAspectRatio(){return this._preserveAspectRatio.enabled}set preserveAspectRatio(t){this._preserveAspectRatio.enabled=t,this._set("preserveAspectRatio",t)}get moveUnit(){return(0,unitUtils.dR)(this.view.spatialReference)??"meters"}get attachmentOrigin(){const t=this.graphic.geometry,e=this._graphicState.isDraped?null:this._outlineVisualElement?.attachmentOrigin;return this._attachmentOrigin=e??manipulatorUtils_k(this.view,this.graphic)??t?.extent?.center,this._attachmentOrigin}reset(){}cancel(){if(this.canUndo){const t=this._editGeometryOperations.undo();(0,editPlaneUtils.ew)(t,this._bounds.mapBounds),this.graphic.geometry=this._editGeometryOperations.data.geometry}this.inputState=null}get canUndo(){return this._editGeometryOperations.canUndo}undo(){if(null!=this.inputState)this.view.activeTool=null;else if(this.canUndo){const t=this._editGeometryOperations.undo();(0,editPlaneUtils.ew)(t,this._bounds.mapBounds),this.graphic.geometry=this._editGeometryOperations.data.geometry}}get canRedo(){return this._editGeometryOperations.canRedo}redo(){if(this.canRedo){const t=this._editGeometryOperations.redo();(0,editPlaneUtils.iQ)(t,this._bounds.mapBounds),this.graphic.geometry=this._editGeometryOperations.data.geometry}}get test(){return{moveZManipulator:this._extentMove.moveZManipulator,resizeManipulators:this._extentScale.resizeManipulators,rotateManipulator:this._extentRotate.rotateManipulator,tooltip:this._tooltip}}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],ExtentTransformTool_U.prototype,"view",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,nonNullable:!0})],ExtentTransformTool_U.prototype,"graphic",void 0),(0,tslib_es6._)([(0,property.qq)()],ExtentTransformTool_U.prototype,"enableZ",void 0),(0,tslib_es6._)([(0,property.qq)()],ExtentTransformTool_U.prototype,"enableScaling",void 0),(0,tslib_es6._)([(0,property.qq)()],ExtentTransformTool_U.prototype,"enableRotation",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0,type:SketchTooltipOptions.c})],ExtentTransformTool_U.prototype,"tooltipOptions",void 0),(0,tslib_es6._)([(0,property.qq)()],ExtentTransformTool_U.prototype,"preserveAspectRatio",null),(0,tslib_es6._)([(0,property.qq)()],ExtentTransformTool_U.prototype,"moveUnit",null),(0,tslib_es6._)([(0,property.qq)()],ExtentTransformTool_U.prototype,"grabbing",void 0),(0,tslib_es6._)([(0,property.qq)()],ExtentTransformTool_U.prototype,"inputState",void 0),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],ExtentTransformTool_U.prototype,"type",void 0),ExtentTransformTool_U=(0,tslib_es6._)([(0,subclass.c)("esri.views.3d.interactive.editingTools.transformGraphic.ExtentTransformTool")],ExtentTransformTool_U);const ExtentTransformTool_G="draped-elevation-changes"},"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/Laserline.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>d});var _output_ReadLinearDepth_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/output/ReadLinearDepth.glsl.js"),_util_CameraSpace_glsl_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/CameraSpace.glsl.js"),_shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float2PassUniform.js"),_shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Float3PassUniform.js"),_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js"),_shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/Texture2DPassUniform.js");function d(d,i){const s=d.fragment;s.include(_output_ReadLinearDepth_glsl_js__WEBPACK_IMPORTED_MODULE_0__.E),d.include(_util_CameraSpace_glsl_js__WEBPACK_IMPORTED_MODULE_1__.ig),s.uniforms.add(new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_4__.d("globalAlpha",(o=>o.globalAlpha)),new _shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_3__.C("glowColor",(o=>o.glowColor)),new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_4__.d("glowWidth",((o,e)=>o.glowWidth*e.camera.pixelRatio)),new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_4__.d("glowFalloff",(o=>o.glowFalloff)),new _shaderModules_Float3PassUniform_js__WEBPACK_IMPORTED_MODULE_3__.C("innerColor",(o=>o.innerColor)),new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_4__.d("innerWidth",((o,e)=>o.innerWidth*e.camera.pixelRatio)),new _shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.W("depthMap",((o,e)=>e.linearDepth?.colorTexture)),new _shaderModules_Float2PassUniform_js__WEBPACK_IMPORTED_MODULE_2__.$("nearFar",((o,e)=>e.camera.nearFar)),new _shaderModules_Texture2DPassUniform_js__WEBPACK_IMPORTED_MODULE_6__.W("frameColor",((o,e)=>e.mainColor))),s.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_5__.Y`vec4 blendPremultiplied(vec4 source, vec4 dest) {
float oneMinusSourceAlpha = 1.0 - source.a;
return vec4(
source.rgb + dest.rgb * oneMinusSourceAlpha,
source.a + dest.a * oneMinusSourceAlpha
);
}`),s.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_5__.Y`vec4 premultipliedColor(vec3 rgb, float alpha) {
return vec4(rgb * alpha, alpha);
}`),s.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_5__.Y`vec4 laserlineProfile(float dist) {
if (dist > glowWidth) {
return vec4(0.0);
}
float innerAlpha = (1.0 - smoothstep(0.0, innerWidth, dist));
float glowAlpha = pow(max(0.0, 1.0 - dist / glowWidth), glowFalloff);
return blendPremultiplied(
premultipliedColor(innerColor, innerAlpha),
premultipliedColor(glowColor, glowAlpha)
);
}`),s.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_5__.Y`bool laserlineReconstructFromDepth(out vec3 pos, out vec3 normal, out float depthDiscontinuityAlpha) {
float depth = linearDepthFromTexture(depthMap, uv, nearFar);
if (-depth == nearFar[0]) {
return false;
}
pos = reconstructPosition(gl_FragCoord.xy, depth);
normal = normalize(cross(dFdx(pos), dFdy(pos)));
float ddepth = fwidth(depth);
depthDiscontinuityAlpha = 1.0 - smoothstep(0.0, 0.01, -ddepth / depth);
return true;
}`),i.contrastControlEnabled?(s.uniforms.add(new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_4__.d("globalAlphaContrastBoost",(o=>null!=o.globalAlphaContrastBoost?o.globalAlphaContrastBoost:1))),s.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_5__.Y`float rgbToLuminance(vec3 color) {
return dot(vec3(0.2126, 0.7152, 0.0722), color);
}
vec4 laserlineOutput(vec4 color) {
float backgroundLuminance = rgbToLuminance(texture(frameColor, uv).rgb);
float alpha = clamp(globalAlpha * max(backgroundLuminance * globalAlphaContrastBoost, 1.0), 0.0, 1.0);
return color * alpha;
}`)):s.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_5__.Y`vec4 laserlineOutput(vec4 color) {
return color * globalAlpha;
}`)}},"./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/ScreenSizeScaling.glsl.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>o});var _util_View_glsl_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderLibrary/util/View.glsl.js"),_shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/FloatPassUniform.js"),_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/3d/webgl-engine/core/shaderModules/interfaces.js");function o(o,c){if(!c.screenSizeEnabled)return;const n=o.vertex;(0,_util_View_glsl_js__WEBPACK_IMPORTED_MODULE_0__.E7)(n,c),n.uniforms.add(new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_1__.d("perScreenPixelRatio",((e,i)=>i.camera.perScreenPixelRatio)),new _shaderModules_FloatPassUniform_js__WEBPACK_IMPORTED_MODULE_1__.d("screenSizeScale",(e=>e.screenSizeScale))),n.code.add(_shaderModules_interfaces_js__WEBPACK_IMPORTED_MODULE_2__.Y`float computeRenderPixelSizeAt( vec3 pWorld ){
vec3 viewForward = - vec3(view[0][2], view[1][2], view[2][2]);
float viewDirectionDistance = abs(dot(viewForward, pWorld - cameraPosition));
return viewDirectionDistance * perScreenPixelRatio;
}
vec3 screenSizeScaling(vec3 position, vec3 anchor){
return position * screenSizeScale * computeRenderPixelSizeAt(anchor) + anchor;
}`)}},"./node_modules/@arcgis/core/views/interactive/tooltip/ExtentTooltipInfos.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>i,S:()=>p});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/quantityUtils.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),_SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/SketchTooltipInfo.js");let i=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_4__.Q{constructor(t){super(t),this.type="extent-rotate",this.angle=0}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],i.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],i.prototype,"angle",void 0),i=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__.c)("esri.views.interactive.tooltip.ExtentRotateTooltipInfo")],i);let p=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_4__.Q{constructor(t){super(t),this.type="extent-scale",this.xScale=0,this.yScale=0,this.xSize=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7,this.ySize=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],p.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],p.prototype,"xScale",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],p.prototype,"yScale",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],p.prototype,"xSize",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],p.prototype,"ySize",void 0),p=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__.c)("esri.views.interactive.tooltip.ExtentScaleTooltipInfo")],p)},"./node_modules/@arcgis/core/views/interactive/tooltip/TranslateTooltipInfos.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I$:()=>c,MH:()=>a,Oq:()=>n,j1:()=>l,qC:()=>r,uU:()=>p});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/quantityUtils.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),_SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/tooltip/SketchTooltipInfo.js");let r=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_4__.Q{constructor(t){super(t),this.type="translate-graphic",this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7}clear(){this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],r.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],r.prototype,"distance",void 0),r=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__.c)("esri.views.interactive.tooltip.TranslateGraphicTooltipInfo")],r);let a=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_4__.Q{constructor(t){super(t),this.type="translate-graphic-z",this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7}clear(){this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],a.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],a.prototype,"distance",void 0),a=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__.c)("esri.views.interactive.tooltip.TranslateGraphicZTooltipInfo")],a);let l=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_4__.Q{constructor(t){super(t),this.type="translate-graphic-xy",this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],l.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],l.prototype,"distance",void 0),l=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__.c)("esri.views.interactive.tooltip.TranslateGraphicXYTooltipInfo")],l);let p=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_4__.Q{constructor(t){super(t),this.type="translate-vertex",this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7,this.elevation=null,this.area=null,this.totalLength=null}clear(){this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7,this.elevation=null,this.area=null,this.totalLength=null}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],p.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],p.prototype,"distance",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],p.prototype,"elevation",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],p.prototype,"area",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],p.prototype,"totalLength",void 0),p=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__.c)("esri.views.interactive.tooltip.TranslateVertexTooltipInfo")],p);let n=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_4__.Q{constructor(t){super(t),this.type="translate-vertex-z",this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7,this.elevation=null}clear(){this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7,this.elevation=null}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],n.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],n.prototype,"distance",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],n.prototype,"elevation",void 0),n=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__.c)("esri.views.interactive.tooltip.TranslateVertexZTooltipInfo")],n);let c=class extends _SketchTooltipInfo_js__WEBPACK_IMPORTED_MODULE_4__.Q{constructor(t){super(t),this.type="translate-vertex-xy",this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7,this.elevation=null,this.area=null,this.totalLength=null}clear(){this.distance=_core_quantityUtils_js__WEBPACK_IMPORTED_MODULE_1__.U7,this.elevation=null,this.area=null,this.totalLength=null}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],c.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],c.prototype,"distance",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],c.prototype,"elevation",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],c.prototype,"area",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.qq)()],c.prototype,"totalLength",void 0),c=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_3__.c)("esri.views.interactive.tooltip.TranslateVertexXYTooltipInfo")],c)}}]);
//# sourceMappingURL=76924.d01aff33.iframe.bundle.js.map