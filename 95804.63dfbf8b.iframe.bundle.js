"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[95804],{"./node_modules/@antv/event-emitter/esm/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function(){function EventEmitter(){this._events={}}return EventEmitter.prototype.on=function(evt,callback,once){return this._events[evt]||(this._events[evt]=[]),this._events[evt].push({callback,once:!!once}),this},EventEmitter.prototype.once=function(evt,callback){return this.on(evt,callback,!0)},EventEmitter.prototype.emit=function(evt){for(var _this=this,args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];var events=this._events[evt]||[],wildcardEvents=this._events["*"]||[],doEmit=function(es){for(var length=es.length,i=0;i<length;i++)if(es[i]){var _a=es[i],callback=_a.callback;_a.once&&(es.splice(i,1),0===es.length&&delete _this._events[evt],length--,i--),callback.apply(_this,args)}};doEmit(events),doEmit(wildcardEvents)},EventEmitter.prototype.off=function(evt,callback){if(evt)if(callback){for(var events=this._events[evt]||[],length_1=events.length,i=0;i<length_1;i++)events[i].callback===callback&&(events.splice(i,1),length_1--,i--);0===events.length&&delete this._events[evt]}else delete this._events[evt];else this._events={};return this},EventEmitter.prototype.getEvents=function(){return this._events},EventEmitter}()},"./node_modules/@antv/graphlib/esm/graph.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>Graph});var esm=__webpack_require__("./node_modules/@antv/event-emitter/esm/index.js");function doBFS(queue,visited,fn,navigator){for(;queue.length;){const node=queue.shift();if(fn(node))return!0;visited.add(node.id),navigator(node.id).forEach((n=>{visited.has(n.id)||(visited.add(n.id),queue.push(n))}))}return!1}function doDFS(node,visited,fn,navigator){if(fn(node))return!0;visited.add(node.id);for(const n of navigator(node.id))if(!visited.has(n.id)&&doDFS(n,visited,fn,navigator))return!0;return!1}const defaultFilter=()=>!0;class GraphView{graph;nodeFilter;edgeFilter;cacheEnabled;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;allNodesMap=new Map;allEdgesMap=new Map;constructor(options){this.graph=options.graph;const nodeFilter=options.nodeFilter||defaultFilter,edgeFilter=options.edgeFilter||defaultFilter;this.nodeFilter=nodeFilter,this.edgeFilter=edge=>{const{source,target}=this.graph.getEdgeDetail(edge.id);return!(!nodeFilter(source)||!nodeFilter(target))&&edgeFilter(edge,source,target)},"auto"===options.cache?(this.cacheEnabled=!0,this.startAutoCache()):"manual"===options.cache?this.cacheEnabled=!0:this.cacheEnabled=!1}clearCache=()=>{this.inEdgesMap.clear(),this.outEdgesMap.clear(),this.bothEdgesMap.clear(),this.allNodesMap.clear(),this.allEdgesMap.clear()};refreshCache=()=>{this.clearCache(),this.updateCache(this.graph.getAllNodes().map((node=>node.id)))};updateCache=involvedNodeIds=>{const involvedEdgeIds=new Set;involvedNodeIds.forEach((id=>{const oldEdgesSet=this.bothEdgesMap.get(id);if(oldEdgesSet&&oldEdgesSet.forEach((edge=>involvedEdgeIds.add(edge.id))),this.hasNode(id)){const inEdges=this.graph.getRelatedEdges(id,"in").filter(this.edgeFilter),outEdges=this.graph.getRelatedEdges(id,"out").filter(this.edgeFilter),bothEdges=Array.from(new Set([...inEdges,...outEdges]));bothEdges.forEach((edge=>involvedEdgeIds.add(edge.id))),this.inEdgesMap.set(id,inEdges),this.outEdgesMap.set(id,outEdges),this.bothEdgesMap.set(id,bothEdges),this.allNodesMap.set(id,this.graph.getNode(id))}else this.inEdgesMap.delete(id),this.outEdgesMap.delete(id),this.bothEdgesMap.delete(id),this.allNodesMap.delete(id)})),involvedEdgeIds.forEach((id=>{this.hasEdge(id)?this.allEdgesMap.set(id,this.graph.getEdge(id)):this.allEdgesMap.delete(id)}))};startAutoCache(){this.refreshCache(),this.graph.on("changed",this.handleGraphChanged)}stopAutoCache(){this.graph.off("changed",this.handleGraphChanged)}handleGraphChanged=event=>{const involvedNodeIds=new Set;event.changes.forEach((change=>{switch(change.type){case"NodeAdded":case"NodeRemoved":involvedNodeIds.add(change.value.id);break;case"NodeDataUpdated":involvedNodeIds.add(change.id);break;case"EdgeAdded":case"EdgeRemoved":involvedNodeIds.add(change.value.source),involvedNodeIds.add(change.value.target);break;case"EdgeUpdated":"source"!==change.propertyName&&"target"!==change.propertyName||(involvedNodeIds.add(change.oldValue),involvedNodeIds.add(change.newValue));break;case"EdgeDataUpdated":if(event.graph.hasEdge(change.id)){const edge=event.graph.getEdge(change.id);involvedNodeIds.add(edge.source),involvedNodeIds.add(edge.target)}}})),this.updateCache(involvedNodeIds)};checkNodeExistence(id){this.getNode(id)}hasNode(id){if(!this.graph.hasNode(id))return!1;const node=this.graph.getNode(id);return this.nodeFilter(node)}areNeighbors(firstNodeId,secondNodeId){return this.checkNodeExistence(firstNodeId),this.getNeighbors(secondNodeId).some((neighbor=>neighbor.id===firstNodeId))}getNode(id){const node=this.graph.getNode(id);if(!this.nodeFilter(node))throw new Error("Node not found for id: "+id);return node}getRelatedEdges(id,direction){if(this.checkNodeExistence(id),this.cacheEnabled)return"in"===direction?this.inEdgesMap.get(id):"out"===direction?this.outEdgesMap.get(id):this.bothEdgesMap.get(id);return this.graph.getRelatedEdges(id,direction).filter(this.edgeFilter)}getDegree(id,direction){return this.getRelatedEdges(id,direction).length}getSuccessors(id){const targets=this.getRelatedEdges(id,"out").map((edge=>this.getNode(edge.target)));return Array.from(new Set(targets))}getPredecessors(id){const sources=this.getRelatedEdges(id,"in").map((edge=>this.getNode(edge.source)));return Array.from(new Set(sources))}getNeighbors(id){const predecessors=this.getPredecessors(id),successors=this.getSuccessors(id);return Array.from(new Set([...predecessors,...successors]))}hasEdge(id){if(!this.graph.hasEdge(id))return!1;const edge=this.graph.getEdge(id);return this.edgeFilter(edge)}getEdge(id){const edge=this.graph.getEdge(id);if(!this.edgeFilter(edge))throw new Error("Edge not found for id: "+id);return edge}getEdgeDetail(id){const edge=this.getEdge(id);return{edge,source:this.getNode(edge.source),target:this.getNode(edge.target)}}hasTreeStructure(treeKey){return this.graph.hasTreeStructure(treeKey)}getRoots(treeKey){return this.graph.getRoots(treeKey).filter(this.nodeFilter)}getChildren(id,treeKey){return this.checkNodeExistence(id),this.graph.getChildren(id,treeKey).filter(this.nodeFilter)}getParent(id,treeKey){this.checkNodeExistence(id);const parent=this.graph.getParent(id,treeKey);return parent&&this.nodeFilter(parent)?parent:null}getAllNodes(){return this.cacheEnabled?Array.from(this.allNodesMap.values()):this.graph.getAllNodes().filter(this.nodeFilter)}getAllEdges(){return this.cacheEnabled?Array.from(this.allEdgesMap.values()):this.graph.getAllEdges().filter(this.edgeFilter)}bfs(id,fn,direction="out"){const navigator={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[direction];doBFS([this.getNode(id)],new Set,fn,navigator)}dfs(id,fn,direction="out"){const navigator={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[direction];doDFS(this.getNode(id),new Set,fn,navigator)}}class Graph extends esm.c{nodeMap=new Map;edgeMap=new Map;inEdgesMap=new Map;outEdgesMap=new Map;bothEdgesMap=new Map;treeIndices=new Map;changes=[];batchCount=0;onChanged=()=>{};constructor(options){super(),options&&(options.nodes&&this.addNodes(options.nodes),options.edges&&this.addEdges(options.edges),options.tree&&this.addTree(options.tree),options.onChanged&&(this.onChanged=options.onChanged))}batch=fn=>{this.batchCount+=1,fn(),this.batchCount-=1,this.batchCount||this.commit()};commit(){const changes=this.changes;this.changes=[];const event={graph:this,changes};this.emit("changed",event),this.onChanged(event)}reduceChanges(changes){let mergedChanges=[];return changes.forEach((change=>{switch(change.type){case"NodeRemoved":{let isNewlyAdded=!1;mergedChanges=mergedChanges.filter((pastChange=>{if("NodeAdded"===pastChange.type){const sameId=pastChange.value.id===change.value.id;return sameId&&(isNewlyAdded=!0),!sameId}return"NodeDataUpdated"===pastChange.type?pastChange.id!==change.value.id:"TreeStructureChanged"!==pastChange.type||pastChange.nodeId!==change.value.id})),isNewlyAdded||mergedChanges.push(change);break}case"EdgeRemoved":{let isNewlyAdded=!1;mergedChanges=mergedChanges.filter((pastChange=>{if("EdgeAdded"===pastChange.type){const sameId=pastChange.value.id===change.value.id;return sameId&&(isNewlyAdded=!0),!sameId}return"EdgeDataUpdated"!==pastChange.type&&"EdgeUpdated"!==pastChange.type||pastChange.id!==change.value.id})),isNewlyAdded||mergedChanges.push(change);break}case"NodeDataUpdated":case"EdgeDataUpdated":case"EdgeUpdated":{const index=mergedChanges.findIndex((pastChange=>pastChange.type===change.type&&pastChange.id===change.id&&(void 0===change.propertyName||pastChange.propertyName===change.propertyName))),existingChange=mergedChanges[index];existingChange?void 0!==change.propertyName?existingChange.newValue=change.newValue:(mergedChanges.splice(index,1),mergedChanges.push(change)):mergedChanges.push(change);break}case"TreeStructureDetached":mergedChanges=mergedChanges.filter((pastChange=>"TreeStructureAttached"===pastChange.type?pastChange.treeKey!==change.treeKey:"TreeStructureChanged"!==pastChange.type||pastChange.treeKey!==change.treeKey)),mergedChanges.push(change);break;case"TreeStructureChanged":{const existingChange=mergedChanges.find((pastChange=>"TreeStructureChanged"===pastChange.type&&pastChange.treeKey===change.treeKey&&pastChange.nodeId===change.nodeId));existingChange?existingChange.newParentId=change.newParentId:mergedChanges.push(change);break}default:mergedChanges.push(change)}})),mergedChanges}checkNodeExistence(id){this.getNode(id)}hasNode(id){return this.nodeMap.has(id)}areNeighbors(firstNodeId,secondNodeId){return this.getNeighbors(secondNodeId).some((neighbor=>neighbor.id===firstNodeId))}getNode(id){const node=this.nodeMap.get(id);if(!node)throw new Error("Node not found for id: "+id);return node}getRelatedEdges(id,direction){if(this.checkNodeExistence(id),"in"===direction){const inEdges=this.inEdgesMap.get(id);return Array.from(inEdges)}if("out"===direction){const outEdges=this.outEdgesMap.get(id);return Array.from(outEdges)}{const bothEdges=this.bothEdgesMap.get(id);return Array.from(bothEdges)}}getDegree(id,direction){return this.getRelatedEdges(id,direction).length}getSuccessors(id){const targets=this.getRelatedEdges(id,"out").map((edge=>this.getNode(edge.target)));return Array.from(new Set(targets))}getPredecessors(id){const sources=this.getRelatedEdges(id,"in").map((edge=>this.getNode(edge.source)));return Array.from(new Set(sources))}getNeighbors(id){const predecessors=this.getPredecessors(id),successors=this.getSuccessors(id);return Array.from(new Set([...predecessors,...successors]))}doAddNode(node){if(this.hasNode(node.id))throw new Error("Node already exists: "+node.id);this.nodeMap.set(node.id,node),this.inEdgesMap.set(node.id,new Set),this.outEdgesMap.set(node.id,new Set),this.bothEdgesMap.set(node.id,new Set),this.treeIndices.forEach((tree=>{tree.childrenMap.set(node.id,new Set)})),this.changes.push({type:"NodeAdded",value:node})}addNodes(nodes){this.batch((()=>{for(const node of nodes)this.doAddNode(node)}))}addNode(node){this.addNodes([node])}doRemoveNode(id){const node=this.getNode(id),bothEdges=this.bothEdgesMap.get(id);bothEdges?.forEach((edge=>this.doRemoveEdge(edge.id))),this.nodeMap.delete(id),this.treeIndices.forEach((tree=>{tree.childrenMap.get(id)?.forEach((child=>{tree.parentMap.delete(child.id)})),tree.parentMap.delete(id),tree.childrenMap.delete(id)})),this.changes.push({type:"NodeRemoved",value:node})}removeNodes(idList){this.batch((()=>{idList.forEach((id=>this.doRemoveNode(id)))}))}removeNode(id){this.removeNodes([id])}updateNodeDataProperty(id,propertyName,value){const node=this.getNode(id);this.batch((()=>{const oldValue=node.data[propertyName],newValue=value;node.data[propertyName]=newValue,this.changes.push({type:"NodeDataUpdated",id,propertyName,oldValue,newValue})}))}mergeNodeData(id,patch){this.batch((()=>{Object.entries(patch).forEach((([propertyName,value])=>{this.updateNodeDataProperty(id,propertyName,value)}))}))}updateNodeData(...args){const id=args[0],node=this.getNode(id);if("string"==typeof args[1])return void this.updateNodeDataProperty(id,args[1],args[2]);let data;if("function"==typeof args[1]){const update=args[1];data=update(node.data)}else"object"==typeof args[1]&&(data=args[1]);this.batch((()=>{const oldValue=node.data,newValue=data;node.data=data,this.changes.push({type:"NodeDataUpdated",id,oldValue,newValue})}))}checkEdgeExistence(id){if(!this.hasEdge(id))throw new Error("Edge not found for id: "+id)}hasEdge(id){return this.edgeMap.has(id)}getEdge(id){return this.checkEdgeExistence(id),this.edgeMap.get(id)}getEdgeDetail(id){const edge=this.getEdge(id);return{edge,source:this.getNode(edge.source),target:this.getNode(edge.target)}}doAddEdge(edge){if(this.hasEdge(edge.id))throw new Error("Edge already exists: "+edge.id);this.checkNodeExistence(edge.source),this.checkNodeExistence(edge.target),this.edgeMap.set(edge.id,edge);const inEdges=this.inEdgesMap.get(edge.target),outEdges=this.outEdgesMap.get(edge.source),bothEdgesOfSource=this.bothEdgesMap.get(edge.source),bothEdgesOfTarget=this.bothEdgesMap.get(edge.target);inEdges.add(edge),outEdges.add(edge),bothEdgesOfSource.add(edge),bothEdgesOfTarget.add(edge),this.changes.push({type:"EdgeAdded",value:edge})}addEdges(edges){this.batch((()=>{for(const edge of edges)this.doAddEdge(edge)}))}addEdge(edge){this.addEdges([edge])}doRemoveEdge(id){const edge=this.getEdge(id),outEdges=this.outEdgesMap.get(edge.source),inEdges=this.inEdgesMap.get(edge.target),bothEdgesOfSource=this.bothEdgesMap.get(edge.source),bothEdgesOfTarget=this.bothEdgesMap.get(edge.target);outEdges.delete(edge),inEdges.delete(edge),bothEdgesOfSource.delete(edge),bothEdgesOfTarget.delete(edge),this.edgeMap.delete(id),this.changes.push({type:"EdgeRemoved",value:edge})}removeEdges(idList){this.batch((()=>{idList.forEach((id=>this.doRemoveEdge(id)))}))}removeEdge(id){this.removeEdges([id])}updateEdgeSource(id,source){const edge=this.getEdge(id);this.checkNodeExistence(source);const oldSource=edge.source,newSource=source;this.outEdgesMap.get(oldSource).delete(edge),this.bothEdgesMap.get(oldSource).delete(edge),this.outEdgesMap.get(newSource).add(edge),this.bothEdgesMap.get(newSource).add(edge),edge.source=source,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id,propertyName:"source",oldValue:oldSource,newValue:newSource})}))}updateEdgeTarget(id,target){const edge=this.getEdge(id);this.checkNodeExistence(target);const oldTarget=edge.target,newTarget=target;this.inEdgesMap.get(oldTarget).delete(edge),this.bothEdgesMap.get(oldTarget).delete(edge),this.inEdgesMap.get(newTarget).add(edge),this.bothEdgesMap.get(newTarget).add(edge),edge.target=target,this.batch((()=>{this.changes.push({type:"EdgeUpdated",id,propertyName:"target",oldValue:oldTarget,newValue:newTarget})}))}updateEdgeDataProperty(id,propertyName,value){const edge=this.getEdge(id);this.batch((()=>{const oldValue=edge.data[propertyName],newValue=value;edge.data[propertyName]=newValue,this.changes.push({type:"EdgeDataUpdated",id,propertyName,oldValue,newValue})}))}updateEdgeData(...args){const id=args[0],edge=this.getEdge(id);if("string"==typeof args[1])return void this.updateEdgeDataProperty(id,args[1],args[2]);let data;if("function"==typeof args[1]){const update=args[1];data=update(edge.data)}else"object"==typeof args[1]&&(data=args[1]);this.batch((()=>{const oldValue=edge.data,newValue=data;edge.data=data,this.changes.push({type:"EdgeDataUpdated",id,oldValue,newValue})}))}mergeEdgeData(id,patch){this.batch((()=>{Object.entries(patch).forEach((([propertyName,value])=>{this.updateEdgeDataProperty(id,propertyName,value)}))}))}checkTreeExistence(treeKey){if(!this.hasTreeStructure(treeKey))throw new Error("Tree structure not found for treeKey: "+treeKey)}hasTreeStructure(treeKey){return this.treeIndices.has(treeKey)}attachTreeStructure(treeKey){this.treeIndices.has(treeKey)||(this.treeIndices.set(treeKey,{parentMap:new Map,childrenMap:new Map}),this.batch((()=>{this.changes.push({type:"TreeStructureAttached",treeKey})})))}detachTreeStructure(treeKey){this.checkTreeExistence(treeKey),this.treeIndices.delete(treeKey),this.batch((()=>{this.changes.push({type:"TreeStructureDetached",treeKey})}))}addTree(tree,treeKey){this.batch((()=>{this.attachTreeStructure(treeKey);const nodes=[],stack=Array.isArray(tree)?tree:[tree];for(;stack.length;){const node=stack.shift();nodes.push(node),node.children&&stack.push(...node.children)}this.addNodes(nodes),nodes.forEach((parent=>{parent.children?.forEach((child=>{this.setParent(child.id,parent.id,treeKey)}))}))}))}getRoots(treeKey){return this.checkTreeExistence(treeKey),this.getAllNodes().filter((node=>!this.getParent(node.id,treeKey)))}getChildren(id,treeKey){this.checkNodeExistence(id),this.checkTreeExistence(treeKey);const children=this.treeIndices.get(treeKey).childrenMap.get(id);return Array.from(children||[])}getParent(id,treeKey){this.checkNodeExistence(id),this.checkTreeExistence(treeKey);return this.treeIndices.get(treeKey).parentMap.get(id)||null}getAncestors(id,treeKey){const ancestors=[];let parent,current=this.getNode(id);for(;parent=this.getParent(current.id,treeKey);)ancestors.push(parent),current=parent;return ancestors}setParent(id,parent,treeKey){this.checkTreeExistence(treeKey);const tree=this.treeIndices.get(treeKey),node=this.getNode(id),oldParent=tree.parentMap.get(id);if(oldParent?.id===parent)return;if(void 0===parent)return oldParent&&tree.childrenMap.get(oldParent.id)?.delete(node),void tree.parentMap.delete(id);const newParent=this.getNode(parent);tree.parentMap.set(id,newParent),oldParent&&tree.childrenMap.get(oldParent.id)?.delete(node);let children=tree.childrenMap.get(newParent.id);children||(children=new Set,tree.childrenMap.set(newParent.id,children)),children.add(node),this.batch((()=>{this.changes.push({type:"TreeStructureChanged",treeKey,nodeId:id,oldParentId:oldParent?.id,newParentId:newParent.id})}))}dfsTree(id,fn,treeKey){return doDFS(this.getNode(id),new Set,fn,(nodeId=>this.getChildren(nodeId,treeKey)))}bfsTree(id,fn,treeKey){return doBFS([this.getNode(id)],new Set,fn,(nodeId=>this.getChildren(nodeId,treeKey)))}getAllNodes(){return Array.from(this.nodeMap.values())}getAllEdges(){return Array.from(this.edgeMap.values())}bfs(id,fn,direction="out"){const navigator={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[direction];return doBFS([this.getNode(id)],new Set,fn,navigator)}dfs(id,fn,direction="out"){const navigator={in:this.getPredecessors.bind(this),out:this.getSuccessors.bind(this),both:this.getNeighbors.bind(this)}[direction];return doDFS(this.getNode(id),new Set,fn,navigator)}clone(){const newNodes=this.getAllNodes().map((oldNode=>({...oldNode,data:{...oldNode.data}}))),newEdges=this.getAllEdges().map((oldEdge=>({...oldEdge,data:{...oldEdge.data}}))),newGraph=new Graph({nodes:newNodes,edges:newEdges});return this.treeIndices.forEach((({parentMap:oldParentMap,childrenMap:oldChildrenMap},treeKey)=>{const parentMap=new Map;oldParentMap.forEach(((parent,key)=>{parentMap.set(key,newGraph.getNode(parent.id))}));const childrenMap=new Map;oldChildrenMap.forEach(((children,key)=>{childrenMap.set(key,new Set(Array.from(children).map((n=>newGraph.getNode(n.id)))))})),newGraph.treeIndices.set(treeKey,{parentMap,childrenMap})})),newGraph}toJSON(){return JSON.stringify({nodes:this.getAllNodes(),edges:this.getAllEdges()})}createView(options){return new GraphView({graph:this,...options})}}},"./node_modules/@antv/layout/lib/circular.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>CircularLayout});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@antv/layout/lib/util/function.js"),_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@antv/layout/lib/util/object.js"),_util_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@antv/layout/lib/util/common.js"),DEFAULTS_LAYOUT_OPTIONS={radius:null,startRadius:null,endRadius:null,startAngle:0,endAngle:2*Math.PI,clockwise:!0,divisions:1,ordering:null,angleRatio:1},CircularLayout=function(){function CircularLayout(options){void 0===options&&(options={}),this.options=options,this.id="circular",this.options=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return CircularLayout.prototype.execute=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return[2,this.genericCircularLayout(!1,graph,options)]}))}))},CircularLayout.prototype.assign=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){switch(_a.label){case 0:return[4,this.genericCircularLayout(!0,graph,options)];case 1:return _a.sent(),[2]}}))}))},CircularLayout.prototype.genericCircularLayout=function(assign,graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){var mergedOptions,width,height,center,divisions,_a,startAngle,_b,endAngle,angleRatio,ordering,clockwise,paramNodeSpacing,paramNodeSize,nodes,edges,_c,calculatedWidth,calculatedHeight,calculatedCenter,n,angleStep,radius,startRadius,endRadius,nodeSpacing_1,nodeSize_1,maxNodeSize_1,perimeter_1,astep,layoutNodes,divN,i,r,angle;return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_d){if(mergedOptions=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},this.options),options),width=mergedOptions.width,height=mergedOptions.height,center=mergedOptions.center,divisions=mergedOptions.divisions,_a=mergedOptions.startAngle,startAngle=void 0===_a?0:_a,_b=mergedOptions.endAngle,endAngle=void 0===_b?2*Math.PI:_b,angleRatio=mergedOptions.angleRatio,ordering=mergedOptions.ordering,clockwise=mergedOptions.clockwise,paramNodeSpacing=mergedOptions.nodeSpacing,paramNodeSize=mergedOptions.nodeSize,nodes=graph.getAllNodes(),edges=graph.getAllEdges(),_c=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.o5)(calculateCenter(width,height,center),3),calculatedWidth=_c[0],calculatedHeight=_c[1],calculatedCenter=_c[2],!(n=null==nodes?void 0:nodes.length)||1===n)return[2,(0,_util_common__WEBPACK_IMPORTED_MODULE_1__.s)(graph,assign,calculatedCenter)];for(angleStep=(endAngle-startAngle)/n,radius=mergedOptions.radius,startRadius=mergedOptions.startRadius,endRadius=mergedOptions.endRadius,paramNodeSpacing?(nodeSpacing_1=(0,_util__WEBPACK_IMPORTED_MODULE_2__.uA)(10,paramNodeSpacing),nodeSize_1=(0,_util__WEBPACK_IMPORTED_MODULE_2__.Gy)(10,paramNodeSize),maxNodeSize_1=-1/0,nodes.forEach((function(node){var nSize=nodeSize_1(node);maxNodeSize_1<nSize&&(maxNodeSize_1=nSize)})),perimeter_1=0,nodes.forEach((function(node,i){perimeter_1+=0===i?maxNodeSize_1||10:(nodeSpacing_1(node)||0)+(maxNodeSize_1||10)})),radius=perimeter_1/(2*Math.PI)):radius||startRadius||endRadius?!startRadius&&endRadius?startRadius=endRadius:startRadius&&!endRadius&&(endRadius=startRadius):radius=Math.min(calculatedHeight,calculatedWidth)/2,astep=angleStep*angleRatio,layoutNodes=[],layoutNodes="topology"===ordering?topologyOrdering(graph,nodes):"topology-directed"===ordering?topologyOrdering(graph,nodes,!0):"degree"===ordering?function degreeOrdering(graph,nodes){var orderedNodes=[];return nodes.forEach((function(node,i){orderedNodes.push((0,_util__WEBPACK_IMPORTED_MODULE_3__.o)(node))})),orderedNodes.sort((function(nodeA,nodeB){return graph.getDegree(nodeA.id,"both")-graph.getDegree(nodeB.id,"both")})),orderedNodes}(graph,nodes):nodes.map((function(node){return(0,_util__WEBPACK_IMPORTED_MODULE_3__.o)(node)})),divN=Math.ceil(n/divisions),i=0;i<n;++i)(r=radius)||null===startRadius||null===endRadius||(r=startRadius+i*(endRadius-startRadius)/(n-1)),r||(r=10+100*i/(n-1)),angle=startAngle+i%divN*astep+2*Math.PI/divisions*Math.floor(i/divN),clockwise||(angle=endAngle-i%divN*astep-2*Math.PI/divisions*Math.floor(i/divN)),layoutNodes[i].data.x=calculatedCenter[0]+Math.cos(angle)*r,layoutNodes[i].data.y=calculatedCenter[1]+Math.sin(angle)*r;return assign&&layoutNodes.forEach((function(node){graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),[2,{nodes:layoutNodes,edges}]}))}))},CircularLayout}(),topologyOrdering=function(graph,nodes,directed){void 0===directed&&(directed=!1);var orderedCNodes=[(0,_util__WEBPACK_IMPORTED_MODULE_3__.o)(nodes[0])],pickFlags={},n=nodes.length;pickFlags[nodes[0].id]=!0;var k=0;return nodes.forEach((function(node,i){if(0!==i)if(i!==n-1&&graph.getDegree(node.id,"both")===graph.getDegree(nodes[i+1].id,"both")&&!graph.areNeighbors(orderedCNodes[k].id,node.id)||pickFlags[node.id]){for(var children=directed?graph.getSuccessors(orderedCNodes[k].id):graph.getNeighbors(orderedCNodes[k].id),foundChild=!1,j=0;j<children.length;j++){var child=children[j];if(graph.getDegree(child.id)===graph.getDegree(node.id)&&!pickFlags[child.id]){orderedCNodes.push((0,_util__WEBPACK_IMPORTED_MODULE_3__.o)(child)),pickFlags[child.id]=!0,foundChild=!0;break}}for(var ii=0;!foundChild&&(pickFlags[nodes[ii].id]||(orderedCNodes.push((0,_util__WEBPACK_IMPORTED_MODULE_3__.o)(nodes[ii])),pickFlags[nodes[ii].id]=!0,foundChild=!0),++ii!==n););}else orderedCNodes.push((0,_util__WEBPACK_IMPORTED_MODULE_3__.o)(node)),pickFlags[node.id]=!0,k++})),orderedCNodes};var calculateCenter=function(width,height,center){var calculatedWidth=width,calculatedHeight=height,calculatedCenter=center;return calculatedWidth||"undefined"==typeof window||(calculatedWidth=window.innerWidth),calculatedHeight||"undefined"==typeof window||(calculatedHeight=window.innerHeight),calculatedCenter||(calculatedCenter=[calculatedWidth/2,calculatedHeight/2]),[calculatedWidth,calculatedHeight,calculatedCenter]}},"./node_modules/@antv/layout/lib/comboCombined.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{w:()=>ComboCombinedLayout});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_antv_util__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),_antv_util__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-function.js"),_antv_util__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-object.js"),_antv_graphlib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@antv/graphlib/esm/graph.js"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@antv/layout/lib/util/math.js"),_util__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@antv/layout/lib/util/array.js"),_util_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@antv/layout/lib/util/common.js"),_mds__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@antv/layout/lib/mds.js"),_force__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@antv/layout/lib/force/index.js"),_concentric__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@antv/layout/lib/concentric.js"),FORCE_LAYOUT_TYPE_MAP={gForce:!0,force2:!0,d3force:!0,fruchterman:!0,forceAtlas2:!0,force:!0,"graphin-force":!0},DEFAULTS_LAYOUT_OPTIONS={center:[0,0],comboPadding:10,treeKey:"combo"},ComboCombinedLayout=function(){function ComboCombinedLayout(options){void 0===options&&(options={}),this.options=options,this.id="comboCombined",this.options=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return ComboCombinedLayout.prototype.execute=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return[2,this.genericComboCombinedLayout(!1,graph,options)]}))}))},ComboCombinedLayout.prototype.assign=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){switch(_a.label){case 0:return[4,this.genericComboCombinedLayout(!0,graph,options)];case 1:return _a.sent(),[2]}}))}))},ComboCombinedLayout.prototype.genericComboCombinedLayout=function(assign,graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){var mergedOptions,center,treeKey,propsOuterLayout,nodes,combos,edges,n,layoutNodes,nodeMap,comboMap,comboNodes,innerGraphLayoutPromises,outerNodeIds,outerLayoutNodes,nodeAncestorIdMap,allHaveNoPosition,outerLayoutEdges,outerPositions,outerLayoutGraph,outerLayout;return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){switch(_a.label){case 0:return mergedOptions=this.initVals((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},this.options),options)),center=mergedOptions.center,treeKey=mergedOptions.treeKey,propsOuterLayout=mergedOptions.outerLayout,nodes=graph.getAllNodes().filter((function(node){return!node.data._isCombo})),combos=graph.getAllNodes().filter((function(node){return node.data._isCombo})),edges=graph.getAllEdges(),(n=null==nodes?void 0:nodes.length)&&1!==n?(layoutNodes=[],nodeMap=new Map,nodes.forEach((function(node){nodeMap.set(node.id,node)})),comboMap=new Map,combos.forEach((function(combo){comboMap.set(combo.id,combo)})),comboNodes=new Map,innerGraphLayoutPromises=this.getInnerGraphs(graph,treeKey,nodeMap,comboMap,edges,mergedOptions,comboNodes),[4,Promise.all(innerGraphLayoutPromises)]):[2,(0,_util_common__WEBPACK_IMPORTED_MODULE_1__.s)(graph,assign,center)];case 1:return _a.sent(),outerNodeIds=new Map,outerLayoutNodes=[],nodeAncestorIdMap=new Map,allHaveNoPosition=!0,graph.getRoots(treeKey).forEach((function(root){var combo=comboNodes.get(root.id),cacheCombo=comboMap.get(root.id)||nodeMap.get(root.id),comboLayoutNode={id:root.id,data:(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},root.data),{x:combo.data.x||cacheCombo.data.x,y:combo.data.y||cacheCombo.data.y,fx:combo.data.fx||cacheCombo.data.fx,fy:combo.data.fy||cacheCombo.data.fy,mass:combo.data.mass||cacheCombo.data.mass,size:combo.data.size})};outerLayoutNodes.push(comboLayoutNode),outerNodeIds.set(root.id,!0),isNaN(comboLayoutNode.data.x)||0===comboLayoutNode.data.x||isNaN(comboLayoutNode.data.y)||0===comboLayoutNode.data.y?(comboLayoutNode.data.x=100*Math.random(),comboLayoutNode.data.y=100*Math.random()):allHaveNoPosition=!1,(0,_util__WEBPACK_IMPORTED_MODULE_2__.wV)(graph,[root],(function(child){child.id!==root.id&&nodeAncestorIdMap.set(child.id,root.id)}),"TB",treeKey)})),outerLayoutEdges=[],edges.forEach((function(edge){var sourceAncestorId=nodeAncestorIdMap.get(edge.source)||edge.source,targetAncestorId=nodeAncestorIdMap.get(edge.target)||edge.target;sourceAncestorId!==targetAncestorId&&outerNodeIds.has(sourceAncestorId)&&outerNodeIds.has(targetAncestorId)&&outerLayoutEdges.push({id:edge.id,source:sourceAncestorId,target:targetAncestorId,data:{}})})),(null==outerLayoutNodes?void 0:outerLayoutNodes.length)?1!==outerLayoutNodes.length?[3,2]:(outerLayoutNodes[0].data.x=center[0],outerLayoutNodes[0].data.y=center[1],[3,6]):[3,7];case 2:return outerLayoutGraph=new _antv_graphlib__WEBPACK_IMPORTED_MODULE_3__.M({nodes:outerLayoutNodes,edges:outerLayoutEdges}),outerLayout=propsOuterLayout||new _force__WEBPACK_IMPORTED_MODULE_4__.k,allHaveNoPosition&&FORCE_LAYOUT_TYPE_MAP[outerLayout.id]?[4,(outerLayoutNodes.length<100?new _mds__WEBPACK_IMPORTED_MODULE_5__.M:new _concentric__WEBPACK_IMPORTED_MODULE_6__.K).assign(outerLayoutGraph)]:[3,4];case 3:_a.sent(),_a.label=4;case 4:return[4,outerLayout.execute(outerLayoutGraph,(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({center,kg:5,preventOverlap:!0,animate:!1},"force"===outerLayout.id?{gravity:1,factor:4,linkDistance:function(edge,source,target){return(Math.max.apply(Math,(0,tslib__WEBPACK_IMPORTED_MODULE_0__.Mt)([],(0,tslib__WEBPACK_IMPORTED_MODULE_0__.o5)(source.data.size)))||32)/2+(Math.max.apply(Math,(0,tslib__WEBPACK_IMPORTED_MODULE_0__.Mt)([],(0,tslib__WEBPACK_IMPORTED_MODULE_0__.o5)(target.data.size)))||32)/2+200}}:{}))];case 5:outerPositions=_a.sent(),_a.label=6;case 6:comboNodes.forEach((function(comboNode){var _a,outerPosition=outerPositions.nodes.find((function(pos){return pos.id===comboNode.id}));if(outerPosition){var _b=outerPosition.data,x_1=_b.x,y_1=_b.y;comboNode.data.visited=!0,comboNode.data.x=x_1,comboNode.data.y=y_1,layoutNodes.push({id:comboNode.id,data:{x:x_1,y:y_1}})}var _c=comboNode.data,x=_c.x,y=_c.y;null===(_a=comboNode.data.nodes)||void 0===_a||_a.forEach((function(node){layoutNodes.push({id:node.id,data:{x:node.data.x+x,y:node.data.y+y}})}))})),comboNodes.forEach((function(_a){var _b,data=_a.data,x=data.x,y=data.y,visited=data.visited;null===(_b=data.nodes)||void 0===_b||_b.forEach((function(node){if(!visited){var layoutNode=layoutNodes.find((function(n){return n.id===node.id}));layoutNode.data.x+=x||0,layoutNode.data.y+=y||0}}))})),_a.label=7;case 7:return assign&&layoutNodes.forEach((function(node){graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),[2,{nodes:layoutNodes,edges}]}}))}))},ComboCombinedLayout.prototype.initVals=function(options){var nodeSizeFunc,spacingFunc,comboPaddingFunc,formattedOptions=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},options),nodeSize=options.nodeSize,spacing=options.spacing,comboPadding=options.comboPadding;if(spacingFunc=(0,_antv_util__WEBPACK_IMPORTED_MODULE_7__.c)(spacing)?function(){return spacing}:(0,_antv_util__WEBPACK_IMPORTED_MODULE_8__.c)(spacing)?spacing:function(){return 0},formattedOptions.spacing=spacingFunc,nodeSize)if((0,_antv_util__WEBPACK_IMPORTED_MODULE_8__.c)(nodeSize))nodeSizeFunc=function(d){var size=nodeSize(d),spacing=spacingFunc(d);return(0,_util__WEBPACK_IMPORTED_MODULE_9__.c)(d.size)?((d.size[0]>d.size[1]?d.size[0]:d.size[1])+spacing)/2:((size||32)+spacing)/2};else if((0,_util__WEBPACK_IMPORTED_MODULE_9__.c)(nodeSize)){var radius_1=(nodeSize[0]>nodeSize[1]?nodeSize[0]:nodeSize[1])/2;nodeSizeFunc=function(d){return radius_1+spacingFunc(d)/2}}else{var radius_2=nodeSize/2;nodeSizeFunc=function(d){return radius_2+spacingFunc(d)/2}}else nodeSizeFunc=function(d){var spacing=spacingFunc(d);return d.size?(0,_util__WEBPACK_IMPORTED_MODULE_9__.c)(d.size)?((d.size[0]>d.size[1]?d.size[0]:d.size[1])+spacing)/2:(0,_antv_util__WEBPACK_IMPORTED_MODULE_10__.c)(d.size)?((d.size.width>d.size.height?d.size.width:d.size.height)+spacing)/2:(d.size+spacing)/2:32+spacing/2};return formattedOptions.nodeSize=nodeSizeFunc,comboPaddingFunc=(0,_antv_util__WEBPACK_IMPORTED_MODULE_7__.c)(comboPadding)?function(){return comboPadding}:(0,_util__WEBPACK_IMPORTED_MODULE_9__.c)(comboPadding)?function(){return Math.max.apply(null,comboPadding)}:(0,_antv_util__WEBPACK_IMPORTED_MODULE_8__.c)(comboPadding)?comboPadding:function(){return 0},formattedOptions.comboPadding=comboPaddingFunc,formattedOptions},ComboCombinedLayout.prototype.getInnerGraphs=function(graph,treeKey,nodeMap,comboMap,edges,options,comboNodes){var _this=this,nodeSize=options.nodeSize,comboPadding=options.comboPadding,spacing=options.spacing,innerGraphLayout=options.innerLayout||new _concentric__WEBPACK_IMPORTED_MODULE_6__.K({}),innerLayoutOptions={center:[0,0],preventOverlap:!0,nodeSpacing:spacing},innerLayoutPromises=[],getSize=function(node){var padding=(null==comboPadding?void 0:comboPadding(node))||10;return(0,_util__WEBPACK_IMPORTED_MODULE_9__.c)(padding)&&(padding=Math.max.apply(Math,(0,tslib__WEBPACK_IMPORTED_MODULE_0__.Mt)([],(0,tslib__WEBPACK_IMPORTED_MODULE_0__.o5)(padding)))),{size:padding?[2*padding,2*padding]:[30,30],padding}};return graph.getRoots(treeKey).forEach((function(root){comboNodes.set(root.id,{id:root.id,data:{nodes:[],size:getSize(root).size}});var start=Promise.resolve();(0,_util__WEBPACK_IMPORTED_MODULE_2__.wV)(graph,[root],(function(treeNode){var _a;if(treeNode.data._isCombo){var _b=getSize(treeNode),nsize=_b.size,padding=_b.padding;if(null===(_a=graph.getChildren(treeNode.id,treeKey))||void 0===_a?void 0:_a.length){var comboNode=comboNodes.get(treeNode.id);comboNodes.set(treeNode.id,{id:treeNode.id,data:(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({nodes:[]},null==comboNode?void 0:comboNode.data)});var innerLayoutNodeIds_1=new Map,innerLayoutNodes_1=graph.getChildren(treeNode.id,treeKey).map((function(child){if(child.data._isCombo)return comboNodes.has(child.id)||comboNodes.set(child.id,{id:child.id,data:(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},child.data)}),innerLayoutNodeIds_1.set(child.id,!0),comboNodes.get(child.id);var oriNode=nodeMap.get(child.id)||comboMap.get(child.id);return innerLayoutNodeIds_1.set(child.id,!0),{id:child.id,data:(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},oriNode.data),child.data)}})),innerGraphData_1={nodes:innerLayoutNodes_1,edges:edges.filter((function(edge){return innerLayoutNodeIds_1.has(edge.source)&&innerLayoutNodeIds_1.has(edge.target)}))},minNodeSize_1=1/0;innerLayoutNodes_1.forEach((function(node){var _a,_b,size=node.data.size;size||(size=(null===(_a=comboNodes.get(node.id))||void 0===_a?void 0:_a.data.size)||(null===(_b=nodeSize)||void 0===_b?void 0:_b(node))||[30,30]),(0,_antv_util__WEBPACK_IMPORTED_MODULE_7__.c)(size)&&(size=[size,size]);var _c=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.o5)(size,2),size0=_c[0],size1=_c[1];minNodeSize_1>size0&&(minNodeSize_1=size0),minNodeSize_1>size1&&(minNodeSize_1=size1),node.data.size=size})),start=start.then((function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(_this,void 0,void 0,(function(){var innerGraphCore,innerLayout,_a,minX,minY,maxX,maxY,center,size;return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_b){switch(_b.label){case 0:return innerGraphCore=new _antv_graphlib__WEBPACK_IMPORTED_MODULE_3__.M(innerGraphData_1),[4,innerGraphLayout.assign(innerGraphCore,innerLayoutOptions)];case 1:return innerLayout=_b.sent(),_a=(0,_util__WEBPACK_IMPORTED_MODULE_2__.C2)(innerLayoutNodes_1),minX=_a.minX,minY=_a.minY,maxX=_a.maxX,maxY=_a.maxY,center={x:(maxX+minX)/2,y:(maxY+minY)/2},innerGraphData_1.nodes.forEach((function(node){node.data.x-=center.x,node.data.y-=center.y})),size=[Math.max(maxX-minX,minNodeSize_1)+2*padding,Math.max(maxY-minY,minNodeSize_1)+2*padding],comboNodes.get(treeNode.id).data.size=size,comboNodes.get(treeNode.id).data.nodes=innerLayoutNodes_1,[2,innerLayout]}}))}))}))}else comboNodes.set(treeNode.id,{id:treeNode.id,data:(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},treeNode.data),{size:nsize})});return!0}}),"BT",treeKey),innerLayoutPromises.push(start)})),innerLayoutPromises},ComboCombinedLayout}()},"./node_modules/@antv/layout/lib/concentric.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{K:()=>ConcentricLayout});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_antv_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-function.js"),_antv_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),_antv_util__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-object.js"),_antv_util__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-string.js"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@antv/layout/lib/util/array.js"),_util__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@antv/layout/lib/util/object.js"),_util_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@antv/layout/lib/util/common.js"),DEFAULTS_LAYOUT_OPTIONS={nodeSize:30,nodeSpacing:10,preventOverlap:!1,sweep:void 0,equidistant:!1,startAngle:1.5*Math.PI,clockwise:!0,maxLevelDiff:void 0,sortBy:"degree"},ConcentricLayout=function(){function ConcentricLayout(options){void 0===options&&(options={}),this.options=options,this.id="concentric",this.options=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return ConcentricLayout.prototype.execute=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return[2,this.genericConcentricLayout(!1,graph,options)]}))}))},ConcentricLayout.prototype.assign=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return this.genericConcentricLayout(!0,graph,options),[2]}))}))},ConcentricLayout.prototype.genericConcentricLayout=function(assign,graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){var mergedOptions,propsCenter,propsWidth,propsHeight,propsSortBy,propsMaxLevelDiff,propsSweep,clockwise,equidistant,preventOverlap,_a,startAngle,nodeSize,nodeSpacing,nodes,edges,width,height,center,layoutNodes,maxNodeSize,maxNodeSpacing,nodeIdxMap,sortBy,maxValueNode,maxLevelDiff,levels,currentLevel,minDist,firstLvlHasMulti,maxR,rStep,r,rDeltaMax_1,rr_1,i,level,rDelta;return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_b){if(mergedOptions=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},this.options),options),propsCenter=mergedOptions.center,propsWidth=mergedOptions.width,propsHeight=mergedOptions.height,propsSortBy=mergedOptions.sortBy,propsMaxLevelDiff=mergedOptions.maxLevelDiff,propsSweep=mergedOptions.sweep,clockwise=mergedOptions.clockwise,equidistant=mergedOptions.equidistant,preventOverlap=mergedOptions.preventOverlap,_a=mergedOptions.startAngle,startAngle=void 0===_a?1.5*Math.PI:_a,nodeSize=mergedOptions.nodeSize,nodeSpacing=mergedOptions.nodeSpacing,nodes=graph.getAllNodes(),edges=graph.getAllEdges(),width=propsWidth||"undefined"==typeof window?propsWidth:window.innerWidth,height=propsHeight||"undefined"==typeof window?propsHeight:window.innerHeight,center=propsCenter||[width/2,height/2],!(null==nodes?void 0:nodes.length)||1===nodes.length)return[2,(0,_util_common__WEBPACK_IMPORTED_MODULE_1__.s)(graph,assign,center)];if(layoutNodes=[],maxNodeSpacing=0,(0,_util__WEBPACK_IMPORTED_MODULE_2__.c)(nodeSize)?maxNodeSize=Math.max(nodeSize[0],nodeSize[1]):(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(nodeSize)?(maxNodeSize=-1/0,nodes.forEach((function(node){var currentSize=nodeSize(node);currentSize>maxNodeSize&&(maxNodeSize=currentSize)}))):maxNodeSize=nodeSize,(0,_util__WEBPACK_IMPORTED_MODULE_2__.c)(nodeSpacing)?maxNodeSpacing=Math.max(nodeSpacing[0],nodeSpacing[1]):(0,_antv_util__WEBPACK_IMPORTED_MODULE_4__.c)(nodeSpacing)&&(maxNodeSpacing=nodeSpacing),nodes.forEach((function(node){var cnode=(0,_util__WEBPACK_IMPORTED_MODULE_5__.o)(node);layoutNodes.push(cnode);var nodeSize=maxNodeSize,data=cnode.data;(0,_util__WEBPACK_IMPORTED_MODULE_2__.c)(data.size)?nodeSize=Math.max(data.size[0],data.size[1]):(0,_antv_util__WEBPACK_IMPORTED_MODULE_4__.c)(data.size)?nodeSize=data.size:(0,_antv_util__WEBPACK_IMPORTED_MODULE_6__.c)(data.size)&&(nodeSize=Math.max(data.size.width,data.size.height)),maxNodeSize=Math.max(maxNodeSize,nodeSize),(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(nodeSpacing)&&(maxNodeSpacing=Math.max(nodeSpacing(node),maxNodeSpacing))})),nodeIdxMap={},layoutNodes.forEach((function(node,i){nodeIdxMap[node.id]=i})),sortBy=propsSortBy,(0,_antv_util__WEBPACK_IMPORTED_MODULE_7__.c)(sortBy)&&void 0!==layoutNodes[0].data[sortBy]||(sortBy="degree"),"degree"===sortBy?layoutNodes.sort((function(n1,n2){return graph.getDegree(n2.id,"both")-graph.getDegree(n1.id,"both")})):layoutNodes.sort((function(n1,n2){return n2.data[sortBy]-n1.data[sortBy]})),maxValueNode=layoutNodes[0],maxLevelDiff=(propsMaxLevelDiff||("degree"===sortBy?graph.getDegree(maxValueNode.id,"both"):maxValueNode.data[sortBy]))/4,currentLevel=(levels=[{nodes:[]}])[0],layoutNodes.forEach((function(node){if(currentLevel.nodes.length>0){var diff="degree"===sortBy?Math.abs(graph.getDegree(currentLevel.nodes[0].id,"both")-graph.getDegree(node.id,"both")):Math.abs(currentLevel.nodes[0].data[sortBy]-node.data[sortBy]);maxLevelDiff&&diff>=maxLevelDiff&&(currentLevel={nodes:[]},levels.push(currentLevel))}currentLevel.nodes.push(node)})),minDist=maxNodeSize+maxNodeSpacing,preventOverlap||(firstLvlHasMulti=levels.length>0&&levels[0].nodes.length>1,maxR=Math.min(width,height)/2-minDist,rStep=maxR/(levels.length+(firstLvlHasMulti?1:0)),minDist=Math.min(minDist,rStep)),r=0,levels.forEach((function(level){var sweep=void 0===propsSweep?2*Math.PI-2*Math.PI/level.nodes.length:propsSweep;if(level.dTheta=sweep/Math.max(1,level.nodes.length-1),level.nodes.length>1&&preventOverlap){var dcos=Math.cos(level.dTheta)-Math.cos(0),dsin=Math.sin(level.dTheta)-Math.sin(0),rMin=Math.sqrt(minDist*minDist/(dcos*dcos+dsin*dsin));r=Math.max(rMin,r)}level.r=r,r+=minDist})),equidistant){for(rDeltaMax_1=0,rr_1=0,i=0;i<levels.length;i++)level=levels[i],rDelta=(level.r||0)-rr_1,rDeltaMax_1=Math.max(rDeltaMax_1,rDelta);rr_1=0,levels.forEach((function(level,i){0===i&&(rr_1=level.r||0),level.r=rr_1,rr_1+=rDeltaMax_1}))}return levels.forEach((function(level){var dTheta=level.dTheta||0,rr=level.r||0;level.nodes.forEach((function(node,j){var theta=startAngle+(clockwise?1:-1)*dTheta*j;node.data.x=center[0]+rr*Math.cos(theta),node.data.y=center[1]+rr*Math.sin(theta)}))})),assign&&layoutNodes.forEach((function(node){return graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),[2,{nodes:layoutNodes,edges}]}))}))},ConcentricLayout}()},"./node_modules/@antv/layout/lib/d3Force/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{S:()=>D3ForceLayout});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),quadtree=__webpack_require__("./node_modules/d3-quadtree/src/quadtree.js");function constant(x){return function(){return x}}function jiggle(random){return 1e-6*(random()-.5)}var noop={value:()=>{}};function dispatch(){for(var t,i=0,n=arguments.length,_={};i<n;++i){if(!(t=arguments[i]+"")||t in _||/[\s.]/.test(t))throw new Error("illegal type: "+t);_[t]=[]}return new Dispatch(_)}function Dispatch(_){this._=_}function get(type,name){for(var c,i=0,n=type.length;i<n;++i)if((c=type[i]).name===name)return c.value}function set(type,name,callback){for(var i=0,n=type.length;i<n;++i)if(type[i].name===name){type[i]=noop,type=type.slice(0,i).concat(type.slice(i+1));break}return null!=callback&&type.push({name,value:callback}),type}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(typename,callback){var t,_=this._,T=function parseTypenames(typenames,types){return typenames.trim().split(/^|\s+/).map((function(t){var name="",i=t.indexOf(".");if(i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),t&&!types.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name}}))}(typename+"",_),i=-1,n=T.length;if(!(arguments.length<2)){if(null!=callback&&"function"!=typeof callback)throw new Error("invalid callback: "+callback);for(;++i<n;)if(t=(typename=T[i]).type)_[t]=set(_[t],typename.name,callback);else if(null==callback)for(t in _)_[t]=set(_[t],typename.name,null);return this}for(;++i<n;)if((t=(typename=T[i]).type)&&(t=get(_[t],typename.name)))return t},copy:function(){var copy={},_=this._;for(var t in _)copy[t]=_[t].slice();return new Dispatch(copy)},call:function(type,that){if((n=arguments.length-2)>0)for(var n,t,args=new Array(n),i=0;i<n;++i)args[i]=arguments[i+2];if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(i=0,n=(t=this._[type]).length;i<n;++i)t[i].value.apply(that,args)},apply:function(type,that,args){if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(var t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)}};const src_dispatch=dispatch;var taskHead,taskTail,timer_frame=0,timeout=0,interval=0,pokeDelay=1e3,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(callback,delay,time){var t=new Timer;return t.restart(callback,delay,time),t}function wake(){clockNow=(clockLast=clock.now())+clockSkew,timer_frame=timeout=0;try{!function timerFlush(){now(),++timer_frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(void 0,e),t=t._next;--timer_frame}()}finally{timer_frame=0,function nap(){var t0,t2,t1=taskHead,time=1/0;for(;t1;)t1._call?(time>t1._time&&(time=t1._time),t0=t1,t1=t1._next):(t2=t1._next,t1._next=null,t1=t0?t0._next=t2:taskHead=t2);taskTail=t0,sleep(time)}(),clockNow=0}}function poke(){var now=clock.now(),delay=now-clockLast;delay>pokeDelay&&(clockSkew-=delay,clockLast=now)}function sleep(time){timer_frame||(timeout&&(timeout=clearTimeout(timeout)),time-clockNow>24?(time<1/0&&(timeout=setTimeout(wake,time-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),timer_frame=1,setFrame(wake)))}Timer.prototype=timer.prototype={constructor:Timer,restart:function(callback,delay,time){if("function"!=typeof callback)throw new TypeError("callback is not a function");time=(null==time?now():+time)+(null==delay?0:+delay),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=callback,this._time=time,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};const a=1664525,c=1013904223,m=4294967296;function x(d){return d.x}function y(d){return d.y}var initialRadius=10,initialAngle=Math.PI*(3-Math.sqrt(5));function simulation(nodes){var simulation,alpha=1,alphaMin=.001,alphaDecay=1-Math.pow(alphaMin,1/300),alphaTarget=0,velocityDecay=.6,forces=new Map,stepper=timer(step),event=src_dispatch("tick","end"),random=function lcg(){let s=1;return()=>(s=(a*s+c)%m)/m}();function step(){tick(),event.call("tick",simulation),alpha<alphaMin&&(stepper.stop(),event.call("end",simulation))}function tick(iterations){var i,node,n=nodes.length;void 0===iterations&&(iterations=1);for(var k=0;k<iterations;++k)for(alpha+=(alphaTarget-alpha)*alphaDecay,forces.forEach((function(force){force(alpha)})),i=0;i<n;++i)null==(node=nodes[i]).fx?node.x+=node.vx*=velocityDecay:(node.x=node.fx,node.vx=0),null==node.fy?node.y+=node.vy*=velocityDecay:(node.y=node.fy,node.vy=0);return simulation}function initializeNodes(){for(var node,i=0,n=nodes.length;i<n;++i){if((node=nodes[i]).index=i,null!=node.fx&&(node.x=node.fx),null!=node.fy&&(node.y=node.fy),isNaN(node.x)||isNaN(node.y)){var radius=initialRadius*Math.sqrt(.5+i),angle=i*initialAngle;node.x=radius*Math.cos(angle),node.y=radius*Math.sin(angle)}(isNaN(node.vx)||isNaN(node.vy))&&(node.vx=node.vy=0)}}function initializeForce(force){return force.initialize&&force.initialize(nodes,random),force}return null==nodes&&(nodes=[]),initializeNodes(),simulation={tick,restart:function(){return stepper.restart(step),simulation},stop:function(){return stepper.stop(),simulation},nodes:function(_){return arguments.length?(nodes=_,initializeNodes(),forces.forEach(initializeForce),simulation):nodes},alpha:function(_){return arguments.length?(alpha=+_,simulation):alpha},alphaMin:function(_){return arguments.length?(alphaMin=+_,simulation):alphaMin},alphaDecay:function(_){return arguments.length?(alphaDecay=+_,simulation):+alphaDecay},alphaTarget:function(_){return arguments.length?(alphaTarget=+_,simulation):alphaTarget},velocityDecay:function(_){return arguments.length?(velocityDecay=1-_,simulation):1-velocityDecay},randomSource:function(_){return arguments.length?(random=_,forces.forEach(initializeForce),simulation):random},force:function(name,_){return arguments.length>1?(null==_?forces.delete(name):forces.set(name,initializeForce(_)),simulation):forces.get(name)},find:function(x,y,radius){var dx,dy,d2,node,closest,i=0,n=nodes.length;for(null==radius?radius=1/0:radius*=radius,i=0;i<n;++i)(d2=(dx=x-(node=nodes[i]).x)*dx+(dy=y-node.y)*dy)<radius&&(closest=node,radius=d2);return closest},on:function(name,_){return arguments.length>1?(event.on(name,_),simulation):event.on(name)}}}function manyBody(){var nodes,node,random,alpha,strengths,strength=constant(-30),distanceMin2=1,distanceMax2=1/0,theta2=.81;function force(_){var i,n=nodes.length,tree=(0,quadtree.c)(nodes,x,y).visitAfter(accumulate);for(alpha=_,i=0;i<n;++i)node=nodes[i],tree.visit(apply)}function initialize(){if(nodes){var i,node,n=nodes.length;for(strengths=new Array(n),i=0;i<n;++i)node=nodes[i],strengths[node.index]=+strength(node,i,nodes)}}function accumulate(quad){var q,c,x,y,i,strength=0,weight=0;if(quad.length){for(x=y=i=0;i<4;++i)(q=quad[i])&&(c=Math.abs(q.value))&&(strength+=q.value,weight+=c,x+=c*q.x,y+=c*q.y);quad.x=x/weight,quad.y=y/weight}else{(q=quad).x=q.data.x,q.y=q.data.y;do{strength+=strengths[q.data.index]}while(q=q.next)}quad.value=strength}function apply(quad,x1,_,x2){if(!quad.value)return!0;var x=quad.x-node.x,y=quad.y-node.y,w=x2-x1,l=x*x+y*y;if(w*w/theta2<l)return l<distanceMax2&&(0===x&&(l+=(x=jiggle(random))*x),0===y&&(l+=(y=jiggle(random))*y),l<distanceMin2&&(l=Math.sqrt(distanceMin2*l)),node.vx+=x*quad.value*alpha/l,node.vy+=y*quad.value*alpha/l),!0;if(!(quad.length||l>=distanceMax2)){(quad.data!==node||quad.next)&&(0===x&&(l+=(x=jiggle(random))*x),0===y&&(l+=(y=jiggle(random))*y),l<distanceMin2&&(l=Math.sqrt(distanceMin2*l)));do{quad.data!==node&&(w=strengths[quad.data.index]*alpha/l,node.vx+=x*w,node.vy+=y*w)}while(quad=quad.next)}}return force.initialize=function(_nodes,_random){nodes=_nodes,random=_random,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.distanceMin=function(_){return arguments.length?(distanceMin2=_*_,force):Math.sqrt(distanceMin2)},force.distanceMax=function(_){return arguments.length?(distanceMax2=_*_,force):Math.sqrt(distanceMax2)},force.theta=function(_){return arguments.length?(theta2=_*_,force):Math.sqrt(theta2)},force}function index(d){return d.index}function find(nodeById,nodeId){var node=nodeById.get(nodeId);if(!node)throw new Error("node not found: "+nodeId);return node}function src_link(links){var strengths,distances,nodes,count,bias,random,id=index,strength=function defaultStrength(link){return 1/Math.min(count[link.source.index],count[link.target.index])},distance=constant(30),iterations=1;function force(alpha){for(var k=0,n=links.length;k<iterations;++k)for(var link,source,target,x,y,l,b,i=0;i<n;++i)source=(link=links[i]).source,x=(target=link.target).x+target.vx-source.x-source.vx||jiggle(random),y=target.y+target.vy-source.y-source.vy||jiggle(random),x*=l=((l=Math.sqrt(x*x+y*y))-distances[i])/l*alpha*strengths[i],y*=l,target.vx-=x*(b=bias[i]),target.vy-=y*b,source.vx+=x*(b=1-b),source.vy+=y*b}function initialize(){if(nodes){var i,link,n=nodes.length,m=links.length,nodeById=new Map(nodes.map(((d,i)=>[id(d,i,nodes),d])));for(i=0,count=new Array(n);i<m;++i)(link=links[i]).index=i,"object"!=typeof link.source&&(link.source=find(nodeById,link.source)),"object"!=typeof link.target&&(link.target=find(nodeById,link.target)),count[link.source.index]=(count[link.source.index]||0)+1,count[link.target.index]=(count[link.target.index]||0)+1;for(i=0,bias=new Array(m);i<m;++i)link=links[i],bias[i]=count[link.source.index]/(count[link.source.index]+count[link.target.index]);strengths=new Array(m),initializeStrength(),distances=new Array(m),initializeDistance()}}function initializeStrength(){if(nodes)for(var i=0,n=links.length;i<n;++i)strengths[i]=+strength(links[i],i,links)}function initializeDistance(){if(nodes)for(var i=0,n=links.length;i<n;++i)distances[i]=+distance(links[i],i,links)}return null==links&&(links=[]),force.initialize=function(_nodes,_random){nodes=_nodes,random=_random,initialize()},force.links=function(_){return arguments.length?(links=_,initialize(),force):links},force.id=function(_){return arguments.length?(id=_,force):id},force.iterations=function(_){return arguments.length?(iterations=+_,force):iterations},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initializeStrength(),force):strength},force.distance=function(_){return arguments.length?(distance="function"==typeof _?_:constant(+_),initializeDistance(),force):distance},force}function collide_x(d){return d.x+d.vx}function collide_y(d){return d.y+d.vy}function collide(radius){var nodes,radii,random,strength=1,iterations=1;function force(){for(var i,tree,node,xi,yi,ri,ri2,n=nodes.length,k=0;k<iterations;++k)for(tree=(0,quadtree.c)(nodes,collide_x,collide_y).visitAfter(prepare),i=0;i<n;++i)node=nodes[i],ri=radii[node.index],ri2=ri*ri,xi=node.x+node.vx,yi=node.y+node.vy,tree.visit(apply);function apply(quad,x0,y0,x1,y1){var data=quad.data,rj=quad.r,r=ri+rj;if(!data)return x0>xi+r||x1<xi-r||y0>yi+r||y1<yi-r;if(data.index>node.index){var x=xi-data.x-data.vx,y=yi-data.y-data.vy,l=x*x+y*y;l<r*r&&(0===x&&(l+=(x=jiggle(random))*x),0===y&&(l+=(y=jiggle(random))*y),l=(r-(l=Math.sqrt(l)))/l*strength,node.vx+=(x*=l)*(r=(rj*=rj)/(ri2+rj)),node.vy+=(y*=l)*r,data.vx-=x*(r=1-r),data.vy-=y*r)}}}function prepare(quad){if(quad.data)return quad.r=radii[quad.data.index];for(var i=quad.r=0;i<4;++i)quad[i]&&quad[i].r>quad.r&&(quad.r=quad[i].r)}function initialize(){if(nodes){var i,node,n=nodes.length;for(radii=new Array(n),i=0;i<n;++i)node=nodes[i],radii[node.index]=+radius(node,i,nodes)}}return"function"!=typeof radius&&(radius=constant(null==radius?1:+radius)),force.initialize=function(_nodes,_random){nodes=_nodes,random=_random,initialize()},force.iterations=function(_){return arguments.length?(iterations=+_,force):iterations},force.strength=function(_){return arguments.length?(strength=+_,force):strength},force.radius=function(_){return arguments.length?(radius="function"==typeof _?_:constant(+_),initialize(),force):radius},force}var is_number=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),is_function=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-function.js"),is_object=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-object.js"),object=__webpack_require__("./node_modules/@antv/layout/lib/util/object.js"),array=__webpack_require__("./node_modules/@antv/layout/lib/util/array.js");function src_x(x){var nodes,strengths,xz,strength=constant(.1);function force(alpha){for(var node,i=0,n=nodes.length;i<n;++i)(node=nodes[i]).vx+=(xz[i]-node.x)*strengths[i]*alpha}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),xz=new Array(n),i=0;i<n;++i)strengths[i]=isNaN(xz[i]=+x(nodes[i],i,nodes))?0:+strength(nodes[i],i,nodes)}}return"function"!=typeof x&&(x=constant(null==x?0:+x)),force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.x=function(_){return arguments.length?(x="function"==typeof _?_:constant(+_),initialize(),force):x},force}function src_y(y){var nodes,strengths,yz,strength=constant(.1);function force(alpha){for(var node,i=0,n=nodes.length;i<n;++i)(node=nodes[i]).vy+=(yz[i]-node.y)*strengths[i]*alpha}function initialize(){if(nodes){var i,n=nodes.length;for(strengths=new Array(n),yz=new Array(n),i=0;i<n;++i)strengths[i]=isNaN(yz[i]=+y(nodes[i],i,nodes))?0:+strength(nodes[i],i,nodes)}}return"function"!=typeof y&&(y=constant(null==y?0:+y)),force.initialize=function(_){nodes=_,initialize()},force.strength=function(_){return arguments.length?(strength="function"==typeof _?_:constant(+_),initialize(),force):strength},force.y=function(_){return arguments.length?(y="function"==typeof _?_:constant(+_),initialize(),force):y},force}function forceInBox(){function constant(_){return function(){return _}}var templateForce,groupBy=function(d){return d.cluster},forceNodeSize=constant(1),forceCharge=constant(-1),forceLinkDistance=constant(100),forceLinkStrength=constant(.1),offset=[0,0],nodes=[],nodesMap={},links=[],centerX=100,centerY=100,foci={none:{x:0,y:0}},templateNodes=[],template="force",enableGrouping=!0,strength=.1;function force(alpha){if(!enableGrouping)return force;templateForce.tick(),getFocisFromTemplate();for(var i=0,n=nodes.length,node=void 0,k=alpha*strength;i<n;++i)(node=nodes[i]).vx+=(foci[groupBy(node)].x-node.x)*k,node.vy+=(foci[groupBy(node)].y-node.y)*k}function initialize(){nodes&&function initializeWithForce(){if(!nodes||!nodes.length)return;if(void 0===groupBy(nodes[0]))throw Error("Couldnt find the grouping attribute for the nodes. Make sure to set it up with forceInBox.groupBy('clusterAttr') before calling .links()");var net=function getGroupsGraph(){var gnodes=[],glinks=[],dNodes={},clustersCounts={},clustersLinks=[];return clustersCounts=function computeClustersNodeCounts(nodes){var clustersCounts={};return nodes.forEach((function(d){var key=groupBy(d);clustersCounts[key]||(clustersCounts[key]={count:0,sumforceNodeSize:0})})),nodes.forEach((function(d){var key=groupBy(d),nodeSize=forceNodeSize(d),tmpCount=clustersCounts[key];tmpCount.count=tmpCount.count+1,tmpCount.sumforceNodeSize=tmpCount.sumforceNodeSize+Math.PI*(nodeSize*nodeSize)*1.3,clustersCounts[key]=tmpCount})),clustersCounts}(nodes),clustersLinks=function computeClustersLinkCounts(links){var dClusterLinks={},clusterLinks=[];return links.forEach((function(l){var key=function getLinkKey(link){var source=link.source,target=link.target,sourceID=groupBy(nodesMap[source]),targetID=groupBy(nodesMap[target]);return sourceID<=targetID?sourceID+"~"+targetID:targetID+"~"+sourceID}(l),count=0;void 0!==dClusterLinks[key]&&(count=dClusterLinks[key]),count+=1,dClusterLinks[key]=count})),Object.entries(dClusterLinks).forEach((function(_a){var _b=(0,tslib_es6.o5)(_a,2),key=_b[0],count=_b[1],source=key.split("~")[0],target=key.split("~")[1];void 0!==source&&void 0!==target&&clusterLinks.push({source,target,count})})),clusterLinks}(links),Object.keys(clustersCounts).forEach((function(key,index){var val=clustersCounts[key];gnodes.push({id:key,size:val.count,r:Math.sqrt(val.sumforceNodeSize/Math.PI)}),dNodes[key]=index})),clustersLinks.forEach((function(link){var sourceTerminal=link.source,targetTerminal=link.target,source=dNodes[sourceTerminal],target=dNodes[targetTerminal];void 0!==source&&void 0!==target&&glinks.push({source,target,count:link.count})})),{nodes:gnodes,links:glinks}}();templateForce=simulation(net.nodes).force("x",src_x(centerX).strength(.1)).force("y",src_y(centerY).strength(.1)).force("collide",collide((function(d){return d.r})).iterations(4)).force("charge",manyBody().strength(forceCharge)).force("links",src_link(net.nodes.length?net.links:[]).distance(forceLinkDistance).strength(forceLinkStrength)),templateNodes=templateForce.nodes(),getFocisFromTemplate()}()}function getFocisFromTemplate(){return foci={none:{x:0,y:0}},templateNodes.forEach((function(d){foci[d.id]={x:d.x-offset[0],y:d.y-offset[1]}})),foci}return force.initialize=function(_){nodes=_,initialize()},force.template=function setTemplate(x){return arguments.length?(template=x,initialize(),force):template},force.groupBy=function setGroupBy(x){return arguments.length?"string"==typeof x?(groupBy=function(d){return d[x]},force):(groupBy=x,force):groupBy},force.enableGrouping=function setEnableGrouping(x){return arguments.length?(enableGrouping=x,force):enableGrouping},force.strength=function setStrength(x){return arguments.length?(strength=x,force):strength},force.centerX=function setCenterX(_){return arguments.length?(centerX=_,force):centerX},force.centerY=function setCenterY(_){return arguments.length?(centerY=_,force):centerY},force.nodes=function setNodes(_){return arguments.length?(function genNodesMap(nodes){nodesMap={},nodes.forEach((function(node){nodesMap[node.id]=node}))}(_||[]),nodes=_||[],force):nodes},force.links=function setLinks(_){return arguments.length?(links=_||[],initialize(),force):links},force.forceNodeSize=function setForceNodeSize(_){return arguments.length?(forceNodeSize="function"==typeof _?_:constant(+_),initialize(),force):forceNodeSize},force.nodeSize=force.forceNodeSize,force.forceCharge=function setForceCharge(_){return arguments.length?(forceCharge="function"==typeof _?_:constant(+_),initialize(),force):forceCharge},force.forceLinkDistance=function setForceLinkDistance(_){return arguments.length?(forceLinkDistance="function"==typeof _?_:constant(+_),initialize(),force):forceLinkDistance},force.forceLinkStrength=function setForceLinkStrength(_){return arguments.length?(forceLinkStrength="function"==typeof _?_:constant(+_),initialize(),force):forceLinkStrength},force.offset=function setOffset(_){return arguments.length?(offset=_,force):offset},force.getFocis=getFocisFromTemplate,force}var DEFAULTS_LAYOUT_OPTIONS={center:[0,0],preventOverlap:!1,nodeSize:void 0,nodeSpacing:void 0,linkDistance:50,forceSimulation:null,alphaDecay:.028,alphaMin:.001,alpha:.3,collideStrength:1,clustering:!1,clusterNodeStrength:-1,clusterEdgeStrength:.1,clusterEdgeDistance:100,clusterFociStrength:.8,clusterNodeSize:10},D3ForceLayout=function(){function D3ForceLayout(options){void 0===options&&(options={}),this.options=options,this.id="d3force",this.options=(0,tslib_es6.C3)((0,tslib_es6.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return D3ForceLayout.prototype.execute=function(graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){return(0,tslib_es6.KE)(this,(function(_a){return[2,this.genericForceLayout(!1,graph,options)]}))}))},D3ForceLayout.prototype.assign=function(graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){return(0,tslib_es6.KE)(this,(function(_a){return this.genericForceLayout(!0,graph,options),[2]}))}))},D3ForceLayout.prototype.stop=function(){var _a;null===(_a=this.forceSimulation)||void 0===_a||_a.stop()},D3ForceLayout.prototype.tick=function(iterations){var _this=this;void 0===iterations&&(iterations=1),this.forceSimulation.tick(iterations);var result={nodes:formatOutNodes(this.lastLayoutNodes),edges:formatOutEdges(this.lastLayoutEdges)};return this.lastAssign&&result.nodes.forEach((function(node){return _this.lastGraph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),result},D3ForceLayout.prototype.genericForceLayout=function(assign,graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){var mergedOptions,nodes,edges,layoutNodes,layoutEdges,alphaMin,alphaDecay,alpha,nodeStrength,edgeStrength,linkDistance,clustering,clusterFociStrength,clusterEdgeDistance,clusterEdgeStrength,clusterNodeStrength,clusterNodeSize,_a,collideStrength,_b,center,preventOverlap,nodeSize,nodeSpacing,onTick,forceSimulation,_this=this;return(0,tslib_es6.KE)(this,(function(_c){return mergedOptions=(0,tslib_es6.C3)((0,tslib_es6.C3)({},this.options),options),nodes=graph.getAllNodes(),edges=graph.getAllEdges(),layoutNodes=nodes.map((function(node){var _a,_b;return(0,tslib_es6.C3)((0,tslib_es6.C3)({},(0,object.o)(node)),{x:null===(_a=node.data)||void 0===_a?void 0:_a.x,y:null===(_b=node.data)||void 0===_b?void 0:_b.y})})),layoutEdges=edges.map((function(edge){return(0,object.o)(edge)})),this.lastLayoutNodes=layoutNodes,this.lastLayoutEdges=layoutEdges,this.lastAssign=assign,this.lastGraph=graph,alphaMin=mergedOptions.alphaMin,alphaDecay=mergedOptions.alphaDecay,alpha=mergedOptions.alpha,nodeStrength=mergedOptions.nodeStrength,edgeStrength=mergedOptions.edgeStrength,linkDistance=mergedOptions.linkDistance,clustering=mergedOptions.clustering,clusterFociStrength=mergedOptions.clusterFociStrength,clusterEdgeDistance=mergedOptions.clusterEdgeDistance,clusterEdgeStrength=mergedOptions.clusterEdgeStrength,clusterNodeStrength=mergedOptions.clusterNodeStrength,clusterNodeSize=mergedOptions.clusterNodeSize,_a=mergedOptions.collideStrength,collideStrength=void 0===_a?1:_a,_b=mergedOptions.center,center=void 0===_b?[0,0]:_b,preventOverlap=mergedOptions.preventOverlap,nodeSize=mergedOptions.nodeSize,nodeSpacing=mergedOptions.nodeSpacing,onTick=mergedOptions.onTick,forceSimulation=mergedOptions.forceSimulation,[2,new Promise((function(resolve){if(forceSimulation){if(clustering)(clusterForce=forceInBox()).nodes(layoutNodes),clusterForce.links(layoutEdges);if(forceSimulation.nodes(layoutNodes),layoutEdges){edgeForce=src_link().id((function(d){return d.id})).links(layoutEdges);edgeStrength&&edgeForce.strength(edgeStrength),linkDistance&&edgeForce.distance(linkDistance),forceSimulation.force("link",edgeForce)}preventOverlap&&_this.overlapProcess(forceSimulation,{nodeSize,nodeSpacing,collideStrength}),forceSimulation.alpha(alpha).restart();var outNodes=formatOutNodes(layoutNodes),outEdges=formatOutEdges(layoutEdges);assign&&outNodes.forEach((function(node){return graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),resolve({nodes:outNodes,edges:outEdges})}else try{var clusterForce,nodeForce=manyBody();if(nodeStrength&&nodeForce.strength(nodeStrength),forceSimulation=simulation().nodes(layoutNodes),clustering)(clusterForce=forceInBox()).centerX(center[0]).centerY(center[1]).template("force").strength(clusterFociStrength),layoutEdges&&clusterForce.links(layoutEdges),layoutNodes&&clusterForce.nodes(layoutNodes),clusterForce.forceLinkDistance(clusterEdgeDistance).forceLinkStrength(clusterEdgeStrength).forceCharge(clusterNodeStrength).forceNodeSize(clusterNodeSize),forceSimulation.force("group",clusterForce);if(forceSimulation.force("center",function src_center(x,y){var nodes,strength=1;function force(){var i,node,n=nodes.length,sx=0,sy=0;for(i=0;i<n;++i)sx+=(node=nodes[i]).x,sy+=node.y;for(sx=(sx/n-x)*strength,sy=(sy/n-y)*strength,i=0;i<n;++i)(node=nodes[i]).x-=sx,node.y-=sy}return null==x&&(x=0),null==y&&(y=0),force.initialize=function(_){nodes=_},force.x=function(_){return arguments.length?(x=+_,force):x},force.y=function(_){return arguments.length?(y=+_,force):y},force.strength=function(_){return arguments.length?(strength=+_,force):strength},force}(center[0],center[1])).force("charge",nodeForce).alpha(alpha).alphaDecay(alphaDecay).alphaMin(alphaMin),preventOverlap&&_this.overlapProcess(forceSimulation,{nodeSize,nodeSpacing,collideStrength}),layoutEdges){var edgeForce=src_link().id((function(d){return d.id})).links(layoutEdges);edgeStrength&&edgeForce.strength(edgeStrength),linkDistance&&edgeForce.distance(linkDistance),forceSimulation.force("link",edgeForce)}forceSimulation.on("tick",(function(){var outNodes=formatOutNodes(layoutNodes);null==onTick||onTick({nodes:outNodes,edges:formatOutEdges(layoutEdges)}),assign&&outNodes.forEach((function(node){return graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})}))})).on("end",(function(){var outNodes=formatOutNodes(layoutNodes);assign&&outNodes.forEach((function(node){return graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),resolve({nodes:outNodes,edges:formatOutEdges(layoutEdges)})}))}catch(e){console.warn(e)}_this.forceSimulation=forceSimulation}))]}))}))},D3ForceLayout.prototype.overlapProcess=function(simulation,options){var nodeSizeFunc,nodeSpacingFunc,nodeSize=options.nodeSize,nodeSpacing=options.nodeSpacing,collideStrength=options.collideStrength;if(nodeSpacingFunc=(0,is_number.c)(nodeSpacing)?function(){return nodeSpacing}:(0,is_function.c)(nodeSpacing)?nodeSpacing:function(){return 0},nodeSize)if((0,is_function.c)(nodeSize))nodeSizeFunc=function(d){return nodeSize(d)+nodeSpacingFunc(d)};else if((0,array.c)(nodeSize)){var radius_1=(nodeSize[0]>nodeSize[1]?nodeSize[0]:nodeSize[1])/2;nodeSizeFunc=function(d){return radius_1+nodeSpacingFunc(d)}}else if((0,is_number.c)(nodeSize)){var radius_2=nodeSize/2;nodeSizeFunc=function(d){return radius_2+nodeSpacingFunc(d)}}else nodeSizeFunc=function(){return 10};else nodeSizeFunc=function(d){return d.size?(0,array.c)(d.size)?(d.size[0]>d.size[1]?d.size[0]:d.size[1])/2+nodeSpacingFunc(d):(0,is_object.c)(d.size)?(d.size.width>d.size.height?d.size.width:d.size.height)/2+nodeSpacingFunc(d):d.size/2+nodeSpacingFunc(d):10+nodeSpacingFunc(d)};simulation.force("collisionForce",collide(nodeSizeFunc).strength(collideStrength))},D3ForceLayout}(),formatOutNodes=function(layoutNodes){return layoutNodes.map((function(node){var x=node.x,y=node.y,others=(0,tslib_es6.sX)(node,["x","y"]);return(0,tslib_es6.C3)((0,tslib_es6.C3)({},others),{data:(0,tslib_es6.C3)((0,tslib_es6.C3)({},others.data),{x,y})})}))},formatOutEdges=function(edges){return edges.map((function(edge){var source=edge.source,target=edge.target,rest=(0,tslib_es6.sX)(edge,["source","target"]);return(0,tslib_es6.C3)((0,tslib_es6.C3)({},rest),{source:source.id,target:target.id})}))}},"./node_modules/@antv/layout/lib/dagre.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>DagreLayout});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),esm_graph=__webpack_require__("./node_modules/@antv/graphlib/esm/graph.js"),is_number=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),is_nil=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-nil.js"),filterOutLinks=function(k,v){if("next"!==k&&"prev"!==k)return v},unlink=function(entry){entry.prev.next=entry.next,entry.next.prev=entry.prev,delete entry.next,delete entry.prev};var greedy_fas_List=function(_super){function List(){return null!==_super&&_super.apply(this,arguments)||this}return(0,tslib_es6.ct)(List,_super),List}(function(){function List(){var shortcut={};shortcut.prev=shortcut,shortcut.next=shortcut.prev,this.shortcut=shortcut}return List.prototype.dequeue=function(){var shortcut=this.shortcut,entry=shortcut.prev;if(entry&&entry!==shortcut)return unlink(entry),entry},List.prototype.enqueue=function(entry){var shortcut=this.shortcut;entry.prev&&entry.next&&unlink(entry),entry.next=shortcut.next,shortcut.next.prev=entry,shortcut.next=entry,entry.prev=shortcut},List.prototype.toString=function(){for(var strs=[],sentinel=this.shortcut,curr=sentinel.prev;curr!==sentinel;)strs.push(JSON.stringify(curr,filterOutLinks)),curr=null==curr?void 0:curr.prev;return"["+strs.join(", ")+"]"},List}()),DEFAULT_WEIGHT_FN=function(){return 1},doGreedyFAS=function(g,buckets,zeroIdx){for(var entry,results=[],sources=buckets[buckets.length-1],sinks=buckets[0];g.getAllNodes().length;){for(;entry=sinks.dequeue();)removeNode(g,buckets,zeroIdx,entry);for(;entry=sources.dequeue();)removeNode(g,buckets,zeroIdx,entry);if(g.getAllNodes().length)for(var i=buckets.length-2;i>0;--i)if(entry=buckets[i].dequeue()){results=results.concat(removeNode(g,buckets,zeroIdx,entry,!0));break}}return results},removeNode=function(g,buckets,zeroIdx,entry,collectPredecessors){var _a,_b,results=[];return g.hasNode(entry.v)&&(null===(_a=g.getRelatedEdges(entry.v,"in"))||void 0===_a||_a.forEach((function(edge){var weight=edge.data.weight,uEntry=g.getNode(edge.source);collectPredecessors&&results.push({v:edge.source,w:edge.target,in:0,out:0}),void 0===uEntry.data.out&&(uEntry.data.out=0),uEntry.data.out-=weight,assignBucket(buckets,zeroIdx,(0,tslib_es6.C3)({v:uEntry.id},uEntry.data))})),null===(_b=g.getRelatedEdges(entry.v,"out"))||void 0===_b||_b.forEach((function(edge){var weight=edge.data.weight,w=edge.target,wEntry=g.getNode(w);void 0===wEntry.data.in&&(wEntry.data.in=0),wEntry.data.in-=weight,assignBucket(buckets,zeroIdx,(0,tslib_es6.C3)({v:wEntry.id},wEntry.data))})),g.removeNode(entry.v)),collectPredecessors?results:void 0},buildState=function(g,weightFn){var fasGraph=new esm_graph.M,maxIn=0,maxOut=0;g.getAllNodes().forEach((function(v){fasGraph.addNode({id:v.id,data:{v:v.id,in:0,out:0}})})),g.getAllEdges().forEach((function(e){var edge=fasGraph.getRelatedEdges(e.source,"out").find((function(edge){return edge.target===e.target})),weight=(null==weightFn?void 0:weightFn(e))||1;edge?fasGraph.updateEdgeData(null==edge?void 0:edge.id,(0,tslib_es6.C3)((0,tslib_es6.C3)({},edge.data),{weight:edge.data.weight+weight})):fasGraph.addEdge({id:e.id,source:e.source,target:e.target,data:{weight}}),maxOut=Math.max(maxOut,fasGraph.getNode(e.source).data.out+=weight),maxIn=Math.max(maxIn,fasGraph.getNode(e.target).data.in+=weight)}));for(var buckets=[],rangeMax=maxOut+maxIn+3,i=0;i<rangeMax;i++)buckets.push(new greedy_fas_List);var zeroIdx=maxIn+1;return fasGraph.getAllNodes().forEach((function(v){assignBucket(buckets,zeroIdx,(0,tslib_es6.C3)({v:v.id},fasGraph.getNode(v.id).data))})),{buckets,zeroIdx,graph:fasGraph}},assignBucket=function(buckets,zeroIdx,entry){entry.out?entry.in?buckets[entry.out-entry.in+zeroIdx].enqueue(entry):buckets[buckets.length-1].enqueue(entry):buckets[0].enqueue(entry)},run=function(g,acyclicer){var fas="greedy"===acyclicer?function(g,weightFn){var _a;if(g.getAllNodes().length<=1)return[];var state=buildState(g,weightFn||DEFAULT_WEIGHT_FN);return null===(_a=doGreedyFAS(state.graph,state.buckets,state.zeroIdx).map((function(e){return g.getRelatedEdges(e.v,"out").filter((function(_a){return _a.target===e.w}))})))||void 0===_a?void 0:_a.flat()}(g,(function(e){return e.data.weight||1})):dfsFAS(g);null==fas||fas.forEach((function(e){var label=e.data;g.removeEdge(e.id),label.forwardName=e.data.name,label.reversed=!0,g.addEdge({id:e.id,source:e.target,target:e.source,data:(0,tslib_es6.C3)({},label)})}))},dfsFAS=function(g){var fas=[],stack={},visited={},dfs=function(v){visited[v]||(visited[v]=!0,stack[v]=!0,g.getRelatedEdges(v,"out").forEach((function(e){stack[e.target]?fas.push(e):dfs(e.target)})),delete stack[v])};return g.getAllNodes().forEach((function(n){return dfs(n.id)})),fas},addDummyNode=function(g,type,data,name){var v;do{v=""+name+Math.random()}while(g.hasNode(v));return data.dummy=type,g.addNode({id:v,data}),v},asNonCompoundGraph=function(g){var simplified=new esm_graph.M;return g.getAllNodes().forEach((function(node){g.getChildren(node.id).length||simplified.addNode((0,tslib_es6.C3)({},node))})),g.getAllEdges().forEach((function(edge){simplified.addEdge(edge)})),simplified},zipObject=function(keys,values){return null==keys?void 0:keys.reduce((function(obj,key,i){return obj[key]=values[i],obj}),{})},intersectRect=function(rect,point){var sx,sy,x=Number(rect.x),y=Number(rect.y),dx=Number(point.x)-x,dy=Number(point.y)-y,w=Number(rect.width)/2,h=Number(rect.height)/2;return dx||dy?(Math.abs(dy)*w>Math.abs(dx)*h?(dy<0&&(h=-h),sx=h*dx/dy,sy=h):(dx<0&&(w=-w),sx=w,sy=w*dy/dx),{x:x+sx,y:y+sy}):{x:0,y:0}},util_buildLayerMatrix=function(g){for(var layeringNodes=[],rankMax=maxRank(g)+1,i=0;i<rankMax;i++)layeringNodes.push([]);g.getAllNodes().forEach((function(node){var rank=node.data.rank;void 0!==rank&&layeringNodes[rank]&&layeringNodes[rank].push(node.id)}));for(i=0;i<rankMax;i++)layeringNodes[i]=layeringNodes[i].sort((function(va,vb){return valueA=g.getNode(va).data.order,valueB=g.getNode(vb).data.order,Number(valueA)-Number(valueB);var valueA,valueB}));return layeringNodes},addBorderNode=function(g,prefix,rank,order){var node={width:0,height:0};return(0,is_number.c)(rank)&&(0,is_number.c)(order)&&(node.rank=rank,node.order=order),addDummyNode(g,"border",node,prefix)},maxRank=function(g){var maxRank;return g.getAllNodes().forEach((function(v){var rank=v.data.rank;void 0!==rank&&(void 0===maxRank||rank>maxRank)&&(maxRank=rank)})),maxRank||(maxRank=0),maxRank},minBy=function(array,func){return array.reduce((function(a,b){return func(a)>func(b)?b:a}))},doDFS=function(graph,node,postorder,visited,navigator,result){visited.includes(node.id)||(visited.push(node.id),postorder||result.push(node.id),navigator(node.id).forEach((function(n){return doDFS(graph,n,postorder,visited,navigator,result)})),postorder&&result.push(node.id))},dfs=function(graph,node,order,isDirected){var nodes=Array.isArray(node)?node:[node],navigator=function(n){return isDirected?graph.getSuccessors(n):graph.getNeighbors(n)},results=[],visited=[];return nodes.forEach((function(node){if(!graph.hasNode(node.id))throw new Error("Graph does not have node: "+node);doDFS(graph,node,"post"===order,visited,navigator,results)})),results},normalizeEdge=function(g,e,dummyChains){var v=e.source,vRank=g.getNode(v).data.rank,w=e.target,wRank=g.getNode(w).data.rank,labelRank=e.data.labelRank;if(wRank!==vRank+1){var dummy,nodeData,i;for(g.removeEdge(e.id),i=0,++vRank;vRank<wRank;++i,++vRank)e.data.points=[],dummy=addDummyNode(g,"edge",nodeData={originalEdge:e,width:0,height:0,rank:vRank},"_d"),vRank===labelRank&&(nodeData.width=e.data.width,nodeData.height=e.data.height,nodeData.dummy="edge-label",nodeData.labelpos=e.data.labelpos),g.addEdge({id:"e"+Math.random(),source:v,target:dummy,data:{weight:e.data.weight}}),0===i&&dummyChains.push(dummy),v=dummy;g.addEdge({id:"e"+Math.random(),source:v,target:w,data:{weight:e.data.weight}})}},longestPath=function(g){var visited={},dfs=function(v){var _a,rank,label=g.getNode(v);return label?visited[v]?label.data.rank:(visited[v]=!0,null===(_a=g.getRelatedEdges(v,"out"))||void 0===_a||_a.forEach((function(e){var r=dfs(e.target)-e.data.minlen;r&&(void 0===rank||r<rank)&&(rank=r)})),rank||(rank=0),label.data.rank=rank,rank):0};g.getAllNodes().filter((function(n){return 0===g.getRelatedEdges(n.id,"in").length})).forEach((function(source){return dfs(source.id)}))},slack=function(g,e){return g.getNode(e.target).data.rank-g.getNode(e.source).data.rank-e.data.minlen},tightTree=function(t,g){var dfs=function(v){g.getRelatedEdges(v,"both").forEach((function(e){var edgeV=e.source,w=v===edgeV?e.target:edgeV;t.hasNode(w)||slack(g,e)||(t.addNode({id:w,data:{}}),t.addEdge({id:e.id,source:v,target:w,data:{}}),dfs(w))}))};return t.getAllNodes().forEach((function(n){return dfs(n.id)})),t.getAllNodes().length},tightTreeWithLayer=function(t,g){var dfs=function(v){var _a;null===(_a=g.getRelatedEdges(v,"both"))||void 0===_a||_a.forEach((function(e){var edgeV=e.source,w=v===edgeV?e.target:edgeV;t.hasNode(w)||void 0===g.getNode(w).data.layer&&slack(g,e)||(t.addNode({id:w,data:{}}),t.addEdge({id:e.id,source:v,target:w,data:{}}),dfs(w))}))};return t.getAllNodes().forEach((function(n){return dfs(n.id)})),t.getAllNodes().length},findMinSlackEdge=function(t,g){return minBy(g.getAllEdges(),(function(e){return t.hasNode(e.source)!==t.hasNode(e.target)?slack(g,e):1/0}))},shiftRanks=function(t,g,delta){t.getAllNodes().forEach((function(tn){var v=g.getNode(tn.id);v.data.rank||(v.data.rank=0),v.data.rank+=delta}))},networkSimplex=function(og){var g=function(g){var simplified=new esm_graph.M;return g.getAllNodes().forEach((function(v){simplified.addNode((0,tslib_es6.C3)({},v))})),g.getAllEdges().forEach((function(e){var edge=simplified.getRelatedEdges(e.source,"out").find((function(edge){return edge.target===e.target}));edge?simplified.updateEdgeData(null==edge?void 0:edge.id,(0,tslib_es6.C3)((0,tslib_es6.C3)({},edge.data),{weight:edge.data.weight+e.data.weight||0,minlen:Math.max(edge.data.minlen,e.data.minlen||1)})):simplified.addEdge({id:e.id,source:e.source,target:e.target,data:{weight:e.data.weight||0,minlen:e.data.minlen||1}})})),simplified}(og);longestPath(g);var e,f,t=function(g){var edge,delta,t=new esm_graph.M({tree:[]}),start=g.getAllNodes()[0],size=g.getAllNodes().length;for(t.addNode(start);tightTree(t,g)<size;)edge=findMinSlackEdge(t,g),delta=t.hasNode(edge.source)?slack(g,edge):-slack(g,edge),shiftRanks(t,g,delta);return t}(g);for(initLowLimValues(t),initCutValues(t,g);e=leaveEdge(t);)f=enterEdge(t,g,e),exchangeEdges(t,g,e,f)},initCutValues=function(t,g){var vs=dfs(t,t.getAllNodes(),"post",!1);(vs=vs.slice(0,(null==vs?void 0:vs.length)-1)).forEach((function(v){assignCutValue(t,g,v)}))},assignCutValue=function(t,g,child){var parent=t.getNode(child).data.parent;t.getRelatedEdges(child,"both").find((function(e){return e.target===parent||e.source===parent})).data.cutvalue=calcCutValue(t,g,child)},calcCutValue=function(t,g,child){var parent=t.getNode(child).data.parent,childIsTail=!0,graphEdge=g.getRelatedEdges(child,"out").find((function(e){return e.target===parent})),cutValue=0;return graphEdge||(childIsTail=!1,graphEdge=g.getRelatedEdges(parent,"out").find((function(e){return e.target===child}))),cutValue=graphEdge.data.weight,g.getRelatedEdges(child,"both").forEach((function(e){var isOutEdge=e.source===child,other=isOutEdge?e.target:e.source;if(other!==parent){var pointsToHead=isOutEdge===childIsTail,otherWeight=e.data.weight;if(cutValue+=pointsToHead?otherWeight:-otherWeight,isTreeEdge(t,child,other)){var otherCutValue=t.getRelatedEdges(child,"both").find((function(e){return e.source===other||e.target===other})).data.cutvalue;cutValue+=pointsToHead?-otherCutValue:otherCutValue}}})),cutValue},initLowLimValues=function(tree,root){void 0===root&&(root=tree.getAllNodes()[0].id),dfsAssignLowLim(tree,{},1,root)},dfsAssignLowLim=function(tree,visited,nextLim,v,parent){var _a,low=nextLim,useNextLim=nextLim,label=tree.getNode(v);return visited[v]=!0,null===(_a=tree.getNeighbors(v))||void 0===_a||_a.forEach((function(w){visited[w.id]||(useNextLim=dfsAssignLowLim(tree,visited,useNextLim,w.id,v))})),label.data.low=low,label.data.lim=useNextLim++,parent?label.data.parent=parent:delete label.data.parent,useNextLim},leaveEdge=function(tree){return tree.getAllEdges().find((function(e){return e.data.cutvalue<0}))},enterEdge=function(t,g,edge){var v=edge.source,w=edge.target;g.getRelatedEdges(v,"out").find((function(e){return e.target===w}))||(v=edge.target,w=edge.source);var vLabel=t.getNode(v),wLabel=t.getNode(w),tailLabel=vLabel,flip=!1;vLabel.data.lim>wLabel.data.lim&&(tailLabel=wLabel,flip=!0);var candidates=g.getAllEdges().filter((function(edge){return flip===isDescendant(t.getNode(edge.source),tailLabel)&&flip!==isDescendant(t.getNode(edge.target),tailLabel)}));return minBy(candidates,(function(edge){return slack(g,edge)}))},exchangeEdges=function(t,g,e,f){var existed=t.getRelatedEdges(e.source,"both").find((function(edge){return edge.source===e.target||edge.target===e.target}));existed&&t.removeEdge(existed.id),t.addEdge({id:"e"+Math.random(),source:f.source,target:f.target,data:{}}),initLowLimValues(t),initCutValues(t,g),updateRanks(t,g)},updateRanks=function(t,g){var root=t.getAllNodes().find((function(v){return!v.data.parent})),vs=dfs(t,root,"pre",!1);(vs=vs.slice(1)).forEach((function(v){var parent=t.getNode(v).data.parent,edge=g.getRelatedEdges(v,"out").find((function(e){return e.target===parent})),flipped=!1;!edge&&g.hasNode(parent)&&(edge=g.getRelatedEdges(parent,"out").find((function(e){return e.target===v})),flipped=!0),g.getNode(v).data.rank=(g.hasNode(parent)&&g.getNode(parent).data.rank||0)+(flipped?null==edge?void 0:edge.data.minlen:-(null==edge?void 0:edge.data.minlen))}))},isTreeEdge=function(tree,u,v){return tree.getRelatedEdges(u,"both").find((function(e){return e.source===v||e.target===v}))},isDescendant=function(vLabel,rootLabel){return rootLabel.data.low<=vLabel.data.lim&&vLabel.data.lim<=rootLabel.data.lim},longestPathRanker=longestPath,tightTreeRanker=function(g){!function(g){var minRank,visited={},dfs=function(v){var _a,rank,label=g.getNode(v);return label?visited[v]?label.data.rank:(visited[v]=!0,null===(_a=g.getRelatedEdges(v,"out"))||void 0===_a||_a.forEach((function(e){var r=dfs(e.target)-e.data.minlen;r&&(void 0===rank||r<rank)&&(rank=r)})),rank||(rank=0),(void 0===minRank||rank<minRank)&&(minRank=rank),label.data.rank=rank,rank):0};g.getAllNodes().filter((function(n){return 0===g.getRelatedEdges(n.id,"in").length})).forEach((function(source){source&&dfs(source.id)})),void 0===minRank&&(minRank=0);var forwardVisited={},dfsForward=function(v,nextRank){var _a,label=g.getNode(v),currRank=isNaN(label.data.layer)?nextRank:label.data.layer;(void 0===label.data.rank||label.data.rank<currRank)&&(label.data.rank=currRank),forwardVisited[v]||(forwardVisited[v]=!0,null===(_a=g.getRelatedEdges(v,"out"))||void 0===_a||_a.forEach((function(e){dfsForward(e.target,currRank+e.data.minlen)})))};g.getAllNodes().forEach((function(n){var label=n.data;label&&(isNaN(label.layer)?label.rank-=minRank:dfsForward(n.id,label.layer))}))}(g),function(g){var edge,delta,t=new esm_graph.M({tree:[]}),start=g.getAllNodes()[0],size=g.getAllNodes().length;for(t.addNode(start);tightTreeWithLayer(t,g)<size;)edge=findMinSlackEdge(t,g),delta=t.hasNode(edge.source)?slack(g,edge):-slack(g,edge),shiftRanks(t,g,delta)}(g)},networkSimplexRanker=function(g){networkSimplex(g)},parentDummyChains=function(g,dummyChains){var postorderNums=function(g){var result={},lim=0,dfs=function(v){var low=lim;g.getChildren(v).forEach((function(n){return dfs(n.id)})),result[v]={low,lim:lim++}};return g.getRoots().forEach((function(n){return dfs(n.id)})),result}(g);dummyChains.forEach((function(startV){var _a,_b,v=startV,node=g.getNode(v),originalEdge=node.data.originalEdge;if(originalEdge)for(var pathData=function(g,postorderNums,v,w){var _a,_b,parent,lca,vPath=[],wPath=[],low=Math.min(postorderNums[v].low,postorderNums[w].low),lim=Math.max(postorderNums[v].lim,postorderNums[w].lim);parent=v;do{parent=null===(_a=g.getParent(parent))||void 0===_a?void 0:_a.id,vPath.push(parent)}while(parent&&(postorderNums[parent].low>low||lim>postorderNums[parent].lim));for(lca=parent,parent=w;parent&&parent!==lca;)wPath.push(parent),parent=null===(_b=g.getParent(parent))||void 0===_b?void 0:_b.id;return{lca,path:vPath.concat(wPath.reverse())}}(g,postorderNums,originalEdge.source,originalEdge.target),path=pathData.path,lca=pathData.lca,pathIdx=0,pathV=path[pathIdx],ascending=!0;v!==originalEdge.target;){if(node=g.getNode(v),ascending){for(;pathV!==lca&&(null===(_a=g.getNode(pathV))||void 0===_a?void 0:_a.data.maxRank)<node.data.rank;)pathV=path[++pathIdx];pathV===lca&&(ascending=!1)}if(!ascending){for(;pathIdx<path.length-1&&(null===(_b=g.getNode(path[pathIdx+1]))||void 0===_b?void 0:_b.data.minRank)<=node.data.rank;)pathIdx++;pathV=path[pathIdx]}g.hasNode(pathV)&&g.setParent(v,pathV),v=g.getSuccessors(v)[0].id}}))},nesting_graph_dfs=function(g,root,nodeSep,weight,height,depths,v){var children=g.getChildren(v);if(null==children?void 0:children.length){var top=addBorderNode(g,"_bt"),bottom=addBorderNode(g,"_bb"),label=g.getNode(v);g.setParent(top,v),label.data.borderTop=top,g.setParent(bottom,v),label.data.borderBottom=bottom,null==children||children.forEach((function(childNode){nesting_graph_dfs(g,root,nodeSep,weight,height,depths,childNode.id);var childTop=childNode.data.borderTop?childNode.data.borderTop:childNode.id,childBottom=childNode.data.borderBottom?childNode.data.borderBottom:childNode.id,thisWeight=childNode.data.borderTop?weight:2*weight,minlen=childTop!==childBottom?1:height-depths[v]+1;g.addEdge({id:"e"+Math.random(),source:top,target:childTop,data:{minlen,weight:thisWeight,nestingEdge:!0}}),g.addEdge({id:"e"+Math.random(),source:childBottom,target:bottom,data:{minlen,weight:thisWeight,nestingEdge:!0}})})),g.getParent(v)||g.addEdge({id:"e"+Math.random(),source:root,target:top,data:{weight:0,minlen:height+depths[v]}})}else v!==root&&g.addEdge({id:"e"+Math.random(),source:root,target:v,data:{weight:0,minlen:nodeSep}})},treeDepths=function(g){var depths={},dfs=function(v,depth){var children=g.getChildren(v);null==children||children.forEach((function(child){return dfs(child.id,depth+1)})),depths[v]=depth};return g.getRoots().forEach((function(v){return dfs(v.id,1)})),depths},sumWeights=function(g){var result=0;return g.getAllEdges().forEach((function(e){result+=e.data.weight})),result},add_border_segments_addBorderNode=function(g,prop,prefix,sg,sgNode,rank){var label={rank,borderType:prop,width:0,height:0},prev=sgNode.data[prop][rank-1],curr=addDummyNode(g,"border",label,prefix);sgNode.data[prop][rank]=curr,g.setParent(curr,sg),prev&&g.addEdge({id:"e"+Math.random(),source:prev,target:curr,data:{weight:1}})},swapWidthHeight=function(g){g.getAllNodes().forEach((function(v){swapWidthHeightOne(v)})),g.getAllEdges().forEach((function(e){swapWidthHeightOne(e)}))},swapWidthHeightOne=function(node){var w=node.data.width;node.data.width=node.data.height,node.data.height=w},reverseY=function(g){g.getAllNodes().forEach((function(v){reverseYOne(v.data)})),g.getAllEdges().forEach((function(edge){var _a;null===(_a=edge.data.points)||void 0===_a||_a.forEach((function(point){return reverseYOne(point)})),edge.data.hasOwnProperty("y")&&reverseYOne(edge.data)}))},reverseYOne=function(node){(null==node?void 0:node.y)&&(node.y=-node.y)},swapXY=function(g){g.getAllNodes().forEach((function(v){swapXYOne(v.data)})),g.getAllEdges().forEach((function(edge){var _a;null===(_a=edge.data.points)||void 0===_a||_a.forEach((function(point){return swapXYOne(point)})),edge.data.hasOwnProperty("x")&&swapXYOne(edge.data)}))},swapXYOne=function(node){var x=node.x;node.x=node.y,node.y=x},initOrder=function(g){for(var visited={},simpleNodes=g.getAllNodes(),nodeRanks=simpleNodes.map((function(v){var _a;return null!==(_a=v.data.rank)&&void 0!==_a?_a:-1/0})),maxRank=Math.max.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(nodeRanks))),layers=[],i=0;i<maxRank+1;i++)layers.push([]);var orderedVs=simpleNodes.sort((function(a,b){return g.getNode(a.id).data.rank-g.getNode(b.id).data.rank})),fixOrderNodes=orderedVs.filter((function(n){return void 0!==g.getNode(n.id).data.fixorder})).sort((function(a,b){return g.getNode(a.id).data.fixorder-g.getNode(b.id).data.fixorder}));return null==fixOrderNodes||fixOrderNodes.forEach((function(n){isNaN(g.getNode(n.id).data.rank)||layers[g.getNode(n.id).data.rank].push(n.id),visited[n.id]=!0})),null==orderedVs||orderedVs.forEach((function(n){return g.dfsTree(n.id,(function(node){if(visited.hasOwnProperty(node.id))return!0;visited[node.id]=!0,isNaN(node.data.rank)||layers[node.data.rank].push(node.id)}))})),layers},twoLayerCrossCount=function(g,northLayer,southLayer){for(var southPos=zipObject(southLayer,southLayer.map((function(v,i){return i}))),southEntries=northLayer.map((function(v){var unsort=g.getRelatedEdges(v,"out").map((function(e){return{pos:southPos[e.target]||0,weight:e.data.weight}}));return null==unsort?void 0:unsort.sort((function(a,b){return a.pos-b.pos}))})).flat().filter((function(entry){return void 0!==entry})),firstIndex=1;firstIndex<southLayer.length;)firstIndex<<=1;var treeSize=2*firstIndex-1;firstIndex-=1;var tree=Array(treeSize).fill(0,0,treeSize),cc=0;return null==southEntries||southEntries.forEach((function(entry){if(entry){var index=entry.pos+firstIndex;tree[index]+=entry.weight;for(var weightSum=0;index>0;)index%2&&(weightSum+=tree[index+1]),tree[index=index-1>>1]+=entry.weight;cc+=entry.weight*weightSum}})),cc},crossCount=function(g,layering){for(var cc=0,i=1;i<(null==layering?void 0:layering.length);i+=1)cc+=twoLayerCrossCount(g,layering[i-1],layering[i]);return cc},createRootNode=function(g){for(var v;g.hasNode(v="_root"+Math.random()););return v},doResolveConflicts=function(sourceSet){for(var _a,_b,entries=[],_loop_1=function(){var entry=sourceSet.pop();entries.push(entry),null===(_a=entry.in.reverse())||void 0===_a||_a.forEach((function(e){return(vEntry=entry,function(uEntry){uEntry.merged||(void 0===uEntry.barycenter||void 0===vEntry.barycenter||uEntry.barycenter>=vEntry.barycenter)&&mergeEntries(vEntry,uEntry)})(e);var vEntry})),null===(_b=entry.out)||void 0===_b||_b.forEach((function(e){return(vEntry=entry,function(wEntry){wEntry.in.push(vEntry),0==--wEntry.indegree&&sourceSet.push(wEntry)})(e);var vEntry}))};null==sourceSet?void 0:sourceSet.length;)_loop_1();var filtered=entries.filter((function(entry){return!entry.merged})),keys=["vs","i","barycenter","weight"];return filtered.map((function(entry){var picked={};return null==keys||keys.forEach((function(key){void 0!==entry[key]&&(picked[key]=entry[key])})),picked}))},mergeEntries=function(target,source){var _a,sum=0,weight=0;target.weight&&(sum+=target.barycenter*target.weight,weight+=target.weight),source.weight&&(sum+=source.barycenter*source.weight,weight+=source.weight),target.vs=null===(_a=source.vs)||void 0===_a?void 0:_a.concat(target.vs),target.barycenter=sum/weight,target.weight=weight,target.i=Math.min(source.i,target.i),source.merged=!0};const resolve_conflicts=function(entries,cg){var _a,_b,_c,mappedEntries={};null==entries||entries.forEach((function(entry,i){mappedEntries[entry.v]={i,indegree:0,in:[],out:[],vs:[entry.v]};var tmp=mappedEntries[entry.v];void 0!==entry.barycenter&&(tmp.barycenter=entry.barycenter,tmp.weight=entry.weight)})),null===(_a=cg.getAllEdges())||void 0===_a||_a.forEach((function(e){var entryV=mappedEntries[e.source],entryW=mappedEntries[e.target];void 0!==entryV&&void 0!==entryW&&(entryW.indegree++,entryV.out.push(mappedEntries[e.target]))}));var sourceSet=null===(_c=(_b=Object.values(mappedEntries)).filter)||void 0===_c?void 0:_c.call(_b,(function(entry){return!entry.indegree}));return doResolveConflicts(sourceSet)};var consumeUnsortable=function(vs,unsortable,index){for(var last,iindex=index;unsortable.length&&(last=unsortable[unsortable.length-1]).i<=iindex;)unsortable.pop(),null==vs||vs.push(last.vs),iindex++;return iindex},compareWithBias=function(bias,usePrev){return function(entryV,entryW){if(void 0!==entryV.fixorder&&void 0!==entryW.fixorder)return entryV.fixorder-entryW.fixorder;if(entryV.barycenter<entryW.barycenter)return-1;if(entryV.barycenter>entryW.barycenter)return 1;if(usePrev&&void 0!==entryV.order&&void 0!==entryW.order){if(entryV.order<entryW.order)return-1;if(entryV.order>entryW.order)return 1}return bias?entryW.i-entryV.i:entryV.i-entryW.i}},sortSubgraph=function(g,v,cg,biasRight,usePrev,keepNodeOrder){var _a,_b,_c,_d,movable=g.getChildren(v).map((function(n){return n.id})),node=g.getNode(v),bl=node?node.data.borderLeft:void 0,br=node?node.data.borderRight:void 0,subgraphs={};bl&&(movable=null==movable?void 0:movable.filter((function(w){return w!==bl&&w!==br})));var barycenters=function(g,movable){return movable.map((function(v){var inV=g.getRelatedEdges(v,"in");if(!(null==inV?void 0:inV.length))return{v};var result={sum:0,weight:0};return null==inV||inV.forEach((function(e){var nodeU=g.getNode(e.source);result.sum+=e.data.weight*nodeU.data.order,result.weight+=e.data.weight})),{v,barycenter:result.sum/result.weight,weight:result.weight}}))}(g,movable||[]);null==barycenters||barycenters.forEach((function(entry){var _a;if(null===(_a=g.getChildren(entry.v))||void 0===_a?void 0:_a.length){var subgraphResult=sortSubgraph(g,entry.v,cg,biasRight,keepNodeOrder);subgraphs[entry.v]=subgraphResult,subgraphResult.hasOwnProperty("barycenter")&&mergeBarycenters(entry,subgraphResult)}}));var entries=resolve_conflicts(barycenters,cg);expandSubgraphs(entries,subgraphs),null===(_a=entries.filter((function(e){return e.vs.length>0})))||void 0===_a||_a.forEach((function(e){var node=g.getNode(e.vs[0]);node&&(e.fixorder=node.data.fixorder,e.order=node.data.order)}));var result=function(entries,biasRight,usePrev,keepNodeOrder){var parts=function(collection,fn){var result={lhs:[],rhs:[]};return null==collection||collection.forEach((function(value){fn(value)?result.lhs.push(value):result.rhs.push(value)})),result}(entries,(function(entry){var hasFixOrder=entry.hasOwnProperty("fixorder")&&!isNaN(entry.fixorder);return keepNodeOrder?!hasFixOrder&&entry.hasOwnProperty("barycenter"):hasFixOrder||entry.hasOwnProperty("barycenter")})),sortable=parts.lhs,unsortable=parts.rhs.sort((function(a,b){return-a.i- -b.i})),vs=[],sum=0,weight=0,vsIndex=0;null==sortable||sortable.sort(compareWithBias(!!biasRight,!!usePrev)),vsIndex=consumeUnsortable(vs,unsortable,vsIndex),null==sortable||sortable.forEach((function(entry){var _a;vsIndex+=null===(_a=entry.vs)||void 0===_a?void 0:_a.length,vs.push(entry.vs),sum+=entry.barycenter*entry.weight,weight+=entry.weight,vsIndex=consumeUnsortable(vs,unsortable,vsIndex)}));var result={vs:vs.flat()};return weight&&(result.barycenter=sum/weight,result.weight=weight),result}(entries,biasRight,usePrev,keepNodeOrder);if(bl&&(result.vs=[bl,result.vs,br].flat(),null===(_b=g.getPredecessors(bl))||void 0===_b?void 0:_b.length)){var blPred=g.getNode((null===(_c=g.getPredecessors(bl))||void 0===_c?void 0:_c[0].id)||""),brPred=g.getNode((null===(_d=g.getPredecessors(br))||void 0===_d?void 0:_d[0].id)||"");result.hasOwnProperty("barycenter")||(result.barycenter=0,result.weight=0),result.barycenter=(result.barycenter*result.weight+blPred.data.order+brPred.data.order)/(result.weight+2),result.weight+=2}return result},expandSubgraphs=function(entries,subgraphs){null==entries||entries.forEach((function(entry){var _a,vss=null===(_a=entry.vs)||void 0===_a?void 0:_a.map((function(v){return subgraphs[v]?subgraphs[v].vs:v}));entry.vs=vss.flat()}))},mergeBarycenters=function(target,other){void 0!==target.barycenter?(target.barycenter=(target.barycenter*target.weight+other.barycenter*other.weight)/(target.weight+other.weight),target.weight+=other.weight):(target.barycenter=other.barycenter,target.weight=other.weight)},clone=__webpack_require__("./node_modules/@antv/util/esm/lodash/clone.js"),buildLayerGraphs=function(g,ranks,direction){return ranks.map((function(rank){return function(g,rank,direction){var root=createRootNode(g),result=new esm_graph.M({tree:[{id:root,children:[],data:{}}]});return g.getAllNodes().forEach((function(v){var parent=g.getParent(v.id);(v.data.rank===rank||v.data.minRank<=rank&&rank<=v.data.maxRank)&&(result.hasNode(v.id)||result.addNode((0,tslib_es6.C3)({},v)),(null==parent?void 0:parent.id)&&!result.hasNode(null==parent?void 0:parent.id)&&result.addNode((0,tslib_es6.C3)({},parent)),result.setParent(v.id,(null==parent?void 0:parent.id)||root),g.getRelatedEdges(v.id,direction).forEach((function(e){var u=e.source===v.id?e.target:e.source;result.hasNode(u)||result.addNode((0,tslib_es6.C3)({},g.getNode(u)));var edge=result.getRelatedEdges(u,"out").find((function(_a){return _a.target===v.id})),weight=void 0!==edge?edge.data.weight:0;edge?result.updateEdgeData(edge.id,(0,tslib_es6.C3)((0,tslib_es6.C3)({},edge.data),{weight:e.data.weight+weight})):result.addEdge({id:e.id,source:u,target:v.id,data:{weight:e.data.weight+weight}})})),v.data.hasOwnProperty("minRank")&&result.updateNodeData(v.id,(0,tslib_es6.C3)((0,tslib_es6.C3)({},v.data),{borderLeft:v.data.borderLeft[rank],borderRight:v.data.borderRight[rank]})))})),result}(g,rank,direction)}))},sweepLayerGraphs=function(layerGraphs,biasRight,usePrev,keepNodeOrder){var cg=new esm_graph.M;null==layerGraphs||layerGraphs.forEach((function(lg){for(var _a,root=lg.getRoots()[0].id,sorted=sortSubgraph(lg,root,cg,biasRight,usePrev,keepNodeOrder),i=0;i<(null===(_a=sorted.vs)||void 0===_a?void 0:_a.length);i++){var lnode=lg.getNode(sorted.vs[i]);lnode&&(lnode.data.order=i)}!function(g,cg,vs){var rootPrev,prev={};null==vs||vs.forEach((function(v){for(var parent,prevChild,child=g.getParent(v);child;){if((parent=g.getParent(child.id))?(prevChild=prev[parent.id],prev[parent.id]=child.id):(prevChild=rootPrev,rootPrev=child.id),prevChild&&prevChild!==child.id)return cg.hasNode(prevChild)||cg.addNode({id:prevChild,data:{}}),cg.hasNode(child.id)||cg.addNode({id:child.id,data:{}}),void(cg.hasEdge("e"+prevChild+"-"+child.id)||cg.addEdge({id:"e"+prevChild+"-"+child.id,source:prevChild,target:child.id,data:{}}));child=parent}}))}(lg,cg,sorted.vs)}))},assignOrder=function(g,layering){null==layering||layering.forEach((function(layer){null==layer||layer.forEach((function(v,i){g.getNode(v).data.order=i}))}))},findType1Conflicts=function(g,layering){var conflicts={};return(null==layering?void 0:layering.length)&&layering.reduce((function(prevLayer,layer){var k0=0,scanPos=0,prevLayerLength=prevLayer.length,lastNode=null==layer?void 0:layer[(null==layer?void 0:layer.length)-1];return null==layer||layer.forEach((function(v,i){var _a,w=findOtherInnerSegmentNode(g,v),k1=w?g.getNode(w.id).data.order:prevLayerLength;(w||v===lastNode)&&(null===(_a=layer.slice(scanPos,i+1))||void 0===_a||_a.forEach((function(scanNode){var _a;null===(_a=g.getPredecessors(scanNode))||void 0===_a||_a.forEach((function(u){var _a,uLabel=g.getNode(u.id),uPos=uLabel.data.order;!(uPos<k0||k1<uPos)||uLabel.data.dummy&&(null===(_a=g.getNode(scanNode))||void 0===_a?void 0:_a.data.dummy)||addConflict(conflicts,u.id,scanNode)}))})),scanPos=i+1,k0=k1)})),layer})),conflicts},findType2Conflicts=function(g,layering){var conflicts={};function scan(south,southPos,southEnd,prevNorthBorder,nextNorthBorder){for(var _a,_b,v,i=southPos;i<southEnd;i++)v=south[i],(null===(_a=g.getNode(v))||void 0===_a?void 0:_a.data.dummy)&&(null===(_b=g.getPredecessors(v))||void 0===_b||_b.forEach((function(u){var uNode=g.getNode(u.id);uNode.data.dummy&&(uNode.data.order<prevNorthBorder||uNode.data.order>nextNorthBorder)&&addConflict(conflicts,u.id,v)})))}function scanIfNeeded(params,scanCache){var cacheKey=function getScannedKey(params){return JSON.stringify(params.slice(1))}(params);scanCache.get(cacheKey)||(scan.apply(void 0,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(params))),scanCache.set(cacheKey,!0))}return(null==layering?void 0:layering.length)&&layering.reduce((function(north,south){var nextNorthPos,prevNorthPos=-1,southPos=0,scanned=new Map;return null==south||south.forEach((function(v,southLookahead){var _a;if("border"===(null===(_a=g.getNode(v))||void 0===_a?void 0:_a.data.dummy)){var predecessors=g.getPredecessors(v)||[];predecessors.length&&(nextNorthPos=g.getNode(predecessors[0].id).data.order,scanIfNeeded([south,southPos,southLookahead,prevNorthPos,nextNorthPos],scanned),southPos=southLookahead,prevNorthPos=nextNorthPos)}scanIfNeeded([south,southPos,south.length,nextNorthPos,north.length],scanned)})),south})),conflicts},findOtherInnerSegmentNode=function(g,v){var _a,_b;if(null===(_a=g.getNode(v))||void 0===_a?void 0:_a.data.dummy)return null===(_b=g.getPredecessors(v))||void 0===_b?void 0:_b.find((function(u){return g.getNode(u.id).data.dummy}))},addConflict=function(conflicts,v,w){var vv=v,ww=w;if(vv>ww){var tmp=vv;vv=ww,ww=tmp}var conflictsV=conflicts[vv];conflictsV||(conflicts[vv]=conflictsV={}),conflictsV[ww]=!0},hasConflict=function(conflicts,v,w){var vv=v;vv>w&&(vv=w);return!!conflicts[vv]},verticalAlignment=function(g,layering,conflicts,neighborFn){var root={},align={},pos={};return null==layering||layering.forEach((function(layer){null==layer||layer.forEach((function(v,order){root[v]=v,align[v]=v,pos[v]=order}))})),null==layering||layering.forEach((function(layer){var prevIdx=-1;null==layer||layer.forEach((function(v){var ws=neighborFn(v).map((function(n){return n.id}));if(ws.length)for(var mp=((ws=ws.sort((function(a,b){return pos[a]-pos[b]}))).length-1)/2,i=Math.floor(mp),il=Math.ceil(mp);i<=il;++i){var w=ws[i];align[v]===v&&prevIdx<pos[w]&&!hasConflict(conflicts,v,w)&&(align[w]=v,align[v]=root[v]=root[w],prevIdx=pos[w])}}))})),{root,align}},horizontalCompaction=function(g,layering,root,align,nodesep,edgesep,reverseSep){var _a,xs={},blockG=buildBlockGraph(g,layering,root,nodesep,edgesep,reverseSep),borderType=reverseSep?"borderLeft":"borderRight",iterate=function(setXsFunc,nextNodesFunc){for(var stack=blockG.getAllNodes(),elem=stack.pop(),visited={};elem;)visited[elem.id]?setXsFunc(elem.id):(visited[elem.id]=!0,stack.push(elem),stack=stack.concat(nextNodesFunc(elem.id))),elem=stack.pop()};return iterate((function(elem){xs[elem]=(blockG.getRelatedEdges(elem,"in")||[]).reduce((function(acc,e){return Math.max(acc,(xs[e.source]||0)+e.data.weight)}),0)}),blockG.getPredecessors.bind(blockG)),iterate((function(elem){var min=(blockG.getRelatedEdges(elem,"out")||[]).reduce((function(acc,e){return Math.min(acc,(xs[e.target]||0)-e.data.weight)}),Number.POSITIVE_INFINITY),node=g.getNode(elem);min!==Number.POSITIVE_INFINITY&&node.data.borderType!==borderType&&(xs[elem]=Math.max(xs[elem],min))}),blockG.getSuccessors.bind(blockG)),null===(_a=Object.values(align))||void 0===_a||_a.forEach((function(v){xs[v]=xs[root[v]]})),xs},buildBlockGraph=function(g,layering,root,nodesep,edgesep,reverseSep){var blockGraph=new esm_graph.M,sepFn=sep(nodesep,edgesep,reverseSep);return null==layering||layering.forEach((function(layer){var u;null==layer||layer.forEach((function(v){var vRoot=root[v];if(blockGraph.hasNode(vRoot)||blockGraph.addNode({id:vRoot,data:{}}),u){var uRoot=root[u],edge=blockGraph.getRelatedEdges(uRoot,"out").find((function(edge){return edge.target===vRoot}));edge?blockGraph.updateEdgeData(edge.id,(0,tslib_es6.C3)((0,tslib_es6.C3)({},edge.data),{weight:Math.max(sepFn(g,v,u),edge.data.weight||0)})):blockGraph.addEdge({id:"e"+Math.random(),source:uRoot,target:vRoot,data:{weight:Math.max(sepFn(g,v,u),0)}})}u=v}))})),blockGraph},findSmallestWidthAlignment=function(g,xss){return minBy(Object.values(xss),(function(xs){var _a,max=Number.NEGATIVE_INFINITY,min=Number.POSITIVE_INFINITY;return null===(_a=Object.keys(xs))||void 0===_a||_a.forEach((function(v){var x=xs[v],halfWidth=width(g,v)/2;max=Math.max(x+halfWidth,max),min=Math.min(x-halfWidth,min)})),max-min}))};function alignCoordinates(xss,alignTo){var alignToVals=Object.values(alignTo),alignToMin=Math.min.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(alignToVals))),alignToMax=Math.max.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(alignToVals)));["u","d"].forEach((function(vert){["l","r"].forEach((function(horiz){var delta,alignment=vert+horiz,xs=xss[alignment];if(xs!==alignTo){var xsVals=Object.values(xs);(delta="l"===horiz?alignToMin-Math.min.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(xsVals))):alignToMax-Math.max.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(xsVals))))&&(xss[alignment]={},Object.keys(xs).forEach((function(key){xss[alignment][key]=xs[key]+delta})))}}))}))}var balance=function(xss,align){var result={};return Object.keys(xss.ul).forEach((function(key){if(align)result[key]=xss[align.toLowerCase()][key];else{var values=Object.values(xss).map((function(x){return x[key]}));result[key]=(values[0]+values[1])/2}})),result},sep=function(nodeSep,edgeSep,reverseSep){return function(g,v,w){var vLabel=g.getNode(v),wLabel=g.getNode(w),sum=0,delta=0;if(sum+=vLabel.data.width/2,vLabel.data.hasOwnProperty("labelpos"))switch((vLabel.data.labelpos||"").toLowerCase()){case"l":delta=-vLabel.data.width/2;break;case"r":delta=vLabel.data.width/2}if(delta&&(sum+=reverseSep?delta:-delta),delta=0,sum+=(vLabel.data.dummy?edgeSep:nodeSep)/2,sum+=(wLabel.data.dummy?edgeSep:nodeSep)/2,sum+=wLabel.data.width/2,wLabel.data.labelpos)switch((wLabel.data.labelpos||"").toLowerCase()){case"l":delta=wLabel.data.width/2;break;case"r":delta=-wLabel.data.width/2}return delta&&(sum+=reverseSep?delta:-delta),delta=0,sum}},width=function(g,v){return g.getNode(v).data.width||0},position=function(g,options){var _a,ng=asNonCompoundGraph(g);!function(g,options){var _a=(options||{}).ranksep,ranksep=void 0===_a?0:_a,layering=util_buildLayerMatrix(g),prevY=0;null==layering||layering.forEach((function(layer){var heights=layer.map((function(v){return g.getNode(v).data.height})),maxHeight=Math.max.apply(Math,(0,tslib_es6.Mt)((0,tslib_es6.Mt)([],(0,tslib_es6.o5)(heights)),[0]));null==layer||layer.forEach((function(v){g.getNode(v).data.y=prevY+maxHeight/2})),prevY+=maxHeight+ranksep}))}(ng,options);var xs=function(g,options){var _a=options||{},graphAlign=_a.align,_b=_a.nodesep,nodesep=void 0===_b?0:_b,_c=_a.edgesep,edgesep=void 0===_c?0:_c,layering=util_buildLayerMatrix(g),conflicts=Object.assign(findType1Conflicts(g,layering),findType2Conflicts(g,layering)),xss={},adjustedLayering=[];["u","d"].forEach((function(vert){adjustedLayering="u"===vert?layering:Object.values(layering).reverse(),["l","r"].forEach((function(horiz){"r"===horiz&&(adjustedLayering=adjustedLayering.map((function(inner){return Object.values(inner).reverse()})));var neighborFn=("u"===vert?g.getPredecessors:g.getSuccessors).bind(g),align=verticalAlignment(0,adjustedLayering,conflicts,neighborFn),xs=horizontalCompaction(g,adjustedLayering,align.root,align.align,nodesep,edgesep,"r"===horiz);"r"===horiz&&Object.keys(xs).forEach((function(xsKey){return xs[xsKey]=-xs[xsKey]})),xss[vert+horiz]=xs}))}));var smallestWidth=findSmallestWidthAlignment(g,xss);return smallestWidth&&alignCoordinates(xss,smallestWidth),balance(xss,graphAlign)}(ng,options);null===(_a=Object.keys(xs))||void 0===_a||_a.forEach((function(key){ng.getNode(key).data.x=xs[key]}))},runLayout=function(g,options){var acyclicer=options.acyclicer,ranker=options.ranker,_a=options.rankdir,rankdir=void 0===_a?"tb":_a,nodeOrder=options.nodeOrder,keepNodeOrder=options.keepNodeOrder,align=options.align,_b=options.nodesep,nodesep=void 0===_b?50:_b,_c=options.edgesep,edgesep=void 0===_c?20:_c,_d=options.ranksep,ranksep=void 0===_d?50:_d;removeSelfEdges(g),run(g,acyclicer);var _e=function(g){var root=addDummyNode(g,"root",{},"_root"),depths=treeDepths(g),maxDepth=Math.max.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(Object.values(depths))));Math.abs(maxDepth)===1/0&&(maxDepth=1);var height=maxDepth-1,nodeSep=2*height+1;g.getAllEdges().forEach((function(e){e.data.minlen*=nodeSep}));var weight=sumWeights(g)+1;return g.getRoots().forEach((function(child){nesting_graph_dfs(g,root,nodeSep,weight,height,depths,child.id)})),{nestingRoot:root,nodeRankFactor:nodeSep}}(g),nestingRoot=_e.nestingRoot,nodeRankFactor=_e.nodeRankFactor;!function(g,ranker){switch(ranker){case"network-simplex":networkSimplexRanker(g);break;case"tight-tree":default:tightTreeRanker(g);break;case"longest-path":longestPathRanker(g)}}(asNonCompoundGraph(g),ranker),injectEdgeLabelProxies(g),function(g,nodeRankFactor){void 0===nodeRankFactor&&(nodeRankFactor=0);var nodes=g.getAllNodes(),nodeRanks=nodes.filter((function(v){return void 0!==v.data.rank})).map((function(v){return v.data.rank})),offset=Math.min.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(nodeRanks))),layers=[];nodes.forEach((function(v){var rank=(v.data.rank||0)-offset;layers[rank]||(layers[rank]=[]),layers[rank].push(v.id)}));for(var delta=0,i=0;i<layers.length;i++){var vs=layers[i];void 0===vs?i%nodeRankFactor!=0&&(delta-=1):delta&&(null==vs||vs.forEach((function(v){var node=g.getNode(v);node&&(node.data.rank=node.data.rank||0,node.data.rank+=delta)})))}}(g,nodeRankFactor),function(g,nestingRoot){nestingRoot&&g.removeNode(nestingRoot),g.getAllEdges().forEach((function(e){e.data.nestingEdge&&g.removeEdge(e.id)}))}(g,nestingRoot),function(g){var nodeRanks=g.getAllNodes().filter((function(v){return void 0!==v.data.rank})).map((function(v){return v.data.rank})),min=Math.min.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(nodeRanks)));g.getAllNodes().forEach((function(v){v.data.hasOwnProperty("rank")&&min!==1/0&&(v.data.rank-=min)}))}(g),assignRankMinMax(g),removeEdgeLabelProxies(g);var dummyChains=[];!function(g,dummyChains){g.getAllEdges().forEach((function(edge){return normalizeEdge(g,edge,dummyChains)}))}(g,dummyChains),parentDummyChains(g,dummyChains),function(g){var dfs=function(v){var children=g.getChildren(v),node=g.getNode(v);if((null==children?void 0:children.length)&&children.forEach((function(child){return dfs(child.id)})),node.data.hasOwnProperty("minRank")){node.data.borderLeft=[],node.data.borderRight=[];for(var rank=node.data.minRank,maxRank=node.data.maxRank+1;rank<maxRank;rank+=1)add_border_segments_addBorderNode(g,"borderLeft","_bl",v,node,rank),add_border_segments_addBorderNode(g,"borderRight","_br",v,node,rank)}};g.getRoots().forEach((function(child){return dfs(child.id)}))}(g),keepNodeOrder&&function(g,nodeOrder){for(var ranks=g.getAllNodes().filter((function(v){var _a;return!(null===(_a=g.getChildren(v.id))||void 0===_a?void 0:_a.length)})).map((function(v){return v.data.rank})),maxRank=Math.max.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(ranks))),layers=[],i=0;i<maxRank+1;i++)layers[i]=[];null==nodeOrder||nodeOrder.forEach((function(n){var node=g.getNode(n);node&&!node.data.dummy&&(isNaN(node.data.rank)||(node.data.fixorder=layers[node.data.rank].length,layers[node.data.rank].push(n)))}))}(g,nodeOrder),function(g,keepNodeOrder){for(var mxRank=maxRank(g),range1=[],range2=[],i=1;i<mxRank+1;i++)range1.push(i);for(i=mxRank-1;i>-1;i--)range2.push(i);var downLayerGraphs=buildLayerGraphs(g,range1,"in"),upLayerGraphs=buildLayerGraphs(g,range2,"out"),layering=initOrder(g);assignOrder(g,layering);for(var best,bestCC=Number.POSITIVE_INFINITY,lastBest=(i=0,0);lastBest<4;++i,++lastBest)sweepLayerGraphs(i%2?downLayerGraphs:upLayerGraphs,i%4>=2,!1,keepNodeOrder),layering=util_buildLayerMatrix(g),(cc=crossCount(g,layering))<bestCC&&(lastBest=0,best=(0,clone.c)(layering),bestCC=cc);for(layering=initOrder(g),assignOrder(g,layering),i=0,lastBest=0;lastBest<4;++i,++lastBest){var cc;sweepLayerGraphs(i%2?downLayerGraphs:upLayerGraphs,i%4>=2,!0,keepNodeOrder),layering=util_buildLayerMatrix(g),(cc=crossCount(g,layering))<bestCC&&(lastBest=0,best=(0,clone.c)(layering),bestCC=cc)}assignOrder(g,best)}(g,keepNodeOrder),insertSelfEdges(g),function(g,rankdir){var rd=rankdir.toLowerCase();"lr"!==rd&&"rl"!==rd||swapWidthHeight(g)}(g,rankdir),position(g,{align,nodesep,edgesep,ranksep}),positionSelfEdges(g),removeBorderNodes(g),function(g,dummyChains){dummyChains.forEach((function(v){var w,node=g.getNode(v),originalEdge=node.data.originalEdge;originalEdge&&g.addEdge(originalEdge);for(var currentV=v;node.data.dummy;)w=g.getSuccessors(currentV)[0],g.removeNode(currentV),originalEdge.data.points.push({x:node.data.x,y:node.data.y}),"edge-label"===node.data.dummy&&(originalEdge.data.x=node.data.x,originalEdge.data.y=node.data.y,originalEdge.data.width=node.data.width,originalEdge.data.height=node.data.height),currentV=w.id,node=g.getNode(currentV)}))}(g,dummyChains),fixupEdgeLabelCoords(g),function(g,rankdir){var rd=rankdir.toLowerCase();"bt"!==rd&&"rl"!==rd||reverseY(g),"lr"!==rd&&"rl"!==rd||(swapXY(g),swapWidthHeight(g))}(g,rankdir);var _f=translateGraph(g),width=_f.width,height=_f.height;return assignNodeIntersects(g),reversePointsForReversedEdges(g),function(g){g.getAllEdges().forEach((function(e){var label=e.data;if(label.reversed){g.removeEdge(e.id);var forwardName=label.forwardName;delete label.reversed,delete label.forwardName,g.addEdge({id:e.id,source:e.target,target:e.source,data:(0,tslib_es6.C3)((0,tslib_es6.C3)({},label),{forwardName})})}}))}(g),{width,height}},inheritOrder=function(currG,prevG){currG.getAllNodes().forEach((function(n){var node=currG.getNode(n.id);if(prevG.hasNode(n.id)){var prevNode=prevG.getNode(n.id);node.data.fixorder=prevNode.data._order,delete prevNode.data._order}else delete node.data.fixorder}))},updateInputGraph=function(inputGraph,layoutGraph){inputGraph.getAllNodes().forEach((function(v){var _a,inputLabel=inputGraph.getNode(v.id);if(inputLabel){var layoutLabel=layoutGraph.getNode(v.id);inputLabel.data.x=layoutLabel.data.x,inputLabel.data.y=layoutLabel.data.y,inputLabel.data._order=layoutLabel.data.order,inputLabel.data._rank=layoutLabel.data.rank,(null===(_a=layoutGraph.getChildren(v.id))||void 0===_a?void 0:_a.length)&&(inputLabel.data.width=layoutLabel.data.width,inputLabel.data.height=layoutLabel.data.height)}})),inputGraph.getAllEdges().forEach((function(e){var inputLabel=inputGraph.getEdge(e.id),layoutLabel=layoutGraph.getEdge(e.id);inputLabel.data.points=layoutLabel?layoutLabel.data.points:[],layoutLabel&&layoutLabel.data.hasOwnProperty("x")&&(inputLabel.data.x=layoutLabel.data.x,inputLabel.data.y=layoutLabel.data.y)}))},nodeNumAttrs=["width","height","layer","fixorder"],nodeDefaults={width:0,height:0},edgeNumAttrs=["minlen","weight","width","height","labeloffset"],edgeDefaults={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},edgeAttrs=["labelpos"],buildLayoutGraph=function(inputGraph){var g=new esm_graph.M({tree:[]});return inputGraph.getAllNodes().forEach((function(v){var node=canonicalize(inputGraph.getNode(v.id).data),defaultNode=(0,tslib_es6.C3)((0,tslib_es6.C3)({},nodeDefaults),node),defaultAttrs=selectNumberAttrs(defaultNode,nodeNumAttrs);g.hasNode(v.id)||g.addNode({id:v.id,data:(0,tslib_es6.C3)({},defaultAttrs)});var parent=inputGraph.hasTreeStructure("combo")?inputGraph.getParent(v.id,"combo"):inputGraph.getParent(v.id);(0,is_nil.c)(parent)||(g.hasNode(parent.id)||g.addNode((0,tslib_es6.C3)({},parent)),g.setParent(v.id,parent.id))})),inputGraph.getAllEdges().forEach((function(e){var edge=canonicalize(inputGraph.getEdge(e.id).data),pickedProperties={};null==edgeAttrs||edgeAttrs.forEach((function(key){void 0!==edge[key]&&(pickedProperties[key]=edge[key])})),g.addEdge({id:e.id,source:e.source,target:e.target,data:Object.assign({},edgeDefaults,selectNumberAttrs(edge,edgeNumAttrs),pickedProperties)})})),g},makeSpaceForEdgeLabels=function(g,options){var _a=options.ranksep,ranksep=void 0===_a?0:_a,rankdir=options.rankdir;return g.getAllNodes().forEach((function(node){isNaN(node.data.layer)||node.data.layer||(node.data.layer=0)})),g.getAllEdges().forEach((function(edge){var _a;edge.data.minlen*=2,"c"!==(null===(_a=edge.data.labelpos)||void 0===_a?void 0:_a.toLowerCase())&&("TB"===rankdir||"BT"===rankdir?edge.data.width+=edge.data.labeloffset:edge.data.height+=edge.data.labeloffset)})),ranksep/2},injectEdgeLabelProxies=function(g){g.getAllEdges().forEach((function(e){if(e.data.width&&e.data.height){var v=g.getNode(e.source),label={e,rank:(g.getNode(e.target).data.rank-v.data.rank)/2+v.data.rank};addDummyNode(g,"edge-proxy",label,"_ep")}}))},assignRankMinMax=function(g){var maxRank=0;return g.getAllNodes().forEach((function(node){var _a,_b;node.data.borderTop&&(node.data.minRank=null===(_a=g.getNode(node.data.borderTop))||void 0===_a?void 0:_a.data.rank,node.data.maxRank=null===(_b=g.getNode(node.data.borderBottom))||void 0===_b?void 0:_b.data.rank,maxRank=Math.max(maxRank,node.data.maxRank||-1/0))})),maxRank},removeEdgeLabelProxies=function(g){g.getAllNodes().forEach((function(node){"edge-proxy"===node.data.dummy&&(g.getEdge(node.data.e.id).data.labelRank=node.data.rank,g.removeNode(node.id))}))},translateGraph=function(g,options){var minX,minY,maxX=0,maxY=0,_a=options||{},_b=_a.marginx,marginX=void 0===_b?0:_b,_c=_a.marginy,marginY=void 0===_c?0:_c,getExtremes=function(attrs){if(attrs.data){var x=attrs.data.x,y=attrs.data.y,w=attrs.data.width,h=attrs.data.height;isNaN(x)||isNaN(w)||(void 0===minX&&(minX=x-w/2),minX=Math.min(minX,x-w/2),maxX=Math.max(maxX,x+w/2)),isNaN(y)||isNaN(h)||(void 0===minY&&(minY=y-h/2),minY=Math.min(minY,y-h/2),maxY=Math.max(maxY,y+h/2))}};return g.getAllNodes().forEach((function(v){getExtremes(v)})),g.getAllEdges().forEach((function(e){(null==e?void 0:e.data.hasOwnProperty("x"))&&getExtremes(e)})),minX-=marginX,minY-=marginY,g.getAllNodes().forEach((function(node){node.data.x-=minX,node.data.y-=minY})),g.getAllEdges().forEach((function(edge){var _a;null===(_a=edge.data.points)||void 0===_a||_a.forEach((function(p){p.x-=minX,p.y-=minY})),edge.data.hasOwnProperty("x")&&(edge.data.x-=minX),edge.data.hasOwnProperty("y")&&(edge.data.y-=minY)})),{width:maxX-minX+marginX,height:maxY-minY+marginY}},assignNodeIntersects=function(g){g.getAllEdges().forEach((function(e){var p1,p2,nodeV=g.getNode(e.source),nodeW=g.getNode(e.target);e.data.points?(p1=e.data.points[0],p2=e.data.points[e.data.points.length-1]):(e.data.points=[],p1={x:nodeW.data.x,y:nodeW.data.y},p2={x:nodeV.data.x,y:nodeV.data.y}),e.data.points.unshift(intersectRect(nodeV.data,p1)),e.data.points.push(intersectRect(nodeW.data,p2))}))},fixupEdgeLabelCoords=function(g){g.getAllEdges().forEach((function(edge){if(edge.data.hasOwnProperty("x"))switch("l"!==edge.data.labelpos&&"r"!==edge.data.labelpos||(edge.data.width-=edge.data.labeloffset),edge.data.labelpos){case"l":edge.data.x-=edge.data.width/2+edge.data.labeloffset;break;case"r":edge.data.x+=edge.data.width/2+edge.data.labeloffset}}))},reversePointsForReversedEdges=function(g){g.getAllEdges().forEach((function(edge){var _a;edge.data.reversed&&(null===(_a=edge.data.points)||void 0===_a||_a.reverse())}))},removeBorderNodes=function(g){g.getAllNodes().forEach((function(v){var _a,_b,_c;if(null===(_a=g.getChildren(v.id))||void 0===_a?void 0:_a.length){var node=g.getNode(v.id),t=g.getNode(node.data.borderTop),b=g.getNode(node.data.borderBottom),l=g.getNode(node.data.borderLeft[(null===(_b=node.data.borderLeft)||void 0===_b?void 0:_b.length)-1]),r=g.getNode(node.data.borderRight[(null===(_c=node.data.borderRight)||void 0===_c?void 0:_c.length)-1]);node.data.width=Math.abs((null==r?void 0:r.data.x)-(null==l?void 0:l.data.x))||10,node.data.height=Math.abs((null==b?void 0:b.data.y)-(null==t?void 0:t.data.y))||10,node.data.x=((null==l?void 0:l.data.x)||0)+node.data.width/2,node.data.y=((null==t?void 0:t.data.y)||0)+node.data.height/2}})),g.getAllNodes().forEach((function(n){"border"===n.data.dummy&&g.removeNode(n.id)}))},removeSelfEdges=function(g){g.getAllEdges().forEach((function(e){if(e.source===e.target){var node=g.getNode(e.source);node.data.selfEdges||(node.data.selfEdges=[]),node.data.selfEdges.push(e),g.removeEdge(e.id)}}))},insertSelfEdges=function(g){var layers=util_buildLayerMatrix(g);null==layers||layers.forEach((function(layer){var orderShift=0;null==layer||layer.forEach((function(v,i){var _a,node=g.getNode(v);node.data.order=i+orderShift,null===(_a=node.data.selfEdges)||void 0===_a||_a.forEach((function(selfEdge){addDummyNode(g,"selfedge",{width:selfEdge.data.width,height:selfEdge.data.height,rank:node.data.rank,order:i+ ++orderShift,e:selfEdge},"_se")})),delete node.data.selfEdges}))}))},positionSelfEdges=function(g){g.getAllNodes().forEach((function(v){var node=g.getNode(v.id);if("selfedge"===node.data.dummy){var selfNode=g.getNode(node.data.e.source),x=selfNode.data.x+selfNode.data.width/2,y=selfNode.data.y,dx=node.data.x-x,dy=selfNode.data.height/2;g.hasEdge(node.data.e.id)?g.updateEdgeData(node.data.e.id,node.data.e.data):g.addEdge({id:node.data.e.id,source:node.data.e.source,target:node.data.e.target,data:node.data.e.data}),g.removeNode(v.id),node.data.e.data.points=[{x:x+2*dx/3,y:y-dy},{x:x+5*dx/6,y:y-dy},{y,x:x+dx},{x:x+5*dx/6,y:y+dy},{x:x+2*dx/3,y:y+dy}],node.data.e.data.x=node.data.x,node.data.e.data.y=node.data.y}}))},selectNumberAttrs=function(obj,attrs){var pickedProperties={};return null==attrs||attrs.forEach((function(key){void 0!==obj[key]&&(pickedProperties[key]=+obj[key])})),pickedProperties},canonicalize=function(attrs){void 0===attrs&&(attrs={});var newAttrs={};return Object.keys(attrs).forEach((function(k){newAttrs[k.toLowerCase()]=attrs[k]})),newAttrs},util_function=__webpack_require__("./node_modules/@antv/layout/lib/util/function.js"),object=__webpack_require__("./node_modules/@antv/layout/lib/util/object.js"),DEFAULTS_LAYOUT_OPTIONS={rankdir:"TB",nodesep:50,ranksep:50,edgeLabelSpace:!0,ranker:"tight-tree",controlPoints:!1,radial:!1,focusNode:null},DagreLayout=function(){function DagreLayout(options){void 0===options&&(options={}),this.options=options,this.id="dagre",this.options=(0,tslib_es6.C3)((0,tslib_es6.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return DagreLayout.prototype.execute=function(graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){return(0,tslib_es6.KE)(this,(function(_a){return[2,this.genericDagreLayout(!1,graph,options)]}))}))},DagreLayout.prototype.assign=function(graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){return(0,tslib_es6.KE)(this,(function(_a){switch(_a.label){case 0:return[4,this.genericDagreLayout(!0,graph,options)];case 1:return _a.sent(),[2]}}))}))},DagreLayout.prototype.genericDagreLayout=function(assign,graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){var mergedOptions,nodeSize,align,_a,rankdir,ranksep,nodesep,ranksepFunc,nodesepFunc,edgeLabelSpace,ranker,nodeOrder,begin,controlPoints,radial,sortByCombo,preset,g,ranksepfunc,nodesepfunc,horisep,vertisep,nodeSizeFunc,nodes,edges,prevGraph,layoutTopLeft,minX_1,minY_1,isHorizontal,layerCoords_1,layerCoordSort,layerCoordsArr_1,isDifferentLayer_1,filterControlPointsOutOfBoundary_1,layoutNodes,layoutEdges;return(0,tslib_es6.KE)(this,(function(_b){return mergedOptions=(0,tslib_es6.C3)((0,tslib_es6.C3)({},this.options),options),nodeSize=mergedOptions.nodeSize,align=mergedOptions.align,_a=mergedOptions.rankdir,rankdir=void 0===_a?"TB":_a,ranksep=mergedOptions.ranksep,nodesep=mergedOptions.nodesep,ranksepFunc=mergedOptions.ranksepFunc,nodesepFunc=mergedOptions.nodesepFunc,edgeLabelSpace=mergedOptions.edgeLabelSpace,ranker=mergedOptions.ranker,nodeOrder=mergedOptions.nodeOrder,begin=mergedOptions.begin,controlPoints=mergedOptions.controlPoints,radial=mergedOptions.radial,sortByCombo=mergedOptions.sortByCombo,preset=mergedOptions.preset,g=new esm_graph.M({tree:[]}),ranksepfunc=(0,util_function.uA)(ranksep||50,ranksepFunc),nodesepfunc=(0,util_function.uA)(nodesep||50,nodesepFunc),horisep=nodesepfunc,vertisep=ranksepfunc,"LR"!==rankdir&&"RL"!==rankdir||(horisep=ranksepfunc,vertisep=nodesepfunc),nodeSizeFunc=(0,util_function.G0)(nodeSize,void 0),nodes=graph.getAllNodes(),edges=graph.getAllEdges(),nodes.forEach((function(node){var size=nodeSizeFunc(node),verti=vertisep(node),width=size+2*horisep(node),height=size+2*verti,layer=node.data.layer;(0,is_number.c)(layer)?g.addNode({id:node.id,data:{width,height,layer}}):g.addNode({id:node.id,data:{width,height}})})),sortByCombo&&(g.attachTreeStructure("combo"),nodes.forEach((function(node){var parentId=node.data.parentId;void 0!==parentId&&g.hasNode(parentId)&&g.setParent(node.id,parentId,"combo")}))),edges.forEach((function(edge){g.addEdge({id:edge.id,source:edge.source,target:edge.target,data:{weight:edge.data.weight||1}})})),prevGraph=void 0,(null==preset?void 0:preset.length)&&(prevGraph=new esm_graph.M({nodes:preset})),function(g,options){var edgeLabelSpace=options.edgeLabelSpace,keepNodeOrder=options.keepNodeOrder,prevGraph=options.prevGraph,rankdir=options.rankdir,ranksep=options.ranksep;!keepNodeOrder&&prevGraph&&inheritOrder(g,prevGraph);var dimension,layoutGraph=buildLayoutGraph(g);edgeLabelSpace&&(options.ranksep=makeSpaceForEdgeLabels(layoutGraph,{rankdir,ranksep}));try{dimension=runLayout(layoutGraph,options)}catch(e){if("Not possible to find intersection inside of the rectangle"===e.message)return void console.error("The following error may be caused by improper layer setting, please make sure your manual layer setting does not violate the graph's structure:\n",e);throw e}updateInputGraph(g,layoutGraph)}(g,{prevGraph,edgeLabelSpace,keepNodeOrder:!!nodeOrder,nodeOrder:nodeOrder||[],acyclicer:"greedy",ranker,rankdir,nodesep,align}),layoutTopLeft=[0,0],begin&&(minX_1=1/0,minY_1=1/0,g.getAllNodes().forEach((function(node){minX_1>node.data.x&&(minX_1=node.data.x),minY_1>node.data.y&&(minY_1=node.data.y)})),g.getAllEdges().forEach((function(edge){var _a;null===(_a=edge.data.points)||void 0===_a||_a.forEach((function(point){minX_1>point.x&&(minX_1=point.x),minY_1>point.y&&(minY_1=point.y)}))})),layoutTopLeft[0]=begin[0]-minX_1,layoutTopLeft[1]=begin[1]-minY_1),isHorizontal="LR"===rankdir||"RL"===rankdir,radial||(layerCoords_1=new Set,layerCoordSort="BT"===rankdir||"RL"===rankdir?function(a,b){return b-a}:function(a,b){return a-b},g.getAllNodes().forEach((function(node){node.data.x=node.data.x+layoutTopLeft[0],node.data.y=node.data.y+layoutTopLeft[1],layerCoords_1.add(isHorizontal?node.data.x:node.data.y)})),layerCoordsArr_1=Array.from(layerCoords_1).sort(layerCoordSort),isDifferentLayer_1=isHorizontal?function(point1,point2){return point1.x!==point2.x}:function(point1,point2){return point1.y!==point2.y},filterControlPointsOutOfBoundary_1=isHorizontal?function(ps,point1,point2){var max=Math.max(point1.y,point2.y),min=Math.min(point1.y,point2.y);return ps.filter((function(point){return point.y<=max&&point.y>=min}))}:function(ps,point1,point2){var max=Math.max(point1.x,point2.x),min=Math.min(point1.x,point2.x);return ps.filter((function(point){return point.x<=max&&point.x>=min}))},g.getAllEdges().forEach((function(edge,i){var _a;edgeLabelSpace&&controlPoints&&"loop"!==edge.data.type&&(edge.data.controlPoints=getControlPoints(null===(_a=edge.data.points)||void 0===_a?void 0:_a.map((function(_a){var x=_a.x,y=_a.y;return{x:x+layoutTopLeft[0],y:y+layoutTopLeft[1]}})),g.getNode(edge.source),g.getNode(edge.target),layerCoordsArr_1,isHorizontal,isDifferentLayer_1,filterControlPointsOutOfBoundary_1))}))),layoutNodes=[],layoutNodes=g.getAllNodes().map((function(node){return(0,object.o)(node)})),layoutEdges=g.getAllEdges(),assign&&(layoutNodes.forEach((function(node){graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),layoutEdges.forEach((function(edge){graph.mergeEdgeData(edge.id,{controlPoints:edge.data.controlPoints})}))),[2,{nodes:layoutNodes,edges:layoutEdges}]}))}))},DagreLayout}(),getControlPoints=function(points,sourceNode,targetNode,layerCoordsArr,isHorizontal,isDifferentLayer,filterControlPointsOutOfBoundary){var controlPoints=(null==points?void 0:points.slice(1,points.length-1))||[];if(sourceNode&&targetNode){var _a=sourceNode.data,sourceX=_a.x,sourceY=_a.y,_b=targetNode.data,targetX=_b.x,targetY=_b.y;if(isHorizontal&&(sourceX=sourceNode.data.y,sourceY=sourceNode.data.x,targetX=targetNode.data.y,targetY=targetNode.data.x),targetY!==sourceY&&sourceX!==targetX){var sourceLayer=layerCoordsArr.indexOf(sourceY),sourceNextLayerCoord=layerCoordsArr[sourceLayer+1];if(sourceNextLayerCoord){var firstControlPoint=controlPoints[0],insertStartControlPoint=isHorizontal?{x:(sourceY+sourceNextLayerCoord)/2,y:(null==firstControlPoint?void 0:firstControlPoint.y)||targetX}:{x:(null==firstControlPoint?void 0:firstControlPoint.x)||targetX,y:(sourceY+sourceNextLayerCoord)/2};firstControlPoint&&!isDifferentLayer(firstControlPoint,insertStartControlPoint)||controlPoints.unshift(insertStartControlPoint)}var targetLayer=layerCoordsArr.indexOf(targetY),layerDiff=Math.abs(targetLayer-sourceLayer);if(1===layerDiff)(controlPoints=filterControlPointsOutOfBoundary(controlPoints,sourceNode.data,targetNode.data)).length||controlPoints.push(isHorizontal?{x:(sourceY+targetY)/2,y:sourceX}:{x:sourceX,y:(sourceY+targetY)/2});else if(layerDiff>1){var targetLastLayerCoord=layerCoordsArr[targetLayer-1];if(targetLastLayerCoord){var lastControlPoints=controlPoints[controlPoints.length-1],insertEndControlPoint=isHorizontal?{x:(targetY+targetLastLayerCoord)/2,y:(null==lastControlPoints?void 0:lastControlPoints.y)||targetX}:{x:(null==lastControlPoints?void 0:lastControlPoints.x)||sourceX,y:(targetY+targetLastLayerCoord)/2};lastControlPoints&&!isDifferentLayer(lastControlPoints,insertEndControlPoint)||controlPoints.push(insertEndControlPoint)}}}}return controlPoints}},"./node_modules/@antv/layout/lib/force/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{k:()=>ForceLayout});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),esm_graph=__webpack_require__("./node_modules/@antv/graphlib/esm/graph.js"),is_number=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),is_object=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-object.js"),is_function=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-function.js"),util_function=__webpack_require__("./node_modules/@antv/layout/lib/util/function.js"),array=__webpack_require__("./node_modules/@antv/layout/lib/util/array.js"),quadtree=__webpack_require__("./node_modules/d3-quadtree/src/quadtree.js");function add_add(tree,x,y,z,d){if(isNaN(x)||isNaN(y)||isNaN(z))return tree;var parent,xm,ym,zm,xp,yp,zp,right,bottom,deep,i,j,node=tree._root,leaf={data:d},x0=tree._x0,y0=tree._y0,z0=tree._z0,x1=tree._x1,y1=tree._y1,z1=tree._z1;if(!node)return tree._root=leaf,tree;for(;node.length;)if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,(deep=z>=(zm=(z0+z1)/2))?z0=zm:z1=zm,parent=node,!(node=node[i=deep<<2|bottom<<1|right]))return parent[i]=leaf,tree;if(xp=+tree._x.call(null,node.data),yp=+tree._y.call(null,node.data),zp=+tree._z.call(null,node.data),x===xp&&y===yp&&z===zp)return leaf.next=node,parent?parent[i]=leaf:tree._root=leaf,tree;do{parent=parent?parent[i]=new Array(8):tree._root=new Array(8),(right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,(deep=z>=(zm=(z0+z1)/2))?z0=zm:z1=zm}while((i=deep<<2|bottom<<1|right)==(j=(zp>=zm)<<2|(yp>=ym)<<1|xp>=xm));return parent[j]=node,parent[i]=leaf,tree}function octant(node,x0,y0,z0,x1,y1,z1){this.node=node,this.x0=x0,this.y0=y0,this.z0=z0,this.x1=x1,this.y1=y1,this.z1=z1}function defaultX(d){return d[0]}function defaultY(d){return d[1]}function defaultZ(d){return d[2]}function octree(nodes,x,y,z){var tree=new Octree(null==x?defaultX:x,null==y?defaultY:y,null==z?defaultZ:z,NaN,NaN,NaN,NaN,NaN,NaN);return null==nodes?tree:tree.addAll(nodes)}function Octree(x,y,z,x0,y0,z0,x1,y1,z1){this._x=x,this._y=y,this._z=z,this._x0=x0,this._y0=y0,this._z0=z0,this._x1=x1,this._y1=y1,this._z1=z1,this._root=void 0}function leaf_copy(leaf){for(var copy={data:leaf.data},next=copy;leaf=leaf.next;)next=next.next={data:leaf.data};return copy}var treeProto=octree.prototype=Octree.prototype;treeProto.copy=function(){var nodes,child,copy=new Octree(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),node=this._root;if(!node)return copy;if(!node.length)return copy._root=leaf_copy(node),copy;for(nodes=[{source:node,target:copy._root=new Array(8)}];node=nodes.pop();)for(var i=0;i<8;++i)(child=node.source[i])&&(child.length?nodes.push({source:child,target:node.target[i]=new Array(8)}):node.target[i]=leaf_copy(child));return copy},treeProto.add=function add(d){const x=+this._x.call(null,d),y=+this._y.call(null,d),z=+this._z.call(null,d);return add_add(this.cover(x,y,z),x,y,z,d)},treeProto.addAll=function addAll(data){Array.isArray(data)||(data=Array.from(data));const n=data.length,xz=new Float64Array(n),yz=new Float64Array(n),zz=new Float64Array(n);let x0=1/0,y0=1/0,z0=1/0,x1=-1/0,y1=-1/0,z1=-1/0;for(let d,x,y,z,i=0;i<n;++i)isNaN(x=+this._x.call(null,d=data[i]))||isNaN(y=+this._y.call(null,d))||isNaN(z=+this._z.call(null,d))||(xz[i]=x,yz[i]=y,zz[i]=z,x<x0&&(x0=x),x>x1&&(x1=x),y<y0&&(y0=y),y>y1&&(y1=y),z<z0&&(z0=z),z>z1&&(z1=z));if(x0>x1||y0>y1||z0>z1)return this;this.cover(x0,y0,z0).cover(x1,y1,z1);for(let i=0;i<n;++i)add_add(this,xz[i],yz[i],zz[i],data[i]);return this},treeProto.cover=function cover(x,y,z){if(isNaN(x=+x)||isNaN(y=+y)||isNaN(z=+z))return this;var x0=this._x0,y0=this._y0,z0=this._z0,x1=this._x1,y1=this._y1,z1=this._z1;if(isNaN(x0))x1=(x0=Math.floor(x))+1,y1=(y0=Math.floor(y))+1,z1=(z0=Math.floor(z))+1;else{for(var parent,i,t=x1-x0||1,node=this._root;x0>x||x>=x1||y0>y||y>=y1||z0>z||z>=z1;)switch(i=(z<z0)<<2|(y<y0)<<1|x<x0,(parent=new Array(8))[i]=node,node=parent,t*=2,i){case 0:x1=x0+t,y1=y0+t,z1=z0+t;break;case 1:x0=x1-t,y1=y0+t,z1=z0+t;break;case 2:x1=x0+t,y0=y1-t,z1=z0+t;break;case 3:x0=x1-t,y0=y1-t,z1=z0+t;break;case 4:x1=x0+t,y1=y0+t,z0=z1-t;break;case 5:x0=x1-t,y1=y0+t,z0=z1-t;break;case 6:x1=x0+t,y0=y1-t,z0=z1-t;break;case 7:x0=x1-t,y0=y1-t,z0=z1-t}this._root&&this._root.length&&(this._root=node)}return this._x0=x0,this._y0=y0,this._z0=z0,this._x1=x1,this._y1=y1,this._z1=z1,this},treeProto.data=function data(){var data=[];return this.visit((function(node){if(!node.length)do{data.push(node.data)}while(node=node.next)})),data},treeProto.extent=function extent(_){return arguments.length?this.cover(+_[0][0],+_[0][1],+_[0][2]).cover(+_[1][0],+_[1][1],+_[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]},treeProto.find=function find(x,y,z,radius){var data,x1,y1,z1,x2,y2,z2,q,i,x0=this._x0,y0=this._y0,z0=this._z0,x3=this._x1,y3=this._y1,z3=this._z1,octs=[],node=this._root;for(node&&octs.push(new octant(node,x0,y0,z0,x3,y3,z3)),null==radius?radius=1/0:(x0=x-radius,y0=y-radius,z0=z-radius,x3=x+radius,y3=y+radius,z3=z+radius,radius*=radius);q=octs.pop();)if(!(!(node=q.node)||(x1=q.x0)>x3||(y1=q.y0)>y3||(z1=q.z0)>z3||(x2=q.x1)<x0||(y2=q.y1)<y0||(z2=q.z1)<z0))if(node.length){var xm=(x1+x2)/2,ym=(y1+y2)/2,zm=(z1+z2)/2;octs.push(new octant(node[7],xm,ym,zm,x2,y2,z2),new octant(node[6],x1,ym,zm,xm,y2,z2),new octant(node[5],xm,y1,zm,x2,ym,z2),new octant(node[4],x1,y1,zm,xm,ym,z2),new octant(node[3],xm,ym,z1,x2,y2,zm),new octant(node[2],x1,ym,z1,xm,y2,zm),new octant(node[1],xm,y1,z1,x2,ym,zm),new octant(node[0],x1,y1,z1,xm,ym,zm)),(i=(z>=zm)<<2|(y>=ym)<<1|x>=xm)&&(q=octs[octs.length-1],octs[octs.length-1]=octs[octs.length-1-i],octs[octs.length-1-i]=q)}else{var dx=x-+this._x.call(null,node.data),dy=y-+this._y.call(null,node.data),dz=z-+this._z.call(null,node.data),d2=dx*dx+dy*dy+dz*dz;if(d2<radius){var d=Math.sqrt(radius=d2);x0=x-d,y0=y-d,z0=z-d,x3=x+d,y3=y+d,z3=z+d,data=node.data}}return data},treeProto.remove=function remove(d){if(isNaN(x=+this._x.call(null,d))||isNaN(y=+this._y.call(null,d))||isNaN(z=+this._z.call(null,d)))return this;var parent,retainer,previous,next,x,y,z,xm,ym,zm,right,bottom,deep,i,j,node=this._root,x0=this._x0,y0=this._y0,z0=this._z0,x1=this._x1,y1=this._y1,z1=this._z1;if(!node)return this;if(node.length)for(;;){if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,(deep=z>=(zm=(z0+z1)/2))?z0=zm:z1=zm,parent=node,!(node=node[i=deep<<2|bottom<<1|right]))return this;if(!node.length)break;(parent[i+1&7]||parent[i+2&7]||parent[i+3&7]||parent[i+4&7]||parent[i+5&7]||parent[i+6&7]||parent[i+7&7])&&(retainer=parent,j=i)}for(;node.data!==d;)if(previous=node,!(node=node.next))return this;return(next=node.next)&&delete node.next,previous?(next?previous.next=next:delete previous.next,this):parent?(next?parent[i]=next:delete parent[i],(node=parent[0]||parent[1]||parent[2]||parent[3]||parent[4]||parent[5]||parent[6]||parent[7])&&node===(parent[7]||parent[6]||parent[5]||parent[4]||parent[3]||parent[2]||parent[1]||parent[0])&&!node.length&&(retainer?retainer[j]=node:this._root=node),this):(this._root=next,this)},treeProto.removeAll=function removeAll(data){for(var i=0,n=data.length;i<n;++i)this.remove(data[i]);return this},treeProto.root=function root(){return this._root},treeProto.size=function size(){var size=0;return this.visit((function(node){if(!node.length)do{++size}while(node=node.next)})),size},treeProto.visit=function visit(callback){var q,child,x0,y0,z0,x1,y1,z1,octs=[],node=this._root;for(node&&octs.push(new octant(node,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));q=octs.pop();)if(!callback(node=q.node,x0=q.x0,y0=q.y0,z0=q.z0,x1=q.x1,y1=q.y1,z1=q.z1)&&node.length){var xm=(x0+x1)/2,ym=(y0+y1)/2,zm=(z0+z1)/2;(child=node[7])&&octs.push(new octant(child,xm,ym,zm,x1,y1,z1)),(child=node[6])&&octs.push(new octant(child,x0,ym,zm,xm,y1,z1)),(child=node[5])&&octs.push(new octant(child,xm,y0,zm,x1,ym,z1)),(child=node[4])&&octs.push(new octant(child,x0,y0,zm,xm,ym,z1)),(child=node[3])&&octs.push(new octant(child,xm,ym,z0,x1,y1,zm)),(child=node[2])&&octs.push(new octant(child,x0,ym,z0,xm,y1,zm)),(child=node[1])&&octs.push(new octant(child,xm,y0,z0,x1,ym,zm)),(child=node[0])&&octs.push(new octant(child,x0,y0,z0,xm,ym,zm))}return this},treeProto.visitAfter=function visitAfter(callback){var q,octs=[],next=[];for(this._root&&octs.push(new octant(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));q=octs.pop();){var node=q.node;if(node.length){var child,x0=q.x0,y0=q.y0,z0=q.z0,x1=q.x1,y1=q.y1,z1=q.z1,xm=(x0+x1)/2,ym=(y0+y1)/2,zm=(z0+z1)/2;(child=node[0])&&octs.push(new octant(child,x0,y0,z0,xm,ym,zm)),(child=node[1])&&octs.push(new octant(child,xm,y0,z0,x1,ym,zm)),(child=node[2])&&octs.push(new octant(child,x0,ym,z0,xm,y1,zm)),(child=node[3])&&octs.push(new octant(child,xm,ym,z0,x1,y1,zm)),(child=node[4])&&octs.push(new octant(child,x0,y0,zm,xm,ym,z1)),(child=node[5])&&octs.push(new octant(child,xm,y0,zm,x1,ym,z1)),(child=node[6])&&octs.push(new octant(child,x0,ym,zm,xm,y1,z1)),(child=node[7])&&octs.push(new octant(child,xm,ym,zm,x1,y1,z1))}next.push(q)}for(;q=next.pop();)callback(q.node,q.x0,q.y0,q.z0,q.x1,q.y1,q.z1);return this},treeProto.x=function x(_){return arguments.length?(this._x=_,this):this._x},treeProto.y=function y(_){return arguments.length?(this._y=_,this):this._y},treeProto.z=function z(_){return arguments.length?(this._z=_,this):this._z};function forceNBody(calcGraph,factor,coulombDisScale2,accMap,dimensions){void 0===dimensions&&(dimensions=2);var weightParam=factor/coulombDisScale2,calcNodes=calcGraph.getAllNodes(),data=calcNodes.map((function(calcNode,i){var _a=calcNode.data,nodeStrength=_a.nodeStrength;return{x:_a.x,y:_a.y,z:_a.z,size:_a.size,index:i,id:calcNode.id,vx:0,vy:0,vz:0,weight:weightParam*nodeStrength}})),tree=(2===dimensions?(0,quadtree.c)(data,(function(d){return d.x}),(function(d){return d.y})):octree(data,(function(d){return d.x}),(function(d){return d.y}),(function(d){return d.z}))).visitAfter(accumulate),nodeMap=new Map;return data.forEach((function(n){nodeMap.set(n.id,n),function computeForce(node,tree,dimensions){tree.visit((function(treeNode,x1,y1,x2,y2){return apply(treeNode,x1,y1,x2,y2,node,dimensions)}))}(n,tree,dimensions)})),data.map((function(n,i){var _a=calcNodes[i],id=_a.id,_b=_a.data.mass,mass=void 0===_b?1:_b;accMap[id]={x:n.vx/mass,y:n.vy/mass,z:n.vz/mass}})),accMap}function accumulate(treeNode){var accWeight=0,accX=0,accY=0,accZ=0,accSize=0,numChildren=treeNode.length;if(numChildren){for(var i=0;i<numChildren;i++){(q=treeNode[i])&&q.weight&&(accWeight+=q.weight,accX+=q.x*q.weight,accY+=q.y*q.weight,accZ+=q.z*q.weight,accSize+=q.size*q.weight)}treeNode.x=accX/accWeight,treeNode.y=accY/accWeight,treeNode.z=accZ/accWeight,treeNode.size=accSize/accWeight,treeNode.weight=accWeight}else{var q=treeNode;treeNode.x=q.data.x,treeNode.y=q.data.y,treeNode.z=q.data.z,treeNode.size=q.data.size,treeNode.weight=q.data.weight}}var apply=function(treeNode,x1,arg1,arg2,arg3,node,dimensions){var _a;if((null===(_a=treeNode.data)||void 0===_a?void 0:_a.id)!==node.id){for(var x2=[arg1,arg2,arg3][dimensions-1],dx=node.x-treeNode.x||.1,dy=node.y-treeNode.y||.1,dz=node.z-treeNode.z||.1,pos=[dx,dy,dz],width=x2-x1,len2=0,i=0;i<dimensions;i++)len2+=pos[i]*pos[i];var len3=Math.sqrt(len2)*len2;if(width*width*.81<len2){var param=treeNode.weight/len3;return node.vx+=dx*param,node.vy+=dy*param,node.vz+=dz*param,!0}if(treeNode.length)return!1;if(treeNode.data!==node){param=treeNode.data.weight/len3;node.vx+=dx*param,node.vy+=dy*param,node.vz+=dz*param}}};var DEFAULTS_LAYOUT_OPTIONS={dimensions:2,maxIteration:500,gravity:10,factor:1,edgeStrength:50,nodeStrength:1e3,coulombDisScale:.005,damping:.9,maxSpeed:200,minMovement:.4,interval:.02,linkDistance:200,clusterNodeStrength:20,preventOverlap:!0,distanceThresholdMode:"mean"},ForceLayout=function(){function ForceLayout(options){void 0===options&&(options={}),this.options=options,this.id="force",this.timeInterval=0,this.judgingDistance=0,this.running=!1,this.options=(0,tslib_es6.C3)((0,tslib_es6.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return ForceLayout.prototype.execute=function(graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){return(0,tslib_es6.KE)(this,(function(_a){return[2,this.genericForceLayout(!1,graph,options)]}))}))},ForceLayout.prototype.assign=function(graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){return(0,tslib_es6.KE)(this,(function(_a){return this.genericForceLayout(!0,graph,options),[2]}))}))},ForceLayout.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},ForceLayout.prototype.tick=function(iterations){var _this=this;if(void 0===iterations&&(iterations=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var i=0;(this.judgingDistance>this.lastOptions.minMovement||i<1)&&i<iterations;i++)this.runOneStep(this.lastCalcGraph,this.lastGraph,i,this.lastVelMap,this.lastOptions),this.updatePosition(this.lastGraph,this.lastCalcGraph,this.lastVelMap,this.lastOptions);var result={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&result.nodes.forEach((function(node){return _this.lastGraph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y,z:3===_this.options.dimensions?node.data.z:void 0})})),result},ForceLayout.prototype.genericForceLayout=function(assign,graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){var mergedOptions,nodes,edges,formattedOptions,dimensions,width,height,nodeSize,getMass,nodeStrength,edgeStrength,linkDistance,layoutNodes,layoutEdges,velMap,calcGraph,maxIteration,minMovement,onTick,iter,_this=this;return(0,tslib_es6.KE)(this,(function(_a){return mergedOptions=(0,tslib_es6.C3)((0,tslib_es6.C3)({},this.options),options),nodes=graph.getAllNodes(),edges=graph.getAllEdges(),formattedOptions=this.formatOptions(mergedOptions,graph),dimensions=formattedOptions.dimensions,width=formattedOptions.width,height=formattedOptions.height,nodeSize=formattedOptions.nodeSize,getMass=formattedOptions.getMass,nodeStrength=formattedOptions.nodeStrength,edgeStrength=formattedOptions.edgeStrength,linkDistance=formattedOptions.linkDistance,layoutNodes=nodes.map((function(node,i){return(0,tslib_es6.C3)((0,tslib_es6.C3)({},node),{data:(0,tslib_es6.C3)((0,tslib_es6.C3)({},node.data),{x:(0,is_number.c)(node.data.x)?node.data.x:Math.random()*width,y:(0,is_number.c)(node.data.y)?node.data.y:Math.random()*height,z:(0,is_number.c)(node.data.z)?node.data.z:Math.random()*Math.sqrt(width*height),size:nodeSize(node)||30,mass:getMass(node),nodeStrength:nodeStrength(node)})})})),layoutEdges=edges.map((function(edge){return(0,tslib_es6.C3)((0,tslib_es6.C3)({},edge),{data:(0,tslib_es6.C3)((0,tslib_es6.C3)({},edge.data),{edgeStrength:edgeStrength(edge),linkDistance:linkDistance(edge,graph.getNode(edge.source),graph.getNode(edge.target))})})})),(null==nodes?void 0:nodes.length)?(velMap={},nodes.forEach((function(node,i){velMap[node.id]={x:0,y:0,z:0}})),calcGraph=new esm_graph.M({nodes:layoutNodes,edges:layoutEdges}),this.formatCentripetal(formattedOptions,calcGraph),maxIteration=formattedOptions.maxIteration,minMovement=formattedOptions.minMovement,onTick=formattedOptions.onTick,this.lastLayoutNodes=layoutNodes,this.lastLayoutEdges=layoutEdges,this.lastAssign=assign,this.lastGraph=graph,this.lastCalcGraph=calcGraph,this.lastOptions=formattedOptions,this.lastVelMap=velMap,"undefined"==typeof window?[2]:(iter=0,[2,new Promise((function(resolve){_this.timeInterval=window.setInterval((function(){nodes&&_this.running||resolve({nodes:formatOutNodes(graph,layoutNodes),edges}),_this.runOneStep(calcGraph,graph,iter,velMap,formattedOptions),_this.updatePosition(graph,calcGraph,velMap,formattedOptions),assign&&layoutNodes.forEach((function(node){return graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y,z:3===dimensions?node.data.z:void 0})})),null==onTick||onTick({nodes:formatOutNodes(graph,layoutNodes),edges}),(++iter>=maxIteration||_this.judgingDistance<minMovement)&&(window.clearInterval(_this.timeInterval),resolve({nodes:formatOutNodes(graph,layoutNodes),edges}))}),0),_this.running=!0}))])):(this.lastResult={nodes:[],edges},[2,{nodes:[],edges}])}))}))},ForceLayout.prototype.formatOptions=function(options,graph){var formattedOptions=(0,tslib_es6.C3)({},options),propsWidth=options.width,propsHeight=options.height,getMass=options.getMass,nodeSize=options.nodeSize;formattedOptions.width=propsWidth||"undefined"==typeof window?propsWidth:window.innerWidth,formattedOptions.height=propsHeight||"undefined"==typeof window?propsHeight:window.innerHeight,options.center||(formattedOptions.center=[formattedOptions.width/2,formattedOptions.height/2]),getMass||(formattedOptions.getMass=function(d){var massWeight=1;(0,is_number.c)(null==d?void 0:d.data.mass)&&(massWeight=null==d?void 0:d.data.mass);var degree=graph.getDegree(d.id,"both");return!degree||degree<5?massWeight:5*degree*massWeight});var nodeSizeFn,nodeSpacingFunc=(0,util_function.uA)(0,options.nodeSpacing);nodeSizeFn=nodeSize?(0,is_function.c)(nodeSize)?function(d){return nodeSize(d)+nodeSpacingFunc(d)}:(0,array.c)(nodeSize)?function(d){var nodeSizeArr=nodeSize;return Math.max(nodeSizeArr[0],nodeSizeArr[1])+nodeSpacingFunc(d)}:function(d){return nodeSize+nodeSpacingFunc(d)}:function(d){var size=((null==d?void 0:d.data)||{}).size;return size?(0,array.c)(size)?Math.max(size[0],size[1])+nodeSpacingFunc(d):(0,is_object.c)(size)?Math.max(size.width,size.height)+nodeSpacingFunc(d):size+nodeSpacingFunc(d):10+nodeSpacingFunc(d)},formattedOptions.nodeSize=nodeSizeFn;var linkDistanceFn=options.linkDistance?(0,util_function.uA)(1,options.linkDistance):function(edge){return 1+formattedOptions.nodeSize(graph.getNode(edge.source))+formattedOptions.nodeSize(graph.getNode(edge.target))};return formattedOptions.linkDistance=linkDistanceFn,formattedOptions.nodeStrength=(0,util_function.uA)(1,options.nodeStrength),formattedOptions.edgeStrength=(0,util_function.uA)(1,options.edgeStrength),formattedOptions},ForceLayout.prototype.formatCentripetal=function(options,calcGraph){var sameTypeLeafMap,clusters,dimensions=options.dimensions,centripetalOptions=options.centripetalOptions,center=options.center,clusterNodeStrength=options.clusterNodeStrength,leafCluster=options.leafCluster,clustering=options.clustering,nodeClusterBy=options.nodeClusterBy,calcNodes=calcGraph.getAllNodes(),basicCentripetal=centripetalOptions||{leaf:2,single:2,others:1,center:function(n){return{x:center[0],y:center[1],z:3===dimensions?center[2]:void 0}}};if("function"!=typeof clusterNodeStrength&&(options.clusterNodeStrength=function(node){return clusterNodeStrength}),leafCluster&&nodeClusterBy&&(sameTypeLeafMap=getSameTypeLeafMap(calcGraph,nodeClusterBy),clusters=Array.from(new Set(null==calcNodes?void 0:calcNodes.map((function(node){return node.data[nodeClusterBy]}))))||[],options.centripetalOptions=Object.assign(basicCentripetal,{single:100,leaf:function(node){var _a=sameTypeLeafMap[node.id]||{},siblingLeaves=_a.siblingLeaves,sameTypeLeaves=_a.sameTypeLeaves;return(null==sameTypeLeaves?void 0:sameTypeLeaves.length)===(null==siblingLeaves?void 0:siblingLeaves.length)||1===(null==clusters?void 0:clusters.length)?1:options.clusterNodeStrength(node)},others:1,center:function(node){var centerPos,degree=calcGraph.getDegree(node.id,"both");if(!degree)return{x:100,y:100,z:0};if(1===degree){var _a=(sameTypeLeafMap[node.id]||{}).sameTypeLeaves,sameTypeLeaves=void 0===_a?[]:_a;1===sameTypeLeaves.length?centerPos=void 0:sameTypeLeaves.length>1&&(centerPos=getAvgNodePosition(sameTypeLeaves))}else centerPos=void 0;return{x:null==centerPos?void 0:centerPos.x,y:null==centerPos?void 0:centerPos.y,z:null==centerPos?void 0:centerPos.z}}})),clustering&&nodeClusterBy){sameTypeLeafMap||(sameTypeLeafMap=getSameTypeLeafMap(calcGraph,nodeClusterBy)),clusters||(clusters=Array.from(new Set(calcNodes.map((function(node){return node.data[nodeClusterBy]}))))),clusters=clusters.filter((function(item){return void 0!==item}));var centerInfo_1={};clusters.forEach((function(cluster){var sameTypeNodes=calcNodes.filter((function(node){return node.data[nodeClusterBy]===cluster})).map((function(node){return calcGraph.getNode(node.id)}));centerInfo_1[cluster]=getAvgNodePosition(sameTypeNodes)})),options.centripetalOptions=Object.assign(basicCentripetal,{single:function(node){return options.clusterNodeStrength(node)},leaf:function(node){return options.clusterNodeStrength(node)},others:function(node){return options.clusterNodeStrength(node)},center:function(node){var centerPos=centerInfo_1[node.data[nodeClusterBy]];return{x:null==centerPos?void 0:centerPos.x,y:null==centerPos?void 0:centerPos.y,z:null==centerPos?void 0:centerPos.z}}})}var _a=options.centripetalOptions||{},leaf=_a.leaf,single=_a.single,others=_a.others;leaf&&"function"!=typeof leaf&&(options.centripetalOptions.leaf=function(){return leaf}),single&&"function"!=typeof single&&(options.centripetalOptions.single=function(){return single}),others&&"function"!=typeof others&&(options.centripetalOptions.others=function(){return others})},ForceLayout.prototype.runOneStep=function(calcGraph,graph,iter,velMap,options){var accMap={},calcNodes=calcGraph.getAllNodes(),calcEdges=calcGraph.getAllEdges();if(null==calcNodes?void 0:calcNodes.length){var monitor=options.monitor;if(this.calRepulsive(calcGraph,accMap,options),calcEdges&&this.calAttractive(calcGraph,accMap,options),this.calGravity(calcGraph,graph,accMap,options),this.updateVelocity(calcGraph,accMap,velMap,options),monitor)monitor({energy:this.calTotalEnergy(accMap,calcNodes),nodes:graph.getAllNodes(),edges:graph.getAllEdges(),iterations:iter})}},ForceLayout.prototype.calTotalEnergy=function(accMap,nodes){var _this=this;if(!(null==nodes?void 0:nodes.length))return 0;var energy=0;return nodes.forEach((function(node,i){var vx=accMap[node.id].x,vy=accMap[node.id].y,vz=3===_this.options.dimensions?accMap[node.id].z:0,speed2=vx*vx+vy*vy+vz*vz,_a=node.data.mass;energy+=(void 0===_a?1:_a)*speed2*.5})),energy},ForceLayout.prototype.calRepulsive=function(calcGraph,accMap,options){var dimensions=options.dimensions,factor=options.factor,coulombDisScale=options.coulombDisScale;forceNBody(calcGraph,factor,coulombDisScale*coulombDisScale,accMap,dimensions)},ForceLayout.prototype.calAttractive=function(calcGraph,accMap,options){var dimensions=options.dimensions,nodeSize=options.nodeSize;calcGraph.getAllEdges().forEach((function(edge,i){var source=edge.source,target=edge.target,sourceNode=calcGraph.getNode(source),targetNode=calcGraph.getNode(target);if(sourceNode&&targetNode){var vecX=targetNode.data.x-sourceNode.data.x,vecY=targetNode.data.y-sourceNode.data.y,vecZ=3===dimensions?targetNode.data.z-sourceNode.data.z:0;vecX||vecY||(vecX=.01*Math.random(),vecY=.01*Math.random(),3!==dimensions||vecZ||(vecZ=.01*Math.random()));var vecLength=Math.sqrt(vecX*vecX+vecY*vecY+vecZ*vecZ);if(!(vecLength<nodeSize(sourceNode)+nodeSize(targetNode))){var direX=vecX/vecLength,direY=vecY/vecLength,direZ=vecZ/vecLength,_a=edge.data||{},_b=_a.linkDistance,linkDistance=void 0===_b?200:_b,_c=_a.edgeStrength,param=(linkDistance-vecLength)*(void 0===_c?200:_c),sourceMassRatio=1/(sourceNode.data.mass||1),targetMassRatio=1/(targetNode.data.mass||1),disX=direX*param,disY=direY*param,disZ=direZ*param;accMap[source].x-=disX*sourceMassRatio,accMap[source].y-=disY*sourceMassRatio,accMap[source].z-=disZ*sourceMassRatio,accMap[target].x+=disX*targetMassRatio,accMap[target].y+=disY*targetMassRatio,accMap[target].z+=disZ*targetMassRatio}}}))},ForceLayout.prototype.calGravity=function(calcGraph,graph,accMap,options){var getCenter=options.getCenter,calcNodes=calcGraph.getAllNodes(),nodes=graph.getAllNodes(),edges=graph.getAllEdges(),width=options.width,height=options.height,center=options.center,defaultGravity=options.gravity,centripetalOptions=options.centripetalOptions;calcNodes&&calcNodes.forEach((function(calcNode){var id=calcNode.id,data=calcNode.data,mass=data.mass,x=data.x,y=data.y,z=data.z,node=graph.getNode(id),vecX=0,vecY=0,vecZ=0,gravity=defaultGravity,inDegree=calcGraph.getDegree(id,"in"),outDegree=calcGraph.getDegree(id,"out"),degree=calcGraph.getDegree(id,"both"),forceCenter=null==getCenter?void 0:getCenter(node,degree);if(forceCenter){var _a=(0,tslib_es6.o5)(forceCenter,3);vecX=x-_a[0],vecY=y-_a[1],gravity=_a[2]}else vecX=x-center[0],vecY=y-center[1],vecZ=z-center[2];if(gravity&&(accMap[id].x-=gravity*vecX/mass,accMap[id].y-=gravity*vecY/mass,accMap[id].z-=gravity*vecZ/mass),centripetalOptions){var leaf=centripetalOptions.leaf,single=centripetalOptions.single,others=centripetalOptions.others,centriCenter=centripetalOptions.center,_b=(null==centriCenter?void 0:centriCenter(node,nodes,edges,width,height))||{x:0,y:0,z:0,centerStrength:0},centriX=_b.x,centriY=_b.y,centriZ=_b.z,centerStrength=_b.centerStrength;if(!(0,is_number.c)(centriX)||!(0,is_number.c)(centriY))return;var vx=(x-centriX)/mass,vy=(y-centriY)/mass,vz=(z-centriZ)/mass;if(centerStrength&&(accMap[id].x-=centerStrength*vx,accMap[id].y-=centerStrength*vy,accMap[id].z-=centerStrength*vz),0===degree){var singleStrength=single(node);if(!singleStrength)return;return accMap[id].x-=singleStrength*vx,accMap[id].y-=singleStrength*vy,void(accMap[id].z-=singleStrength*vz)}if(0===inDegree||0===outDegree){var leafStrength=leaf(node,nodes,edges);if(!leafStrength)return;return accMap[id].x-=leafStrength*vx,accMap[id].y-=leafStrength*vy,void(accMap[id].z-=leafStrength*vz)}var othersStrength=others(node);if(!othersStrength)return;accMap[id].x-=othersStrength*vx,accMap[id].y-=othersStrength*vy,accMap[id].z-=othersStrength*vz}}))},ForceLayout.prototype.updateVelocity=function(calcGraph,accMap,velMap,options){var damping=options.damping,maxSpeed=options.maxSpeed,interval=options.interval,dimensions=options.dimensions,calcNodes=calcGraph.getAllNodes();(null==calcNodes?void 0:calcNodes.length)&&calcNodes.forEach((function(calcNode){var id=calcNode.id,vx=(velMap[id].x+accMap[id].x*interval)*damping||.01,vy=(velMap[id].y+accMap[id].y*interval)*damping||.01,vz=3===dimensions?(velMap[id].z+accMap[id].z*interval)*damping||.01:0,vLength=Math.sqrt(vx*vx+vy*vy+vz*vz);if(vLength>maxSpeed){var param2=maxSpeed/vLength;vx*=param2,vy*=param2,vz*=param2}velMap[id]={x:vx,y:vy,z:vz}}))},ForceLayout.prototype.updatePosition=function(graph,calcGraph,velMap,options){var _this=this,distanceThresholdMode=options.distanceThresholdMode,interval=options.interval,dimensions=options.dimensions,calcNodes=calcGraph.getAllNodes();if(null==calcNodes?void 0:calcNodes.length){var sum=0;"max"===distanceThresholdMode?this.judgingDistance=-1/0:"min"===distanceThresholdMode&&(this.judgingDistance=1/0),calcNodes.forEach((function(calcNode){var id=calcNode.id,node=graph.getNode(id);if((0,is_number.c)(node.data.fx)&&(0,is_number.c)(node.data.fy))calcGraph.mergeNodeData(id,{x:node.data.fx,y:node.data.fy,z:3===dimensions?node.data.fz:void 0});else{var distX=velMap[id].x*interval,distY=velMap[id].y*interval,distZ=3===dimensions?velMap[id].z*interval:0;calcGraph.mergeNodeData(id,{x:calcNode.data.x+distX,y:calcNode.data.y+distY,z:calcNode.data.z+distZ});var distanceMagnitude=Math.sqrt(distX*distX+distY*distY+distZ*distZ);switch(distanceThresholdMode){case"max":_this.judgingDistance<distanceMagnitude&&(_this.judgingDistance=distanceMagnitude);break;case"min":_this.judgingDistance>distanceMagnitude&&(_this.judgingDistance=distanceMagnitude);break;default:sum+=distanceMagnitude}}})),distanceThresholdMode&&"mean"!==distanceThresholdMode||(this.judgingDistance=sum/calcNodes.length)}else this.judgingDistance=0},ForceLayout}(),getSameTypeLeafMap=function(calcGraph,nodeClusterBy){var calcNodes=calcGraph.getAllNodes();if(!(null==calcNodes?void 0:calcNodes.length))return{};var sameTypeLeafMap={};return calcNodes.forEach((function(node,i){1===calcGraph.getDegree(node.id,"both")&&(sameTypeLeafMap[node.id]=getCoreNodeAndSiblingLeaves(calcGraph,"leaf",node,nodeClusterBy))})),sameTypeLeafMap},getCoreNodeAndSiblingLeaves=function(calcGraph,type,node,nodeClusterBy){var inDegree=calcGraph.getDegree(node.id,"in"),outDegree=calcGraph.getDegree(node.id,"out"),coreNode=node,siblingLeaves=[];return 0===inDegree?(coreNode=calcGraph.getSuccessors(node.id)[0],siblingLeaves=calcGraph.getNeighbors(coreNode.id)):0===outDegree&&(coreNode=calcGraph.getPredecessors(node.id)[0],siblingLeaves=calcGraph.getNeighbors(coreNode.id)),siblingLeaves=siblingLeaves.filter((function(node){return 0===calcGraph.getDegree(node.id,"in")||0===calcGraph.getDegree(node.id,"out")})),{coreNode,siblingLeaves,sameTypeLeaves:getSameTypeNodes(calcGraph,type,nodeClusterBy,node,siblingLeaves)}},getSameTypeNodes=function(calcGraph,type,nodeClusterBy,node,relativeNodes){var typeName=node.data[nodeClusterBy]||"",sameTypeNodes=(null==relativeNodes?void 0:relativeNodes.filter((function(item){return item.data[nodeClusterBy]===typeName})))||[];return"leaf"===type&&(sameTypeNodes=sameTypeNodes.filter((function(item){return 0===calcGraph.getDegree(item.id,"in")||0===calcGraph.getDegree(item.id,"out")}))),sameTypeNodes},getAvgNodePosition=function(nodes){var totalNodes={x:0,y:0};nodes.forEach((function(node){var _a=node.data,x=_a.x,y=_a.y;totalNodes.x+=x||0,totalNodes.y+=y||0}));var length=nodes.length||1;return{x:totalNodes.x/length,y:totalNodes.y/length}},formatOutNodes=function(graph,layoutNodes){return layoutNodes.map((function(calcNode){var id=calcNode.id,data=calcNode.data,node=graph.getNode(id);return(0,tslib_es6.C3)((0,tslib_es6.C3)({},node),{data:(0,tslib_es6.C3)((0,tslib_es6.C3)({},node.data),{x:data.x,y:data.y,z:data.z})})}))}},"./node_modules/@antv/layout/lib/forceAtlas2/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>ForceAtlas2Layout});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),is_number=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),is_object=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-object.js"),is_function=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-function.js"),esm_graph=__webpack_require__("./node_modules/@antv/graphlib/esm/graph.js"),object=__webpack_require__("./node_modules/@antv/layout/lib/util/object.js"),array=__webpack_require__("./node_modules/@antv/layout/lib/util/array.js"),common=__webpack_require__("./node_modules/@antv/layout/lib/util/common.js");const body=function(){function Body(params){this.id=params.id||0,this.rx=params.rx,this.ry=params.ry,this.fx=0,this.fy=0,this.mass=params.mass,this.degree=params.degree,this.g=params.g||0}return Body.prototype.distanceTo=function(bo){var dx=this.rx-bo.rx,dy=this.ry-bo.ry;return Math.hypot(dx,dy)},Body.prototype.setPos=function(x,y){this.rx=x,this.ry=y},Body.prototype.resetForce=function(){this.fx=0,this.fy=0},Body.prototype.addForce=function(b){var dx=b.rx-this.rx,dy=b.ry-this.ry,dist=Math.hypot(dx,dy);dist=dist<1e-4?1e-4:dist;var F=this.g*(this.degree+1)*(b.degree+1)/dist;this.fx+=F*dx/dist,this.fy+=F*dy/dist},Body.prototype.in=function(quad){return quad.contains(this.rx,this.ry)},Body.prototype.add=function(bo){var nenwMass=this.mass+bo.mass;return new Body({rx:(this.rx*this.mass+bo.rx*bo.mass)/nenwMass,ry:(this.ry*this.mass+bo.ry*bo.mass)/nenwMass,mass:nenwMass,degree:this.degree+bo.degree})},Body}();const forceAtlas2_quad=function(){function Quad(params){this.xmid=params.xmid,this.ymid=params.ymid,this.length=params.length,this.massCenter=params.massCenter||[0,0],this.mass=params.mass||1}return Quad.prototype.getLength=function(){return this.length},Quad.prototype.contains=function(x,y){var halfLen=this.length/2;return x<=this.xmid+halfLen&&x>=this.xmid-halfLen&&y<=this.ymid+halfLen&&y>=this.ymid-halfLen},Quad.prototype.NW=function(){return new Quad({xmid:this.xmid-this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},Quad.prototype.NE=function(){return new Quad({xmid:this.xmid+this.length/4,ymid:this.ymid+this.length/4,length:this.length/2})},Quad.prototype.SW=function(){return new Quad({xmid:this.xmid-this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},Quad.prototype.SE=function(){return new Quad({xmid:this.xmid+this.length/4,ymid:this.ymid-this.length/4,length:this.length/2})},Quad}();const forceAtlas2_quadTree=function(){function QuadTree(param){this.body=null,this.quad=null,this.NW=null,this.NE=null,this.SW=null,this.SE=null,this.theta=.5,null!=param&&(this.quad=param)}return QuadTree.prototype.insert=function(bo){null!=this.body?this._isExternal()?(this.quad&&(this.NW=new QuadTree(this.quad.NW()),this.NE=new QuadTree(this.quad.NE()),this.SW=new QuadTree(this.quad.SW()),this.SE=new QuadTree(this.quad.SE())),this._putBody(this.body),this._putBody(bo),this.body=this.body.add(bo)):(this.body=this.body.add(bo),this._putBody(bo)):this.body=bo},QuadTree.prototype._putBody=function(bo){this.quad&&(bo.in(this.quad.NW())&&this.NW?this.NW.insert(bo):bo.in(this.quad.NE())&&this.NE?this.NE.insert(bo):bo.in(this.quad.SW())&&this.SW?this.SW.insert(bo):bo.in(this.quad.SE())&&this.SE&&this.SE.insert(bo))},QuadTree.prototype._isExternal=function(){return null==this.NW&&null==this.NE&&null==this.SW&&null==this.SE},QuadTree.prototype.updateForce=function(bo){null!=this.body&&bo!==this.body&&(this._isExternal()||(this.quad?this.quad.getLength():0)/this.body.distanceTo(bo)<this.theta?bo.addForce(this.body):(this.NW&&this.NW.updateForce(bo),this.NE&&this.NE.updateForce(bo),this.SW&&this.SW.updateForce(bo),this.SE&&this.SE.updateForce(bo)))},QuadTree}();var DEFAULTS_LAYOUT_OPTIONS={center:[0,0],width:300,height:300,kr:5,kg:1,mode:"normal",preventOverlap:!1,dissuadeHubs:!1,maxIteration:0,ks:.1,ksmax:10,tao:.1},ForceAtlas2Layout=function(){function ForceAtlas2Layout(options){void 0===options&&(options={}),this.options=options,this.id="forceAtlas2",this.options=(0,tslib_es6.C3)((0,tslib_es6.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return ForceAtlas2Layout.prototype.execute=function(graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){return(0,tslib_es6.KE)(this,(function(_a){return[2,this.genericForceAtlas2Layout(!1,graph,options)]}))}))},ForceAtlas2Layout.prototype.assign=function(graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){return(0,tslib_es6.KE)(this,(function(_a){return this.genericForceAtlas2Layout(!0,graph,options),[2]}))}))},ForceAtlas2Layout.prototype.genericForceAtlas2Layout=function(assign,graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){var edges,nodes,mergedOptions,width,height,prune,maxIteration,nodeSize,center,calcNodes,calcEdges,calcGraph,sizes,j,_a,source,target,sourceDegree,targetDegree,targetNode,sourceNode,postOptions;return(0,tslib_es6.KE)(this,(function(_b){if(edges=graph.getAllEdges(),nodes=graph.getAllNodes(),mergedOptions=this.formatOptions(options,nodes.length),width=mergedOptions.width,height=mergedOptions.height,prune=mergedOptions.prune,maxIteration=mergedOptions.maxIteration,nodeSize=mergedOptions.nodeSize,center=mergedOptions.center,!(null==nodes?void 0:nodes.length)||1===nodes.length)return[2,(0,common.s)(graph,assign,center)];if(calcNodes=nodes.map((function(node){return(0,object.o)(node,[width,height])})),calcEdges=edges.filter((function(edge){return edge.source!==edge.target})),calcGraph=new esm_graph.M({nodes:calcNodes,edges:calcEdges}),sizes=this.getSizes(calcGraph,graph,nodeSize),this.run(calcGraph,graph,maxIteration,sizes,assign,mergedOptions),prune){for(j=0;j<calcEdges.length;j+=1)_a=calcEdges[j],source=_a.source,target=_a.target,sourceDegree=calcGraph.getDegree(source),targetDegree=calcGraph.getDegree(source),sourceDegree<=1?(targetNode=calcGraph.getNode(target),calcGraph.mergeNodeData(source,{x:targetNode.data.x,y:targetNode.data.y})):targetDegree<=1&&(sourceNode=calcGraph.getNode(source),calcGraph.mergeNodeData(target,{x:sourceNode.data.x,y:sourceNode.data.y}));postOptions=(0,tslib_es6.C3)((0,tslib_es6.C3)({},mergedOptions),{prune:!1,barnesHut:!1}),this.run(calcGraph,graph,100,sizes,assign,postOptions)}return[2,{nodes:calcNodes,edges}]}))}))},ForceAtlas2Layout.prototype.getSizes=function(calcGraph,graph,nodeSize){for(var nodes=calcGraph.getAllNodes(),sizes={},i=0;i<nodes.length;i+=1){var _a=nodes[i],id=_a.id,data=_a.data;if(sizes[id]=10,(0,is_number.c)(data.size))sizes[id]=data.size;else if((0,array.c)(data.size))isNaN(data.size[0])||(sizes[id]=Math.max(data.size[0])),isNaN(data.size[1])||(sizes[id]=Math.max(data.size[1]));else if((0,is_object.c)(data.size))sizes[id]=Math.max(data.size.width,data.size.height);else if((0,is_function.c)(nodeSize)){var size=nodeSize(graph.getNode(id));(0,array.c)(size)?sizes[id]=Math.max.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(size))):sizes[id]=size}else(0,array.c)(nodeSize)?sizes[id]=Math.max.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(nodeSize))):(0,is_number.c)(nodeSize)&&(sizes[id]=nodeSize)}return sizes},ForceAtlas2Layout.prototype.formatOptions=function(options,nodeNum){void 0===options&&(options={});var mergedOptions=(0,tslib_es6.C3)((0,tslib_es6.C3)({},this.options),options),center=mergedOptions.center,width=mergedOptions.width,height=mergedOptions.height,barnesHut=mergedOptions.barnesHut,prune=mergedOptions.prune,maxIteration=mergedOptions.maxIteration,kr=mergedOptions.kr,kg=mergedOptions.kg;return mergedOptions.width=width||"undefined"==typeof window?width:window.innerWidth,mergedOptions.height=height||"undefined"==typeof window?height:window.innerHeight,mergedOptions.center=center||[mergedOptions.width/2,mergedOptions.height/2],void 0===barnesHut&&nodeNum>250&&(mergedOptions.barnesHut=!0),void 0===prune&&nodeNum>100&&(mergedOptions.prune=!0),0!==maxIteration||prune?0===maxIteration&&prune&&(mergedOptions.maxIteration=100,nodeNum<=200&&nodeNum>100?mergedOptions.maxIteration=500:nodeNum>200&&(mergedOptions.maxIteration=950)):(mergedOptions.maxIteration=250,nodeNum<=200&&nodeNum>100?mergedOptions.maxIteration=1e3:nodeNum>200&&(mergedOptions.maxIteration=1200)),kr||(mergedOptions.kr=50,nodeNum>100&&nodeNum<=500?mergedOptions.kr=20:nodeNum>500&&(mergedOptions.kr=1)),kg||(mergedOptions.kg=20,nodeNum>100&&nodeNum<=500?mergedOptions.kg=10:nodeNum>500&&(mergedOptions.kg=1)),mergedOptions},ForceAtlas2Layout.prototype.run=function(calcGraph,graph,iteration,sizes,assign,options){for(var kr=options.kr,barnesHut=options.barnesHut,onTick=options.onTick,calcNodes=calcGraph.getAllNodes(),sg=0,iter=iteration,forces={},preForces={},bodies={},i=0;i<calcNodes.length;i+=1){var _a=calcNodes[i],data=_a.data,id=_a.id;if(forces[id]=[0,0],barnesHut){var params={id:i,rx:data.x,ry:data.y,mass:1,g:kr,degree:calcGraph.getDegree(id)};bodies[id]=new body(params)}}for(;iter>0;)sg=this.oneStep(calcGraph,{iter,preventOverlapIters:50,krPrime:100,sg,forces,preForces,bodies,sizes},options),iter--,null==onTick||onTick({nodes:calcNodes,edges:graph.getAllEdges()});return calcGraph},ForceAtlas2Layout.prototype.oneStep=function(graph,params,options){for(var iter=params.iter,preventOverlapIters=params.preventOverlapIters,krPrime=params.krPrime,sg=params.sg,preForces=params.preForces,bodies=params.bodies,sizes=params.sizes,forces=params.forces,preventOverlap=options.preventOverlap,barnesHut=options.barnesHut,nodes=graph.getAllNodes(),i=0;i<nodes.length;i+=1){var id=nodes[i].id;preForces[id]=(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(forces[id])),forces[id]=[0,0]}return forces=this.getAttrForces(graph,iter,preventOverlapIters,sizes,forces,options),forces=barnesHut&&(preventOverlap&&iter>preventOverlapIters||!preventOverlap)?this.getOptRepGraForces(graph,forces,bodies,options):this.getRepGraForces(graph,iter,preventOverlapIters,forces,krPrime,sizes,options),this.updatePos(graph,forces,preForces,sg,options)},ForceAtlas2Layout.prototype.getAttrForces=function(graph,iter,preventOverlapIters,sizes,forces,options){for(var preventOverlap=options.preventOverlap,dissuadeHubs=options.dissuadeHubs,mode=options.mode,prune=options.prune,edges=graph.getAllEdges(),i=0;i<edges.length;i+=1){var _a=edges[i],source=_a.source,target=_a.target,sourceNode=graph.getNode(source),targetNode=graph.getNode(target),sourceDegree=graph.getDegree(source),targetDegree=graph.getDegree(target);if(!prune||!(sourceDegree<=1||targetDegree<=1)){var dir=[targetNode.data.x-sourceNode.data.x,targetNode.data.y-sourceNode.data.y],eucliDis=Math.hypot(dir[0],dir[1]);eucliDis=eucliDis<1e-4?1e-4:eucliDis,dir[0]=dir[0]/eucliDis,dir[1]=dir[1]/eucliDis,preventOverlap&&iter<preventOverlapIters&&(eucliDis=eucliDis-sizes[source]-sizes[target]);var fa1=eucliDis,fa2=fa1;"linlog"===mode&&(fa2=fa1=Math.log(1+eucliDis)),dissuadeHubs&&(fa1=eucliDis/sourceDegree,fa2=eucliDis/targetDegree),preventOverlap&&iter<preventOverlapIters&&eucliDis<=0?(fa1=0,fa2=0):preventOverlap&&iter<preventOverlapIters&&eucliDis>0&&(fa1=eucliDis,fa2=eucliDis),forces[source][0]+=fa1*dir[0],forces[target][0]-=fa2*dir[0],forces[source][1]+=fa1*dir[1],forces[target][1]-=fa2*dir[1]}}return forces},ForceAtlas2Layout.prototype.getOptRepGraForces=function(graph,forces,bodies,options){for(var kg=options.kg,center=options.center,prune=options.prune,nodes=graph.getAllNodes(),nodeNum=nodes.length,minx=9e10,maxx=-9e10,miny=9e10,maxy=-9e10,i=0;i<nodeNum;i+=1){var _a=nodes[i],id=_a.id,data=_a.data;prune&&graph.getDegree(id)<=1||(bodies[id].setPos(data.x,data.y),data.x>=maxx&&(maxx=data.x),data.x<=minx&&(minx=data.x),data.y>=maxy&&(maxy=data.y),data.y<=miny&&(miny=data.y))}var width=Math.max(maxx-minx,maxy-miny),quad=new forceAtlas2_quad({xmid:(maxx+minx)/2,ymid:(maxy+miny)/2,length:width,massCenter:center,mass:nodeNum}),quadTree=new forceAtlas2_quadTree(quad);for(i=0;i<nodeNum;i+=1){id=nodes[i].id;prune&&graph.getDegree(id)<=1||bodies[id].in(quad)&&quadTree.insert(bodies[id])}for(i=0;i<nodeNum;i+=1){var _b=nodes[i],degree=(id=_b.id,data=_b.data,graph.getDegree(id));if(!(prune&&degree<=1)){bodies[id].resetForce(),quadTree.updateForce(bodies[id]),forces[id][0]-=bodies[id].fx,forces[id][1]-=bodies[id].fy;var dir=[data.x-center[0],data.y-center[1]],eucliDis=Math.hypot(dir[0],dir[1]);eucliDis=eucliDis<1e-4?1e-4:eucliDis,dir[0]=dir[0]/eucliDis,dir[1]=dir[1]/eucliDis;var fg=kg*(degree+1);forces[id][0]-=fg*dir[0],forces[id][1]-=fg*dir[1]}}return forces},ForceAtlas2Layout.prototype.getRepGraForces=function(graph,iter,preventOverlapIters,forces,krPrime,sizes,options){for(var preventOverlap=options.preventOverlap,kr=options.kr,kg=options.kg,center=options.center,prune=options.prune,nodes=graph.getAllNodes(),nodeNum=nodes.length,i=0;i<nodeNum;i+=1){for(var nodei=nodes[i],degreei=graph.getDegree(nodei.id),j=i+1;j<nodeNum;j+=1){var nodej=nodes[j],degreej=graph.getDegree(nodej.id);if(!prune||!(degreei<=1||degreej<=1)){var dir_1=[nodej.data.x-nodei.data.x,nodej.data.y-nodei.data.y],eucliDis_1=Math.hypot(dir_1[0],dir_1[1]);eucliDis_1=eucliDis_1<1e-4?1e-4:eucliDis_1,dir_1[0]=dir_1[0]/eucliDis_1,dir_1[1]=dir_1[1]/eucliDis_1,preventOverlap&&iter<preventOverlapIters&&(eucliDis_1=eucliDis_1-sizes[nodei.id]-sizes[nodej.id]);var fr=kr*(degreei+1)*(degreej+1)/eucliDis_1;preventOverlap&&iter<preventOverlapIters&&eucliDis_1<0?fr=krPrime*(degreei+1)*(degreej+1):preventOverlap&&iter<preventOverlapIters&&0===eucliDis_1?fr=0:preventOverlap&&iter<preventOverlapIters&&eucliDis_1>0&&(fr=kr*(degreei+1)*(degreej+1)/eucliDis_1),forces[nodei.id][0]-=fr*dir_1[0],forces[nodej.id][0]+=fr*dir_1[0],forces[nodei.id][1]-=fr*dir_1[1],forces[nodej.id][1]+=fr*dir_1[1]}}var dir=[nodei.data.x-center[0],nodei.data.y-center[1]],eucliDis=Math.hypot(dir[0],dir[1]);dir[0]=dir[0]/eucliDis,dir[1]=dir[1]/eucliDis;var fg=kg*(degreei+1);forces[nodei.id][0]-=fg*dir[0],forces[nodei.id][1]-=fg*dir[1]}return forces},ForceAtlas2Layout.prototype.updatePos=function(graph,forces,preForces,sg,options){for(var ks=options.ks,tao=options.tao,prune=options.prune,ksmax=options.ksmax,nodes=graph.getAllNodes(),nodeNum=nodes.length,swgns=[],trans=[],swgG=0,traG=0,usingSg=sg,i=0;i<nodeNum;i+=1){var id=nodes[i].id,degree=graph.getDegree(id);if(!(prune&&degree<=1)){var minus=[forces[id][0]-preForces[id][0],forces[id][1]-preForces[id][1]],minusNorm=Math.hypot(minus[0],minus[1]),add=[forces[id][0]+preForces[id][0],forces[id][1]+preForces[id][1]],addNorm=Math.hypot(add[0],add[1]);swgns[i]=minusNorm,trans[i]=addNorm/2,swgG+=(degree+1)*swgns[i],traG+=(degree+1)*trans[i]}}var preSG=usingSg;usingSg=tao*traG/swgG,0!==preSG&&(usingSg=usingSg>1.5*preSG?1.5*preSG:usingSg);for(i=0;i<nodeNum;i+=1){var _a=nodes[i],data=(id=_a.id,_a.data);degree=graph.getDegree(id);if(!(prune&&degree<=1)&&(!(0,is_number.c)(data.fx)||!(0,is_number.c)(data.fy))){var sn=ks*usingSg/(1+usingSg*Math.sqrt(swgns[i])),absForce=Math.hypot(forces[id][0],forces[id][1]),max=ksmax/(absForce=absForce<1e-4?1e-4:absForce),dnx=(sn=sn>max?max:sn)*forces[id][0],dny=sn*forces[id][1];graph.mergeNodeData(id,{x:data.x+dnx,y:data.y+dny})}}return usingSg},ForceAtlas2Layout}()},"./node_modules/@antv/layout/lib/fruchterman.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{W:()=>FruchtermanLayout});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_antv_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),_antv_graphlib__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@antv/graphlib/esm/graph.js"),_util__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@antv/layout/lib/util/object.js"),DEFAULTS_LAYOUT_OPTIONS={maxIteration:1e3,gravity:10,speed:5,clustering:!1,clusterGravity:10,width:300,height:300,nodeClusterBy:"cluster"},FruchtermanLayout=function(){function FruchtermanLayout(options){void 0===options&&(options={}),this.options=options,this.id="fruchterman",this.timeInterval=0,this.running=!1,this.options=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return FruchtermanLayout.prototype.execute=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return[2,this.genericFruchtermanLayout(!1,graph,options)]}))}))},FruchtermanLayout.prototype.assign=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return this.genericFruchtermanLayout(!0,graph,options),[2]}))}))},FruchtermanLayout.prototype.stop=function(){this.timeInterval&&"undefined"!=typeof window&&window.clearInterval(this.timeInterval),this.running=!1},FruchtermanLayout.prototype.tick=function(iterations){var _this=this;if(void 0===iterations&&(iterations=this.options.maxIteration||1),this.lastResult)return this.lastResult;for(var i=0;i<iterations;i++)this.runOneStep(this.lastGraph,this.lastClusterMap,this.lastOptions);var result={nodes:this.lastLayoutNodes,edges:this.lastLayoutEdges};return this.lastAssign&&result.nodes.forEach((function(node){return _this.lastGraph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y,z:3===_this.options.dimensions?node.data.z:void 0})})),result},FruchtermanLayout.prototype.genericFruchtermanLayout=function(assign,graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){var formattedOptions,dimensions,width,height,center,clustering,nodeClusterBy,maxIteration,onTick,nodes,edges,result,layoutNodes,calcGraph,clusterMap,iter,_this=this;return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return this.running?[2]:(formattedOptions=this.formatOptions(options),dimensions=formattedOptions.dimensions,width=formattedOptions.width,height=formattedOptions.height,center=formattedOptions.center,clustering=formattedOptions.clustering,nodeClusterBy=formattedOptions.nodeClusterBy,maxIteration=formattedOptions.maxIteration,onTick=formattedOptions.onTick,nodes=graph.getAllNodes(),edges=graph.getAllEdges(),(null==nodes?void 0:nodes.length)?1===nodes.length?(assign&&graph.mergeNodeData(nodes[0].id,{x:center[0],y:center[1],z:3===dimensions?center[2]:void 0}),result={nodes:[(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},nodes[0]),{data:(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},nodes[0].data),{x:center[0],y:center[1],z:3===dimensions?center[2]:void 0})})],edges},this.lastResult=result,[2,result]):(layoutNodes=nodes.map((function(node){return(0,_util__WEBPACK_IMPORTED_MODULE_1__.o)(node,[width,height])})),calcGraph=new _antv_graphlib__WEBPACK_IMPORTED_MODULE_2__.M({nodes:layoutNodes,edges}),clusterMap={},clustering&&layoutNodes.forEach((function(node){var clusterValue=node.data[nodeClusterBy];clusterMap[clusterValue]||(clusterMap[clusterValue]={name:clusterValue,cx:0,cy:0,count:0})})),this.lastLayoutNodes=layoutNodes,this.lastLayoutEdges=edges,this.lastAssign=assign,this.lastGraph=calcGraph,this.lastOptions=formattedOptions,this.lastClusterMap=clusterMap,"undefined"==typeof window?[2]:(iter=0,[2,new Promise((function(resolve){_this.timeInterval=window.setInterval((function(){_this.running?(_this.runOneStep(calcGraph,clusterMap,formattedOptions),assign&&layoutNodes.forEach((function(_a){var id=_a.id,data=_a.data;return graph.mergeNodeData(id,{x:data.x,y:data.y,z:3===dimensions?data.z:void 0})})),null==onTick||onTick({nodes:layoutNodes,edges}),++iter>=maxIteration&&(window.clearInterval(_this.timeInterval),resolve({nodes:layoutNodes,edges}))):resolve({nodes:layoutNodes,edges})}),0),_this.running=!0}))])):(result={nodes:[],edges},this.lastResult=result,[2,result]))}))}))},FruchtermanLayout.prototype.formatOptions=function(options){void 0===options&&(options={});var mergedOptions=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},this.options),options),clustering=mergedOptions.clustering,nodeClusterBy=mergedOptions.nodeClusterBy,propsCenter=mergedOptions.center,propsWidth=mergedOptions.width,propsHeight=mergedOptions.height;return mergedOptions.width=propsWidth||"undefined"==typeof window?propsWidth:window.innerWidth,mergedOptions.height=propsHeight||"undefined"==typeof window?propsHeight:window.innerHeight,mergedOptions.center=propsCenter||[mergedOptions.width/2,mergedOptions.height/2],mergedOptions.clustering=clustering&&!!nodeClusterBy,mergedOptions},FruchtermanLayout.prototype.runOneStep=function(calcGraph,clusterMap,options){var dimensions=options.dimensions,height=options.height,width=options.width,gravity=options.gravity,center=options.center,speed=options.speed,clustering=options.clustering,nodeClusterBy=options.nodeClusterBy,propsClusterGravity=options.clusterGravity,area=height*width,maxDisplace=Math.sqrt(area)/10,nodes=calcGraph.getAllNodes(),k2=area/(nodes.length+1),k=Math.sqrt(k2),displacements={};if(this.applyCalculate(calcGraph,displacements,k,k2),clustering){for(var key in clusterMap)clusterMap[key].cx=0,clusterMap[key].cy=0,clusterMap[key].count=0;for(var key in nodes.forEach((function(node){var data=node.data,c=clusterMap[data[nodeClusterBy]];(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(data.x)&&(c.cx+=data.x),(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(data.y)&&(c.cy+=data.y),c.count++})),clusterMap)clusterMap[key].cx/=clusterMap[key].count,clusterMap[key].cy/=clusterMap[key].count;var clusterGravity_1=propsClusterGravity||gravity;nodes.forEach((function(node,j){var id=node.id,data=node.data;if((0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(data.x)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(data.y)){var c=clusterMap[data[nodeClusterBy]],distLength=Math.sqrt((data.x-c.cx)*(data.x-c.cx)+(data.y-c.cy)*(data.y-c.cy)),gravityForce=k*clusterGravity_1;displacements[id].x-=gravityForce*(data.x-c.cx)/distLength,displacements[id].y-=gravityForce*(data.y-c.cy)/distLength}}))}nodes.forEach((function(node,j){var id=node.id,data=node.data;if((0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(data.x)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(data.y)){var gravityForce=.01*k*gravity;displacements[id].x-=gravityForce*(data.x-center[0]),displacements[id].y-=gravityForce*(data.y-center[1]),3===dimensions&&(displacements[id].z-=gravityForce*(data.z-center[2]))}})),nodes.forEach((function(node,j){var id=node.id,data=node.data;if((0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(data.fx)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(data.fy))return data.x=data.fx,data.y=data.fy,void(3===dimensions&&(data.z=data.fz));if((0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(data.x)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(data.y)){var distLength=Math.sqrt(displacements[id].x*displacements[id].x+displacements[id].y*displacements[id].y+(3===dimensions?displacements[id].z*displacements[id].z:0));if(distLength>0){var limitedDist=Math.min(maxDisplace*(speed/800),distLength);calcGraph.mergeNodeData(id,{x:data.x+displacements[id].x/distLength*limitedDist,y:data.y+displacements[id].y/distLength*limitedDist,z:3===dimensions?data.z+displacements[id].z/distLength*limitedDist:void 0})}}}))},FruchtermanLayout.prototype.applyCalculate=function(calcGraph,displacements,k,k2){this.calRepulsive(calcGraph,displacements,k2),this.calAttractive(calcGraph,displacements,k)},FruchtermanLayout.prototype.calRepulsive=function(calcGraph,displacements,k2){var _this=this,nodes=calcGraph.getAllNodes();nodes.forEach((function(_a,i){var v=_a.data,vid=_a.id;displacements[vid]={x:0,y:0,z:0},nodes.forEach((function(_a,j){var u=_a.data,uid=_a.id;if(!(i<=j)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(v.x)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(u.x)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(v.y)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(u.y)){var vecX=v.x-u.x,vecY=v.y-u.y,vecZ=3===_this.options.dimensions?v.z-u.z:0,lengthSqr=vecX*vecX+vecY*vecY+vecZ*vecZ;0===lengthSqr&&(lengthSqr=1,vecX=.01,vecY=.01,vecZ=.01);var common=k2/lengthSqr,dispX=vecX*common,dispY=vecY*common,dispZ=vecZ*common;displacements[vid].x+=dispX,displacements[vid].y+=dispY,displacements[uid].x-=dispX,displacements[uid].y-=dispY,3===_this.options.dimensions&&(displacements[vid].z+=dispZ,displacements[uid].z-=dispZ)}}))}))},FruchtermanLayout.prototype.calAttractive=function(calcGraph,displacements,k){var _this=this;calcGraph.getAllEdges().forEach((function(e){var source=e.source,target=e.target;if(source&&target&&source!==target){var u=calcGraph.getNode(source).data,v=calcGraph.getNode(target).data;if((0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(v.x)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(u.x)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(v.y)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(u.y)){var vecX=v.x-u.x,vecY=v.y-u.y,vecZ=3===_this.options.dimensions?v.z-u.z:0,common=Math.sqrt(vecX*vecX+vecY*vecY+vecZ*vecZ)/k,dispX=vecX*common,dispY=vecY*common,dispZ=vecZ*common;displacements[source].x+=dispX,displacements[source].y+=dispY,displacements[target].x-=dispX,displacements[target].y-=dispY,3===_this.options.dimensions&&(displacements[source].z+=dispZ,displacements[target].z-=dispZ)}}}))},FruchtermanLayout}()},"./node_modules/@antv/layout/lib/grid.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{w:()=>GridLayout});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_antv_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-string.js"),_antv_util__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@antv/layout/lib/util/object.js"),_util__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@antv/layout/lib/util/function.js"),_util__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@antv/layout/lib/util/array.js"),_util_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@antv/layout/lib/util/common.js"),DEFAULTS_LAYOUT_OPTIONS={begin:[0,0],preventOverlap:!0,preventOverlapPadding:10,condense:!1,rows:void 0,cols:void 0,position:void 0,sortBy:"degree",nodeSize:30,width:300,height:300},GridLayout=function(){function GridLayout(options){void 0===options&&(options={}),this.options=options,this.id="grid",this.options=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return GridLayout.prototype.execute=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return[2,this.genericGridLayout(!1,graph,options)]}))}))},GridLayout.prototype.assign=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return this.genericGridLayout(!0,graph,options),[2]}))}))},GridLayout.prototype.genericGridLayout=function(assign,graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){var mergedOptions,_a,begin,condense,preventOverlapPadding,preventOverlap,propsRows,propsCols,paramNodeSpacing,paramNodeSize,propsWidth,propsHeight,position,sortBy,nodes,edges,n,layoutNodes,width,height,cells,rcs,splits,sm,lg,cellWidth,cellHeight,nodeSpacing_1,nodeSize_1,cellUsed,rc,id2manPos,i,node,rcPos,pos,result;return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_b){if(mergedOptions=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},this.options),options),_a=mergedOptions.begin,begin=void 0===_a?[0,0]:_a,condense=mergedOptions.condense,preventOverlapPadding=mergedOptions.preventOverlapPadding,preventOverlap=mergedOptions.preventOverlap,propsRows=mergedOptions.rows,propsCols=mergedOptions.cols,paramNodeSpacing=mergedOptions.nodeSpacing,paramNodeSize=mergedOptions.nodeSize,propsWidth=mergedOptions.width,propsHeight=mergedOptions.height,position=mergedOptions.position,sortBy=mergedOptions.sortBy,nodes=graph.getAllNodes(),edges=graph.getAllEdges(),!(n=null==nodes?void 0:nodes.length)||1===n)return[2,(0,_util_common__WEBPACK_IMPORTED_MODULE_1__.s)(graph,assign,begin)];if(layoutNodes=nodes.map((function(node){return(0,_util__WEBPACK_IMPORTED_MODULE_2__.o)(node)})),"id"===sortBy||(0,_antv_util__WEBPACK_IMPORTED_MODULE_3__.c)(sortBy)&&void 0!==layoutNodes[0].data[sortBy]||(sortBy="degree"),"degree"===sortBy?layoutNodes.sort((function(n1,n2){return graph.getDegree(n2.id,"both")-graph.getDegree(n1.id,"both")})):"id"===sortBy?layoutNodes.sort((function(n1,n2){return(0,_antv_util__WEBPACK_IMPORTED_MODULE_4__.c)(n2.id)&&(0,_antv_util__WEBPACK_IMPORTED_MODULE_4__.c)(n1.id)?n2.id-n1.id:(""+n1.id).localeCompare(""+n2.id)})):layoutNodes.sort((function(n1,n2){return n2.data[sortBy]-n1.data[sortBy]})),width=propsWidth||"undefined"==typeof window?propsWidth:window.innerWidth,height=propsHeight||"undefined"==typeof window?propsHeight:window.innerHeight,cells=n,rcs={rows:propsRows,cols:propsCols},null!=propsRows&&null!=propsCols?(rcs.rows=propsRows,rcs.cols=propsCols):null!=propsRows&&null==propsCols?(rcs.rows=propsRows,rcs.cols=Math.ceil(cells/rcs.rows)):null==propsRows&&null!=propsCols?(rcs.cols=propsCols,rcs.rows=Math.ceil(cells/rcs.cols)):(splits=Math.sqrt(cells*height/width),rcs.rows=Math.round(splits),rcs.cols=Math.round(width/height*splits)),rcs.rows=Math.max(rcs.rows,1),rcs.cols=Math.max(rcs.cols,1),rcs.cols*rcs.rows>cells)sm=small(rcs),lg=large(rcs),(sm-1)*lg>=cells?small(rcs,sm-1):(lg-1)*sm>=cells&&large(rcs,lg-1);else for(;rcs.cols*rcs.rows<cells;)sm=small(rcs),((lg=large(rcs))+1)*sm>=cells?large(rcs,lg+1):small(rcs,sm+1);for(cellWidth=condense?0:width/rcs.cols,cellHeight=condense?0:height/rcs.rows,(preventOverlap||paramNodeSpacing)&&(nodeSpacing_1=(0,_util__WEBPACK_IMPORTED_MODULE_5__.uA)(10,paramNodeSpacing),nodeSize_1=(0,_util__WEBPACK_IMPORTED_MODULE_5__.Gy)(30,paramNodeSize,!1),layoutNodes.forEach((function(node){node.data.x&&node.data.y||(node.data.x=0,node.data.y=0);var nodeW,nodeH,oNode=graph.getNode(node.id),res=nodeSize_1(oNode)||30;(0,_util__WEBPACK_IMPORTED_MODULE_6__.c)(res)?(nodeW=res[0],nodeH=res[1]):(nodeW=res,nodeH=res);var p=void 0!==nodeSpacing_1?nodeSpacing_1(node):preventOverlapPadding,w=nodeW+p,h=nodeH+p;cellWidth=Math.max(cellWidth,w),cellHeight=Math.max(cellHeight,h)}))),cellUsed={},rc={row:0,col:0},id2manPos={},i=0;i<layoutNodes.length;i++){if(node=layoutNodes[i],rcPos=void 0,position&&(rcPos=position(graph.getNode(node.id))),rcPos&&(void 0!==rcPos.row||void 0!==rcPos.col)){if(void 0===(pos={row:rcPos.row,col:rcPos.col}).col)for(pos.col=0;used(cellUsed,pos);)pos.col++;else if(void 0===pos.row)for(pos.row=0;used(cellUsed,pos);)pos.row++;id2manPos[node.id]=pos,use(cellUsed,pos)}getPos(node,begin,cellWidth,cellHeight,id2manPos,rcs,rc,cellUsed)}return result={nodes:layoutNodes,edges},assign&&layoutNodes.forEach((function(node){graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),[2,result]}))}))},GridLayout}(),small=function(rcs,val){var res,rows=rcs.rows||5,cols=rcs.cols||5;null==val?res=Math.min(rows,cols):Math.min(rows,cols)===rcs.rows?rcs.rows=val:rcs.cols=val;return res},large=function(rcs,val){var result,usedRows=rcs.rows||5,usedCols=rcs.cols||5;null==val?result=Math.max(usedRows,usedCols):Math.max(usedRows,usedCols)===rcs.rows?rcs.rows=val:rcs.cols=val;return result},used=function(cellUsed,rc){return cellUsed["c-"+rc.row+"-"+rc.col]||!1},use=function(cellUsed,rc){return cellUsed["c-"+rc.row+"-"+rc.col]=!0},moveToNextCell=function(rcs,rc){var cols=rcs.cols||5;rc.col++,rc.col>=cols&&(rc.col=0,rc.row++)},getPos=function(node,begin,cellWidth,cellHeight,id2manPos,rcs,rc,cellUsed){var x,y,rcPos=id2manPos[node.id];if(rcPos)x=rcPos.col*cellWidth+cellWidth/2+begin[0],y=rcPos.row*cellHeight+cellHeight/2+begin[1];else{for(;used(cellUsed,rc);)moveToNextCell(rcs,rc);x=rc.col*cellWidth+cellWidth/2+begin[0],y=rc.row*cellHeight+cellHeight/2+begin[1],use(cellUsed,rc),moveToNextCell(rcs,rc)}node.data.x=x,node.data.y=y}},"./node_modules/@antv/layout/lib/mds.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{M:()=>MDSLayout});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),ml_matrix__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/ml-matrix/matrix.mjs"),_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@antv/layout/lib/util/math.js"),_util__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@antv/layout/lib/util/object.js"),_util_common__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@antv/layout/lib/util/common.js"),DEFAULTS_LAYOUT_OPTIONS={center:[0,0],linkDistance:50},MDSLayout=function(){function MDSLayout(options){void 0===options&&(options={}),this.options=options,this.id="mds",this.options=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return MDSLayout.prototype.execute=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return[2,this.genericMDSLayout(!1,graph,options)]}))}))},MDSLayout.prototype.assign=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return this.genericMDSLayout(!0,graph,options),[2]}))}))},MDSLayout.prototype.genericMDSLayout=function(assign,graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){var mergedOptions,_a,center,_b,linkDistance,nodes,edges,adjMatrix,distances,scaledD,positions,layoutNodes;return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_c){return mergedOptions=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},this.options),options),_a=mergedOptions.center,center=void 0===_a?[0,0]:_a,_b=mergedOptions.linkDistance,linkDistance=void 0===_b?50:_b,nodes=graph.getAllNodes(),edges=graph.getAllEdges(),(null==nodes?void 0:nodes.length)&&1!==nodes.length?(adjMatrix=(0,_util__WEBPACK_IMPORTED_MODULE_2__.iA)({nodes,edges},!1),distances=(0,_util__WEBPACK_IMPORTED_MODULE_2__.Ws)(adjMatrix),handleInfinity(distances),scaledD=(0,_util__WEBPACK_IMPORTED_MODULE_2__.SG)(distances,linkDistance),positions=runMDS(scaledD),layoutNodes=[],positions.forEach((function(p,i){var cnode=(0,_util__WEBPACK_IMPORTED_MODULE_3__.o)(nodes[i]);cnode.data.x=p[0]+center[0],cnode.data.y=p[1]+center[1],layoutNodes.push(cnode)})),assign&&layoutNodes.forEach((function(node){return graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),[2,{nodes:layoutNodes,edges}]):[2,(0,_util_common__WEBPACK_IMPORTED_MODULE_1__.s)(graph,assign,center)]}))}))},MDSLayout}(),handleInfinity=function(distances){var maxDistance=-999999;distances.forEach((function(row){row.forEach((function(value){value!==1/0&&maxDistance<value&&(maxDistance=value)}))})),distances.forEach((function(row,i){row.forEach((function(value,j){value===1/0&&(distances[i][j]=maxDistance)}))}))},runMDS=function(distances){var M=ml_matrix__WEBPACK_IMPORTED_MODULE_4__.WU.mul(ml_matrix__WEBPACK_IMPORTED_MODULE_4__.WU.pow(distances,2),-.5),rowMeans=M.mean("row"),colMeans=M.mean("column"),totalMean=M.mean();M.add(totalMean).subRowVector(rowMeans).subColumnVector(colMeans);var ret=new ml_matrix__WEBPACK_IMPORTED_MODULE_4__.SE(M),eigenValues=ml_matrix__WEBPACK_IMPORTED_MODULE_4__.WU.sqrt(ret.diagonalMatrix).diagonal();return ret.leftSingularVectors.toJSON().map((function(row){return ml_matrix__WEBPACK_IMPORTED_MODULE_4__.WU.mul([row],[eigenValues]).toJSON()[0].splice(0,2)}))}},"./node_modules/@antv/layout/lib/radial/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>RadialLayout});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),is_string=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-string.js"),math=__webpack_require__("./node_modules/@antv/layout/lib/util/math.js"),util_function=__webpack_require__("./node_modules/@antv/layout/lib/util/function.js"),object=__webpack_require__("./node_modules/@antv/layout/lib/util/object.js"),common=__webpack_require__("./node_modules/@antv/layout/lib/util/common.js"),matrix=__webpack_require__("./node_modules/ml-matrix/matrix.mjs"),DEFAULTS_LAYOUT_OPTIONS={iterations:10,height:10,width:10,speed:100,gravity:10,k:5},getRepulsion=function(nodes,positions,disp,k,radii,nodeSizeFunc){positions.forEach((function(v,i){disp[i]={x:0,y:0},positions.forEach((function(u,j){if(i!==j&&radii[i]===radii[j]){var vecx=v.x-u.x,vecy=v.y-u.y,vecLength=Math.sqrt(vecx*vecx+vecy*vecy);if(0===vecLength){vecLength=1;var sign=i>j?1:-1;vecx=.01*sign,vecy=.01*sign}if(vecLength<nodeSizeFunc(nodes[i])/2+nodeSizeFunc(nodes[j])/2){var common=k*k/vecLength;disp[i].x+=vecx/vecLength*common,disp[i].y+=vecy/vecLength*common}}}))}))},updatePositions=function(positions,disp,speed,strictRadial,focusIdx,maxDisplace,width,radii){var maxDisp=maxDisplace||width/10;return strictRadial&&disp.forEach((function(di,i){var vx=positions[i].x-positions[focusIdx].x,vy=positions[i].y-positions[focusIdx].y,vLength=Math.sqrt(vx*vx+vy*vy),vpx=vy/vLength,vpy=-vx/vLength,diLength=Math.sqrt(di.x*di.x+di.y*di.y),alpha=Math.acos((vpx*di.x+vpy*di.y)/diLength);alpha>Math.PI/2&&(alpha-=Math.PI/2,vpx*=-1,vpy*=-1);var tdispLength=Math.cos(alpha)*diLength;di.x=vpx*tdispLength,di.y=vpy*tdispLength})),positions.forEach((function(n,i){if(i!==focusIdx){var distLength=Math.sqrt(disp[i].x*disp[i].x+disp[i].y*disp[i].y);if(distLength>0&&i!==focusIdx){var limitedDist=Math.min(maxDisp*(speed/800),distLength);if(n.x+=disp[i].x/distLength*limitedDist,n.y+=disp[i].y/distLength*limitedDist,strictRadial){var vx=n.x-positions[focusIdx].x,vy=n.y-positions[focusIdx].y,nfDis=Math.sqrt(vx*vx+vy*vy);vx=vx/nfDis*radii[i],vy=vy/nfDis*radii[i],n.x=positions[focusIdx].x+vx,n.y=positions[focusIdx].y+vy}}}})),positions},radial_DEFAULTS_LAYOUT_OPTIONS={maxIteration:1e3,focusNode:null,unitRadius:null,linkDistance:50,preventOverlap:!1,strictRadial:!0,maxPreventOverlapIteration:200,sortStrength:10},RadialLayout=function(){function RadialLayout(options){void 0===options&&(options={}),this.options=options,this.id="radial",this.options=(0,tslib_es6.C3)((0,tslib_es6.C3)({},radial_DEFAULTS_LAYOUT_OPTIONS),options)}return RadialLayout.prototype.execute=function(graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){return(0,tslib_es6.KE)(this,(function(_a){return[2,this.genericRadialLayout(!1,graph,options)]}))}))},RadialLayout.prototype.assign=function(graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){return(0,tslib_es6.KE)(this,(function(_a){return this.genericRadialLayout(!0,graph,options),[2]}))}))},RadialLayout.prototype.genericRadialLayout=function(assign,graph,options){return(0,tslib_es6.kH)(this,void 0,void 0,(function(){var mergedOptions,propsWidth,propsHeight,propsCenter,propsFocusNode,propsUnitRadius,nodeSize,nodeSpacing,strictRadial,preventOverlap,maxPreventOverlapIteration,sortBy,_a,linkDistance,_b,sortStrength,_c,maxIteration,nodes,edges,width,height,center,focusNode,i,focusIndex,adjMatrix,distances,maxDistance,focusNodeD,semiWidth,semiHeight,maxRadius,maxD,radii,unitRadius,idealDistances,weights,mdsResult,positions,nodeSizeFunc,nonoverlapForceParams,layoutNodes;return(0,tslib_es6.KE)(this,(function(_d){if(mergedOptions=(0,tslib_es6.C3)((0,tslib_es6.C3)({},this.options),options),propsWidth=mergedOptions.width,propsHeight=mergedOptions.height,propsCenter=mergedOptions.center,propsFocusNode=mergedOptions.focusNode,propsUnitRadius=mergedOptions.unitRadius,nodeSize=mergedOptions.nodeSize,nodeSpacing=mergedOptions.nodeSpacing,strictRadial=mergedOptions.strictRadial,preventOverlap=mergedOptions.preventOverlap,maxPreventOverlapIteration=mergedOptions.maxPreventOverlapIteration,sortBy=mergedOptions.sortBy,_a=mergedOptions.linkDistance,linkDistance=void 0===_a?50:_a,_b=mergedOptions.sortStrength,sortStrength=void 0===_b?10:_b,_c=mergedOptions.maxIteration,maxIteration=void 0===_c?1e3:_c,nodes=graph.getAllNodes(),edges=graph.getAllEdges(),width=propsWidth||"undefined"==typeof window?propsWidth:window.innerWidth,height=propsHeight||"undefined"==typeof window?propsHeight:window.innerHeight,center=propsCenter||[width/2,height/2],!(null==nodes?void 0:nodes.length)||1===nodes.length)return[2,(0,common.s)(graph,assign,center)];if(focusNode=nodes[0],(0,is_string.c)(propsFocusNode)){for(i=0;i<nodes.length;i++)if(nodes[i].id===propsFocusNode){focusNode=nodes[i];break}}else focusNode=propsFocusNode||nodes[0];return focusIndex=getIndexById(nodes,focusNode.id),adjMatrix=(0,math.iA)({nodes,edges},!1),distances=(0,math.Ws)(adjMatrix),maxDistance=maxToFocus(distances,focusIndex),handleInfinity(distances,focusIndex,maxDistance+1),focusNodeD=distances[focusIndex],semiWidth=width-center[0]>center[0]?center[0]:width-center[0],semiHeight=height-center[1]>center[1]?center[1]:height-center[1],0===semiWidth&&(semiWidth=width/2),0===semiHeight&&(semiHeight=height/2),maxRadius=Math.min(semiWidth,semiHeight),maxD=Math.max.apply(Math,(0,tslib_es6.Mt)([],(0,tslib_es6.o5)(focusNodeD))),radii=[],unitRadius=propsUnitRadius||maxRadius/maxD,focusNodeD.forEach((function(value,i){radii[i]=value*unitRadius})),idealDistances=eIdealDisMatrix(nodes,distances,linkDistance,radii,unitRadius,sortBy,sortStrength),weights=getWeightMatrix(idealDistances),mdsResult=function(dimension,distances,linkDistance){try{var M=matrix.WU.mul(matrix.WU.pow(distances,2),-.5),rowMeans=M.mean("row"),colMeans=M.mean("column"),totalMean=M.mean();M.add(totalMean).subRowVector(rowMeans).subColumnVector(colMeans);var ret=new matrix.SE(M),eigenValues_1=matrix.WU.sqrt(ret.diagonalMatrix).diagonal();return ret.leftSingularVectors.toJSON().map((function(row){return matrix.WU.mul([row],[eigenValues_1]).toJSON()[0].splice(0,dimension)}))}catch(_a){for(var res=[],i=0;i<distances.length;i++){var x=Math.random()*linkDistance,y=Math.random()*linkDistance;res.push([x,y])}return res}}(linkDistance,idealDistances,linkDistance),positions=mdsResult.map((function(_a){var _b=(0,tslib_es6.o5)(_a,2),x=_b[0],y=_b[1];return{x:(isNaN(x)?Math.random()*linkDistance:x)-mdsResult[focusIndex][0],y:(isNaN(y)?Math.random()*linkDistance:y)-mdsResult[focusIndex][1]}})),this.run(maxIteration,positions,weights,idealDistances,radii,focusIndex),preventOverlap&&(nodeSizeFunc=(0,util_function.G0)(nodeSize,nodeSpacing),nonoverlapForceParams={nodes,nodeSizeFunc,positions,radii,height,width,strictRadial:Boolean(strictRadial),focusIdx:focusIndex,iterations:maxPreventOverlapIteration||200,k:positions.length/4.5},positions=function(graph,options){for(var mergedOptions=(0,tslib_es6.C3)((0,tslib_es6.C3)({},DEFAULTS_LAYOUT_OPTIONS),options),positions=mergedOptions.positions,iterations=mergedOptions.iterations,width=mergedOptions.width,k=mergedOptions.k,_a=mergedOptions.speed,speed=void 0===_a?100:_a,strictRadial=mergedOptions.strictRadial,focusIdx=mergedOptions.focusIdx,_b=mergedOptions.radii,radii=void 0===_b?[]:_b,nodeSizeFunc=mergedOptions.nodeSizeFunc,nodes=graph.getAllNodes(),disp=[],maxDisplace=width/10,i=0;i<iterations;i++)positions.forEach((function(_,k){disp[k]={x:0,y:0}})),getRepulsion(nodes,positions,disp,k,radii,nodeSizeFunc),updatePositions(positions,disp,speed,strictRadial,focusIdx,maxDisplace,width,radii);return positions}(graph,nonoverlapForceParams)),layoutNodes=[],positions.forEach((function(p,i){var cnode=(0,object.o)(nodes[i]);cnode.data.x=p.x+center[0],cnode.data.y=p.y+center[1],layoutNodes.push(cnode)})),assign&&layoutNodes.forEach((function(node){return graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),[2,{nodes:layoutNodes,edges}]}))}))},RadialLayout.prototype.run=function(maxIteration,positions,weights,idealDistances,radii,focusIndex){for(var i=0;i<=maxIteration;i++){var param=i/maxIteration;this.oneIteration(param,positions,radii,idealDistances,weights,focusIndex)}},RadialLayout.prototype.oneIteration=function(param,positions,radii,distances,weights,focusIndex){var vparam=1-param;positions.forEach((function(v,i){var originDis=(0,math.CS)(v,{x:0,y:0}),reciODis=0===originDis?0:1/originDis;if(i!==focusIndex){var xMolecule=0,yMolecule=0,denominator=0;positions.forEach((function(u,j){if(i!==j){var edis=(0,math.CS)(v,u),reciEdis=0===edis?0:1/edis,idealDis=distances[j][i];denominator+=weights[i][j],xMolecule+=weights[i][j]*(u.x+idealDis*(v.x-u.x)*reciEdis),yMolecule+=weights[i][j]*(u.y+idealDis*(v.y-u.y)*reciEdis)}}));var reciR=0===radii[i]?0:1/radii[i];denominator*=vparam,denominator+=param*reciR*reciR,xMolecule*=vparam,xMolecule+=param*reciR*v.x*reciODis,v.x=xMolecule/denominator,yMolecule*=vparam,yMolecule+=param*reciR*v.y*reciODis,v.y=yMolecule/denominator}}))},RadialLayout}(),eIdealDisMatrix=function(nodes,distances,linkDistance,radii,unitRadius,sortBy,sortStrength){if(!nodes)return[];var result=[];if(distances){var sortValueCache_1={};distances.forEach((function(row,i){var newRow=[];row.forEach((function(v,j){var _a,_b;if(i===j)newRow.push(0);else if(radii[i]===radii[j])if("data"===sortBy)newRow.push(v*(Math.abs(i-j)*sortStrength)/(radii[i]/unitRadius));else if(sortBy){var iValue=void 0,jValue=void 0;if(sortValueCache_1[nodes[i].id])iValue=sortValueCache_1[nodes[i].id];else{var value=("id"===sortBy?nodes[i].id:null===(_a=nodes[i].data)||void 0===_a?void 0:_a[sortBy])||0;iValue=(0,is_string.c)(value)?value.charCodeAt(0):value,sortValueCache_1[nodes[i].id]=iValue}if(sortValueCache_1[nodes[j].id])jValue=sortValueCache_1[nodes[j].id];else{value=("id"===sortBy?nodes[j].id:null===(_b=nodes[j].data)||void 0===_b?void 0:_b[sortBy])||0;jValue=(0,is_string.c)(value)?value.charCodeAt(0):value,sortValueCache_1[nodes[j].id]=jValue}newRow.push(v*(Math.abs(iValue-jValue)*sortStrength)/(radii[i]/unitRadius))}else newRow.push(v*linkDistance/(radii[i]/unitRadius));else{var link=(linkDistance+unitRadius)/2;newRow.push(v*link)}})),result.push(newRow)}))}return result},getWeightMatrix=function(idealDistances){for(var rows=idealDistances.length,cols=idealDistances[0].length,result=[],i=0;i<rows;i++){for(var row=[],j=0;j<cols;j++)0!==idealDistances[i][j]?row.push(1/(idealDistances[i][j]*idealDistances[i][j])):row.push(0);result.push(row)}return result},getIndexById=function(array,id){var index=-1;return array.forEach((function(a,i){a.id===id&&(index=i)})),Math.max(index,0)},handleInfinity=function(matrix,focusIndex,step){for(var length=matrix.length,i=0;i<length;i++)if(matrix[focusIndex][i]===1/0){matrix[focusIndex][i]=step,matrix[i][focusIndex]=step;for(var j=0;j<length;j++)matrix[i][j]!==1/0&&matrix[focusIndex][j]===1/0&&(matrix[focusIndex][j]=step+matrix[i][j],matrix[j][focusIndex]=step+matrix[i][j])}for(i=0;i<length;i++)if(i!==focusIndex)for(j=0;j<length;j++)if(matrix[i][j]===1/0){var minus=Math.abs(matrix[focusIndex][i]-matrix[focusIndex][j]);minus=0===minus?1:minus,matrix[i][j]=minus}},maxToFocus=function(matrix,focusIndex){for(var max=0,i=0;i<matrix[focusIndex].length;i++)matrix[focusIndex][i]!==1/0&&(max=matrix[focusIndex][i]>max?matrix[focusIndex][i]:max);return max}},"./node_modules/@antv/layout/lib/random.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>RandomLayout});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),DEFAULTS_LAYOUT_OPTIONS={center:[0,0],width:300,height:300},RandomLayout=function(){function RandomLayout(options){void 0===options&&(options={}),this.options=options,this.id="random",this.options=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},DEFAULTS_LAYOUT_OPTIONS),options)}return RandomLayout.prototype.execute=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return[2,this.genericRandomLayout(!1,graph,options)]}))}))},RandomLayout.prototype.assign=function(graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return this.genericRandomLayout(!0,graph,options),[2]}))}))},RandomLayout.prototype.genericRandomLayout=function(assign,graph,options){return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.kH)(this,void 0,void 0,(function(){var mergedOptions,propsCenter,propsWidth,propsHeight,nodes,width,height,center,layoutNodes;return(0,tslib__WEBPACK_IMPORTED_MODULE_0__.KE)(this,(function(_a){return mergedOptions=(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},this.options),options),propsCenter=mergedOptions.center,propsWidth=mergedOptions.width,propsHeight=mergedOptions.height,nodes=graph.getAllNodes(),.9,width=propsWidth||"undefined"==typeof window?propsWidth:window.innerWidth,height=propsHeight||"undefined"==typeof window?propsHeight:window.innerHeight,center=propsCenter||[width/2,height/2],layoutNodes=[],nodes&&nodes.forEach((function(node){layoutNodes.push({id:node.id,data:{x:.9*(Math.random()-.5)*width+center[0],y:.9*(Math.random()-.5)*height+center[1]}})})),assign&&layoutNodes.forEach((function(node){return graph.mergeNodeData(node.id,{x:node.data.x,y:node.data.y})})),[2,{nodes:layoutNodes,edges:graph.getAllEdges()}]}))}))},RandomLayout}()},"./node_modules/@antv/layout/lib/types.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function isLayoutWithIterations(layout){return!!layout.tick&&!!layout.stop}__webpack_require__.d(__webpack_exports__,{W:()=>isLayoutWithIterations})},"./node_modules/@antv/layout/lib/util/array.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>isArray});var isArray=Array.isArray},"./node_modules/@antv/layout/lib/util/common.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{s:()=>handleSingleNodeGraph});var tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),handleSingleNodeGraph=function(graph,assign,center){var nodes=graph.getAllNodes(),edges=graph.getAllEdges();return(null==nodes?void 0:nodes.length)?1===nodes.length?(assign&&graph.mergeNodeData(nodes[0].id,{x:center[0],y:center[1]}),{nodes:[(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},nodes[0]),{data:(0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.C3)({},nodes[0].data),{x:center[0],y:center[1]})})],edges}):void 0:{nodes:[],edges}}},"./node_modules/@antv/layout/lib/util/function.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G0:()=>formatNodeSize,Gy:()=>formatSizeFn,uA:()=>formatNumberFn});var tslib__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_antv_util__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-function.js"),_antv_util__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),_antv_util__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-object.js");function formatNumberFn(defaultValue,value){return(0,_antv_util__WEBPACK_IMPORTED_MODULE_0__.c)(value)?value:(0,_antv_util__WEBPACK_IMPORTED_MODULE_1__.c)(value)?function(){return value}:function(){return defaultValue}}function formatSizeFn(defaultValue,value,resultIsNumber){return void 0===resultIsNumber&&(resultIsNumber=!0),value||0===value?(0,_antv_util__WEBPACK_IMPORTED_MODULE_0__.c)(value)?value:(0,_antv_util__WEBPACK_IMPORTED_MODULE_1__.c)(value)?function(){return value}:Array.isArray(value)?function(){if(resultIsNumber){var max=Math.max.apply(Math,(0,tslib__WEBPACK_IMPORTED_MODULE_3__.Mt)([],(0,tslib__WEBPACK_IMPORTED_MODULE_3__.o5)(value)));return isNaN(max)?defaultValue:max}return value}:(0,_antv_util__WEBPACK_IMPORTED_MODULE_2__.c)(value)?function(){if(resultIsNumber){var max=Math.max(value.width,value.height);return isNaN(max)?defaultValue:max}return[value.width,value.height]}:function(){return defaultValue}:function(d){var size=(d.data||{}).size;return size?Array.isArray(size)?size[0]>size[1]?size[0]:size[1]:(0,_antv_util__WEBPACK_IMPORTED_MODULE_2__.c)(size)?size.width>size.height?size.width:size.height:size:defaultValue}}var formatNodeSize=function(nodeSize,nodeSpacing){var nodeSpacingFunc;return nodeSpacingFunc=(0,_antv_util__WEBPACK_IMPORTED_MODULE_1__.c)(nodeSpacing)?function(){return nodeSpacing}:(0,_antv_util__WEBPACK_IMPORTED_MODULE_0__.c)(nodeSpacing)?nodeSpacing:function(){return 0},nodeSize?Array.isArray(nodeSize)?function(d){return(nodeSize[0]>nodeSize[1]?nodeSize[0]:nodeSize[1])+nodeSpacingFunc(d)}:(0,_antv_util__WEBPACK_IMPORTED_MODULE_0__.c)(nodeSize)?nodeSize:function(d){return nodeSize+nodeSpacingFunc(d)}:function(d){var _a,_b;if(null===(_a=d.data)||void 0===_a?void 0:_a.bboxSize)return Math.max(d.data.bboxSize[0],d.data.bboxSize[1])+nodeSpacingFunc(d);if(null===(_b=d.data)||void 0===_b?void 0:_b.size){if(Array.isArray(d.data.size))return Math.max(d.data.size[0],d.data.size[1])+nodeSpacingFunc(d);var dataSize=d.data.size;return(0,_antv_util__WEBPACK_IMPORTED_MODULE_2__.c)(dataSize)?(dataSize.width>dataSize.height?dataSize.width:dataSize.height)+nodeSpacingFunc(d):dataSize+nodeSpacingFunc(d)}return 10+nodeSpacingFunc(d)}}},"./node_modules/@antv/layout/lib/util/math.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C2:()=>getLayoutBBox,CS:()=>getEuclideanDistance,SG:()=>scaleMatrix,Ws:()=>floydWarshall,iA:()=>getAdjMatrix,wV:()=>graphTreeDfs});var _antv_util__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),_array__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@antv/layout/lib/util/array.js"),floydWarshall=function(adjMatrix){for(var dist=[],size=adjMatrix.length,i=0;i<size;i+=1){dist[i]=[];for(var j=0;j<size;j+=1)i===j?dist[i][j]=0:0!==adjMatrix[i][j]&&adjMatrix[i][j]?dist[i][j]=adjMatrix[i][j]:dist[i][j]=1/0}for(var k=0;k<size;k+=1)for(i=0;i<size;i+=1)for(j=0;j<size;j+=1)dist[i][j]>dist[i][k]+dist[k][j]&&(dist[i][j]=dist[i][k]+dist[k][j]);return dist},getAdjMatrix=function(data,directed){var nodes=data.nodes,edges=data.edges,matrix=[],nodeMap={};if(!nodes)throw new Error("invalid nodes data!");return nodes&&nodes.forEach((function(node,i){nodeMap[node.id]=i;matrix.push([])})),null==edges||edges.forEach((function(e){var source=e.source,target=e.target,sIndex=nodeMap[source],tIndex=nodeMap[target];void 0!==sIndex&&void 0!==tIndex&&(matrix[sIndex][tIndex]=1,directed||(matrix[tIndex][sIndex]=1))})),matrix},scaleMatrix=function(matrix,ratio){var result=[];return matrix.forEach((function(row){var newRow=[];row.forEach((function(v){newRow.push(v*ratio)})),result.push(newRow)})),result},getLayoutBBox=function(nodes){var minX=1/0,minY=1/0,maxX=-1/0,maxY=-1/0;return nodes.forEach((function(node){var size=node.data.size;(0,_array__WEBPACK_IMPORTED_MODULE_0__.c)(size)?1===size.length&&(size=[size[0],size[0]]):(0,_antv_util__WEBPACK_IMPORTED_MODULE_1__.c)(size)?size=[size,size]:(void 0===size||isNaN(size))&&(size=[30,30]);var halfSize=[size[0]/2,size[1]/2],left=node.data.x-halfSize[0],right=node.data.x+halfSize[0],top=node.data.y-halfSize[1],bottom=node.data.y+halfSize[1];minX>left&&(minX=left),minY>top&&(minY=top),maxX<right&&(maxX=right),maxY<bottom&&(maxY=bottom)})),{minX,minY,maxX,maxY}},getEuclideanDistance=function(p1,p2){return Math.sqrt((p1.x-p2.x)*(p1.x-p2.x)+(p1.y-p2.y)*(p1.y-p2.y))},graphTreeDfs=function(graph,nodes,fn,mode,treeKey,stopFns){if(void 0===mode&&(mode="TB"),void 0===stopFns&&(stopFns={}),null==nodes?void 0:nodes.length)for(var stopBranchFn=stopFns.stopBranchFn,stopAllFn=stopFns.stopAllFn,i=0;i<nodes.length;i++){var node=nodes[i];if(graph.hasNode(node.id)&&!(null==stopBranchFn?void 0:stopBranchFn(node))){if(null==stopAllFn?void 0:stopAllFn(node))return;"TB"===mode&&fn(node),graphTreeDfs(graph,graph.getChildren(node.id,treeKey),fn,mode,treeKey,stopFns),"TB"!==mode&&fn(node)}}}},"./node_modules/@antv/layout/lib/util/object.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{o:()=>cloneFormatData});var _antv_util__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-number.js"),clone=function(target){if(null===target)return target;if(target instanceof Date)return new Date(target.getTime());if(target instanceof Array){var cp_1=[];return target.forEach((function(v){cp_1.push(v)})),cp_1.map((function(n){return clone(n)}))}if("object"==typeof target){var cp_2={};return Object.keys(target).forEach((function(k){cp_2[k]=clone(target[k])})),cp_2}return target},cloneFormatData=function(target,initRange){var cloned=clone(target);return cloned.data=cloned.data||{},initRange&&((0,_antv_util__WEBPACK_IMPORTED_MODULE_0__.c)(cloned.data.x)||(cloned.data.x=Math.random()*initRange[0]),(0,_antv_util__WEBPACK_IMPORTED_MODULE_0__.c)(cloned.data.y)||(cloned.data.y=Math.random()*initRange[1])),cloned}},"./node_modules/@antv/util/esm/lodash/clone.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>__WEBPACK_DEFAULT_EXPORT__});var _is_array__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-array.js"),clone=function(obj){if("object"!=typeof obj||null===obj)return obj;var rst;if((0,_is_array__WEBPACK_IMPORTED_MODULE_0__.c)(obj)){rst=[];for(var i=0,l=obj.length;i<l;i++)"object"==typeof obj[i]&&null!=obj[i]?rst[i]=clone(obj[i]):rst[i]=obj[i]}else for(var k in rst={},obj)"object"==typeof obj[k]&&null!=obj[k]?rst[k]=clone(obj[k]):rst[k]=obj[k];return rst};const __WEBPACK_DEFAULT_EXPORT__=clone},"./node_modules/@antv/util/esm/lodash/is-array.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>__WEBPACK_DEFAULT_EXPORT__});var _is_type__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-type.js");const __WEBPACK_DEFAULT_EXPORT__=function(value){return Array.isArray?Array.isArray(value):(0,_is_type__WEBPACK_IMPORTED_MODULE_0__.c)(value,"Array")}},"./node_modules/@antv/util/esm/lodash/is-function.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function(value){return"function"==typeof value}},"./node_modules/@antv/util/esm/lodash/is-nil.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function(value){return null==value}},"./node_modules/@antv/util/esm/lodash/is-number.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>__WEBPACK_DEFAULT_EXPORT__});var _is_type__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-type.js");const __WEBPACK_DEFAULT_EXPORT__=function(value){return(0,_is_type__WEBPACK_IMPORTED_MODULE_0__.c)(value,"Number")}},"./node_modules/@antv/util/esm/lodash/is-object.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=function(value){var type=typeof value;return null!==value&&"object"===type||"function"===type}},"./node_modules/@antv/util/esm/lodash/is-string.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>__WEBPACK_DEFAULT_EXPORT__});var _is_type__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@antv/util/esm/lodash/is-type.js");const __WEBPACK_DEFAULT_EXPORT__=function(str){return(0,_is_type__WEBPACK_IMPORTED_MODULE_0__.c)(str,"String")}},"./node_modules/@antv/util/esm/lodash/is-type.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{c:()=>__WEBPACK_DEFAULT_EXPORT__});var toString={}.toString;const __WEBPACK_DEFAULT_EXPORT__=function(value,type){return toString.call(value)==="[object "+type+"]"}},"./node_modules/d3-quadtree/src/quadtree.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function add_add(tree,x,y,d){if(isNaN(x)||isNaN(y))return tree;var parent,xm,ym,xp,yp,right,bottom,i,j,node=tree._root,leaf={data:d},x0=tree._x0,y0=tree._y0,x1=tree._x1,y1=tree._y1;if(!node)return tree._root=leaf,tree;for(;node.length;)if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return parent[i]=leaf,tree;if(xp=+tree._x.call(null,node.data),yp=+tree._y.call(null,node.data),x===xp&&y===yp)return leaf.next=node,parent?parent[i]=leaf:tree._root=leaf,tree;do{parent=parent?parent[i]=new Array(4):tree._root=new Array(4),(right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym}while((i=bottom<<1|right)==(j=(yp>=ym)<<1|xp>=xm));return parent[j]=node,parent[i]=leaf,tree}function quad(node,x0,y0,x1,y1){this.node=node,this.x0=x0,this.y0=y0,this.x1=x1,this.y1=y1}function defaultX(d){return d[0]}function defaultY(d){return d[1]}function quadtree(nodes,x,y){var tree=new Quadtree(null==x?defaultX:x,null==y?defaultY:y,NaN,NaN,NaN,NaN);return null==nodes?tree:tree.addAll(nodes)}function Quadtree(x,y,x0,y0,x1,y1){this._x=x,this._y=y,this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this._root=void 0}function leaf_copy(leaf){for(var copy={data:leaf.data},next=copy;leaf=leaf.next;)next=next.next={data:leaf.data};return copy}__webpack_require__.d(__webpack_exports__,{c:()=>quadtree});var treeProto=quadtree.prototype=Quadtree.prototype;treeProto.copy=function(){var nodes,child,copy=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),node=this._root;if(!node)return copy;if(!node.length)return copy._root=leaf_copy(node),copy;for(nodes=[{source:node,target:copy._root=new Array(4)}];node=nodes.pop();)for(var i=0;i<4;++i)(child=node.source[i])&&(child.length?nodes.push({source:child,target:node.target[i]=new Array(4)}):node.target[i]=leaf_copy(child));return copy},treeProto.add=function add(d){const x=+this._x.call(null,d),y=+this._y.call(null,d);return add_add(this.cover(x,y),x,y,d)},treeProto.addAll=function addAll(data){var d,i,x,y,n=data.length,xz=new Array(n),yz=new Array(n),x0=1/0,y0=1/0,x1=-1/0,y1=-1/0;for(i=0;i<n;++i)isNaN(x=+this._x.call(null,d=data[i]))||isNaN(y=+this._y.call(null,d))||(xz[i]=x,yz[i]=y,x<x0&&(x0=x),x>x1&&(x1=x),y<y0&&(y0=y),y>y1&&(y1=y));if(x0>x1||y0>y1)return this;for(this.cover(x0,y0).cover(x1,y1),i=0;i<n;++i)add_add(this,xz[i],yz[i],data[i]);return this},treeProto.cover=function cover(x,y){if(isNaN(x=+x)||isNaN(y=+y))return this;var x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(isNaN(x0))x1=(x0=Math.floor(x))+1,y1=(y0=Math.floor(y))+1;else{for(var parent,i,z=x1-x0||1,node=this._root;x0>x||x>=x1||y0>y||y>=y1;)switch(i=(y<y0)<<1|x<x0,(parent=new Array(4))[i]=node,node=parent,z*=2,i){case 0:x1=x0+z,y1=y0+z;break;case 1:x0=x1-z,y1=y0+z;break;case 2:x1=x0+z,y0=y1-z;break;case 3:x0=x1-z,y0=y1-z}this._root&&this._root.length&&(this._root=node)}return this._x0=x0,this._y0=y0,this._x1=x1,this._y1=y1,this},treeProto.data=function data(){var data=[];return this.visit((function(node){if(!node.length)do{data.push(node.data)}while(node=node.next)})),data},treeProto.extent=function extent(_){return arguments.length?this.cover(+_[0][0],+_[0][1]).cover(+_[1][0],+_[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},treeProto.find=function find(x,y,radius){var data,x1,y1,x2,y2,q,i,x0=this._x0,y0=this._y0,x3=this._x1,y3=this._y1,quads=[],node=this._root;for(node&&quads.push(new quad(node,x0,y0,x3,y3)),null==radius?radius=1/0:(x0=x-radius,y0=y-radius,x3=x+radius,y3=y+radius,radius*=radius);q=quads.pop();)if(!(!(node=q.node)||(x1=q.x0)>x3||(y1=q.y0)>y3||(x2=q.x1)<x0||(y2=q.y1)<y0))if(node.length){var xm=(x1+x2)/2,ym=(y1+y2)/2;quads.push(new quad(node[3],xm,ym,x2,y2),new quad(node[2],x1,ym,xm,y2),new quad(node[1],xm,y1,x2,ym),new quad(node[0],x1,y1,xm,ym)),(i=(y>=ym)<<1|x>=xm)&&(q=quads[quads.length-1],quads[quads.length-1]=quads[quads.length-1-i],quads[quads.length-1-i]=q)}else{var dx=x-+this._x.call(null,node.data),dy=y-+this._y.call(null,node.data),d2=dx*dx+dy*dy;if(d2<radius){var d=Math.sqrt(radius=d2);x0=x-d,y0=y-d,x3=x+d,y3=y+d,data=node.data}}return data},treeProto.remove=function remove(d){if(isNaN(x=+this._x.call(null,d))||isNaN(y=+this._y.call(null,d)))return this;var parent,retainer,previous,next,x,y,xm,ym,right,bottom,i,j,node=this._root,x0=this._x0,y0=this._y0,x1=this._x1,y1=this._y1;if(!node)return this;if(node.length)for(;;){if((right=x>=(xm=(x0+x1)/2))?x0=xm:x1=xm,(bottom=y>=(ym=(y0+y1)/2))?y0=ym:y1=ym,parent=node,!(node=node[i=bottom<<1|right]))return this;if(!node.length)break;(parent[i+1&3]||parent[i+2&3]||parent[i+3&3])&&(retainer=parent,j=i)}for(;node.data!==d;)if(previous=node,!(node=node.next))return this;return(next=node.next)&&delete node.next,previous?(next?previous.next=next:delete previous.next,this):parent?(next?parent[i]=next:delete parent[i],(node=parent[0]||parent[1]||parent[2]||parent[3])&&node===(parent[3]||parent[2]||parent[1]||parent[0])&&!node.length&&(retainer?retainer[j]=node:this._root=node),this):(this._root=next,this)},treeProto.removeAll=function removeAll(data){for(var i=0,n=data.length;i<n;++i)this.remove(data[i]);return this},treeProto.root=function root(){return this._root},treeProto.size=function size(){var size=0;return this.visit((function(node){if(!node.length)do{++size}while(node=node.next)})),size},treeProto.visit=function visit(callback){var q,child,x0,y0,x1,y1,quads=[],node=this._root;for(node&&quads.push(new quad(node,this._x0,this._y0,this._x1,this._y1));q=quads.pop();)if(!callback(node=q.node,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1)&&node.length){var xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[3])&&quads.push(new quad(child,xm,ym,x1,y1)),(child=node[2])&&quads.push(new quad(child,x0,ym,xm,y1)),(child=node[1])&&quads.push(new quad(child,xm,y0,x1,ym)),(child=node[0])&&quads.push(new quad(child,x0,y0,xm,ym))}return this},treeProto.visitAfter=function visitAfter(callback){var q,quads=[],next=[];for(this._root&&quads.push(new quad(this._root,this._x0,this._y0,this._x1,this._y1));q=quads.pop();){var node=q.node;if(node.length){var child,x0=q.x0,y0=q.y0,x1=q.x1,y1=q.y1,xm=(x0+x1)/2,ym=(y0+y1)/2;(child=node[0])&&quads.push(new quad(child,x0,y0,xm,ym)),(child=node[1])&&quads.push(new quad(child,xm,y0,x1,ym)),(child=node[2])&&quads.push(new quad(child,x0,ym,xm,y1)),(child=node[3])&&quads.push(new quad(child,xm,ym,x1,y1))}next.push(q)}for(;q=next.pop();)callback(q.node,q.x0,q.y0,q.x1,q.y1);return this},treeProto.x=function x(_){return arguments.length?(this._x=_,this):this._x},treeProto.y=function y(_){return arguments.length?(this._y=_,this):this._y}},"./node_modules/is-any-array/lib-esm/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{isAnyArray:()=>isAnyArray});const toString=Object.prototype.toString;function isAnyArray(value){const tag=toString.call(value);return tag.endsWith("Array]")&&!tag.includes("Big")}},"./node_modules/ml-array-rescale/lib-es6/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>rescale});var lib_esm=__webpack_require__("./node_modules/is-any-array/lib-esm/index.js");function rescale(input){var output,options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,lib_esm.isAnyArray)(input))throw new TypeError("input must be an array");if(0===input.length)throw new TypeError("input must not be empty");if(void 0!==options.output){if(!(0,lib_esm.isAnyArray)(options.output))throw new TypeError("output option must be an array if specified");output=options.output}else output=new Array(input.length);var currentMin=function min(input){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,lib_esm.isAnyArray)(input))throw new TypeError("input must be an array");if(0===input.length)throw new TypeError("input must not be empty");var _options$fromIndex=options.fromIndex,fromIndex=void 0===_options$fromIndex?0:_options$fromIndex,_options$toIndex=options.toIndex,toIndex=void 0===_options$toIndex?input.length:_options$toIndex;if(fromIndex<0||fromIndex>=input.length||!Number.isInteger(fromIndex))throw new Error("fromIndex must be a positive integer smaller than length");if(toIndex<=fromIndex||toIndex>input.length||!Number.isInteger(toIndex))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var minValue=input[fromIndex],i=fromIndex+1;i<toIndex;i++)input[i]<minValue&&(minValue=input[i]);return minValue}(input),currentMax=function max(input){var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,lib_esm.isAnyArray)(input))throw new TypeError("input must be an array");if(0===input.length)throw new TypeError("input must not be empty");var _options$fromIndex=options.fromIndex,fromIndex=void 0===_options$fromIndex?0:_options$fromIndex,_options$toIndex=options.toIndex,toIndex=void 0===_options$toIndex?input.length:_options$toIndex;if(fromIndex<0||fromIndex>=input.length||!Number.isInteger(fromIndex))throw new Error("fromIndex must be a positive integer smaller than length");if(toIndex<=fromIndex||toIndex>input.length||!Number.isInteger(toIndex))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var maxValue=input[fromIndex],i=fromIndex+1;i<toIndex;i++)input[i]>maxValue&&(maxValue=input[i]);return maxValue}(input);if(currentMin===currentMax)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var _options$min=options.min,minValue=void 0===_options$min?options.autoMinMax?currentMin:0:_options$min,_options$max=options.max,maxValue=void 0===_options$max?options.autoMinMax?currentMax:1:_options$max;if(minValue>=maxValue)throw new RangeError("min option must be smaller than max option");for(var factor=(maxValue-minValue)/(currentMax-currentMin),i=0;i<input.length;i++)output[i]=(input[i]-currentMin)*factor+minValue;return output}},"./node_modules/ml-matrix/matrix.js":(__unused_webpack_module,exports,__webpack_require__)=>{var isAnyArray=__webpack_require__("./node_modules/is-any-array/lib-esm/index.js"),rescale=__webpack_require__("./node_modules/ml-array-rescale/lib-es6/index.js");const indent=" ".repeat(2),indentData=" ".repeat(4);function inspectMatrixWithOptions(matrix,options={}){const{maxRows=15,maxColumns=10,maxNumSize=8,padMinus="auto"}=options;return`${matrix.constructor.name} {\n${indent}[\n${indentData}${function inspectData(matrix,maxRows,maxColumns,maxNumSize,padMinus){const{rows,columns}=matrix,maxI=Math.min(rows,maxRows),maxJ=Math.min(columns,maxColumns),result=[];if("auto"===padMinus){padMinus=!1;loop:for(let i=0;i<maxI;i++)for(let j=0;j<maxJ;j++)if(matrix.get(i,j)<0){padMinus=!0;break loop}}for(let i=0;i<maxI;i++){let line=[];for(let j=0;j<maxJ;j++)line.push(formatNumber(matrix.get(i,j),maxNumSize,padMinus));result.push(`${line.join(" ")}`)}maxJ!==columns&&(result[result.length-1]+=` ... ${columns-maxColumns} more columns`);maxI!==rows&&result.push(`... ${rows-maxRows} more rows`);return result.join(`\n${indentData}`)}(matrix,maxRows,maxColumns,maxNumSize,padMinus)}\n${indent}]\n${indent}rows: ${matrix.rows}\n${indent}columns: ${matrix.columns}\n}`}function formatNumber(num,maxNumSize,padMinus){return(num>=0&&padMinus?` ${formatNumber2(num,maxNumSize-1)}`:formatNumber2(num,maxNumSize)).padEnd(maxNumSize)}function formatNumber2(num,len){let str=num.toString();if(str.length<=len)return str;let fix=num.toFixed(len);if(fix.length>len&&(fix=num.toFixed(Math.max(0,len-(fix.length-len)))),fix.length<=len&&!fix.startsWith("0.000")&&!fix.startsWith("-0.000"))return fix;let exp=num.toExponential(len);return exp.length>len&&(exp=num.toExponential(Math.max(0,len-(exp.length-len)))),exp.slice(0)}function checkRowIndex(matrix,index,outer){let max=outer?matrix.rows:matrix.rows-1;if(index<0||index>max)throw new RangeError("Row index out of range")}function checkColumnIndex(matrix,index,outer){let max=outer?matrix.columns:matrix.columns-1;if(index<0||index>max)throw new RangeError("Column index out of range")}function checkRowVector(matrix,vector){if(vector.to1DArray&&(vector=vector.to1DArray()),vector.length!==matrix.columns)throw new RangeError("vector size must be the same as the number of columns");return vector}function checkColumnVector(matrix,vector){if(vector.to1DArray&&(vector=vector.to1DArray()),vector.length!==matrix.rows)throw new RangeError("vector size must be the same as the number of rows");return vector}function checkRowIndices(matrix,rowIndices){if(!isAnyArray.isAnyArray(rowIndices))throw new TypeError("row indices must be an array");for(let i=0;i<rowIndices.length;i++)if(rowIndices[i]<0||rowIndices[i]>=matrix.rows)throw new RangeError("row indices are out of range")}function checkColumnIndices(matrix,columnIndices){if(!isAnyArray.isAnyArray(columnIndices))throw new TypeError("column indices must be an array");for(let i=0;i<columnIndices.length;i++)if(columnIndices[i]<0||columnIndices[i]>=matrix.columns)throw new RangeError("column indices are out of range")}function checkRange(matrix,startRow,endRow,startColumn,endColumn){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(checkNumber("startRow",startRow),checkNumber("endRow",endRow),checkNumber("startColumn",startColumn),checkNumber("endColumn",endColumn),startRow>endRow||startColumn>endColumn||startRow<0||startRow>=matrix.rows||endRow<0||endRow>=matrix.rows||startColumn<0||startColumn>=matrix.columns||endColumn<0||endColumn>=matrix.columns)throw new RangeError("Submatrix indices are out of range")}function newArray(length,value=0){let array=[];for(let i=0;i<length;i++)array.push(value);return array}function checkNumber(name,value){if("number"!=typeof value)throw new TypeError(`${name} must be a number`)}function checkNonEmpty(matrix){if(matrix.isEmpty())throw new Error("Empty matrix has no elements to index")}class AbstractMatrix{static from1DArray(newRows,newColumns,newData){if(newRows*newColumns!==newData.length)throw new RangeError("data length does not match given dimensions");let newMatrix=new Matrix(newRows,newColumns);for(let row=0;row<newRows;row++)for(let column=0;column<newColumns;column++)newMatrix.set(row,column,newData[row*newColumns+column]);return newMatrix}static rowVector(newData){let vector=new Matrix(1,newData.length);for(let i=0;i<newData.length;i++)vector.set(0,i,newData[i]);return vector}static columnVector(newData){let vector=new Matrix(newData.length,1);for(let i=0;i<newData.length;i++)vector.set(i,0,newData[i]);return vector}static zeros(rows,columns){return new Matrix(rows,columns)}static ones(rows,columns){return new Matrix(rows,columns).fill(1)}static rand(rows,columns,options={}){if("object"!=typeof options)throw new TypeError("options must be an object");const{random=Math.random}=options;let matrix=new Matrix(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)matrix.set(i,j,random());return matrix}static randInt(rows,columns,options={}){if("object"!=typeof options)throw new TypeError("options must be an object");const{min=0,max=1e3,random=Math.random}=options;if(!Number.isInteger(min))throw new TypeError("min must be an integer");if(!Number.isInteger(max))throw new TypeError("max must be an integer");if(min>=max)throw new RangeError("min must be smaller than max");let interval=max-min,matrix=new Matrix(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++){let value=min+Math.round(random()*interval);matrix.set(i,j,value)}return matrix}static eye(rows,columns,value){void 0===columns&&(columns=rows),void 0===value&&(value=1);let min=Math.min(rows,columns),matrix=this.zeros(rows,columns);for(let i=0;i<min;i++)matrix.set(i,i,value);return matrix}static diag(data,rows,columns){let l=data.length;void 0===rows&&(rows=l),void 0===columns&&(columns=rows);let min=Math.min(l,rows,columns),matrix=this.zeros(rows,columns);for(let i=0;i<min;i++)matrix.set(i,i,data[i]);return matrix}static min(matrix1,matrix2){matrix1=this.checkMatrix(matrix1),matrix2=this.checkMatrix(matrix2);let rows=matrix1.rows,columns=matrix1.columns,result=new Matrix(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)result.set(i,j,Math.min(matrix1.get(i,j),matrix2.get(i,j)));return result}static max(matrix1,matrix2){matrix1=this.checkMatrix(matrix1),matrix2=this.checkMatrix(matrix2);let rows=matrix1.rows,columns=matrix1.columns,result=new this(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)result.set(i,j,Math.max(matrix1.get(i,j),matrix2.get(i,j)));return result}static checkMatrix(value){return AbstractMatrix.isMatrix(value)?value:new Matrix(value)}static isMatrix(value){return null!=value&&"Matrix"===value.klass}get size(){return this.rows*this.columns}apply(callback){if("function"!=typeof callback)throw new TypeError("callback must be a function");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)callback.call(this,i,j);return this}to1DArray(){let array=[];for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)array.push(this.get(i,j));return array}to2DArray(){let copy=[];for(let i=0;i<this.rows;i++){copy.push([]);for(let j=0;j<this.columns;j++)copy[i].push(this.get(i,j))}return copy}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let i=0;i<this.rows;i++)for(let j=0;j<=i;j++)if(this.get(i,j)!==this.get(j,i))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let i=0;i<this.rows;i++)if(0!==this.get(i,i))return!1;return!0}isEchelonForm(){let i=0,j=0,previousColumn=-1,isEchelonForm=!0,checked=!1;for(;i<this.rows&&isEchelonForm;){for(j=0,checked=!1;j<this.columns&&!1===checked;)0===this.get(i,j)?j++:1===this.get(i,j)&&j>previousColumn?(checked=!0,previousColumn=j):(isEchelonForm=!1,checked=!0);i++}return isEchelonForm}isReducedEchelonForm(){let i=0,j=0,previousColumn=-1,isReducedEchelonForm=!0,checked=!1;for(;i<this.rows&&isReducedEchelonForm;){for(j=0,checked=!1;j<this.columns&&!1===checked;)0===this.get(i,j)?j++:1===this.get(i,j)&&j>previousColumn?(checked=!0,previousColumn=j):(isReducedEchelonForm=!1,checked=!0);for(let k=j+1;k<this.rows;k++)0!==this.get(i,k)&&(isReducedEchelonForm=!1);i++}return isReducedEchelonForm}echelonForm(){let result=this.clone(),h=0,k=0;for(;h<result.rows&&k<result.columns;){let iMax=h;for(let i=h;i<result.rows;i++)result.get(i,k)>result.get(iMax,k)&&(iMax=i);if(0===result.get(iMax,k))k++;else{result.swapRows(h,iMax);let tmp=result.get(h,k);for(let j=k;j<result.columns;j++)result.set(h,j,result.get(h,j)/tmp);for(let i=h+1;i<result.rows;i++){let factor=result.get(i,k)/result.get(h,k);result.set(i,k,0);for(let j=k+1;j<result.columns;j++)result.set(i,j,result.get(i,j)-result.get(h,j)*factor)}h++,k++}}return result}reducedEchelonForm(){let result=this.echelonForm(),m=result.columns,n=result.rows,h=n-1;for(;h>=0;)if(0===result.maxRow(h))h--;else{let p=0,pivot=!1;for(;p<n&&!1===pivot;)1===result.get(h,p)?pivot=!0:p++;for(let i=0;i<h;i++){let factor=result.get(i,p);for(let j=p;j<m;j++){let tmp=result.get(i,j)-factor*result.get(h,j);result.set(i,j,tmp)}}h--}return result}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(options={}){if("object"!=typeof options)throw new TypeError("options must be an object");const{rows=1,columns=1}=options;if(!Number.isInteger(rows)||rows<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(columns)||columns<=0)throw new TypeError("columns must be a positive integer");let matrix=new Matrix(this.rows*rows,this.columns*columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)matrix.setSubMatrix(this,this.rows*i,this.columns*j);return matrix}fill(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,value);return this}neg(){return this.mulS(-1)}getRow(index){checkRowIndex(this,index);let row=[];for(let i=0;i<this.columns;i++)row.push(this.get(index,i));return row}getRowVector(index){return Matrix.rowVector(this.getRow(index))}setRow(index,array){checkRowIndex(this,index),array=checkRowVector(this,array);for(let i=0;i<this.columns;i++)this.set(index,i,array[i]);return this}swapRows(row1,row2){checkRowIndex(this,row1),checkRowIndex(this,row2);for(let i=0;i<this.columns;i++){let temp=this.get(row1,i);this.set(row1,i,this.get(row2,i)),this.set(row2,i,temp)}return this}getColumn(index){checkColumnIndex(this,index);let column=[];for(let i=0;i<this.rows;i++)column.push(this.get(i,index));return column}getColumnVector(index){return Matrix.columnVector(this.getColumn(index))}setColumn(index,array){checkColumnIndex(this,index),array=checkColumnVector(this,array);for(let i=0;i<this.rows;i++)this.set(i,index,array[i]);return this}swapColumns(column1,column2){checkColumnIndex(this,column1),checkColumnIndex(this,column2);for(let i=0;i<this.rows;i++){let temp=this.get(i,column1);this.set(i,column1,this.get(i,column2)),this.set(i,column2,temp)}return this}addRowVector(vector){vector=checkRowVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)+vector[j]);return this}subRowVector(vector){vector=checkRowVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)-vector[j]);return this}mulRowVector(vector){vector=checkRowVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)*vector[j]);return this}divRowVector(vector){vector=checkRowVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)/vector[j]);return this}addColumnVector(vector){vector=checkColumnVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)+vector[i]);return this}subColumnVector(vector){vector=checkColumnVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)-vector[i]);return this}mulColumnVector(vector){vector=checkColumnVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)*vector[i]);return this}divColumnVector(vector){vector=checkColumnVector(this,vector);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)/vector[i]);return this}mulRow(index,value){checkRowIndex(this,index);for(let i=0;i<this.columns;i++)this.set(index,i,this.get(index,i)*value);return this}mulColumn(index,value){checkColumnIndex(this,index);for(let i=0;i<this.rows;i++)this.set(i,index,this.get(i,index)*value);return this}max(by){if(this.isEmpty())return NaN;switch(by){case"row":{const max=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let row=0;row<this.rows;row++)for(let column=0;column<this.columns;column++)this.get(row,column)>max[row]&&(max[row]=this.get(row,column));return max}case"column":{const max=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let row=0;row<this.rows;row++)for(let column=0;column<this.columns;column++)this.get(row,column)>max[column]&&(max[column]=this.get(row,column));return max}case void 0:{let max=this.get(0,0);for(let row=0;row<this.rows;row++)for(let column=0;column<this.columns;column++)this.get(row,column)>max&&(max=this.get(row,column));return max}default:throw new Error(`invalid option: ${by}`)}}maxIndex(){checkNonEmpty(this);let v=this.get(0,0),idx=[0,0];for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.get(i,j)>v&&(v=this.get(i,j),idx[0]=i,idx[1]=j);return idx}min(by){if(this.isEmpty())return NaN;switch(by){case"row":{const min=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let row=0;row<this.rows;row++)for(let column=0;column<this.columns;column++)this.get(row,column)<min[row]&&(min[row]=this.get(row,column));return min}case"column":{const min=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let row=0;row<this.rows;row++)for(let column=0;column<this.columns;column++)this.get(row,column)<min[column]&&(min[column]=this.get(row,column));return min}case void 0:{let min=this.get(0,0);for(let row=0;row<this.rows;row++)for(let column=0;column<this.columns;column++)this.get(row,column)<min&&(min=this.get(row,column));return min}default:throw new Error(`invalid option: ${by}`)}}minIndex(){checkNonEmpty(this);let v=this.get(0,0),idx=[0,0];for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.get(i,j)<v&&(v=this.get(i,j),idx[0]=i,idx[1]=j);return idx}maxRow(row){if(checkRowIndex(this,row),this.isEmpty())return NaN;let v=this.get(row,0);for(let i=1;i<this.columns;i++)this.get(row,i)>v&&(v=this.get(row,i));return v}maxRowIndex(row){checkRowIndex(this,row),checkNonEmpty(this);let v=this.get(row,0),idx=[row,0];for(let i=1;i<this.columns;i++)this.get(row,i)>v&&(v=this.get(row,i),idx[1]=i);return idx}minRow(row){if(checkRowIndex(this,row),this.isEmpty())return NaN;let v=this.get(row,0);for(let i=1;i<this.columns;i++)this.get(row,i)<v&&(v=this.get(row,i));return v}minRowIndex(row){checkRowIndex(this,row),checkNonEmpty(this);let v=this.get(row,0),idx=[row,0];for(let i=1;i<this.columns;i++)this.get(row,i)<v&&(v=this.get(row,i),idx[1]=i);return idx}maxColumn(column){if(checkColumnIndex(this,column),this.isEmpty())return NaN;let v=this.get(0,column);for(let i=1;i<this.rows;i++)this.get(i,column)>v&&(v=this.get(i,column));return v}maxColumnIndex(column){checkColumnIndex(this,column),checkNonEmpty(this);let v=this.get(0,column),idx=[0,column];for(let i=1;i<this.rows;i++)this.get(i,column)>v&&(v=this.get(i,column),idx[0]=i);return idx}minColumn(column){if(checkColumnIndex(this,column),this.isEmpty())return NaN;let v=this.get(0,column);for(let i=1;i<this.rows;i++)this.get(i,column)<v&&(v=this.get(i,column));return v}minColumnIndex(column){checkColumnIndex(this,column),checkNonEmpty(this);let v=this.get(0,column),idx=[0,column];for(let i=1;i<this.rows;i++)this.get(i,column)<v&&(v=this.get(i,column),idx[0]=i);return idx}diag(){let min=Math.min(this.rows,this.columns),diag=[];for(let i=0;i<min;i++)diag.push(this.get(i,i));return diag}norm(type="frobenius"){switch(type){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${type}`)}}cumulativeSum(){let sum=0;for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)sum+=this.get(i,j),this.set(i,j,sum);return this}dot(vector2){AbstractMatrix.isMatrix(vector2)&&(vector2=vector2.to1DArray());let vector1=this.to1DArray();if(vector1.length!==vector2.length)throw new RangeError("vectors do not have the same size");let dot=0;for(let i=0;i<vector1.length;i++)dot+=vector1[i]*vector2[i];return dot}mmul(other){other=Matrix.checkMatrix(other);let m=this.rows,n=this.columns,p=other.columns,result=new Matrix(m,p),Bcolj=new Float64Array(n);for(let j=0;j<p;j++){for(let k=0;k<n;k++)Bcolj[k]=other.get(k,j);for(let i=0;i<m;i++){let s=0;for(let k=0;k<n;k++)s+=this.get(i,k)*Bcolj[k];result.set(i,j,s)}}return result}strassen2x2(other){other=Matrix.checkMatrix(other);let result=new Matrix(2,2);const a11=this.get(0,0),b11=other.get(0,0),a12=this.get(0,1),b12=other.get(0,1),a21=this.get(1,0),b21=other.get(1,0),a22=this.get(1,1),b22=other.get(1,1),m1=(a11+a22)*(b11+b22),m2=(a21+a22)*b11,m3=a11*(b12-b22),m4=a22*(b21-b11),m5=(a11+a12)*b22,c00=m1+m4-m5+(a12-a22)*(b21+b22),c01=m3+m5,c10=m2+m4,c11=m1-m2+m3+(a21-a11)*(b11+b12);return result.set(0,0,c00),result.set(0,1,c01),result.set(1,0,c10),result.set(1,1,c11),result}strassen3x3(other){other=Matrix.checkMatrix(other);let result=new Matrix(3,3);const a00=this.get(0,0),a01=this.get(0,1),a02=this.get(0,2),a10=this.get(1,0),a11=this.get(1,1),a12=this.get(1,2),a20=this.get(2,0),a21=this.get(2,1),a22=this.get(2,2),b00=other.get(0,0),b01=other.get(0,1),b02=other.get(0,2),b10=other.get(1,0),b11=other.get(1,1),b12=other.get(1,2),b20=other.get(2,0),b21=other.get(2,1),b22=other.get(2,2),m2=(a00-a10)*(-b01+b11),m4=(-a00+a10+a11)*(b00-b01+b11),m5=(a10+a11)*(-b00+b01),m6=a00*b00,m7=(-a00+a20+a21)*(b00-b02+b12),m8=(-a00+a20)*(b02-b12),m9=(a20+a21)*(-b00+b02),m12=(-a02+a21+a22)*(b11+b20-b21),m13=(a02-a22)*(b11-b21),m14=a02*b20,m15=(a21+a22)*(-b20+b21),m16=(-a02+a11+a12)*(b12+b20-b22),m17=(a02-a12)*(b12-b22),m18=(a11+a12)*(-b20+b22),c00=m6+m14+a01*b10,c01=(a00+a01+a02-a10-a11-a21-a22)*b11+m4+m5+m6+m12+m14+m15,c02=m6+m7+m9+(a00+a01+a02-a11-a12-a20-a21)*b12+m14+m16+m18,c10=m2+a11*(-b00+b01+b10-b11-b12-b20+b22)+m4+m6+m14+m16+m17,c11=m2+m4+m5+m6+a12*b21,c12=m14+m16+m17+m18+a10*b02,c20=m6+m7+m8+a21*(-b00+b02+b10-b11-b12-b20+b21)+m12+m13+m14,c21=m12+m13+m14+m15+a20*b01,c22=m6+m7+m8+m9+a22*b22;return result.set(0,0,c00),result.set(0,1,c01),result.set(0,2,c02),result.set(1,0,c10),result.set(1,1,c11),result.set(1,2,c12),result.set(2,0,c20),result.set(2,1,c21),result.set(2,2,c22),result}mmulStrassen(y){y=Matrix.checkMatrix(y);let x=this.clone(),r1=x.rows,c1=x.columns,r2=y.rows,c2=y.columns;function embed(mat,rows,cols){let r=mat.rows,c=mat.columns;if(r===rows&&c===cols)return mat;{let resultat=AbstractMatrix.zeros(rows,cols);return resultat=resultat.setSubMatrix(mat,0,0),resultat}}c1!==r2&&console.warn(`Multiplying ${r1} x ${c1} and ${r2} x ${c2} matrix: dimensions do not match.`);let r=Math.max(r1,r2),c=Math.max(c1,c2);return x=embed(x,r,c),function blockMult(a,b,rows,cols){if(rows<=512||cols<=512)return a.mmul(b);rows%2==1&&cols%2==1?(a=embed(a,rows+1,cols+1),b=embed(b,rows+1,cols+1)):rows%2==1?(a=embed(a,rows+1,cols),b=embed(b,rows+1,cols)):cols%2==1&&(a=embed(a,rows,cols+1),b=embed(b,rows,cols+1));let halfRows=parseInt(a.rows/2,10),halfCols=parseInt(a.columns/2,10),a11=a.subMatrix(0,halfRows-1,0,halfCols-1),b11=b.subMatrix(0,halfRows-1,0,halfCols-1),a12=a.subMatrix(0,halfRows-1,halfCols,a.columns-1),b12=b.subMatrix(0,halfRows-1,halfCols,b.columns-1),a21=a.subMatrix(halfRows,a.rows-1,0,halfCols-1),b21=b.subMatrix(halfRows,b.rows-1,0,halfCols-1),a22=a.subMatrix(halfRows,a.rows-1,halfCols,a.columns-1),b22=b.subMatrix(halfRows,b.rows-1,halfCols,b.columns-1),m1=blockMult(AbstractMatrix.add(a11,a22),AbstractMatrix.add(b11,b22),halfRows,halfCols),m2=blockMult(AbstractMatrix.add(a21,a22),b11,halfRows,halfCols),m3=blockMult(a11,AbstractMatrix.sub(b12,b22),halfRows,halfCols),m4=blockMult(a22,AbstractMatrix.sub(b21,b11),halfRows,halfCols),m5=blockMult(AbstractMatrix.add(a11,a12),b22,halfRows,halfCols),m6=blockMult(AbstractMatrix.sub(a21,a11),AbstractMatrix.add(b11,b12),halfRows,halfCols),m7=blockMult(AbstractMatrix.sub(a12,a22),AbstractMatrix.add(b21,b22),halfRows,halfCols),c11=AbstractMatrix.add(m1,m4);c11.sub(m5),c11.add(m7);let c12=AbstractMatrix.add(m3,m5),c21=AbstractMatrix.add(m2,m4),c22=AbstractMatrix.sub(m1,m2);c22.add(m3),c22.add(m6);let result=AbstractMatrix.zeros(2*c11.rows,2*c11.columns);return result=result.setSubMatrix(c11,0,0),result=result.setSubMatrix(c12,c11.rows,0),result=result.setSubMatrix(c21,0,c11.columns),result=result.setSubMatrix(c22,c11.rows,c11.columns),result.subMatrix(0,rows-1,0,cols-1)}(x,y=embed(y,r,c),r,c)}scaleRows(options={}){if("object"!=typeof options)throw new TypeError("options must be an object");const{min=0,max=1}=options;if(!Number.isFinite(min))throw new TypeError("min must be a number");if(!Number.isFinite(max))throw new TypeError("max must be a number");if(min>=max)throw new RangeError("min must be smaller than max");let newMatrix=new Matrix(this.rows,this.columns);for(let i=0;i<this.rows;i++){const row=this.getRow(i);row.length>0&&rescale(row,{min,max,output:row}),newMatrix.setRow(i,row)}return newMatrix}scaleColumns(options={}){if("object"!=typeof options)throw new TypeError("options must be an object");const{min=0,max=1}=options;if(!Number.isFinite(min))throw new TypeError("min must be a number");if(!Number.isFinite(max))throw new TypeError("max must be a number");if(min>=max)throw new RangeError("min must be smaller than max");let newMatrix=new Matrix(this.rows,this.columns);for(let i=0;i<this.columns;i++){const column=this.getColumn(i);column.length&&rescale(column,{min,max,output:column}),newMatrix.setColumn(i,column)}return newMatrix}flipRows(){const middle=Math.ceil(this.columns/2);for(let i=0;i<this.rows;i++)for(let j=0;j<middle;j++){let first=this.get(i,j),last=this.get(i,this.columns-1-j);this.set(i,j,last),this.set(i,this.columns-1-j,first)}return this}flipColumns(){const middle=Math.ceil(this.rows/2);for(let j=0;j<this.columns;j++)for(let i=0;i<middle;i++){let first=this.get(i,j),last=this.get(this.rows-1-i,j);this.set(i,j,last),this.set(this.rows-1-i,j,first)}return this}kroneckerProduct(other){other=Matrix.checkMatrix(other);let m=this.rows,n=this.columns,p=other.rows,q=other.columns,result=new Matrix(m*p,n*q);for(let i=0;i<m;i++)for(let j=0;j<n;j++)for(let k=0;k<p;k++)for(let l=0;l<q;l++)result.set(p*i+k,q*j+l,this.get(i,j)*other.get(k,l));return result}kroneckerSum(other){if(other=Matrix.checkMatrix(other),!this.isSquare()||!other.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let m=this.rows,n=other.rows,AxI=this.kroneckerProduct(Matrix.eye(n,n)),IxB=Matrix.eye(m,m).kroneckerProduct(other);return AxI.add(IxB)}transpose(){let result=new Matrix(this.columns,this.rows);for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)result.set(j,i,this.get(i,j));return result}sortRows(compareFunction=compareNumbers){for(let i=0;i<this.rows;i++)this.setRow(i,this.getRow(i).sort(compareFunction));return this}sortColumns(compareFunction=compareNumbers){for(let i=0;i<this.columns;i++)this.setColumn(i,this.getColumn(i).sort(compareFunction));return this}subMatrix(startRow,endRow,startColumn,endColumn){checkRange(this,startRow,endRow,startColumn,endColumn);let newMatrix=new Matrix(endRow-startRow+1,endColumn-startColumn+1);for(let i=startRow;i<=endRow;i++)for(let j=startColumn;j<=endColumn;j++)newMatrix.set(i-startRow,j-startColumn,this.get(i,j));return newMatrix}subMatrixRow(indices,startColumn,endColumn){if(void 0===startColumn&&(startColumn=0),void 0===endColumn&&(endColumn=this.columns-1),startColumn>endColumn||startColumn<0||startColumn>=this.columns||endColumn<0||endColumn>=this.columns)throw new RangeError("Argument out of range");let newMatrix=new Matrix(indices.length,endColumn-startColumn+1);for(let i=0;i<indices.length;i++)for(let j=startColumn;j<=endColumn;j++){if(indices[i]<0||indices[i]>=this.rows)throw new RangeError(`Row index out of range: ${indices[i]}`);newMatrix.set(i,j-startColumn,this.get(indices[i],j))}return newMatrix}subMatrixColumn(indices,startRow,endRow){if(void 0===startRow&&(startRow=0),void 0===endRow&&(endRow=this.rows-1),startRow>endRow||startRow<0||startRow>=this.rows||endRow<0||endRow>=this.rows)throw new RangeError("Argument out of range");let newMatrix=new Matrix(endRow-startRow+1,indices.length);for(let i=0;i<indices.length;i++)for(let j=startRow;j<=endRow;j++){if(indices[i]<0||indices[i]>=this.columns)throw new RangeError(`Column index out of range: ${indices[i]}`);newMatrix.set(j-startRow,i,this.get(j,indices[i]))}return newMatrix}setSubMatrix(matrix,startRow,startColumn){if((matrix=Matrix.checkMatrix(matrix)).isEmpty())return this;checkRange(this,startRow,startRow+matrix.rows-1,startColumn,startColumn+matrix.columns-1);for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)this.set(startRow+i,startColumn+j,matrix.get(i,j));return this}selection(rowIndices,columnIndices){checkRowIndices(this,rowIndices),checkColumnIndices(this,columnIndices);let newMatrix=new Matrix(rowIndices.length,columnIndices.length);for(let i=0;i<rowIndices.length;i++){let rowIndex=rowIndices[i];for(let j=0;j<columnIndices.length;j++){let columnIndex=columnIndices[j];newMatrix.set(i,j,this.get(rowIndex,columnIndex))}}return newMatrix}trace(){let min=Math.min(this.rows,this.columns),trace=0;for(let i=0;i<min;i++)trace+=this.get(i,i);return trace}clone(){return this.constructor.copy(this,new Matrix(this.rows,this.columns))}static copy(from,to){for(const[row,column,value]of from.entries())to.set(row,column,value);return to}sum(by){switch(by){case"row":return function sumByRow(matrix){let sum=newArray(matrix.rows);for(let i=0;i<matrix.rows;++i)for(let j=0;j<matrix.columns;++j)sum[i]+=matrix.get(i,j);return sum}(this);case"column":return function sumByColumn(matrix){let sum=newArray(matrix.columns);for(let i=0;i<matrix.rows;++i)for(let j=0;j<matrix.columns;++j)sum[j]+=matrix.get(i,j);return sum}(this);case void 0:return function sumAll(matrix){let v=0;for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)v+=matrix.get(i,j);return v}(this);default:throw new Error(`invalid option: ${by}`)}}product(by){switch(by){case"row":return function productByRow(matrix){let sum=newArray(matrix.rows,1);for(let i=0;i<matrix.rows;++i)for(let j=0;j<matrix.columns;++j)sum[i]*=matrix.get(i,j);return sum}(this);case"column":return function productByColumn(matrix){let sum=newArray(matrix.columns,1);for(let i=0;i<matrix.rows;++i)for(let j=0;j<matrix.columns;++j)sum[j]*=matrix.get(i,j);return sum}(this);case void 0:return function productAll(matrix){let v=1;for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)v*=matrix.get(i,j);return v}(this);default:throw new Error(`invalid option: ${by}`)}}mean(by){const sum=this.sum(by);switch(by){case"row":for(let i=0;i<this.rows;i++)sum[i]/=this.columns;return sum;case"column":for(let i=0;i<this.columns;i++)sum[i]/=this.rows;return sum;case void 0:return sum/this.size;default:throw new Error(`invalid option: ${by}`)}}variance(by,options={}){if("object"==typeof by&&(options=by,by=void 0),"object"!=typeof options)throw new TypeError("options must be an object");const{unbiased=!0,mean=this.mean(by)}=options;if("boolean"!=typeof unbiased)throw new TypeError("unbiased must be a boolean");switch(by){case"row":if(!isAnyArray.isAnyArray(mean))throw new TypeError("mean must be an array");return function varianceByRow(matrix,unbiased,mean){const rows=matrix.rows,cols=matrix.columns,variance=[];for(let i=0;i<rows;i++){let sum1=0,sum2=0,x=0;for(let j=0;j<cols;j++)x=matrix.get(i,j)-mean[i],sum1+=x,sum2+=x*x;unbiased?variance.push((sum2-sum1*sum1/cols)/(cols-1)):variance.push((sum2-sum1*sum1/cols)/cols)}return variance}(this,unbiased,mean);case"column":if(!isAnyArray.isAnyArray(mean))throw new TypeError("mean must be an array");return function varianceByColumn(matrix,unbiased,mean){const rows=matrix.rows,cols=matrix.columns,variance=[];for(let j=0;j<cols;j++){let sum1=0,sum2=0,x=0;for(let i=0;i<rows;i++)x=matrix.get(i,j)-mean[j],sum1+=x,sum2+=x*x;unbiased?variance.push((sum2-sum1*sum1/rows)/(rows-1)):variance.push((sum2-sum1*sum1/rows)/rows)}return variance}(this,unbiased,mean);case void 0:if("number"!=typeof mean)throw new TypeError("mean must be a number");return function varianceAll(matrix,unbiased,mean){const rows=matrix.rows,cols=matrix.columns,size=rows*cols;let sum1=0,sum2=0,x=0;for(let i=0;i<rows;i++)for(let j=0;j<cols;j++)x=matrix.get(i,j)-mean,sum1+=x,sum2+=x*x;return unbiased?(sum2-sum1*sum1/size)/(size-1):(sum2-sum1*sum1/size)/size}(this,unbiased,mean);default:throw new Error(`invalid option: ${by}`)}}standardDeviation(by,options){"object"==typeof by&&(options=by,by=void 0);const variance=this.variance(by,options);if(void 0===by)return Math.sqrt(variance);for(let i=0;i<variance.length;i++)variance[i]=Math.sqrt(variance[i]);return variance}center(by,options={}){if("object"==typeof by&&(options=by,by=void 0),"object"!=typeof options)throw new TypeError("options must be an object");const{center=this.mean(by)}=options;switch(by){case"row":if(!isAnyArray.isAnyArray(center))throw new TypeError("center must be an array");return function centerByRow(matrix,mean){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)-mean[i])}(this,center),this;case"column":if(!isAnyArray.isAnyArray(center))throw new TypeError("center must be an array");return function centerByColumn(matrix,mean){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)-mean[j])}(this,center),this;case void 0:if("number"!=typeof center)throw new TypeError("center must be a number");return function centerAll(matrix,mean){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)-mean)}(this,center),this;default:throw new Error(`invalid option: ${by}`)}}scale(by,options={}){if("object"==typeof by&&(options=by,by=void 0),"object"!=typeof options)throw new TypeError("options must be an object");let scale=options.scale;switch(by){case"row":if(void 0===scale)scale=function getScaleByRow(matrix){const scale=[];for(let i=0;i<matrix.rows;i++){let sum=0;for(let j=0;j<matrix.columns;j++)sum+=Math.pow(matrix.get(i,j),2)/(matrix.columns-1);scale.push(Math.sqrt(sum))}return scale}(this);else if(!isAnyArray.isAnyArray(scale))throw new TypeError("scale must be an array");return function scaleByRow(matrix,scale){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)/scale[i])}(this,scale),this;case"column":if(void 0===scale)scale=function getScaleByColumn(matrix){const scale=[];for(let j=0;j<matrix.columns;j++){let sum=0;for(let i=0;i<matrix.rows;i++)sum+=Math.pow(matrix.get(i,j),2)/(matrix.rows-1);scale.push(Math.sqrt(sum))}return scale}(this);else if(!isAnyArray.isAnyArray(scale))throw new TypeError("scale must be an array");return function scaleByColumn(matrix,scale){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)/scale[j])}(this,scale),this;case void 0:if(void 0===scale)scale=function getScaleAll(matrix){const divider=matrix.size-1;let sum=0;for(let j=0;j<matrix.columns;j++)for(let i=0;i<matrix.rows;i++)sum+=Math.pow(matrix.get(i,j),2)/divider;return Math.sqrt(sum)}(this);else if("number"!=typeof scale)throw new TypeError("scale must be a number");return function scaleAll(matrix,scale){for(let i=0;i<matrix.rows;i++)for(let j=0;j<matrix.columns;j++)matrix.set(i,j,matrix.get(i,j)/scale)}(this,scale),this;default:throw new Error(`invalid option: ${by}`)}}toString(options){return inspectMatrixWithOptions(this,options)}[Symbol.iterator](){return this.entries()}*entries(){for(let row=0;row<this.rows;row++)for(let col=0;col<this.columns;col++)yield[row,col,this.get(row,col)]}*values(){for(let row=0;row<this.rows;row++)for(let col=0;col<this.columns;col++)yield this.get(row,col)}}function compareNumbers(a,b){return a-b}AbstractMatrix.prototype.klass="Matrix","undefined"!=typeof Symbol&&(AbstractMatrix.prototype[Symbol.for("nodejs.util.inspect.custom")]=function inspectMatrix(){return inspectMatrixWithOptions(this)}),AbstractMatrix.random=AbstractMatrix.rand,AbstractMatrix.randomInt=AbstractMatrix.randInt,AbstractMatrix.diagonal=AbstractMatrix.diag,AbstractMatrix.prototype.diagonal=AbstractMatrix.prototype.diag,AbstractMatrix.identity=AbstractMatrix.eye,AbstractMatrix.prototype.negate=AbstractMatrix.prototype.neg,AbstractMatrix.prototype.tensorProduct=AbstractMatrix.prototype.kroneckerProduct;class Matrix extends AbstractMatrix{data;#initData(nRows,nColumns){if(this.data=[],!(Number.isInteger(nColumns)&&nColumns>=0))throw new TypeError("nColumns must be a positive integer");for(let i=0;i<nRows;i++)this.data.push(new Float64Array(nColumns));this.rows=nRows,this.columns=nColumns}constructor(nRows,nColumns){if(super(),Matrix.isMatrix(nRows))this.#initData(nRows.rows,nRows.columns),Matrix.copy(nRows,this);else if(Number.isInteger(nRows)&&nRows>=0)this.#initData(nRows,nColumns);else{if(!isAnyArray.isAnyArray(nRows))throw new TypeError("First argument must be a positive number or an array");{const arrayData=nRows;if("number"!=typeof(nColumns=(nRows=arrayData.length)?arrayData[0].length:0))throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let i=0;i<nRows;i++){if(arrayData[i].length!==nColumns)throw new RangeError("Inconsistent array dimensions");if(!arrayData[i].every((element=>"number"==typeof element)))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(arrayData[i]))}this.rows=nRows,this.columns=nColumns}}}set(rowIndex,columnIndex,value){return this.data[rowIndex][columnIndex]=value,this}get(rowIndex,columnIndex){return this.data[rowIndex][columnIndex]}removeRow(index){return checkRowIndex(this,index),this.data.splice(index,1),this.rows-=1,this}addRow(index,array){return void 0===array&&(array=index,index=this.rows),checkRowIndex(this,index,!0),array=Float64Array.from(checkRowVector(this,array)),this.data.splice(index,0,array),this.rows+=1,this}removeColumn(index){checkColumnIndex(this,index);for(let i=0;i<this.rows;i++){const newRow=new Float64Array(this.columns-1);for(let j=0;j<index;j++)newRow[j]=this.data[i][j];for(let j=index+1;j<this.columns;j++)newRow[j-1]=this.data[i][j];this.data[i]=newRow}return this.columns-=1,this}addColumn(index,array){void 0===array&&(array=index,index=this.columns),checkColumnIndex(this,index,!0),array=checkColumnVector(this,array);for(let i=0;i<this.rows;i++){const newRow=new Float64Array(this.columns+1);let j=0;for(;j<index;j++)newRow[j]=this.data[i][j];for(newRow[j++]=array[i];j<this.columns+1;j++)newRow[j]=this.data[i][j-1];this.data[i]=newRow}return this.columns+=1,this}}!function installMathOperations(AbstractMatrix,Matrix){AbstractMatrix.prototype.add=function add(value){return"number"==typeof value?this.addS(value):this.addM(value)},AbstractMatrix.prototype.addS=function addS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)+value);return this},AbstractMatrix.prototype.addM=function addM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)+matrix.get(i,j));return this},AbstractMatrix.add=function add(matrix,value){return new Matrix(matrix).add(value)},AbstractMatrix.prototype.sub=function sub(value){return"number"==typeof value?this.subS(value):this.subM(value)},AbstractMatrix.prototype.subS=function subS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)-value);return this},AbstractMatrix.prototype.subM=function subM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)-matrix.get(i,j));return this},AbstractMatrix.sub=function sub(matrix,value){return new Matrix(matrix).sub(value)},AbstractMatrix.prototype.subtract=AbstractMatrix.prototype.sub,AbstractMatrix.prototype.subtractS=AbstractMatrix.prototype.subS,AbstractMatrix.prototype.subtractM=AbstractMatrix.prototype.subM,AbstractMatrix.subtract=AbstractMatrix.sub,AbstractMatrix.prototype.mul=function mul(value){return"number"==typeof value?this.mulS(value):this.mulM(value)},AbstractMatrix.prototype.mulS=function mulS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)*value);return this},AbstractMatrix.prototype.mulM=function mulM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)*matrix.get(i,j));return this},AbstractMatrix.mul=function mul(matrix,value){return new Matrix(matrix).mul(value)},AbstractMatrix.prototype.multiply=AbstractMatrix.prototype.mul,AbstractMatrix.prototype.multiplyS=AbstractMatrix.prototype.mulS,AbstractMatrix.prototype.multiplyM=AbstractMatrix.prototype.mulM,AbstractMatrix.multiply=AbstractMatrix.mul,AbstractMatrix.prototype.div=function div(value){return"number"==typeof value?this.divS(value):this.divM(value)},AbstractMatrix.prototype.divS=function divS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)/value);return this},AbstractMatrix.prototype.divM=function divM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)/matrix.get(i,j));return this},AbstractMatrix.div=function div(matrix,value){return new Matrix(matrix).div(value)},AbstractMatrix.prototype.divide=AbstractMatrix.prototype.div,AbstractMatrix.prototype.divideS=AbstractMatrix.prototype.divS,AbstractMatrix.prototype.divideM=AbstractMatrix.prototype.divM,AbstractMatrix.divide=AbstractMatrix.div,AbstractMatrix.prototype.mod=function mod(value){return"number"==typeof value?this.modS(value):this.modM(value)},AbstractMatrix.prototype.modS=function modS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)%value);return this},AbstractMatrix.prototype.modM=function modM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)%matrix.get(i,j));return this},AbstractMatrix.mod=function mod(matrix,value){return new Matrix(matrix).mod(value)},AbstractMatrix.prototype.modulus=AbstractMatrix.prototype.mod,AbstractMatrix.prototype.modulusS=AbstractMatrix.prototype.modS,AbstractMatrix.prototype.modulusM=AbstractMatrix.prototype.modM,AbstractMatrix.modulus=AbstractMatrix.mod,AbstractMatrix.prototype.and=function and(value){return"number"==typeof value?this.andS(value):this.andM(value)},AbstractMatrix.prototype.andS=function andS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)&value);return this},AbstractMatrix.prototype.andM=function andM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)&matrix.get(i,j));return this},AbstractMatrix.and=function and(matrix,value){return new Matrix(matrix).and(value)},AbstractMatrix.prototype.or=function or(value){return"number"==typeof value?this.orS(value):this.orM(value)},AbstractMatrix.prototype.orS=function orS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)|value);return this},AbstractMatrix.prototype.orM=function orM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)|matrix.get(i,j));return this},AbstractMatrix.or=function or(matrix,value){return new Matrix(matrix).or(value)},AbstractMatrix.prototype.xor=function xor(value){return"number"==typeof value?this.xorS(value):this.xorM(value)},AbstractMatrix.prototype.xorS=function xorS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)^value);return this},AbstractMatrix.prototype.xorM=function xorM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)^matrix.get(i,j));return this},AbstractMatrix.xor=function xor(matrix,value){return new Matrix(matrix).xor(value)},AbstractMatrix.prototype.leftShift=function leftShift(value){return"number"==typeof value?this.leftShiftS(value):this.leftShiftM(value)},AbstractMatrix.prototype.leftShiftS=function leftShiftS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)<<value);return this},AbstractMatrix.prototype.leftShiftM=function leftShiftM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)<<matrix.get(i,j));return this},AbstractMatrix.leftShift=function leftShift(matrix,value){return new Matrix(matrix).leftShift(value)},AbstractMatrix.prototype.signPropagatingRightShift=function signPropagatingRightShift(value){return"number"==typeof value?this.signPropagatingRightShiftS(value):this.signPropagatingRightShiftM(value)},AbstractMatrix.prototype.signPropagatingRightShiftS=function signPropagatingRightShiftS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)>>value);return this},AbstractMatrix.prototype.signPropagatingRightShiftM=function signPropagatingRightShiftM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)>>matrix.get(i,j));return this},AbstractMatrix.signPropagatingRightShift=function signPropagatingRightShift(matrix,value){return new Matrix(matrix).signPropagatingRightShift(value)},AbstractMatrix.prototype.rightShift=function rightShift(value){return"number"==typeof value?this.rightShiftS(value):this.rightShiftM(value)},AbstractMatrix.prototype.rightShiftS=function rightShiftS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)>>>value);return this},AbstractMatrix.prototype.rightShiftM=function rightShiftM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,this.get(i,j)>>>matrix.get(i,j));return this},AbstractMatrix.rightShift=function rightShift(matrix,value){return new Matrix(matrix).rightShift(value)},AbstractMatrix.prototype.zeroFillRightShift=AbstractMatrix.prototype.rightShift,AbstractMatrix.prototype.zeroFillRightShiftS=AbstractMatrix.prototype.rightShiftS,AbstractMatrix.prototype.zeroFillRightShiftM=AbstractMatrix.prototype.rightShiftM,AbstractMatrix.zeroFillRightShift=AbstractMatrix.rightShift,AbstractMatrix.prototype.not=function not(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,~this.get(i,j));return this},AbstractMatrix.not=function not(matrix){return new Matrix(matrix).not()},AbstractMatrix.prototype.abs=function abs(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.abs(this.get(i,j)));return this},AbstractMatrix.abs=function abs(matrix){return new Matrix(matrix).abs()},AbstractMatrix.prototype.acos=function acos(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.acos(this.get(i,j)));return this},AbstractMatrix.acos=function acos(matrix){return new Matrix(matrix).acos()},AbstractMatrix.prototype.acosh=function acosh(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.acosh(this.get(i,j)));return this},AbstractMatrix.acosh=function acosh(matrix){return new Matrix(matrix).acosh()},AbstractMatrix.prototype.asin=function asin(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.asin(this.get(i,j)));return this},AbstractMatrix.asin=function asin(matrix){return new Matrix(matrix).asin()},AbstractMatrix.prototype.asinh=function asinh(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.asinh(this.get(i,j)));return this},AbstractMatrix.asinh=function asinh(matrix){return new Matrix(matrix).asinh()},AbstractMatrix.prototype.atan=function atan(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.atan(this.get(i,j)));return this},AbstractMatrix.atan=function atan(matrix){return new Matrix(matrix).atan()},AbstractMatrix.prototype.atanh=function atanh(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.atanh(this.get(i,j)));return this},AbstractMatrix.atanh=function atanh(matrix){return new Matrix(matrix).atanh()},AbstractMatrix.prototype.cbrt=function cbrt(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.cbrt(this.get(i,j)));return this},AbstractMatrix.cbrt=function cbrt(matrix){return new Matrix(matrix).cbrt()},AbstractMatrix.prototype.ceil=function ceil(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.ceil(this.get(i,j)));return this},AbstractMatrix.ceil=function ceil(matrix){return new Matrix(matrix).ceil()},AbstractMatrix.prototype.clz32=function clz32(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.clz32(this.get(i,j)));return this},AbstractMatrix.clz32=function clz32(matrix){return new Matrix(matrix).clz32()},AbstractMatrix.prototype.cos=function cos(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.cos(this.get(i,j)));return this},AbstractMatrix.cos=function cos(matrix){return new Matrix(matrix).cos()},AbstractMatrix.prototype.cosh=function cosh(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.cosh(this.get(i,j)));return this},AbstractMatrix.cosh=function cosh(matrix){return new Matrix(matrix).cosh()},AbstractMatrix.prototype.exp=function exp(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.exp(this.get(i,j)));return this},AbstractMatrix.exp=function exp(matrix){return new Matrix(matrix).exp()},AbstractMatrix.prototype.expm1=function expm1(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.expm1(this.get(i,j)));return this},AbstractMatrix.expm1=function expm1(matrix){return new Matrix(matrix).expm1()},AbstractMatrix.prototype.floor=function floor(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.floor(this.get(i,j)));return this},AbstractMatrix.floor=function floor(matrix){return new Matrix(matrix).floor()},AbstractMatrix.prototype.fround=function fround(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.fround(this.get(i,j)));return this},AbstractMatrix.fround=function fround(matrix){return new Matrix(matrix).fround()},AbstractMatrix.prototype.log=function log(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.log(this.get(i,j)));return this},AbstractMatrix.log=function log(matrix){return new Matrix(matrix).log()},AbstractMatrix.prototype.log1p=function log1p(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.log1p(this.get(i,j)));return this},AbstractMatrix.log1p=function log1p(matrix){return new Matrix(matrix).log1p()},AbstractMatrix.prototype.log10=function log10(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.log10(this.get(i,j)));return this},AbstractMatrix.log10=function log10(matrix){return new Matrix(matrix).log10()},AbstractMatrix.prototype.log2=function log2(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.log2(this.get(i,j)));return this},AbstractMatrix.log2=function log2(matrix){return new Matrix(matrix).log2()},AbstractMatrix.prototype.round=function round(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.round(this.get(i,j)));return this},AbstractMatrix.round=function round(matrix){return new Matrix(matrix).round()},AbstractMatrix.prototype.sign=function sign(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.sign(this.get(i,j)));return this},AbstractMatrix.sign=function sign(matrix){return new Matrix(matrix).sign()},AbstractMatrix.prototype.sin=function sin(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.sin(this.get(i,j)));return this},AbstractMatrix.sin=function sin(matrix){return new Matrix(matrix).sin()},AbstractMatrix.prototype.sinh=function sinh(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.sinh(this.get(i,j)));return this},AbstractMatrix.sinh=function sinh(matrix){return new Matrix(matrix).sinh()},AbstractMatrix.prototype.sqrt=function sqrt(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.sqrt(this.get(i,j)));return this},AbstractMatrix.sqrt=function sqrt(matrix){return new Matrix(matrix).sqrt()},AbstractMatrix.prototype.tan=function tan(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.tan(this.get(i,j)));return this},AbstractMatrix.tan=function tan(matrix){return new Matrix(matrix).tan()},AbstractMatrix.prototype.tanh=function tanh(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.tanh(this.get(i,j)));return this},AbstractMatrix.tanh=function tanh(matrix){return new Matrix(matrix).tanh()},AbstractMatrix.prototype.trunc=function trunc(){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.trunc(this.get(i,j)));return this},AbstractMatrix.trunc=function trunc(matrix){return new Matrix(matrix).trunc()},AbstractMatrix.pow=function pow(matrix,arg0){return new Matrix(matrix).pow(arg0)},AbstractMatrix.prototype.pow=function pow(value){return"number"==typeof value?this.powS(value):this.powM(value)},AbstractMatrix.prototype.powS=function powS(value){for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.pow(this.get(i,j),value));return this},AbstractMatrix.prototype.powM=function powM(matrix){if(matrix=Matrix.checkMatrix(matrix),this.rows!==matrix.rows||this.columns!==matrix.columns)throw new RangeError("Matrices dimensions must be equal");for(let i=0;i<this.rows;i++)for(let j=0;j<this.columns;j++)this.set(i,j,Math.pow(this.get(i,j),matrix.get(i,j)));return this}}(AbstractMatrix,Matrix);class SymmetricMatrix extends AbstractMatrix{#matrix;get size(){return this.#matrix.size}get rows(){return this.#matrix.rows}get columns(){return this.#matrix.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(value){return Matrix.isMatrix(value)&&"SymmetricMatrix"===value.klassType}static zeros(diagonalSize){return new this(diagonalSize)}static ones(diagonalSize){return new this(diagonalSize).fill(1)}constructor(diagonalSize){if(super(),Matrix.isMatrix(diagonalSize)){if(!diagonalSize.isSymmetric())throw new TypeError("not symmetric data");this.#matrix=Matrix.copy(diagonalSize,new Matrix(diagonalSize.rows,diagonalSize.rows))}else if(Number.isInteger(diagonalSize)&&diagonalSize>=0)this.#matrix=new Matrix(diagonalSize,diagonalSize);else if(this.#matrix=new Matrix(diagonalSize),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const matrix=new SymmetricMatrix(this.diagonalSize);for(const[row,col,value]of this.upperRightEntries())matrix.set(row,col,value);return matrix}toMatrix(){return new Matrix(this)}get(rowIndex,columnIndex){return this.#matrix.get(rowIndex,columnIndex)}set(rowIndex,columnIndex,value){return this.#matrix.set(rowIndex,columnIndex,value),this.#matrix.set(columnIndex,rowIndex,value),this}removeCross(index){return this.#matrix.removeRow(index),this.#matrix.removeColumn(index),this}addCross(index,array){void 0===array&&(array=index,index=this.diagonalSize);const row=array.slice();return row.splice(index,1),this.#matrix.addRow(index,row),this.#matrix.addColumn(index,array),this}applyMask(mask){if(mask.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const sidesToRemove=[];for(const[index,passthroughs]of mask.entries())passthroughs||sidesToRemove.push(index);sidesToRemove.reverse();for(const sideIndex of sidesToRemove)this.removeCross(sideIndex);return this}toCompact(){const{diagonalSize}=this,compact=new Array(diagonalSize*(diagonalSize+1)/2);for(let col=0,row=0,index=0;index<compact.length;index++)compact[index]=this.get(row,col),++col>=diagonalSize&&(col=++row);return compact}static fromCompact(compact){const compactSize=compact.length,diagonalSize=(Math.sqrt(8*compactSize+1)-1)/2;if(!Number.isInteger(diagonalSize))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(compact)}`);const matrix=new SymmetricMatrix(diagonalSize);for(let col=0,row=0,index=0;index<compactSize;index++)matrix.set(col,row,compact[index]),++col>=diagonalSize&&(col=++row);return matrix}*upperRightEntries(){for(let row=0,col=0;row<this.diagonalSize;void 0){const value=this.get(row,col);yield[row,col,value],++col>=this.diagonalSize&&(col=++row)}}*upperRightValues(){for(let row=0,col=0;row<this.diagonalSize;void 0){const value=this.get(row,col);yield value,++col>=this.diagonalSize&&(col=++row)}}}SymmetricMatrix.prototype.klassType="SymmetricMatrix";class DistanceMatrix extends SymmetricMatrix{static isDistanceMatrix(value){return SymmetricMatrix.isSymmetricMatrix(value)&&"DistanceMatrix"===value.klassSubType}constructor(sideSize){if(super(sideSize),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(rowIndex,columnIndex,value){return rowIndex===columnIndex&&(value=0),super.set(rowIndex,columnIndex,value)}addCross(index,array){return void 0===array&&(array=index,index=this.diagonalSize),(array=array.slice())[index]=0,super.addCross(index,array)}toSymmetricMatrix(){return new SymmetricMatrix(this)}clone(){const matrix=new DistanceMatrix(this.diagonalSize);for(const[row,col,value]of this.upperRightEntries())row!==col&&matrix.set(row,col,value);return matrix}toCompact(){const{diagonalSize}=this,compact=new Array((diagonalSize-1)*diagonalSize/2);for(let col=1,row=0,index=0;index<compact.length;index++)compact[index]=this.get(row,col),++col>=diagonalSize&&(col=1+ ++row);return compact}static fromCompact(compact){const compactSize=compact.length,diagonalSize=(Math.sqrt(8*compactSize+1)+1)/2;if(!Number.isInteger(diagonalSize))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(compact)}`);const matrix=new this(diagonalSize);for(let col=1,row=0,index=0;index<compactSize;index++)matrix.set(col,row,compact[index]),++col>=diagonalSize&&(col=1+ ++row);return matrix}}DistanceMatrix.prototype.klassSubType="DistanceMatrix";class BaseView extends AbstractMatrix{constructor(matrix,rows,columns){super(),this.matrix=matrix,this.rows=rows,this.columns=columns}}class MatrixSelectionView extends BaseView{constructor(matrix,rowIndices,columnIndices){checkRowIndices(matrix,rowIndices),checkColumnIndices(matrix,columnIndices),super(matrix,rowIndices.length,columnIndices.length),this.rowIndices=rowIndices,this.columnIndices=columnIndices}set(rowIndex,columnIndex,value){return this.matrix.set(this.rowIndices[rowIndex],this.columnIndices[columnIndex],value),this}get(rowIndex,columnIndex){return this.matrix.get(this.rowIndices[rowIndex],this.columnIndices[columnIndex])}}class WrapperMatrix1D extends AbstractMatrix{constructor(data,options={}){const{rows=1}=options;if(data.length%rows!=0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=rows,this.columns=data.length/rows,this.data=data}set(rowIndex,columnIndex,value){let index=this._calculateIndex(rowIndex,columnIndex);return this.data[index]=value,this}get(rowIndex,columnIndex){let index=this._calculateIndex(rowIndex,columnIndex);return this.data[index]}_calculateIndex(row,column){return row*this.columns+column}}class WrapperMatrix2D extends AbstractMatrix{constructor(data){super(),this.data=data,this.rows=data.length,this.columns=data[0].length}set(rowIndex,columnIndex,value){return this.data[rowIndex][columnIndex]=value,this}get(rowIndex,columnIndex){return this.data[rowIndex][columnIndex]}}class LuDecomposition{constructor(matrix){let i,j,k,p,s,t,v,LUcolj,kmax,lu=(matrix=WrapperMatrix2D.checkMatrix(matrix)).clone(),rows=lu.rows,columns=lu.columns,pivotVector=new Float64Array(rows),pivotSign=1;for(i=0;i<rows;i++)pivotVector[i]=i;for(LUcolj=new Float64Array(rows),j=0;j<columns;j++){for(i=0;i<rows;i++)LUcolj[i]=lu.get(i,j);for(i=0;i<rows;i++){for(kmax=Math.min(i,j),s=0,k=0;k<kmax;k++)s+=lu.get(i,k)*LUcolj[k];LUcolj[i]-=s,lu.set(i,j,LUcolj[i])}for(p=j,i=j+1;i<rows;i++)Math.abs(LUcolj[i])>Math.abs(LUcolj[p])&&(p=i);if(p!==j){for(k=0;k<columns;k++)t=lu.get(p,k),lu.set(p,k,lu.get(j,k)),lu.set(j,k,t);v=pivotVector[p],pivotVector[p]=pivotVector[j],pivotVector[j]=v,pivotSign=-pivotSign}if(j<rows&&0!==lu.get(j,j))for(i=j+1;i<rows;i++)lu.set(i,j,lu.get(i,j)/lu.get(j,j))}this.LU=lu,this.pivotVector=pivotVector,this.pivotSign=pivotSign}isSingular(){let data=this.LU,col=data.columns;for(let j=0;j<col;j++)if(0===data.get(j,j))return!0;return!1}solve(value){value=Matrix.checkMatrix(value);let lu=this.LU;if(lu.rows!==value.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let i,j,k,count=value.columns,X=value.subMatrixRow(this.pivotVector,0,count-1),columns=lu.columns;for(k=0;k<columns;k++)for(i=k+1;i<columns;i++)for(j=0;j<count;j++)X.set(i,j,X.get(i,j)-X.get(k,j)*lu.get(i,k));for(k=columns-1;k>=0;k--){for(j=0;j<count;j++)X.set(k,j,X.get(k,j)/lu.get(k,k));for(i=0;i<k;i++)for(j=0;j<count;j++)X.set(i,j,X.get(i,j)-X.get(k,j)*lu.get(i,k))}return X}get determinant(){let data=this.LU;if(!data.isSquare())throw new Error("Matrix must be square");let determinant=this.pivotSign,col=data.columns;for(let j=0;j<col;j++)determinant*=data.get(j,j);return determinant}get lowerTriangularMatrix(){let data=this.LU,rows=data.rows,columns=data.columns,X=new Matrix(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)i>j?X.set(i,j,data.get(i,j)):i===j?X.set(i,j,1):X.set(i,j,0);return X}get upperTriangularMatrix(){let data=this.LU,rows=data.rows,columns=data.columns,X=new Matrix(rows,columns);for(let i=0;i<rows;i++)for(let j=0;j<columns;j++)i<=j?X.set(i,j,data.get(i,j)):X.set(i,j,0);return X}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function hypotenuse(a,b){let r=0;return Math.abs(a)>Math.abs(b)?(r=b/a,Math.abs(a)*Math.sqrt(1+r*r)):0!==b?(r=a/b,Math.abs(b)*Math.sqrt(1+r*r)):0}class QrDecomposition{constructor(value){let i,j,k,s,qr=(value=WrapperMatrix2D.checkMatrix(value)).clone(),m=value.rows,n=value.columns,rdiag=new Float64Array(n);for(k=0;k<n;k++){let nrm=0;for(i=k;i<m;i++)nrm=hypotenuse(nrm,qr.get(i,k));if(0!==nrm){for(qr.get(k,k)<0&&(nrm=-nrm),i=k;i<m;i++)qr.set(i,k,qr.get(i,k)/nrm);for(qr.set(k,k,qr.get(k,k)+1),j=k+1;j<n;j++){for(s=0,i=k;i<m;i++)s+=qr.get(i,k)*qr.get(i,j);for(s=-s/qr.get(k,k),i=k;i<m;i++)qr.set(i,j,qr.get(i,j)+s*qr.get(i,k))}}rdiag[k]=-nrm}this.QR=qr,this.Rdiag=rdiag}solve(value){value=Matrix.checkMatrix(value);let qr=this.QR,m=qr.rows;if(value.rows!==m)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let i,j,k,s,count=value.columns,X=value.clone(),n=qr.columns;for(k=0;k<n;k++)for(j=0;j<count;j++){for(s=0,i=k;i<m;i++)s+=qr.get(i,k)*X.get(i,j);for(s=-s/qr.get(k,k),i=k;i<m;i++)X.set(i,j,X.get(i,j)+s*qr.get(i,k))}for(k=n-1;k>=0;k--){for(j=0;j<count;j++)X.set(k,j,X.get(k,j)/this.Rdiag[k]);for(i=0;i<k;i++)for(j=0;j<count;j++)X.set(i,j,X.get(i,j)-X.get(k,j)*qr.get(i,k))}return X.subMatrix(0,n-1,0,count-1)}isFullRank(){let columns=this.QR.columns;for(let i=0;i<columns;i++)if(0===this.Rdiag[i])return!1;return!0}get upperTriangularMatrix(){let i,j,qr=this.QR,n=qr.columns,X=new Matrix(n,n);for(i=0;i<n;i++)for(j=0;j<n;j++)i<j?X.set(i,j,qr.get(i,j)):i===j?X.set(i,j,this.Rdiag[i]):X.set(i,j,0);return X}get orthogonalMatrix(){let i,j,k,s,qr=this.QR,rows=qr.rows,columns=qr.columns,X=new Matrix(rows,columns);for(k=columns-1;k>=0;k--){for(i=0;i<rows;i++)X.set(i,k,0);for(X.set(k,k,1),j=k;j<columns;j++)if(0!==qr.get(k,k)){for(s=0,i=k;i<rows;i++)s+=qr.get(i,k)*X.get(i,j);for(s=-s/qr.get(k,k),i=k;i<rows;i++)X.set(i,j,X.get(i,j)+s*qr.get(i,k))}}return X}}class SingularValueDecomposition{constructor(value,options={}){if((value=WrapperMatrix2D.checkMatrix(value)).isEmpty())throw new Error("Matrix must be non-empty");let m=value.rows,n=value.columns;const{computeLeftSingularVectors=!0,computeRightSingularVectors=!0,autoTranspose=!1}=options;let a,wantu=Boolean(computeLeftSingularVectors),wantv=Boolean(computeRightSingularVectors),swapped=!1;if(m<n)if(autoTranspose){a=value.transpose(),m=a.rows,n=a.columns,swapped=!0;let aux=wantu;wantu=wantv,wantv=aux}else a=value.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=value.clone();let nu=Math.min(m,n),ni=Math.min(m+1,n),s=new Float64Array(ni),U=new Matrix(m,nu),V=new Matrix(n,n),e=new Float64Array(n),work=new Float64Array(m),si=new Float64Array(ni);for(let i=0;i<ni;i++)si[i]=i;let nct=Math.min(m-1,n),nrt=Math.max(0,Math.min(n-2,m)),mrc=Math.max(nct,nrt);for(let k=0;k<mrc;k++){if(k<nct){s[k]=0;for(let i=k;i<m;i++)s[k]=hypotenuse(s[k],a.get(i,k));if(0!==s[k]){a.get(k,k)<0&&(s[k]=-s[k]);for(let i=k;i<m;i++)a.set(i,k,a.get(i,k)/s[k]);a.set(k,k,a.get(k,k)+1)}s[k]=-s[k]}for(let j=k+1;j<n;j++){if(k<nct&&0!==s[k]){let t=0;for(let i=k;i<m;i++)t+=a.get(i,k)*a.get(i,j);t=-t/a.get(k,k);for(let i=k;i<m;i++)a.set(i,j,a.get(i,j)+t*a.get(i,k))}e[j]=a.get(k,j)}if(wantu&&k<nct)for(let i=k;i<m;i++)U.set(i,k,a.get(i,k));if(k<nrt){e[k]=0;for(let i=k+1;i<n;i++)e[k]=hypotenuse(e[k],e[i]);if(0!==e[k]){e[k+1]<0&&(e[k]=0-e[k]);for(let i=k+1;i<n;i++)e[i]/=e[k];e[k+1]+=1}if(e[k]=-e[k],k+1<m&&0!==e[k]){for(let i=k+1;i<m;i++)work[i]=0;for(let i=k+1;i<m;i++)for(let j=k+1;j<n;j++)work[i]+=e[j]*a.get(i,j);for(let j=k+1;j<n;j++){let t=-e[j]/e[k+1];for(let i=k+1;i<m;i++)a.set(i,j,a.get(i,j)+t*work[i])}}if(wantv)for(let i=k+1;i<n;i++)V.set(i,k,e[i])}}let p=Math.min(n,m+1);if(nct<n&&(s[nct]=a.get(nct,nct)),m<p&&(s[p-1]=0),nrt+1<p&&(e[nrt]=a.get(nrt,p-1)),e[p-1]=0,wantu){for(let j=nct;j<nu;j++){for(let i=0;i<m;i++)U.set(i,j,0);U.set(j,j,1)}for(let k=nct-1;k>=0;k--)if(0!==s[k]){for(let j=k+1;j<nu;j++){let t=0;for(let i=k;i<m;i++)t+=U.get(i,k)*U.get(i,j);t=-t/U.get(k,k);for(let i=k;i<m;i++)U.set(i,j,U.get(i,j)+t*U.get(i,k))}for(let i=k;i<m;i++)U.set(i,k,-U.get(i,k));U.set(k,k,1+U.get(k,k));for(let i=0;i<k-1;i++)U.set(i,k,0)}else{for(let i=0;i<m;i++)U.set(i,k,0);U.set(k,k,1)}}if(wantv)for(let k=n-1;k>=0;k--){if(k<nrt&&0!==e[k])for(let j=k+1;j<n;j++){let t=0;for(let i=k+1;i<n;i++)t+=V.get(i,k)*V.get(i,j);t=-t/V.get(k+1,k);for(let i=k+1;i<n;i++)V.set(i,j,V.get(i,j)+t*V.get(i,k))}for(let i=0;i<n;i++)V.set(i,k,0);V.set(k,k,1)}let pp=p-1,eps=Number.EPSILON;for(;p>0;){let k,kase;for(k=p-2;k>=-1&&-1!==k;k--){const alpha=Number.MIN_VALUE+eps*Math.abs(s[k]+Math.abs(s[k+1]));if(Math.abs(e[k])<=alpha||Number.isNaN(e[k])){e[k]=0;break}}if(k===p-2)kase=4;else{let ks;for(ks=p-1;ks>=k&&ks!==k;ks--){let t=(ks!==p?Math.abs(e[ks]):0)+(ks!==k+1?Math.abs(e[ks-1]):0);if(Math.abs(s[ks])<=eps*t){s[ks]=0;break}}ks===k?kase=3:ks===p-1?kase=1:(kase=2,k=ks)}switch(k++,kase){case 1:{let f=e[p-2];e[p-2]=0;for(let j=p-2;j>=k;j--){let t=hypotenuse(s[j],f),cs=s[j]/t,sn=f/t;if(s[j]=t,j!==k&&(f=-sn*e[j-1],e[j-1]=cs*e[j-1]),wantv)for(let i=0;i<n;i++)t=cs*V.get(i,j)+sn*V.get(i,p-1),V.set(i,p-1,-sn*V.get(i,j)+cs*V.get(i,p-1)),V.set(i,j,t)}break}case 2:{let f=e[k-1];e[k-1]=0;for(let j=k;j<p;j++){let t=hypotenuse(s[j],f),cs=s[j]/t,sn=f/t;if(s[j]=t,f=-sn*e[j],e[j]=cs*e[j],wantu)for(let i=0;i<m;i++)t=cs*U.get(i,j)+sn*U.get(i,k-1),U.set(i,k-1,-sn*U.get(i,j)+cs*U.get(i,k-1)),U.set(i,j,t)}break}case 3:{const scale=Math.max(Math.abs(s[p-1]),Math.abs(s[p-2]),Math.abs(e[p-2]),Math.abs(s[k]),Math.abs(e[k])),sp=s[p-1]/scale,spm1=s[p-2]/scale,epm1=e[p-2]/scale,sk=s[k]/scale,ek=e[k]/scale,b=((spm1+sp)*(spm1-sp)+epm1*epm1)/2,c=sp*epm1*(sp*epm1);let shift=0;0===b&&0===c||(shift=b<0?0-Math.sqrt(b*b+c):Math.sqrt(b*b+c),shift=c/(b+shift));let f=(sk+sp)*(sk-sp)+shift,g=sk*ek;for(let j=k;j<p-1;j++){let t=hypotenuse(f,g);0===t&&(t=Number.MIN_VALUE);let cs=f/t,sn=g/t;if(j!==k&&(e[j-1]=t),f=cs*s[j]+sn*e[j],e[j]=cs*e[j]-sn*s[j],g=sn*s[j+1],s[j+1]=cs*s[j+1],wantv)for(let i=0;i<n;i++)t=cs*V.get(i,j)+sn*V.get(i,j+1),V.set(i,j+1,-sn*V.get(i,j)+cs*V.get(i,j+1)),V.set(i,j,t);if(t=hypotenuse(f,g),0===t&&(t=Number.MIN_VALUE),cs=f/t,sn=g/t,s[j]=t,f=cs*e[j]+sn*s[j+1],s[j+1]=-sn*e[j]+cs*s[j+1],g=sn*e[j+1],e[j+1]=cs*e[j+1],wantu&&j<m-1)for(let i=0;i<m;i++)t=cs*U.get(i,j)+sn*U.get(i,j+1),U.set(i,j+1,-sn*U.get(i,j)+cs*U.get(i,j+1)),U.set(i,j,t)}e[p-2]=f;break}case 4:if(s[k]<=0&&(s[k]=s[k]<0?-s[k]:0,wantv))for(let i=0;i<=pp;i++)V.set(i,k,-V.get(i,k));for(;k<pp&&!(s[k]>=s[k+1]);){let t=s[k];if(s[k]=s[k+1],s[k+1]=t,wantv&&k<n-1)for(let i=0;i<n;i++)t=V.get(i,k+1),V.set(i,k+1,V.get(i,k)),V.set(i,k,t);if(wantu&&k<m-1)for(let i=0;i<m;i++)t=U.get(i,k+1),U.set(i,k+1,U.get(i,k)),U.set(i,k,t);k++}p--}}if(swapped){let tmp=V;V=U,U=tmp}this.m=m,this.n=n,this.s=s,this.U=U,this.V=V}solve(value){let Y=value,e=this.threshold,scols=this.s.length,Ls=Matrix.zeros(scols,scols);for(let i=0;i<scols;i++)Math.abs(this.s[i])<=e?Ls.set(i,i,0):Ls.set(i,i,1/this.s[i]);let U=this.U,V=this.rightSingularVectors,VL=V.mmul(Ls),vrows=V.rows,urows=U.rows,VLU=Matrix.zeros(vrows,urows);for(let i=0;i<vrows;i++)for(let j=0;j<urows;j++){let sum=0;for(let k=0;k<scols;k++)sum+=VL.get(i,k)*U.get(j,k);VLU.set(i,j,sum)}return VLU.mmul(Y)}solveForDiagonal(value){return this.solve(Matrix.diag(value))}inverse(){let V=this.V,e=this.threshold,vrows=V.rows,vcols=V.columns,X=new Matrix(vrows,this.s.length);for(let i=0;i<vrows;i++)for(let j=0;j<vcols;j++)Math.abs(this.s[j])>e&&X.set(i,j,V.get(i,j)/this.s[j]);let U=this.U,urows=U.rows,ucols=U.columns,Y=new Matrix(vrows,urows);for(let i=0;i<vrows;i++)for(let j=0;j<urows;j++){let sum=0;for(let k=0;k<ucols;k++)sum+=X.get(i,k)*U.get(j,k);Y.set(i,j,sum)}return Y}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let tol=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,r=0,s=this.s;for(let i=0,ii=s.length;i<ii;i++)s[i]>tol&&r++;return r}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return Matrix.diag(this.s)}}function solve(leftHandSide,rightHandSide,useSVD=!1){return leftHandSide=WrapperMatrix2D.checkMatrix(leftHandSide),rightHandSide=WrapperMatrix2D.checkMatrix(rightHandSide),useSVD?new SingularValueDecomposition(leftHandSide).solve(rightHandSide):leftHandSide.isSquare()?new LuDecomposition(leftHandSide).solve(rightHandSide):new QrDecomposition(leftHandSide).solve(rightHandSide)}function xrange(n,exception){let range=[];for(let i=0;i<n;i++)i!==exception&&range.push(i);return range}function dependenciesOneRow(error,matrix,index,thresholdValue=1e-9,thresholdError=1e-9){if(error>thresholdError)return new Array(matrix.rows+1).fill(0);{let returnArray=matrix.addRow(index,[0]);for(let i=0;i<returnArray.rows;i++)Math.abs(returnArray.get(i,0))<thresholdValue&&returnArray.set(i,0,0);return returnArray.to1DArray()}}class EigenvalueDecomposition{constructor(matrix,options={}){const{assumeSymmetric=!1}=options;if(!(matrix=WrapperMatrix2D.checkMatrix(matrix)).isSquare())throw new Error("Matrix is not a square matrix");if(matrix.isEmpty())throw new Error("Matrix must be non-empty");let i,j,n=matrix.columns,V=new Matrix(n,n),d=new Float64Array(n),e=new Float64Array(n),value=matrix,isSymmetric=!1;if(isSymmetric=!!assumeSymmetric||matrix.isSymmetric(),isSymmetric){for(i=0;i<n;i++)for(j=0;j<n;j++)V.set(i,j,value.get(i,j));!function tred2(n,e,d,V){let f,g,h,i,j,k,hh,scale;for(j=0;j<n;j++)d[j]=V.get(n-1,j);for(i=n-1;i>0;i--){for(scale=0,h=0,k=0;k<i;k++)scale+=Math.abs(d[k]);if(0===scale)for(e[i]=d[i-1],j=0;j<i;j++)d[j]=V.get(i-1,j),V.set(i,j,0),V.set(j,i,0);else{for(k=0;k<i;k++)d[k]/=scale,h+=d[k]*d[k];for(f=d[i-1],g=Math.sqrt(h),f>0&&(g=-g),e[i]=scale*g,h-=f*g,d[i-1]=f-g,j=0;j<i;j++)e[j]=0;for(j=0;j<i;j++){for(f=d[j],V.set(j,i,f),g=e[j]+V.get(j,j)*f,k=j+1;k<=i-1;k++)g+=V.get(k,j)*d[k],e[k]+=V.get(k,j)*f;e[j]=g}for(f=0,j=0;j<i;j++)e[j]/=h,f+=e[j]*d[j];for(hh=f/(h+h),j=0;j<i;j++)e[j]-=hh*d[j];for(j=0;j<i;j++){for(f=d[j],g=e[j],k=j;k<=i-1;k++)V.set(k,j,V.get(k,j)-(f*e[k]+g*d[k]));d[j]=V.get(i-1,j),V.set(i,j,0)}}d[i]=h}for(i=0;i<n-1;i++){if(V.set(n-1,i,V.get(i,i)),V.set(i,i,1),h=d[i+1],0!==h){for(k=0;k<=i;k++)d[k]=V.get(k,i+1)/h;for(j=0;j<=i;j++){for(g=0,k=0;k<=i;k++)g+=V.get(k,i+1)*V.get(k,j);for(k=0;k<=i;k++)V.set(k,j,V.get(k,j)-g*d[k])}}for(k=0;k<=i;k++)V.set(k,i+1,0)}for(j=0;j<n;j++)d[j]=V.get(n-1,j),V.set(n-1,j,0);V.set(n-1,n-1,1),e[0]=0}(n,e,d,V),function tql2(n,e,d,V){let g,h,i,j,k,l,m,p,r,dl1,c,c2,c3,el1,s,s2;for(i=1;i<n;i++)e[i-1]=e[i];e[n-1]=0;let f=0,tst1=0,eps=Number.EPSILON;for(l=0;l<n;l++){for(tst1=Math.max(tst1,Math.abs(d[l])+Math.abs(e[l])),m=l;m<n&&!(Math.abs(e[m])<=eps*tst1);)m++;if(m>l)do{for(g=d[l],p=(d[l+1]-g)/(2*e[l]),r=hypotenuse(p,1),p<0&&(r=-r),d[l]=e[l]/(p+r),d[l+1]=e[l]*(p+r),dl1=d[l+1],h=g-d[l],i=l+2;i<n;i++)d[i]-=h;for(f+=h,p=d[m],c=1,c2=c,c3=c,el1=e[l+1],s=0,s2=0,i=m-1;i>=l;i--)for(c3=c2,c2=c,s2=s,g=c*e[i],h=c*p,r=hypotenuse(p,e[i]),e[i+1]=s*r,s=e[i]/r,c=p/r,p=c*d[i]-s*g,d[i+1]=h+s*(c*g+s*d[i]),k=0;k<n;k++)h=V.get(k,i+1),V.set(k,i+1,s*V.get(k,i)+c*h),V.set(k,i,c*V.get(k,i)-s*h);p=-s*s2*c3*el1*e[l]/dl1,e[l]=s*p,d[l]=c*p}while(Math.abs(e[l])>eps*tst1);d[l]=d[l]+f,e[l]=0}for(i=0;i<n-1;i++){for(k=i,p=d[i],j=i+1;j<n;j++)d[j]<p&&(k=j,p=d[j]);if(k!==i)for(d[k]=d[i],d[i]=p,j=0;j<n;j++)p=V.get(j,i),V.set(j,i,V.get(j,k)),V.set(j,k,p)}}(n,e,d,V)}else{let H=new Matrix(n,n),ort=new Float64Array(n);for(j=0;j<n;j++)for(i=0;i<n;i++)H.set(i,j,value.get(i,j));!function orthes(n,H,ort,V){let f,g,h,i,j,m,scale,low=0,high=n-1;for(m=low+1;m<=high-1;m++){for(scale=0,i=m;i<=high;i++)scale+=Math.abs(H.get(i,m-1));if(0!==scale){for(h=0,i=high;i>=m;i--)ort[i]=H.get(i,m-1)/scale,h+=ort[i]*ort[i];for(g=Math.sqrt(h),ort[m]>0&&(g=-g),h-=ort[m]*g,ort[m]=ort[m]-g,j=m;j<n;j++){for(f=0,i=high;i>=m;i--)f+=ort[i]*H.get(i,j);for(f/=h,i=m;i<=high;i++)H.set(i,j,H.get(i,j)-f*ort[i])}for(i=0;i<=high;i++){for(f=0,j=high;j>=m;j--)f+=ort[j]*H.get(i,j);for(f/=h,j=m;j<=high;j++)H.set(i,j,H.get(i,j)-f*ort[j])}ort[m]=scale*ort[m],H.set(m,m-1,scale*g)}}for(i=0;i<n;i++)for(j=0;j<n;j++)V.set(i,j,i===j?1:0);for(m=high-1;m>=low+1;m--)if(0!==H.get(m,m-1)){for(i=m+1;i<=high;i++)ort[i]=H.get(i,m-1);for(j=m;j<=high;j++){for(g=0,i=m;i<=high;i++)g+=ort[i]*V.get(i,j);for(g=g/ort[m]/H.get(m,m-1),i=m;i<=high;i++)V.set(i,j,V.get(i,j)+g*ort[i])}}}(n,H,ort,V),function hqr2(nn,e,d,V,H){let i,j,k,l,m,t,w,x,y,ra,sa,vr,vi,notlast,cdivres,n=nn-1,low=0,high=nn-1,eps=Number.EPSILON,exshift=0,norm=0,p=0,q=0,r=0,s=0,z=0,iter=0;for(i=0;i<nn;i++)for((i<low||i>high)&&(d[i]=H.get(i,i),e[i]=0),j=Math.max(i-1,0);j<nn;j++)norm+=Math.abs(H.get(i,j));for(;n>=low;){for(l=n;l>low&&(s=Math.abs(H.get(l-1,l-1))+Math.abs(H.get(l,l)),0===s&&(s=norm),!(Math.abs(H.get(l,l-1))<eps*s));)l--;if(l===n)H.set(n,n,H.get(n,n)+exshift),d[n]=H.get(n,n),e[n]=0,n--,iter=0;else if(l===n-1){if(w=H.get(n,n-1)*H.get(n-1,n),p=(H.get(n-1,n-1)-H.get(n,n))/2,q=p*p+w,z=Math.sqrt(Math.abs(q)),H.set(n,n,H.get(n,n)+exshift),H.set(n-1,n-1,H.get(n-1,n-1)+exshift),x=H.get(n,n),q>=0){for(z=p>=0?p+z:p-z,d[n-1]=x+z,d[n]=d[n-1],0!==z&&(d[n]=x-w/z),e[n-1]=0,e[n]=0,x=H.get(n,n-1),s=Math.abs(x)+Math.abs(z),p=x/s,q=z/s,r=Math.sqrt(p*p+q*q),p/=r,q/=r,j=n-1;j<nn;j++)z=H.get(n-1,j),H.set(n-1,j,q*z+p*H.get(n,j)),H.set(n,j,q*H.get(n,j)-p*z);for(i=0;i<=n;i++)z=H.get(i,n-1),H.set(i,n-1,q*z+p*H.get(i,n)),H.set(i,n,q*H.get(i,n)-p*z);for(i=low;i<=high;i++)z=V.get(i,n-1),V.set(i,n-1,q*z+p*V.get(i,n)),V.set(i,n,q*V.get(i,n)-p*z)}else d[n-1]=x+p,d[n]=x+p,e[n-1]=z,e[n]=-z;n-=2,iter=0}else{if(x=H.get(n,n),y=0,w=0,l<n&&(y=H.get(n-1,n-1),w=H.get(n,n-1)*H.get(n-1,n)),10===iter){for(exshift+=x,i=low;i<=n;i++)H.set(i,i,H.get(i,i)-x);s=Math.abs(H.get(n,n-1))+Math.abs(H.get(n-1,n-2)),x=y=.75*s,w=-.4375*s*s}if(30===iter&&(s=(y-x)/2,s=s*s+w,s>0)){for(s=Math.sqrt(s),y<x&&(s=-s),s=x-w/((y-x)/2+s),i=low;i<=n;i++)H.set(i,i,H.get(i,i)-s);exshift+=s,x=y=w=.964}for(iter+=1,m=n-2;m>=l&&(z=H.get(m,m),r=x-z,s=y-z,p=(r*s-w)/H.get(m+1,m)+H.get(m,m+1),q=H.get(m+1,m+1)-z-r-s,r=H.get(m+2,m+1),s=Math.abs(p)+Math.abs(q)+Math.abs(r),p/=s,q/=s,r/=s,m!==l)&&!(Math.abs(H.get(m,m-1))*(Math.abs(q)+Math.abs(r))<eps*(Math.abs(p)*(Math.abs(H.get(m-1,m-1))+Math.abs(z)+Math.abs(H.get(m+1,m+1)))));)m--;for(i=m+2;i<=n;i++)H.set(i,i-2,0),i>m+2&&H.set(i,i-3,0);for(k=m;k<=n-1&&(notlast=k!==n-1,k!==m&&(p=H.get(k,k-1),q=H.get(k+1,k-1),r=notlast?H.get(k+2,k-1):0,x=Math.abs(p)+Math.abs(q)+Math.abs(r),0!==x&&(p/=x,q/=x,r/=x)),0!==x);k++)if(s=Math.sqrt(p*p+q*q+r*r),p<0&&(s=-s),0!==s){for(k!==m?H.set(k,k-1,-s*x):l!==m&&H.set(k,k-1,-H.get(k,k-1)),p+=s,x=p/s,y=q/s,z=r/s,q/=p,r/=p,j=k;j<nn;j++)p=H.get(k,j)+q*H.get(k+1,j),notlast&&(p+=r*H.get(k+2,j),H.set(k+2,j,H.get(k+2,j)-p*z)),H.set(k,j,H.get(k,j)-p*x),H.set(k+1,j,H.get(k+1,j)-p*y);for(i=0;i<=Math.min(n,k+3);i++)p=x*H.get(i,k)+y*H.get(i,k+1),notlast&&(p+=z*H.get(i,k+2),H.set(i,k+2,H.get(i,k+2)-p*r)),H.set(i,k,H.get(i,k)-p),H.set(i,k+1,H.get(i,k+1)-p*q);for(i=low;i<=high;i++)p=x*V.get(i,k)+y*V.get(i,k+1),notlast&&(p+=z*V.get(i,k+2),V.set(i,k+2,V.get(i,k+2)-p*r)),V.set(i,k,V.get(i,k)-p),V.set(i,k+1,V.get(i,k+1)-p*q)}}}if(0===norm)return;for(n=nn-1;n>=0;n--)if(p=d[n],q=e[n],0===q)for(l=n,H.set(n,n,1),i=n-1;i>=0;i--){for(w=H.get(i,i)-p,r=0,j=l;j<=n;j++)r+=H.get(i,j)*H.get(j,n);if(e[i]<0)z=w,s=r;else if(l=i,0===e[i]?H.set(i,n,0!==w?-r/w:-r/(eps*norm)):(x=H.get(i,i+1),y=H.get(i+1,i),q=(d[i]-p)*(d[i]-p)+e[i]*e[i],t=(x*s-z*r)/q,H.set(i,n,t),H.set(i+1,n,Math.abs(x)>Math.abs(z)?(-r-w*t)/x:(-s-y*t)/z)),t=Math.abs(H.get(i,n)),eps*t*t>1)for(j=i;j<=n;j++)H.set(j,n,H.get(j,n)/t)}else if(q<0)for(l=n-1,Math.abs(H.get(n,n-1))>Math.abs(H.get(n-1,n))?(H.set(n-1,n-1,q/H.get(n,n-1)),H.set(n-1,n,-(H.get(n,n)-p)/H.get(n,n-1))):(cdivres=cdiv(0,-H.get(n-1,n),H.get(n-1,n-1)-p,q),H.set(n-1,n-1,cdivres[0]),H.set(n-1,n,cdivres[1])),H.set(n,n-1,0),H.set(n,n,1),i=n-2;i>=0;i--){for(ra=0,sa=0,j=l;j<=n;j++)ra+=H.get(i,j)*H.get(j,n-1),sa+=H.get(i,j)*H.get(j,n);if(w=H.get(i,i)-p,e[i]<0)z=w,r=ra,s=sa;else if(l=i,0===e[i]?(cdivres=cdiv(-ra,-sa,w,q),H.set(i,n-1,cdivres[0]),H.set(i,n,cdivres[1])):(x=H.get(i,i+1),y=H.get(i+1,i),vr=(d[i]-p)*(d[i]-p)+e[i]*e[i]-q*q,vi=2*(d[i]-p)*q,0===vr&&0===vi&&(vr=eps*norm*(Math.abs(w)+Math.abs(q)+Math.abs(x)+Math.abs(y)+Math.abs(z))),cdivres=cdiv(x*r-z*ra+q*sa,x*s-z*sa-q*ra,vr,vi),H.set(i,n-1,cdivres[0]),H.set(i,n,cdivres[1]),Math.abs(x)>Math.abs(z)+Math.abs(q)?(H.set(i+1,n-1,(-ra-w*H.get(i,n-1)+q*H.get(i,n))/x),H.set(i+1,n,(-sa-w*H.get(i,n)-q*H.get(i,n-1))/x)):(cdivres=cdiv(-r-y*H.get(i,n-1),-s-y*H.get(i,n),z,q),H.set(i+1,n-1,cdivres[0]),H.set(i+1,n,cdivres[1]))),t=Math.max(Math.abs(H.get(i,n-1)),Math.abs(H.get(i,n))),eps*t*t>1)for(j=i;j<=n;j++)H.set(j,n-1,H.get(j,n-1)/t),H.set(j,n,H.get(j,n)/t)}for(i=0;i<nn;i++)if(i<low||i>high)for(j=i;j<nn;j++)V.set(i,j,H.get(i,j));for(j=nn-1;j>=low;j--)for(i=low;i<=high;i++){for(z=0,k=low;k<=Math.min(j,high);k++)z+=V.get(i,k)*H.get(k,j);V.set(i,j,z)}}(n,e,d,V,H)}this.n=n,this.e=e,this.d=d,this.V=V}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let i,j,n=this.n,e=this.e,d=this.d,X=new Matrix(n,n);for(i=0;i<n;i++){for(j=0;j<n;j++)X.set(i,j,0);X.set(i,i,d[i]),e[i]>0?X.set(i,i+1,e[i]):e[i]<0&&X.set(i,i-1,e[i])}return X}}function cdiv(xr,xi,yr,yi){let r,d;return Math.abs(yr)>Math.abs(yi)?(r=yi/yr,d=yr+r*yi,[(xr+r*xi)/d,(xi-r*xr)/d]):(r=yr/yi,d=yi+r*yr,[(r*xr+xi)/d,(r*xi-xr)/d])}class CholeskyDecomposition{constructor(value){if(!(value=WrapperMatrix2D.checkMatrix(value)).isSymmetric())throw new Error("Matrix is not symmetric");let i,j,k,a=value,dimension=a.rows,l=new Matrix(dimension,dimension),positiveDefinite=!0;for(j=0;j<dimension;j++){let d=0;for(k=0;k<j;k++){let s=0;for(i=0;i<k;i++)s+=l.get(k,i)*l.get(j,i);s=(a.get(j,k)-s)/l.get(k,k),l.set(j,k,s),d+=s*s}for(d=a.get(j,j)-d,positiveDefinite&=d>0,l.set(j,j,Math.sqrt(Math.max(d,0))),k=j+1;k<dimension;k++)l.set(j,k,0)}this.L=l,this.positiveDefinite=Boolean(positiveDefinite)}isPositiveDefinite(){return this.positiveDefinite}solve(value){value=WrapperMatrix2D.checkMatrix(value);let l=this.L,dimension=l.rows;if(value.rows!==dimension)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let i,j,k,count=value.columns,B=value.clone();for(k=0;k<dimension;k++)for(j=0;j<count;j++){for(i=0;i<k;i++)B.set(k,j,B.get(k,j)-B.get(i,j)*l.get(k,i));B.set(k,j,B.get(k,j)/l.get(k,k))}for(k=dimension-1;k>=0;k--)for(j=0;j<count;j++){for(i=k+1;i<dimension;i++)B.set(k,j,B.get(k,j)-B.get(i,j)*l.get(i,k));B.set(k,j,B.get(k,j)/l.get(k,k))}return B}get lowerTriangularMatrix(){return this.L}}class nipals{constructor(X,options={}){X=WrapperMatrix2D.checkMatrix(X);let{Y}=options;const{scaleScores=!1,maxIterations=1e3,terminationCriteria=1e-10}=options;let u;if(Y){if(Y=isAnyArray.isAnyArray(Y)&&"number"==typeof Y[0]?Matrix.columnVector(Y):WrapperMatrix2D.checkMatrix(Y),Y.rows!==X.rows)throw new Error("Y should have the same number of rows as X");u=Y.getColumnVector(0)}else u=X.getColumnVector(0);let t,q,w,tOld,diff=1;for(let counter=0;counter<maxIterations&&diff>terminationCriteria;counter++)w=X.transpose().mmul(u).div(u.transpose().mmul(u).get(0,0)),w=w.div(w.norm()),t=X.mmul(w).div(w.transpose().mmul(w).get(0,0)),counter>0&&(diff=t.clone().sub(tOld).pow(2).sum()),tOld=t.clone(),Y?(q=Y.transpose().mmul(t).div(t.transpose().mmul(t).get(0,0)),q=q.div(q.norm()),u=Y.mmul(q).div(q.transpose().mmul(q).get(0,0))):u=t;if(Y){let p=X.transpose().mmul(t).div(t.transpose().mmul(t).get(0,0));p=p.div(p.norm());let xResidual=X.clone().sub(t.clone().mmul(p.transpose())),residual=u.transpose().mmul(t).div(t.transpose().mmul(t).get(0,0)),yResidual=Y.clone().sub(t.clone().mulS(residual.get(0,0)).mmul(q.transpose()));this.t=t,this.p=p.transpose(),this.w=w.transpose(),this.q=q,this.u=u,this.s=t.transpose().mmul(t),this.xResidual=xResidual,this.yResidual=yResidual,this.betas=residual}else this.w=w.transpose(),this.s=t.transpose().mmul(t).sqrt(),this.t=scaleScores?t.clone().div(this.s.get(0,0)):t,this.xResidual=X.sub(t.mmul(w.transpose()))}}exports.ec=AbstractMatrix,exports.Y$=CholeskyDecomposition,exports.uw=CholeskyDecomposition,exports.kh=DistanceMatrix,exports.cg=EigenvalueDecomposition,exports.ai=EigenvalueDecomposition,exports.LU=LuDecomposition,exports.EV=LuDecomposition,exports.WU=Matrix,exports.Cg=class MatrixColumnSelectionView extends BaseView{constructor(matrix,columnIndices){checkColumnIndices(matrix,columnIndices),super(matrix,matrix.rows,columnIndices.length),this.columnIndices=columnIndices}set(rowIndex,columnIndex,value){return this.matrix.set(rowIndex,this.columnIndices[columnIndex],value),this}get(rowIndex,columnIndex){return this.matrix.get(rowIndex,this.columnIndices[columnIndex])}},exports.sJ=class MatrixColumnView extends BaseView{constructor(matrix,column){checkColumnIndex(matrix,column),super(matrix,matrix.rows,1),this.column=column}set(rowIndex,columnIndex,value){return this.matrix.set(rowIndex,this.column,value),this}get(rowIndex){return this.matrix.get(rowIndex,this.column)}},exports.q8=class MatrixFlipColumnView extends BaseView{constructor(matrix){super(matrix,matrix.rows,matrix.columns)}set(rowIndex,columnIndex,value){return this.matrix.set(rowIndex,this.columns-columnIndex-1,value),this}get(rowIndex,columnIndex){return this.matrix.get(rowIndex,this.columns-columnIndex-1)}},exports.iy=class MatrixFlipRowView extends BaseView{constructor(matrix){super(matrix,matrix.rows,matrix.columns)}set(rowIndex,columnIndex,value){return this.matrix.set(this.rows-rowIndex-1,columnIndex,value),this}get(rowIndex,columnIndex){return this.matrix.get(this.rows-rowIndex-1,columnIndex)}},exports.sf=class MatrixRowSelectionView extends BaseView{constructor(matrix,rowIndices){checkRowIndices(matrix,rowIndices),super(matrix,rowIndices.length,matrix.columns),this.rowIndices=rowIndices}set(rowIndex,columnIndex,value){return this.matrix.set(this.rowIndices[rowIndex],columnIndex,value),this}get(rowIndex,columnIndex){return this.matrix.get(this.rowIndices[rowIndex],columnIndex)}},exports.EF=class MatrixRowView extends BaseView{constructor(matrix,row){checkRowIndex(matrix,row),super(matrix,1,matrix.columns),this.row=row}set(rowIndex,columnIndex,value){return this.matrix.set(this.row,columnIndex,value),this}get(rowIndex,columnIndex){return this.matrix.get(this.row,columnIndex)}},exports.C2=MatrixSelectionView,exports.ob=class MatrixSubView extends BaseView{constructor(matrix,startRow,endRow,startColumn,endColumn){checkRange(matrix,startRow,endRow,startColumn,endColumn),super(matrix,endRow-startRow+1,endColumn-startColumn+1),this.startRow=startRow,this.startColumn=startColumn}set(rowIndex,columnIndex,value){return this.matrix.set(this.startRow+rowIndex,this.startColumn+columnIndex,value),this}get(rowIndex,columnIndex){return this.matrix.get(this.startRow+rowIndex,this.startColumn+columnIndex)}},exports.wN=class MatrixTransposeView extends BaseView{constructor(matrix){super(matrix,matrix.columns,matrix.rows)}set(rowIndex,columnIndex,value){return this.matrix.set(columnIndex,rowIndex,value),this}get(rowIndex,columnIndex){return this.matrix.get(columnIndex,rowIndex)}},exports.S=nipals,exports.Ev=nipals,exports.QR=QrDecomposition,exports.G_=QrDecomposition,exports.Ed=SingularValueDecomposition,exports.SE=SingularValueDecomposition,exports.QH=SymmetricMatrix,exports.AP=WrapperMatrix1D,exports.qm=WrapperMatrix2D,exports.w7=function correlation(xMatrix,yMatrix=xMatrix,options={}){xMatrix=new Matrix(xMatrix);let yIsSame=!1;if("object"!=typeof yMatrix||Matrix.isMatrix(yMatrix)||isAnyArray.isAnyArray(yMatrix)?yMatrix=new Matrix(yMatrix):(options=yMatrix,yMatrix=xMatrix,yIsSame=!0),xMatrix.rows!==yMatrix.rows)throw new TypeError("Both matrices must have the same number of rows");const{center=!0,scale=!0}=options;center&&(xMatrix.center("column"),yIsSame||yMatrix.center("column")),scale&&(xMatrix.scale("column"),yIsSame||yMatrix.scale("column"));const sdx=xMatrix.standardDeviation("column",{unbiased:!0}),sdy=yIsSame?sdx:yMatrix.standardDeviation("column",{unbiased:!0}),corr=xMatrix.transpose().mmul(yMatrix);for(let i=0;i<corr.rows;i++)for(let j=0;j<corr.columns;j++)corr.set(i,j,corr.get(i,j)*(1/(sdx[i]*sdy[j]))*(1/(xMatrix.rows-1)));return corr},exports.O0=function covariance(xMatrix,yMatrix=xMatrix,options={}){xMatrix=new Matrix(xMatrix);let yIsSame=!1;if("object"!=typeof yMatrix||Matrix.isMatrix(yMatrix)||isAnyArray.isAnyArray(yMatrix)?yMatrix=new Matrix(yMatrix):(options=yMatrix,yMatrix=xMatrix,yIsSame=!0),xMatrix.rows!==yMatrix.rows)throw new TypeError("Both matrices must have the same number of rows");const{center=!0}=options;center&&(xMatrix=xMatrix.center("column"),yIsSame||(yMatrix=yMatrix.center("column")));const cov=xMatrix.transpose().mmul(yMatrix);for(let i=0;i<cov.rows;i++)for(let j=0;j<cov.columns;j++)cov.set(i,j,cov.get(i,j)*(1/(xMatrix.rows-1)));return cov},exports.cp=Matrix,exports.Ou=function determinant(matrix){if((matrix=Matrix.checkMatrix(matrix)).isSquare()){if(0===matrix.columns)return 1;let a,b,c,d;if(2===matrix.columns)return a=matrix.get(0,0),b=matrix.get(0,1),c=matrix.get(1,0),d=matrix.get(1,1),a*d-b*c;if(3===matrix.columns){let subMatrix0,subMatrix1,subMatrix2;return subMatrix0=new MatrixSelectionView(matrix,[1,2],[1,2]),subMatrix1=new MatrixSelectionView(matrix,[1,2],[0,2]),subMatrix2=new MatrixSelectionView(matrix,[1,2],[0,1]),a=matrix.get(0,0),b=matrix.get(0,1),c=matrix.get(0,2),a*determinant(subMatrix0)-b*determinant(subMatrix1)+c*determinant(subMatrix2)}return new LuDecomposition(matrix).determinant}throw Error("determinant can only be calculated for a square matrix")},exports.gR=function inverse(matrix,useSVD=!1){return matrix=WrapperMatrix2D.checkMatrix(matrix),useSVD?new SingularValueDecomposition(matrix).inverse():solve(matrix,Matrix.eye(matrix.rows))},exports.mM=function linearDependencies(matrix,options={}){const{thresholdValue=1e-9,thresholdError=1e-9}=options;let n=(matrix=Matrix.checkMatrix(matrix)).rows,results=new Matrix(n,n);for(let i=0;i<n;i++){let b=Matrix.columnVector(matrix.getRow(i)),Abis=matrix.subMatrixRow(xrange(n,i)).transpose(),x=new SingularValueDecomposition(Abis).solve(b),error=Matrix.sub(b,Abis.mmul(x)).abs().max();results.setRow(i,dependenciesOneRow(error,x,i,thresholdValue,thresholdError))}return results},exports.Yf=function pseudoInverse(matrix,threshold=Number.EPSILON){if((matrix=Matrix.checkMatrix(matrix)).isEmpty())return matrix.transpose();let svdSolution=new SingularValueDecomposition(matrix,{autoTranspose:!0}),U=svdSolution.leftSingularVectors,V=svdSolution.rightSingularVectors,s=svdSolution.diagonal;for(let i=0;i<s.length;i++)Math.abs(s[i])>threshold?s[i]=1/s[i]:s[i]=0;return V.mmul(Matrix.diag(s).mmul(U.transpose()))},exports.c5=solve,exports.em=function wrap(array,options){if(isAnyArray.isAnyArray(array))return array[0]&&isAnyArray.isAnyArray(array[0])?new WrapperMatrix2D(array):new WrapperMatrix1D(array,options);throw new Error("the argument is not an array")}},"./node_modules/ml-matrix/matrix.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{SE:()=>SingularValueDecomposition,WU:()=>Matrix});var _matrix_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/ml-matrix/matrix.js");_matrix_js__WEBPACK_IMPORTED_MODULE_0__.ec,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.Y$,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.uw,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.kh,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.cg,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.ai,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.LU,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.EV;const Matrix=_matrix_js__WEBPACK_IMPORTED_MODULE_0__.WU,SingularValueDecomposition=(_matrix_js__WEBPACK_IMPORTED_MODULE_0__.Cg,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.sJ,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.q8,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.iy,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.sf,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.EF,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.C2,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.ob,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.wN,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.S,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.Ev,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.QR,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.G_,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.Ed,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.SE);_matrix_js__WEBPACK_IMPORTED_MODULE_0__.QH,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.AP,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.qm,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.w7,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.O0;_matrix_js__WEBPACK_IMPORTED_MODULE_0__.cp.Matrix?_matrix_js__WEBPACK_IMPORTED_MODULE_0__.cp.Matrix:_matrix_js__WEBPACK_IMPORTED_MODULE_0__.WU;_matrix_js__WEBPACK_IMPORTED_MODULE_0__.Ou,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.gR,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.mM,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.Yf,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.c5,_matrix_js__WEBPACK_IMPORTED_MODULE_0__.em}}]);