/*! For license information please see 7948.1da958b1.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[7948],{"./packages/editors/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{U3:()=>AxDrawCanvas,IR:()=>AxMdxEditor,rM:()=>AxMonacoEditor});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),dist=__webpack_require__("./packages/core/dist/index.js"),urls=__webpack_require__("./node_modules/@tldraw/assets/urls.js"),dist_esm=__webpack_require__("./node_modules/@tldraw/tldraw/dist-esm/index.mjs"),react=(__webpack_require__("./node_modules/@tldraw/tldraw/tldraw.css"),__webpack_require__("./node_modules/react/index.js"));const DrawContext=(0,react.createContext)({}),DrawContextProvider=({children,...props})=>(0,jsx_runtime.jsx)(DrawContext.Provider,{value:props,children});try{DrawContextProvider.displayName="DrawContextProvider",DrawContextProvider.__docgenInfo={description:"",displayName:"DrawContextProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/canvas/DrawContext.tsx#DrawContextProvider"]={docgenInfo:DrawContextProvider.__docgenInfo,name:"DrawContextProvider",path:"packages/editors/src/canvas/DrawContext.tsx#DrawContextProvider"})}catch(__react_docgen_typescript_loader_error){}var editor_dist_esm=__webpack_require__("./node_modules/@tldraw/editor/dist-esm/index.mjs"),dom_to_image=__webpack_require__("./node_modules/dom-to-image/src/dom-to-image.js"),dom_to_image_default=__webpack_require__.n(dom_to_image);class Idle extends editor_dist_esm.nui{static id="idle";onPointerDown=info=>{this.parent.transition("pointing",info)};onEnter=()=>{this.editor.setCursor({type:"cross",rotation:0})};onCancel=()=>{this.editor.setCurrentTool("select")};onKeyUp=info=>{if("Enter"===info.key){if(this.editor.instanceState.isReadonly)return null;const{onlySelectedShape}=this.editor;onlySelectedShape&&this.editor.getShapeUtil(onlySelectedShape).canEdit(onlySelectedShape)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(onlySelectedShape.id),this.editor.root.current.value?.transition("editing_shape",{...info,target:"shape",shape:onlySelectedShape}))}}}class Pointing extends editor_dist_esm.nui{static id="pointing";markId="";onPointerUp=()=>{this.cancel()};onCancel=()=>{this.cancel()};onComplete=()=>{this.cancel()};onInterrupt=()=>{this.cancel()};onPointerMove=info=>{if(this.editor.inputs.isDragging){const{originPagePoint}=this.editor.inputs,id=(0,dist_esm.F17)();this.markId=`creating:${id}`,this.editor.mark(this.markId),this.editor.createShapes([{id,type:"avatar",x:originPagePoint.x,y:originPagePoint.y,props:{color:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"person",align:"middle"}}]).select(id).setCurrentTool("select.resizing",{...info,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"avatar"})}};cancel(){this.shape&&this.editor.bailToMark(this.markId),this.editor.setHintingShapes([]),this.parent.transition("idle",{})}}const AvatarShapeProps={color:dist_esm.R_W,fill:dist_esm.pp9,dash:dist_esm.ciG,size:dist_esm.ST$,font:dist_esm.Y8S,align:dist_esm.XoM,text:dist_esm.T.string};class AvatarShapeTool extends editor_dist_esm.nui{static id="avatar";static initial="idle";static children=()=>[Idle,Pointing];shapeType="avatar"}const SIZE_MAP={s:48,m:72,l:96,xl:128},FONT_SIZE_MAP={s:12,m:16,l:18,xl:22};class AvatarShapeUtil extends dist_esm.EeJ{static type="avatar";static props=AvatarShapeProps;canEdit=()=>!0;hideResizeHandles=()=>!0;hideRotateHandle=()=>!0;getDefaultProps(){return{color:"black",fill:"none",dash:"draw",size:"s",font:"draw",text:"person",align:"middle"}}getGeometry(shape){const size=SIZE_MAP[shape.props.size];return new dist_esm.zc7({width:size,height:+size+32,isFilled:!0})}indicator(shape){const size=SIZE_MAP[shape.props.size];return(0,jsx_runtime.jsx)("rect",{width:size,height:size})}onChange=(shape,newText)=>{const{id,type,props:{text}}=shape;newText&&text.trim()!==newText.trim()&&this.editor.updateShapes([{id,type,props:{text:newText.trim()}}])};component(shape){const isDark=(0,dist.F5)(),isEditing=(0,dist_esm.YzH)(shape.id),size=SIZE_MAP[shape.props.size],theme=(0,dist_esm.y6M)({isDarkMode:isDark}),inputRef=(0,react.useRef)("");return(0,react.useEffect)((()=>{!isEditing&&inputRef.current&&this.onChange(shape,inputRef.current)}),[isEditing]),(0,jsx_runtime.jsxs)("div",{"data-shape-id":shape.id,children:[(0,jsx_runtime.jsx)("svg",{id:shape.id,viewBox:"0 0 30 30",children:(0,jsx_runtime.jsx)("path",{width:size,height:size,fill:"transparent",stroke:theme[shape.props.color]?.solid,d:"M5 27.4996C5 20.2996 8.79988 17.0996 14.9999 17.0996C21.1999 17.0996 25.0001 20.2996 25 27.4996M14.9997 15.6001C18.4792 15.6001 21.2998 12.7794 21.2998 9.30003C21.2998 5.82062 18.4792 3 14.9997 3C11.5203 3 8.69971 5.82062 8.69971 9.30003C8.69971 12.7794 11.5203 15.6001 14.9997 15.6001Z"})}),(0,jsx_runtime.jsx)("div",{id:shape.id,className:"tl-text-label","data-isediting":isEditing,"data-font":shape.props.font,style:{alignItems:"end",fontSize:FONT_SIZE_MAP[shape.props.size],color:theme[shape.props.color].solid},children:(0,jsx_runtime.jsxs)("div",{className:"tl-text-label__inner",children:[(0,jsx_runtime.jsx)("div",{className:"tl-text tl-text-content",dir:"ltr",children:`${shape.props.text}`}),isEditing&&(0,jsx_runtime.jsx)("textarea",{className:"tl-text tl-text-input",name:"text",tabIndex:-1,autoComplete:"false",autoCapitalize:"false",autoCorrect:"false",autoSave:"false",placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",ref:el=>(el?.select(),el?.focus()),onChange:e=>inputRef.current=e.target.value,defaultValue:shape.props.text})]})})]})}async toSvg(shape){const el=document.querySelector(`div[data-shape-id="${shape.id}"]`);return el?await dom_to_image_default().toPng(el).then((function(dataUrl){const image=document.createElementNS("http://www.w3.org/2000/svg","image");return image.setAttributeNS("http://www.w3.org/1999/xlink","href",dataUrl),image})):document.createElementNS("http://www.w3.org/2000/svg","image")}}try{type.displayName="AvatarShapeUtil.type",type.__docgenInfo={description:"The type of the shape util, which should match the shape's type.",displayName:"AvatarShapeUtil.type",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/canvas/shapes/avatar/AvatarShapeTool.tsx#AvatarShapeUtil.type"]={docgenInfo:AvatarShapeUtil.type.__docgenInfo,name:"AvatarShapeUtil.type",path:"packages/editors/src/canvas/shapes/avatar/AvatarShapeTool.tsx#AvatarShapeUtil.type"})}catch(__react_docgen_typescript_loader_error){}var utilities_dist=__webpack_require__("./packages/utilities/dist/index.js");class AudioShapeUtil extends dist_esm.EeJ{static type="audio-card";canResize=()=>!1;getDefaultProps(){return{src:"",poster:"",fileName:"",fileSize:0}}getGeometry(shape){return new dist_esm.zc7({width:320,height:96,isFilled:!0})}component(shape){const audioRef=(0,react.useRef)(null);return(0,react.useEffect)((()=>{audioRef.current?.addEventListener("play",(()=>{audioRef.current?.closest(".tl-container")?.querySelectorAll("video,audio").forEach((el=>{el!==audioRef.current&&el.pause()}))}))}),[]),(0,jsx_runtime.jsx)(dist_esm.G7H,{className:"relative grid",children:(0,jsx_runtime.jsxs)("div",{"data-shape-id":shape.id,className:"bg-zinc-900 relative p-1 flex flex-col overflow-hidden",children:[(0,jsx_runtime.jsx)("audio",{controls:!0,ref:audioRef,src:shape.props.src,className:"object-contain flex-1 w-full pointer-events-auto overflow-hidden"}),(0,jsx_runtime.jsx)("img",{src:shape.props.poster,className:"object-fill flex-1 pointer-events-auto overflow-hidden hidden"}),(0,jsx_runtime.jsxs)("div",{className:"bg-zinc-800/80 text-white items-center py-1 px-2 flex gap-1 text-sm",children:[(0,jsx_runtime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,children:(0,jsx_runtime.jsx)("path",{d:"M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"})}),(0,jsx_runtime.jsx)("div",{className:"truncate flex-1",children:shape.props.fileName}),(0,jsx_runtime.jsx)("div",{children:utilities_dist.Format.bytes(shape.props.fileSize??0)})]})]})})}indicator(shape){return(0,jsx_runtime.jsx)("rect",{})}async toSvg(shape){const el=document.querySelector(`div[data-shape-id="${shape.id}"]`);return el?(el.childNodes.item(0).style.display="none",el.childNodes.item(1).style.display="block",await dom_to_image_default().toPng(el).then((function(dataUrl){const image=document.createElementNS("http://www.w3.org/2000/svg","image");return image.setAttributeNS("http://www.w3.org/1999/xlink","href",dataUrl),el.childNodes.item(0).style.display="block",el.childNodes.item(1).style.display="none",image}))):document.createElementNS("http://www.w3.org/2000/svg","image")}}try{type.displayName="AudioShapeUtil.type",type.__docgenInfo={description:"The type of the shape util, which should match the shape's type.",displayName:"AudioShapeUtil.type",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/canvas/shapes/custom/AudioShape.tsx#AudioShapeUtil.type"]={docgenInfo:AudioShapeUtil.type.__docgenInfo,name:"AudioShapeUtil.type",path:"packages/editors/src/canvas/shapes/custom/AudioShape.tsx#AudioShapeUtil.type"})}catch(__react_docgen_typescript_loader_error){}class CardShapeUtil extends dist_esm.EeJ{static type="data-card";onResize=(shape,info)=>({props:{w:Math.max(Math.min(info.initialBounds.w*info.scaleX,1024),128),h:Math.max(Math.min(info.initialBounds.h*info.scaleY,768),128)}});getDefaultProps(){return{w:300,h:200}}getGeometry(shape){return new dist_esm.zc7({width:shape.props.w,height:shape.props.h,isFilled:!0})}component(shape){const{renderer}=(0,react.useContext)(DrawContext);return(0,jsx_runtime.jsx)(dist_esm.G7H,{className:"relative grid",children:(0,jsx_runtime.jsx)("div",{className:"relative grid","data-shape-id":shape.id,children:renderer?.(shape.props)})})}indicator(shape){return(0,jsx_runtime.jsx)("rect",{width:shape.props.w,height:shape.props.h})}async toSvg(shape){const el=document.querySelector(`div[data-shape-id="${shape.id}"]`);return el?await dom_to_image_default().toPng(el).then((function(dataUrl){const image=document.createElementNS("http://www.w3.org/2000/svg","image");return image.setAttributeNS("http://www.w3.org/1999/xlink","href",dataUrl),image})):document.createElementNS("http://www.w3.org/2000/svg","image")}}try{type.displayName="CardShapeUtil.type",type.__docgenInfo={description:"The type of the shape util, which should match the shape's type.",displayName:"CardShapeUtil.type",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/canvas/shapes/custom/CardShape.tsx#CardShapeUtil.type"]={docgenInfo:CardShapeUtil.type.__docgenInfo,name:"CardShapeUtil.type",path:"packages/editors/src/canvas/shapes/custom/CardShape.tsx#CardShapeUtil.type"})}catch(__react_docgen_typescript_loader_error){}class FileShapeUtil extends dist_esm.EeJ{static type="file-card";canResize=()=>!1;getDefaultProps(){return{icon:"",fileType:"",fileName:"",fileSize:0}}getGeometry(shape){return new dist_esm.zc7({width:320,height:72,isFilled:!0})}component(shape){return(0,jsx_runtime.jsx)(dist_esm.G7H,{className:"relative grid",children:(0,jsx_runtime.jsxs)("div",{"data-shape-id":shape.id,className:"relative p-1 flex border rounded m-1 overflow-hidden",children:[(0,jsx_runtime.jsx)("img",{src:shape.props.icon,className:"object-contain pointer-events-none overflow-hidden w-12 h-12"}),(0,jsx_runtime.jsxs)("div",{className:"flex-1 overflow-hidden text-sm py-1 px-2",children:[(0,jsx_runtime.jsxs)("div",{className:"items-center flex gap-1",children:[(0,jsx_runtime.jsx)("div",{className:"truncate flex-1",children:shape.props.fileName}),(0,jsx_runtime.jsx)("div",{children:utilities_dist.Format.bytes(shape.props.fileSize??0)})]}),(0,jsx_runtime.jsx)("div",{children:shape.props.fileType})]})]})})}indicator(shape){return(0,jsx_runtime.jsx)("rect",{})}async toSvg(shape){const el=document.querySelector(`div[data-shape-id="${shape.id}"]`);return el?await dom_to_image_default().toPng(el).then((function(dataUrl){const image=document.createElementNS("http://www.w3.org/2000/svg","image");return image.setAttributeNS("http://www.w3.org/1999/xlink","href",dataUrl),image})):document.createElementNS("http://www.w3.org/2000/svg","image")}}try{type.displayName="FileShapeUtil.type",type.__docgenInfo={description:"The type of the shape util, which should match the shape's type.",displayName:"FileShapeUtil.type",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/canvas/shapes/custom/FileShape.tsx#FileShapeUtil.type"]={docgenInfo:FileShapeUtil.type.__docgenInfo,name:"FileShapeUtil.type",path:"packages/editors/src/canvas/shapes/custom/FileShape.tsx#FileShapeUtil.type"})}catch(__react_docgen_typescript_loader_error){}class ImageShapeUtil extends dist_esm.EeJ{static type="image-card";onResize=(shape,info)=>({props:{w:Math.max(Math.min(info.initialBounds.w*info.scaleX,1024),128),h:Math.max(Math.min(info.initialBounds.h*info.scaleY,768),128)}});getDefaultProps(){return{src:"",fileName:"",fileSize:0,w:400,h:300}}getGeometry(shape){return new dist_esm.zc7({width:shape.props.w,height:shape.props.h,isFilled:!0})}component(shape){return(0,jsx_runtime.jsx)(dist_esm.G7H,{className:"relative grid",children:(0,jsx_runtime.jsxs)("div",{"data-shape-id":shape.id,className:"bg-zinc-900 relative p-1 flex flex-col overflow-hidden",children:[(0,jsx_runtime.jsx)("img",{src:shape.props.src,className:"object-contain flex-1 pointer-events-none overflow-hidden"}),(0,jsx_runtime.jsxs)("div",{className:"bg-zinc-800/80 text-white items-center py-1 px-2 flex gap-1 text-sm",children:[(0,jsx_runtime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,children:(0,jsx_runtime.jsx)("path",{d:"M4,4H7L9,2H15L17,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4A2,2 0 0,1 2,18V6A2,2 0 0,1 4,4M12,7A5,5 0 0,0 7,12A5,5 0 0,0 12,17A5,5 0 0,0 17,12A5,5 0 0,0 12,7M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9Z"})}),(0,jsx_runtime.jsx)("div",{className:"truncate flex-1",children:shape.props.fileName}),(0,jsx_runtime.jsx)("div",{children:utilities_dist.Format.bytes(shape.props.fileSize??0)})]})]})})}indicator(shape){return(0,jsx_runtime.jsx)("rect",{width:shape.props.w,height:shape.props.h})}async toSvg(shape){const el=document.querySelector(`div[data-shape-id="${shape.id}"]`);return el?await dom_to_image_default().toPng(el).then((function(dataUrl){const image=document.createElementNS("http://www.w3.org/2000/svg","image");return image.setAttributeNS("http://www.w3.org/1999/xlink","href",dataUrl),image})):document.createElementNS("http://www.w3.org/2000/svg","image")}}try{type.displayName="ImageShapeUtil.type",type.__docgenInfo={description:"The type of the shape util, which should match the shape's type.",displayName:"ImageShapeUtil.type",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/canvas/shapes/custom/ImageShape.tsx#ImageShapeUtil.type"]={docgenInfo:ImageShapeUtil.type.__docgenInfo,name:"ImageShapeUtil.type",path:"packages/editors/src/canvas/shapes/custom/ImageShape.tsx#ImageShapeUtil.type"})}catch(__react_docgen_typescript_loader_error){}class VideoShapeUtil extends dist_esm.EeJ{static type="video-card";onResize=(shape,info)=>({props:{w:Math.max(Math.min(info.initialBounds.w*info.scaleX,1024),128),h:Math.max(Math.min(info.initialBounds.h*info.scaleY,768),128)}});getDefaultProps(){return{src:"",poster:"",fileName:"",fileSize:0,w:400,h:300}}getGeometry(shape){return new dist_esm.zc7({width:shape.props.w,height:shape.props.h,isFilled:!0})}component(shape){const videoRef=(0,react.useRef)(null);return(0,react.useEffect)((()=>{videoRef.current?.addEventListener("play",(()=>{videoRef.current?.closest(".tl-container")?.querySelectorAll("video,audio").forEach((el=>{el!==videoRef.current&&el.pause()}))}))}),[]),(0,jsx_runtime.jsx)(dist_esm.G7H,{className:"relative grid",children:(0,jsx_runtime.jsxs)("div",{"data-shape-id":shape.id,className:"bg-zinc-900 relative p-1 flex flex-col overflow-hidden",children:[(0,jsx_runtime.jsx)("video",{controls:!0,ref:videoRef,src:shape.props.src,poster:shape.props.poster,className:"object-contain flex-1 pointer-events-auto overflow-hidden"}),(0,jsx_runtime.jsx)("img",{src:shape.props.poster,className:"object-contain flex-1 pointer-events-auto overflow-hidden hidden"}),(0,jsx_runtime.jsxs)("div",{className:"bg-zinc-800/80 text-white items-center py-1 px-2 flex gap-1 text-sm",children:[(0,jsx_runtime.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:16,height:16,children:(0,jsx_runtime.jsx)("path",{d:"M17,10.5V7A1,1 0 0,0 16,6H4A1,1 0 0,0 3,7V17A1,1 0 0,0 4,18H16A1,1 0 0,0 17,17V13.5L21,17.5V6.5L17,10.5Z"})}),(0,jsx_runtime.jsx)("div",{className:"truncate flex-1",children:shape.props.fileName}),(0,jsx_runtime.jsx)("div",{children:utilities_dist.Format.bytes(shape.props.fileSize??0)})]})]})})}indicator(shape){return(0,jsx_runtime.jsx)("rect",{width:shape.props.w,height:shape.props.h})}async toSvg(shape){const el=document.querySelector(`div[data-shape-id="${shape.id}"]`);return el?(el.childNodes.item(0).style.display="none",el.childNodes.item(1).style.display="block",await dom_to_image_default().toPng(el).then((function(dataUrl){const image=document.createElementNS("http://www.w3.org/2000/svg","image");return image.setAttributeNS("http://www.w3.org/1999/xlink","href",dataUrl),el.childNodes.item(0).style.display="block",el.childNodes.item(1).style.display="none",image}))):document.createElementNS("http://www.w3.org/2000/svg","image")}}try{type.displayName="VideoShapeUtil.type",type.__docgenInfo={description:"The type of the shape util, which should match the shape's type.",displayName:"VideoShapeUtil.type",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/canvas/shapes/custom/VideoShape.tsx#VideoShapeUtil.type"]={docgenInfo:VideoShapeUtil.type.__docgenInfo,name:"VideoShapeUtil.type",path:"packages/editors/src/canvas/shapes/custom/VideoShape.tsx#VideoShapeUtil.type"})}catch(__react_docgen_typescript_loader_error){}const TypeMap={image:"image-card",video:"video-card",audio:"audio-card",file:"file-card",card:"data-card"},AxDrawCanvas=({snapshot,renderer,canvasRef})=>{const[editorRef,setEditor]=(0,react.useState)(),isDark=(0,dist.F5)();(0,react.useEffect)((()=>{editorRef?.user.updateUserPreferences({isDarkMode:isDark})}),[editorRef,isDark]),(0,react.useLayoutEffect)((()=>{setTimeout((()=>{snapshot&&editorRef?.store.loadSnapshot(snapshot)}),500)}),[editorRef,snapshot]);const handleDragOver=(0,react.useCallback)((e=>!!e.dataTransfer.getData("axux/canvas")||(e.preventDefault(),!1)),[]),handleDrop=(0,react.useCallback)((e=>{const data=e.dataTransfer.getData("axux/canvas");if(!data)return e.preventDefault(),!1;const{type,...props}=JSON.parse(data);if(type in TypeMap){const{x=0,y=0}=editorRef?.getContainer().getBoundingClientRect()??{};editorRef?.createShape({type:TypeMap[type],x:e.clientX-x,y:e.clientY-y,props})}return!0}),[editorRef]);(0,react.useImperativeHandle)(canvasRef,(()=>({exportPages:()=>({})})));const TLDraw=(0,react.useMemo)((()=>(0,jsx_runtime.jsx)(dist_esm.DrV,{assetUrls:(0,urls.o)(),shapeUtils:[AvatarShapeUtil,AudioShapeUtil,ImageShapeUtil,VideoShapeUtil,CardShapeUtil,FileShapeUtil],tools:[AvatarShapeTool],onMount:setEditor,overrides:{toolbar:(editor,schema,helpers)=>(schema.push({id:"avatar",type:"item",readonlyOk:!0,toolItem:{id:"avatar",label:"tool.avatar",readonlyOk:!1,icon:"avatar",onSelect(){editor.setCurrentTool("avatar")}}}),schema.filter((t=>!["asset","embed"].includes(t.id)))),menu:(editor,schema,helpers)=>schema.filter((t=>!["extras"].includes(t.id))),actions:(editor,schema,helpers)=>(schema["insert-embed"].kbd="",schema["insert-media"].kbd="",schema)}})),[]);return(0,jsx_runtime.jsx)(DrawContextProvider,{renderer,children:(0,jsx_runtime.jsx)(dist.zb,{children:(0,jsx_runtime.jsx)("div",{className:"absolute inset-0",onDragOver:handleDragOver,onDrop:handleDrop,children:TLDraw})})})};try{AxDrawCanvas.displayName="AxDrawCanvas",AxDrawCanvas.__docgenInfo={description:"",displayName:"AxDrawCanvas",props:{snapshot:{defaultValue:null,description:"",name:"snapshot",required:!1,type:{name:"StoreSnapshot<TLRecord>"}},onUpdate:{defaultValue:null,description:"",name:"onUpdate",required:!1,type:{name:"((snapshot: StoreSnapshot<TLRecord>) => void)"}},renderer:{defaultValue:null,description:"",name:"renderer",required:!1,type:{name:"((props: KeyValue) => AnyObject)"}},canvasRef:{defaultValue:null,description:"",name:"canvasRef",required:!1,type:{name:"RefObject<{ exportPages: () => KeyValue<string>; }>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/canvas/DrawCanvas.tsx#AxDrawCanvas"]={docgenInfo:AxDrawCanvas.__docgenInfo,name:"AxDrawCanvas",path:"packages/editors/src/canvas/DrawCanvas.tsx#AxDrawCanvas"})}catch(__react_docgen_typescript_loader_error){}var react_dist=__webpack_require__("./node_modules/@monaco-editor/react/dist/index.mjs"),appIcons=__webpack_require__("./packages/core/dist/types/appIcons.js"),es=__webpack_require__("./node_modules/react-i18next/dist/es/index.js");const Tools=({editor})=>{const{t}=(0,es.$G)("editors"),foldAll=(0,react.useCallback)((()=>{editor&&editor.getAction("editor.foldLevel2")?.run()}),[editor]),unfoldAll=(0,react.useCallback)((()=>{editor&&editor.getAction("editor.unfoldAll")?.run()}),[editor]),search=(0,react.useCallback)((()=>{editor&&editor.getAction("actions.find")?.run()}),[editor]),commandPalette=(0,react.useCallback)((()=>{editor&&(editor.focus(),editor.getAction("editor.action.quickCommand")?.run())}),[editor]);return(0,jsx_runtime.jsxs)(dist.Q6,{children:[(0,jsx_runtime.jsx)("div",{className:"flex-1"}),(0,jsx_runtime.jsxs)(dist.oG.Group,{variant:"flat",children:[(0,jsx_runtime.jsx)(dist.oG,{size:"sm",variant:"link",onClick:search,tooltip:t("action.find"),icon:appIcons.U.iconSearch}),(0,jsx_runtime.jsx)(dist.qm,{size:"xs"}),(0,jsx_runtime.jsx)(dist.oG,{size:"sm",variant:"link",onClick:foldAll,tooltip:t("action.collapseAll"),icon:appIcons.U.iconCollapseAll}),(0,jsx_runtime.jsx)(dist.oG,{size:"sm",variant:"link",onClick:unfoldAll,tooltip:t("action.expandAll"),icon:appIcons.U.iconExpandAll}),(0,jsx_runtime.jsx)(dist.qm,{size:"xs"}),(0,jsx_runtime.jsx)(dist.oG,{size:"sm",variant:"link",onClick:commandPalette,tooltip:t("action.showShortcuts"),icon:appIcons.U.iconQuestion})]})]})};try{Tools.displayName="Tools",Tools.__docgenInfo={description:"",displayName:"Tools",props:{editor:{defaultValue:null,description:"",name:"editor",required:!1,type:{name:"any"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/code/Tools.tsx#Tools"]={docgenInfo:Tools.__docgenInfo,name:"Tools",path:"packages/editors/src/code/Tools.tsx#Tools"})}catch(__react_docgen_typescript_loader_error){}const useSuggestions=(monaco,language="json",suggestions=[])=>((0,react.useEffect)((()=>{if(monaco){const instance=(suggestions=>monaco?.languages.registerCompletionItemProvider(language,{triggerCharacters:["{"],provideCompletionItems:(model,position)=>{const suggestionsList=((instance,suggestions,model,position)=>{let results=[],hasParent=!1;const prevChar=model.getValueInRange({startColumn:position.column-2,startLineNumber:position.lineNumber,endColumn:position.column,endLineNumber:position.lineNumber}),nextChar=model.getValueInRange({startColumn:position.column,startLineNumber:position.lineNumber,endColumn:position.column+2,endLineNumber:position.lineNumber}),hasBracket=prevChar.match(/\{+/)?.shift()?.length??0,hasClosingBracket=nextChar.match(/\{+/)?.shift()?.length??0;if(1===hasBracket)return[];let text=model.getWordUntilPosition(position).word;const prev=model.findPreviousMatch("{",{lineNumber:0,column:0},!1,!1,null,!0);if(prev&&(text=model.getValueInRange({...prev.range,endColumn:position.column})),text=text.replace("{","").trim(),0===text.length)results=suggestions;else{const splits=text.split(".").filter((s=>""!==s.trim()));if(splits.length){hasParent=!0;let i=0,children=suggestions;const dotEnd="."===text[text.length-1];for(const split of splits){const found=children.find((c=>c.text===split)),isLast=splits.length-1==i++;dotEnd?found?.children?.length&&(children=found.children,isLast&&(results=children)):found&&(isLast?children=children.filter((s=>s.text.includes(text))):found.children&&(children=found.children))}results=children}else results=suggestions.filter((s=>s.text.includes(text)))}return results.map((s=>((instance,suggestion,hasBracket,hasClosingBracket,hasParent=!1)=>{const showSuggest=suggestion.children?.length;let insertBrackets=!1,insertText=suggestion.text;return showSuggest?(insertText=`${suggestion.text}.`,insertBrackets=!hasParent):hasParent?insertText=`${suggestion.text}`:(insertText=`${suggestion.text}`,insertBrackets=!0),insertBrackets&&(insertText=`${2===hasBracket?"":1===hasBracket?"{":"{{"}${insertText}${2===hasClosingBracket?"":1===hasClosingBracket?"}":"}}"}`),{label:suggestion.label,kind:instance.languages.CompletionItemKind.Variable,detail:suggestion.description,insertText,...showSuggest?{command:{id:"editor.action.triggerSuggest"}}:{},range:null}})(instance,s,hasBracket,hasClosingBracket,hasParent)))})(monaco,suggestions,model,position);return{suggestions:suggestionsList}}}))(suggestions);return()=>{instance?.dispose()}}}),[monaco,language,suggestions]),null),AxMonacoEditor=({editorRef:ref,value,hideToolbar,isLoading,isReadonly=!1,language="json",suggestions=[],onChange})=>{const[editorRef,setEditorRef]=(0,react.useState)(),[monacoRef,setMonacoRef]=(0,react.useState)(),isDark=(0,dist.F5)();useSuggestions(monacoRef,language,suggestions),(0,react.useImperativeHandle)(ref,(()=>({getValue:()=>editorRef?.editor?.getValue(),validate(){const model=editorRef?.editor?.getModel();if(model){const markers=editorRef?.editor.getModelMarkers(model);return 0===markers?.length}return!0}})),[editorRef]);const[theme,setTheme]=(0,react.useState)("");(0,react.useLayoutEffect)((()=>{editorRef&&setTheme(isDark?"vs-dark":"light")}),[isDark,editorRef]);const resizeHandler=(0,react.useCallback)((size=>editorRef?.editor?.layout(size)),[editorRef]),containerRef=(0,dist.yU)(resizeHandler),deferredValue=(0,react.useDeferredValue)(value),codeValue=(0,react.useMemo)((()=>(0,utilities_dist.isString)(deferredValue)?deferredValue:JSON.stringify(deferredValue,null,4)),[deferredValue]),handleChange=(0,dist.Nr)(onChange);return(0,jsx_runtime.jsxs)(dist.zb,{isLoading,children:[!hideToolbar&&(0,jsx_runtime.jsx)(Tools,{editor:editorRef}),(0,jsx_runtime.jsx)(dist.zb,{ref:containerRef,className:"ax-editor",children:(0,jsx_runtime.jsx)(react_dist.ZP,{onMount:(e,m)=>(!!e&&setEditorRef(e),!!m&&setMonacoRef(m)),value:codeValue,language,onChange:handleChange,theme,options:{wordWrap:"on",readOnly:isReadonly}})})]})};try{AxMonacoEditor.displayName="AxMonacoEditor",AxMonacoEditor.__docgenInfo={description:"",displayName:"AxMonacoEditor",props:{editorRef:{defaultValue:null,description:"",name:"editorRef",required:!1,type:{name:"Ref<MonacoEditorRef>"}},value:{defaultValue:null,description:"code string",name:"value",required:!1,type:{name:"any"}},onChange:{defaultValue:null,description:"onChange callback",name:"onChange",required:!1,type:{name:"((value?: string) => void)"}},isLoading:{defaultValue:null,description:"loading state",name:"isLoading",required:!1,type:{name:"boolean"}},isReadonly:{defaultValue:{value:"false"},description:"readonly",name:"isReadonly",required:!1,type:{name:"boolean"}},hideToolbar:{defaultValue:null,description:"hide toolbar",name:"hideToolbar",required:!1,type:{name:"boolean"}},language:{defaultValue:{value:"json"},description:"code language",name:"language",required:!1,type:{name:"enum",value:[{value:'"text"'},{value:'"json"'},{value:'"css"'},{value:'"html"'},{value:'"markdown"'}]}},suggestions:{defaultValue:{value:"[]"},description:"",name:"suggestions",required:!1,type:{name:"SuggestionItem[]"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/code/CodeEditor.tsx#AxMonacoEditor"]={docgenInfo:AxMonacoEditor.__docgenInfo,name:"AxMonacoEditor",path:"packages/editors/src/code/CodeEditor.tsx#AxMonacoEditor"})}catch(__react_docgen_typescript_loader_error){}var purify=__webpack_require__("./node_modules/dompurify/dist/purify.js"),core=__webpack_require__("./packages/editors/node_modules/highlight.js/es/core.js"),marked_esm=__webpack_require__("./node_modules/marked/lib/marked.esm.js"),marked_admonition_extension_dist=__webpack_require__("./node_modules/marked-admonition-extension/dist/index.mjs"),src=__webpack_require__("./node_modules/marked-emoji/src/index.js"),marked_highlight_src=__webpack_require__("./node_modules/marked-highlight/src/index.js"),bash=__webpack_require__("./packages/editors/node_modules/highlight.js/es/languages/bash.js"),css=__webpack_require__("./packages/editors/node_modules/highlight.js/es/languages/css.js"),javascript=__webpack_require__("./packages/editors/node_modules/highlight.js/es/languages/javascript.js"),json=__webpack_require__("./packages/editors/node_modules/highlight.js/es/languages/json.js"),typescript=__webpack_require__("./packages/editors/node_modules/highlight.js/es/languages/typescript.js"),xml=__webpack_require__("./packages/editors/node_modules/highlight.js/es/languages/xml.js"),yaml=__webpack_require__("./packages/editors/node_modules/highlight.js/es/languages/yaml.js"),emoji_en_US=__webpack_require__("./node_modules/emojilib/dist/emoji-en-US.json");const emojiMap=Object.entries(emoji_en_US).reduce(((ret,[emoji,names])=>(names.forEach((name=>ret[name]=ret[name]??emoji)),ret)),{});core.Z.registerLanguage("javascript",javascript.Z),core.Z.registerLanguage("typescript",typescript.Z),core.Z.registerLanguage("css",css.Z),core.Z.registerLanguage("json",json.Z),core.Z.registerLanguage("bash",bash.Z),core.Z.registerLanguage("html",xml.Z),core.Z.registerLanguage("yaml",yaml.Z),core.Z.registerLanguage("default",xml.Z);const LANGS=["javascript","typescript","css","json","bash","html","yaml"],_marked=new marked_esm.M2(marked_admonition_extension_dist.ZP,(0,src.c)({emojis:emojiMap,unicode:!0}),(0,marked_highlight_src.G)({langPrefix:"hljs language-",highlight:(code,language)=>core.Z.highlight(code,{language:LANGS.includes(language)?language:"default"}).value}));_marked.use({gfm:!0,breaks:!0,renderer:{code:(code,infostring="")=>`<pre class="hljs language-${infostring}"><code>${code}</code><button onclick='navigator.clipboard.writeText(this.previousSibling.innerText)' class="hljs-copy"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z" /></svg></button></pre>`},hooks:{postprocess:source=>purify.sanitize(source)}});const marked=_marked,AxMdx=({text,className,...rest})=>{const[mdtext,setMdtext]=(0,react.useState)("");return(0,react.useEffect)((()=>{const parsed=text?marked.parse(text.replaceAll(":::","!!! ")):"";Promise.resolve(parsed).then(setMdtext)}),[text]),(0,jsx_runtime.jsx)("div",{className:`markdown-body ${className??""}`,dangerouslySetInnerHTML:{__html:mdtext}})};try{AxMdx.displayName="AxMdx",AxMdx.__docgenInfo={description:"",displayName:"AxMdx",props:{text:{defaultValue:null,description:"",name:"text",required:!0,type:{name:"string"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/mdx/Mdx.tsx#AxMdx"]={docgenInfo:AxMdx.__docgenInfo,name:"AxMdx",path:"packages/editors/src/mdx/Mdx.tsx#AxMdx"})}catch(__react_docgen_typescript_loader_error){}var MDXEditor=__webpack_require__("./node_modules/@mdxeditor/editor/dist/MDXEditor.js"),headings=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/headings/index.js"),lists=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/lists/index.js"),quote=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/quote/index.js"),table=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/table/index.js"),thematic_break=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/thematic-break/index.js"),plugins_link=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/link/index.js"),codeblock=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/codeblock/index.js"),link_dialog=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/link-dialog/index.js"),codemirror=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/codemirror/index.js"),CodeMirrorEditor=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/codemirror/CodeMirrorEditor.js"),directives=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/directives/index.js"),AdmonitionDirectiveDescriptor=__webpack_require__("./node_modules/@mdxeditor/editor/dist/directive-editors/AdmonitionDirectiveDescriptor.js"),toolbar=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/index.js"),primitives_toolbar=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/primitives/toolbar.js"),ChangeCodeMirrorLanguage=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/ChangeCodeMirrorLanguage.js"),UndoRedo=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/UndoRedo.js"),BoldItalicUnderlineToggles=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/BoldItalicUnderlineToggles.js"),CodeToggle=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/CodeToggle.js"),ListsToggle=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/ListsToggle.js"),BlockTypeSelect=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/BlockTypeSelect.js"),CreateLink=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/CreateLink.js"),InsertTable=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/InsertTable.js"),InsertThematicBreak=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/InsertThematicBreak.js"),InsertCodeBlock=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/InsertCodeBlock.js"),ChangeAdmonitionType=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/ChangeAdmonitionType.js"),InsertAdmonition=__webpack_require__("./node_modules/@mdxeditor/editor/dist/plugins/toolbar/components/InsertAdmonition.js");__webpack_require__("./node_modules/@mdxeditor/editor/dist/style.css");const AxMdxEditor=({value:_value,onChange})=>{const isDark=(0,dist.F5)(),[showPreview,setShowPreview]=(0,react.useState)(!1),[actualValue,setActualValue]=(0,react.useState)(_value),value=(0,react.useDeferredValue)(_value);(0,react.useEffect)((()=>{setActualValue(value??"")}),[value]);const handleChange=(0,react.useCallback)((val=>{setActualValue(val.replaceAll("\\:",":")),onChange?.(val.replaceAll("\\:",":"))}),[onChange]);return showPreview?(0,jsx_runtime.jsxs)(dist.zb,{children:[(0,jsx_runtime.jsxs)(dist.Q6,{className:"py-1 px-2",children:[(0,jsx_runtime.jsx)("div",{className:"flex-1"}),(0,jsx_runtime.jsx)(dist.oG,{icon:"mdi mdi-close",className:"self-center",onClick:()=>setShowPreview(!1),variant:"link",size:"sm"})]}),(0,jsx_runtime.jsx)(dist.aW,{children:(0,jsx_runtime.jsx)(AxMdx,{text:actualValue??""})})]}):(0,jsx_runtime.jsx)(MDXEditor.P,{className:"mdx-editor "+(isDark?"dark-theme":"light-theme"),markdown:actualValue??"",onChange:handleChange,contentEditableClassName:"markdown-body",plugins:[(0,headings.bB)(),(0,lists.df)(),(0,quote.q)(),(0,table.zf)(),(0,thematic_break.nz)(),(0,plugins_link.a)(),(0,codeblock.u9)(),(0,link_dialog.w)(),(0,codemirror.AX)({codeBlockLanguages:{js:"JavaScript",ts:"TypeScript",tsx:"TypeScript (React)",jsx:"JavaScript (React)",css:"CSS",html:"HTML",bash:"Bash",json:"JSON",yaml:"YAML"}}),(0,codeblock.u9)({defaultCodeBlockLanguage:"js",codeBlockEditorDescriptors:[{match:()=>!0,priority:0,Editor:CodeMirrorEditor.s}]}),(0,directives.we)({directiveDescriptors:[AdmonitionDirectiveDescriptor.Q]}),(0,toolbar.N2)({toolbarContents:()=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(primitives_toolbar.bu,{options:[{when:editor=>"codeblock"===editor?.editorType,contents:()=>(0,jsx_runtime.jsx)(ChangeCodeMirrorLanguage.w,{})},{fallback:()=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(UndoRedo.Q,{}),(0,jsx_runtime.jsx)(primitives_toolbar.Z0,{}),(0,jsx_runtime.jsx)(BoldItalicUnderlineToggles.$,{}),(0,jsx_runtime.jsx)(CodeToggle.K,{}),(0,jsx_runtime.jsx)(primitives_toolbar.Z0,{}),(0,jsx_runtime.jsx)(ListsToggle.s,{}),(0,jsx_runtime.jsx)(primitives_toolbar.Z0,{}),(0,jsx_runtime.jsx)(BlockTypeSelect.I,{}),(0,jsx_runtime.jsx)(primitives_toolbar.Z0,{}),(0,jsx_runtime.jsx)(CreateLink.c,{}),(0,jsx_runtime.jsx)(InsertTable.c,{}),(0,jsx_runtime.jsx)(InsertThematicBreak.c,{}),(0,jsx_runtime.jsx)(primitives_toolbar.Z0,{}),(0,jsx_runtime.jsx)(InsertCodeBlock.j,{}),(0,jsx_runtime.jsx)(primitives_toolbar.bu,{options:[{when:editor=>"directive"===editor?.rootNode?.getType()&&["note","tip","info","danger","caution"].includes(editor.rootNode.getMdastNode()?.name),contents:()=>(0,jsx_runtime.jsx)(ChangeAdmonitionType.i,{})},{fallback:()=>(0,jsx_runtime.jsx)(InsertAdmonition.v,{})}]})]})}]}),(0,jsx_runtime.jsx)(dist.oG,{icon:"mdi mdi-eye",className:"m-0 self-center",onClick:()=>setShowPreview(!0),variant:"link",size:"sm"})]})})]})};try{AxMdxEditor.displayName="AxMdxEditor",AxMdxEditor.__docgenInfo={description:"",displayName:"AxMdxEditor",props:{value:{defaultValue:null,description:"code string",name:"value",required:!1,type:{name:"string"}},onChange:{defaultValue:null,description:"onChange callback",name:"onChange",required:!1,type:{name:"((value: string) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/editors/src/mdx/MdxEditor.tsx#AxMdxEditor"]={docgenInfo:AxMdxEditor.__docgenInfo,name:"AxMdxEditor",path:"packages/editors/src/mdx/MdxEditor.tsx#AxMdxEditor"})}catch(__react_docgen_typescript_loader_error){}}}]);