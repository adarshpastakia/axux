"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[66424],{"./node_modules/@arcgis/core/chunks/boundedPlane.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{a:()=>W,c:()=>Z,g:()=>$,h:()=>as,u:()=>J});__webpack_require__("./node_modules/@arcgis/core/core/has.js");var _core_Logger_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),_core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/core/ObjectStack.js"),_mat4_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4.js"),_mat4f64_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/chunks/mat4f64.js"),_vec3_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3.js"),_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3f64.js"),_geometry_support_Axis_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/Axis.js"),_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/lineSegment.js"),_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/plane.js"),_geometry_support_ray_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/ray.js"),_geometry_support_vector_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vector.js"),_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vectorStacks.js");const U=_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__.c.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");const G=class z{constructor(){this.plane=(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.Su)(),this.origin=(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.c)(),this.basis1=(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.c)(),this.basis2=(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.c)()}};function W(s=Ns){return{plane:(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.Su)(s.plane),origin:(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.g)(s.origin),basis1:(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.g)(s.basis1),basis2:(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.g)(s.basis2)}}function Z(s,t=W()){return H(s.origin,s.basis1,s.basis2,t)}function H(s,t,i,n=W()){return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(n.origin,s),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(n.basis1,t),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(n.basis2,i),J(n),function Ps(s,t){Math.abs((0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.j)(s.basis1,s.basis2)/((0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.l)(s.basis1)*(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.l)(s.basis2)))>1e-6&&U.warn(t,"Provided basis vectors are not perpendicular"),Math.abs((0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.j)(s.basis1,ds(s)))>1e-6&&U.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.j)(ds(s),s.origin)-s.plane[3])>1e-6&&U.warn(t,"Plane offset is not consistent with plane origin")}(n,"fromValues()"),n}function J(s){(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.QJ)(s.basis2,s.basis1,s.origin,s.plane)}function K(s,t,i){s!==i&&Z(s,i);const n=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.i)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get(),ds(s),t);return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.g)(i.origin,i.origin,n),i.plane[3]-=t,i}function $(s,t=W()){const i=(s[2]-s[0])/2,n=(s[3]-s[1])/2;return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.s)(t.origin,s[0]+i,s[1]+n,0),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.s)(t.basis1,i,0,0),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.s)(t.basis2,0,n,0),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.WK)(0,0,1,0,t.plane),t}function ss(s,t,i){return!!(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__._y)(s.plane,t,i)&&js(s,i)}function is(s,i,n){const o=ws.get();vs(s,i,o,ws.get());let r=Number.POSITIVE_INFINITY;for(const e of As){const c=ys(s,e,Ms.get()),u=_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get();if((0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.K)(o,c,u)){const s=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.C)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get(),i.origin,u),o=Math.abs((0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_2__.Uj)((0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.j)(i.direction,s)));o<r&&(r=o,(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(n,u))}}return r===Number.POSITIVE_INFINITY?ns(s,i,n):n}function ns(s,t,i){if(ss(s,t,i))return i;const n=ws.get(),o=ws.get();vs(s,t,n,o);let r=Number.POSITIVE_INFINITY;for(const e of As){const c=ys(s,e,Ms.get()),u=_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get();if((0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.ET)(n,c,u)){const s=(0,_geometry_support_ray_js__WEBPACK_IMPORTED_MODULE_10__.Ed)(t,u);if(!(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.Mv)(o,u))continue;s<r&&(r=s,(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(i,u))}}return es(s,t.origin)<r&&os(s,t.origin,i),i}function os(s,t,i){const n=(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.C_)(s.plane,t,_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get()),o=(0,_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_8__.g3)(Is(s,s.basis1),n,-1,1,_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get()),r=(0,_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_8__.g3)(Is(s,s.basis2),n,-1,1,_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get());return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.f)(i,(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.g)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get(),o,r),s.origin),i}function rs(s,t,i){const{origin:n,basis1:o,basis2:r}=s,e=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.f)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get(),t,n),a=(0,_geometry_support_vector_js__WEBPACK_IMPORTED_MODULE_11__.G8)(o,e),c=(0,_geometry_support_vector_js__WEBPACK_IMPORTED_MODULE_11__.G8)(r,e),u=(0,_geometry_support_vector_js__WEBPACK_IMPORTED_MODULE_11__.G8)(ds(s),e);return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.s)(i,a,c,u)}function es(s,t){const i=rs(s,t,_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get()),{basis1:n,basis2:o}=s,r=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.l)(n),e=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.l)(o),a=Math.max(Math.abs(i[0])-r,0),c=Math.max(Math.abs(i[1])-e,0),u=i[2];return a*a+c*c+u*u}function as(s,t){return Math.sqrt(es(s,t))}function bs(s,t){const i=-s.plane[3];return(0,_geometry_support_vector_js__WEBPACK_IMPORTED_MODULE_11__.G8)(ds(s),t)-i}function ds(s){return(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.i4)(s.plane)}function js(s,t){const i=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.f)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get(),t,s.origin),n=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.m)(s.basis1),o=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.m)(s.basis2),r=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.j)(s.basis1,i),e=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.j)(s.basis2,i);return-r-n<0&&r-n<0&&-e-o<0&&e-o<0}function Is(s,t){const i=Ms.get();return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(i.origin,s.origin),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(i.vector,t),i}function ys(s,t,i){const{basis1:n,basis2:o,origin:r}=s,e=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.i)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get(),n,t.origin[0]),a=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.i)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get(),o,t.origin[1]);(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.g)(i.origin,e,a),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.g)(i.origin,i.origin,r);const g=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.i)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get(),n,t.direction[0]),b=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.i)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get(),o,t.direction[1]);return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.i)(i.vector,(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.g)(g,g,b),2),i}function vs(s,t,i,n){const o=ds(s);(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.QJ)(o,t.direction,t.origin,i),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.QJ)((0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.i4)(i),o,t.origin,n)}const Ns={plane:(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.Su)(),origin:(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.f)(0,0,0),basis1:(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.f)(1,0,0),basis2:(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.f)(0,1,0)},ws=new _core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_13__.o(_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.Su),Ms=new _core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_13__.o(_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_8__.Su),Ss=(0,_vec3f64_js__WEBPACK_IMPORTED_MODULE_6__.c)(),Ts=new _core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_13__.o((()=>W())),As=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],xs=(0,_mat4f64_js__WEBPACK_IMPORTED_MODULE_4__.a)(),Vs=(0,_mat4f64_js__WEBPACK_IMPORTED_MODULE_4__.a)();Object.freeze(Object.defineProperty({__proto__:null,BoundedPlaneClass:G,altitudeAt:bs,axisAt:function gs(s,t,i,n){return function hs(s,t,i){switch(t){case _geometry_support_Axis_js__WEBPACK_IMPORTED_MODULE_7__.k.X:(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(i,s.basis1),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.n)(i,i);break;case _geometry_support_Axis_js__WEBPACK_IMPORTED_MODULE_7__.k.Y:(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(i,s.basis2),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.n)(i,i);break;case _geometry_support_Axis_js__WEBPACK_IMPORTED_MODULE_7__.k.Z:(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(i,ds(s))}return i}(s,i,n)},closestPoint:ns,closestPointOnSilhouette:is,copy:Z,copyWithoutVerify:function D(s,t){(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(t.origin,s.origin),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(t.basis1,s.basis1),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.c)(t.basis2,s.basis2),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.kT)(t.plane,s.plane)},create:W,distance:as,distance2:es,distanceToSilhouette:function cs(s,t){let i=Number.NEGATIVE_INFINITY;for(const n of As){const o=ys(s,n,Ms.get()),r=(0,_geometry_support_lineSegment_js__WEBPACK_IMPORTED_MODULE_8__.Ed)(o,t);r>i&&(i=r)}return Math.sqrt(i)},elevate:K,equals:function ps(s,t){return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.h)(s.basis1,t.basis1)&&(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.h)(s.basis2,t.basis2)&&(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.h)(s.origin,t.origin)},extrusionContainsPoint:function us(s,t){return(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.Mv)(s.plane,t)&&js(s,t)},fromAABoundingRect:$,fromValues:H,intersectRay:ss,intersectRayClosestSilhouette:function ts(s,t,i){if(ss(s,t,i))return i;const n=is(s,t,_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get());return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.g)(i,t.origin,(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.i)(_geometry_support_vectorStacks_js__WEBPACK_IMPORTED_MODULE_12__.Wq.get(),t.direction,(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.o)(t.origin,n)/(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.l)(t.direction))),i},normal:ds,projectPoint:os,projectPointLocal:rs,rotate:function ms(s,t,i,n){return s!==n&&Z(s,n),(0,_mat4_js__WEBPACK_IMPORTED_MODULE_3__.c)(Vs,t,i),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.e)(n.basis1,s.basis1,Vs),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.e)(n.basis2,s.basis2,Vs),J(n),n},setAltitudeAt:function fs(s,t,i,n){const o=bs(s,t),r=(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.i)(Ss,ds(s),i-o);return(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.g)(n,t,r),n},setExtent:function Q(s,t,i){return $(t,i),K(i,bs(s,s.origin),i),i},transform:function ls(s,t,i){return s!==i&&Z(s,i),(0,_mat4_js__WEBPACK_IMPORTED_MODULE_3__.i)(xs,t),(0,_mat4_js__WEBPACK_IMPORTED_MODULE_3__.t)(xs,xs),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.e)(i.basis1,s.basis1,xs),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.e)(i.basis2,s.basis2,xs),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.e)((0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.i4)(i.plane),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.i4)(s.plane),xs),(0,_vec3_js__WEBPACK_IMPORTED_MODULE_5__.e)(i.origin,s.origin,t),(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.uY)(i.plane,i.plane,i.origin),i},up:Ns,updateUnboundedPlane:J,wrap:function X(s,t,i){const n=Ts.get();return n.origin=s,n.basis1=t,n.basis2=i,n.plane=(0,_geometry_support_plane_js__WEBPACK_IMPORTED_MODULE_9__.em)(0,0,0,0),J(n),n}},Symbol.toStringTag,{value:"Module"}))},"./node_modules/@arcgis/core/core/memoize.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function t(t){let r,e,i=[],u=!1;return function f(...f){return u&&r===this&&function n(t,n){if(t.length!==n.length)return!1;for(let r=0;r<t.length;++r)if(t[r]!==n[r])return!1;return!0}(f,i)||(e=t.apply(this,f),r=this,i=f,u=!0),e}}__webpack_require__.d(__webpack_exports__,{s:()=>t})},"./node_modules/@arcgis/core/core/workers/WorkerHandle.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>h});var _arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),_handleUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/handleUtils.js"),_Logger_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_workers_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/workers/workers.js");class h{constructor(e,t,r,h,o={}){this._mainMethod=t,this._transferLists=r,this._listeners=[],this._promise=(0,_workers_js__WEBPACK_IMPORTED_MODULE_4__.eU)(e,{...o,schedule:h}).then((e=>{if(void 0===this._thread){this._thread=e,this._promise=null,o.hasInitialize&&this.broadcast({},"initialize");for(const e of this._listeners)this._connectListener(e)}else e.close()})),this._promise.catch((t=>_Logger_js__WEBPACK_IMPORTED_MODULE_2__.c.getLogger("esri.core.workers.WorkerHandle").error(`Failed to initialize ${e} worker: ${t}`)))}on(s,r){const i={removed:!1,eventName:s,callback:r,threadHandle:null};return this._listeners.push(i),this._connectListener(i),(0,_handleUtils_js__WEBPACK_IMPORTED_MODULE_1__.uU)((()=>{i.removed=!0,(0,_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__.aE)(this._listeners,i),this._thread&&null!=i.threadHandle&&i.threadHandle.remove()}))}destroy(){this._thread&&(this._thread.close(),this._thread=null),this._promise=null,this._listeners.length=0,this._transferLists={}}invoke(e,t){return this.invokeMethod(this._mainMethod,e,t)}invokeMethod(e,t,s){if(this._thread){const r=this._transferLists[e],i=r?r(t):[];return this._thread.invoke(e,t,{transferList:i,signal:s})}return this._promise?this._promise.then((()=>((0,_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.wp)(s),this.invokeMethod(e,t,s)))):Promise.reject(null)}broadcast(e,t){return this._thread?Promise.all(this._thread.broadcast(t,e)).then((()=>{})):this._promise?this._promise.then((()=>this.broadcast(e,t))):Promise.reject()}get promise(){return this._promise}_connectListener(e){this._thread&&this._thread.on(e.eventName,e.callback).then((t=>{e.removed||(e.threadHandle=t)}))}}},"./node_modules/@arcgis/core/geometry/support/lineSegment.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C_:()=>l,Ed:()=>M,KO:()=>A,Su:()=>v,WK:()=>h,Yf:()=>B,_W:()=>k,g3:()=>d,i_:()=>b,kT:()=>p});var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),_core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/ObjectStack.js"),_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3.js"),_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3f64.js"),_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/vectorStacks.js");function v(t){return t?{origin:(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.g)(t.origin),vector:(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.g)(t.vector)}:{origin:(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.c)(),vector:(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.c)()}}function p(t,r=v()){return h(t.origin,t.vector,r)}function h(t,r,o=v()){return(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.c)(o.origin,t),(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.c)(o.vector,r),o}function b(t,r,i=v()){return(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.c)(i.origin,t),(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.f)(i.vector,r,t),i}function M(r,n){const c=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.f)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get(),n,r.origin),s=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.j)(r.vector,c),u=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.j)(r.vector,r.vector),a=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.qk)(s/u,0,1),g=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.f)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get(),(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.i)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get(),r.vector,a),c);return(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.j)(g,g)}function l(t,r,n){return d(t,r,0,1,n)}function A(t,r,n){return(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.g)(n,t.origin,(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.i)(n,t.vector,r))}function d(r,n,u,a,g){const{vector:v,origin:m}=r,p=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.f)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get(),n,m),h=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.j)(v,p)/(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.m)(v);return(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.i)(g,v,(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.qk)(h,u,a)),(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.g)(g,g,r.origin)}function B(t,r){if(q(t,function m(t,r){const n=x.get();return n.origin=t,n.vector=r,n}(r.origin,r.direction),!1,w)){const{tA:r,pB:n,distance2:o}=w;if(r>=0&&r<=1)return o;if(r<0)return(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.a)(t.origin,n);if(r>1)return(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.a)((0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.g)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get(),t.origin,t.vector),n)}return null}function k(t,r,o){return!!q(t,r,!0,w)&&((0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.c)(o,w.pA),!0)}function q(r,n,o,i){const e=1e-6,s=r.origin,a=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.g)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get(),s,r.vector),g=n.origin,v=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.g)(_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get(),g,n.vector),m=_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get(),p=_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get();if(m[0]=s[0]-g[0],m[1]=s[1]-g[1],m[2]=s[2]-g[2],p[0]=v[0]-g[0],p[1]=v[1]-g[1],p[2]=v[2]-g[2],Math.abs(p[0])<e&&Math.abs(p[1])<e&&Math.abs(p[2])<e)return!1;const h=_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get();if(h[0]=a[0]-s[0],h[1]=a[1]-s[1],h[2]=a[2]-s[2],Math.abs(h[0])<e&&Math.abs(h[1])<e&&Math.abs(h[2])<e)return!1;const b=m[0]*p[0]+m[1]*p[1]+m[2]*p[2],M=p[0]*h[0]+p[1]*h[1]+p[2]*h[2],j=m[0]*h[0]+m[1]*h[1]+m[2]*h[2],l=p[0]*p[0]+p[1]*p[1]+p[2]*p[2],A=(h[0]*h[0]+h[1]*h[1]+h[2]*h[2])*l-M*M;if(Math.abs(A)<e)return!1;let d=(b*M-j*l)/A,B=(b+M*d)/l;o&&(d=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.qk)(d,0,1),B=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_0__.qk)(B,0,1));const k=_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get(),S=_vectorStacks_js__WEBPACK_IMPORTED_MODULE_3__.Wq.get();return k[0]=s[0]+d*h[0],k[1]=s[1]+d*h[1],k[2]=s[2]+d*h[2],S[0]=g[0]+B*p[0],S[1]=g[1]+B*p[1],S[2]=g[2]+B*p[2],i.tA=d,i.tB=B,i.pA=k,i.pB=S,i.distance2=(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_1__.a)(k,S),!0}const w={tA:0,tB:0,pA:(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.c)(),pB:(0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_2__.c)(),distance2:0},x=new _core_ObjectStack_js__WEBPACK_IMPORTED_MODULE_4__.o((()=>v()))},"./node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{y:()=>r});var _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/constraints.js"),_FeatureSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/FeatureSnappingCandidate.js"),_hints_PointSnappingHint_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/PointSnappingHint.js");class r extends _FeatureSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_1__.e{constructor(n){super({...n,constraint:new _sketch_constraints_js__WEBPACK_IMPORTED_MODULE_0__.gD(n.targetPoint)})}get hints(){return[new _hints_PointSnappingHint_js__WEBPACK_IMPORTED_MODULE_2__.O(this.targetPoint,this.isDraped,this.domain)]}}},"./node_modules/@arcgis/core/views/interactive/snapping/featureSources/FeatureServiceSnappingSource.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FeatureServiceSnappingSource:()=>F});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Accessor=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),asyncUtils=__webpack_require__("./node_modules/@arcgis/core/core/asyncUtils.js"),handleUtils=__webpack_require__("./node_modules/@arcgis/core/core/handleUtils.js"),memoize=__webpack_require__("./node_modules/@arcgis/core/core/memoize.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),arrayUtils=(__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js")),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),UpdatingHandles=__webpack_require__("./node_modules/@arcgis/core/core/support/UpdatingHandles.js"),layerUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/layerUtils.js"),elevationInfoUtils=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js"),TileKey=__webpack_require__("./node_modules/@arcgis/core/layers/support/TileKey.js"),vec3=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3.js"),vec4f64=__webpack_require__("./node_modules/@arcgis/core/chunks/vec4f64.js"),boundedPlane=__webpack_require__("./node_modules/@arcgis/core/chunks/boundedPlane.js");function c(n,o){return(0,boundedPlane.g)(o.extent,tileUtils_e),(0,boundedPlane.h)(tileUtils_e,(0,vec3.s)(a,n.x,n.y,0))}const tileUtils_e=(0,boundedPlane.a)(),a=(0,vec4f64.c)();var layerViewUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/layerViewUtils.js");let p=class extends Accessor.c{get tiles(){const e=this.tilesCoveringView,t=null!=this.pointOfInterest?this.pointOfInterest:this.view.center;return e.sort(((e,r)=>c(t,e)-c(t,r))),e}_scaleEnabled(){return(0,layerViewUtils.EB)(this.view.scale,this.layer.minScale||0,this.layer.maxScale||0)}get tilesCoveringView(){if(!this.view.ready||!this.view.featuresTilingScheme||!this.view.state||null==this.tileInfo)return[];if(!this._scaleEnabled)return[];const{spans:e,lodInfo:t}=this.view.featuresTilingScheme.getTileCoverage(this.view.state,0),{level:r}=t,i=[];for(const{row:o,colFrom:s,colTo:n}of e)for(let e=s;e<=n;e++){const s=t.normalizeCol(e),n=new TileKey.g(null,r,o,s);this.tileInfo.updateTileInfo(n),i.push(n)}return i}get tileInfo(){return this.view.featuresTilingScheme?.tileInfo??null}get tileSize(){return null!=this.tileInfo?this.tileInfo.size[0]:256}constructor(e){super(e),this.pointOfInterest=null}initialize(){this.addHandles((0,reactiveUtils.aE)((()=>this.view?.state?.viewpoint),(()=>this.notifyChange("tilesCoveringView")),reactiveUtils.du))}};(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],p.prototype,"tiles",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],p.prototype,"_scaleEnabled",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],p.prototype,"tilesCoveringView",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],p.prototype,"tileInfo",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],p.prototype,"tileSize",null),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],p.prototype,"view",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],p.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.qq)()],p.prototype,"pointOfInterest",void 0),p=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles2D")],p);var s,aaBoundingRect=__webpack_require__("./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js");!function(i){i[i.INVISIBLE=0]="INVISIBLE",i[i.VISIBLE_WHEN_EXTENDED=1]="VISIBLE_WHEN_EXTENDED",i[i.VISIBLE_ON_SURFACE=2]="VISIBLE_ON_SURFACE"}(s||(s={}));let FeatureServiceTiles3D_p=class extends Accessor.c{get tiles(){const e=this.tilesCoveringView,t=this._effectivePointOfInterest;if(null!=t){const r=e.map((e=>c(t,e)));for(let i=1;i<r.length;i++)if(r[i-1]>r[i])return e.sort(((e,r)=>c(t,e)-c(t,r))),e.slice()}return e}get tilesCoveringView(){return this._filterTiles(this.view.featureTiles?.tiles?.toArray()).map(u)}get tileInfo(){return this.view.featureTiles?.tilingScheme.toTileInfo()??null}get tileSize(){return this.view.featureTiles?.tileSize??256}get _effectivePointOfInterest(){const e=this.pointOfInterest;return null!=e?e:this.view.pointsOfInterest?.focus.location}constructor(e){super(e),this.pointOfInterest=null}initialize(){this.addHandles((0,reactiveUtils.aE)((()=>this.view.featureTiles),(e=>{this.removeHandles(f),e&&this.addHandles(e.addClient(),f)}),reactiveUtils._8))}_filterTiles(e){return null==e?[]:e.filter((e=>Math.abs(e.measures.screenRect[3]-e.measures.screenRect[1])>FeatureServiceTiles3D_a&&e.measures.visibility===s.VISIBLE_ON_SURFACE))}};function u({lij:[e,t,r],extent:i}){return new TileKey.g(`${e}/${t}/${r}`,e,t,r,i)}(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],FeatureServiceTiles3D_p.prototype,"tiles",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],FeatureServiceTiles3D_p.prototype,"tilesCoveringView",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],FeatureServiceTiles3D_p.prototype,"tileInfo",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],FeatureServiceTiles3D_p.prototype,"tileSize",null),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],FeatureServiceTiles3D_p.prototype,"view",void 0),(0,tslib_es6._)([(0,property.qq)()],FeatureServiceTiles3D_p.prototype,"pointOfInterest",void 0),(0,tslib_es6._)([(0,property.qq)()],FeatureServiceTiles3D_p.prototype,"_effectivePointOfInterest",null),FeatureServiceTiles3D_p=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiles3D")],FeatureServiceTiles3D_p);const FeatureServiceTiles3D_a=50,f="feature-tiles";var snappingUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/snappingUtils.js"),queryEngineUtils=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/featureSources/queryEngineUtils.js"),Polygon=__webpack_require__("./node_modules/@arcgis/core/geometry/Polygon.js"),Color=__webpack_require__("./node_modules/@arcgis/core/Color.js"),Graphic=__webpack_require__("./node_modules/@arcgis/core/Graphic.js"),Collection=(__webpack_require__("./node_modules/@arcgis/core/symbols.js"),__webpack_require__("./node_modules/@arcgis/core/core/Collection.js")),mathUtils=__webpack_require__("./node_modules/@arcgis/core/core/mathUtils.js"),PointSymbol3D=__webpack_require__("./node_modules/@arcgis/core/symbols/PointSymbol3D.js"),SimpleFillSymbol=__webpack_require__("./node_modules/@arcgis/core/symbols/SimpleFillSymbol.js"),TextSymbol=__webpack_require__("./node_modules/@arcgis/core/symbols/TextSymbol.js"),TextSymbol3DLayer=__webpack_require__("./node_modules/@arcgis/core/symbols/TextSymbol3DLayer.js"),Symbol3DVerticalOffset=__webpack_require__("./node_modules/@arcgis/core/symbols/support/Symbol3DVerticalOffset.js"),LineCallout3D=__webpack_require__("./node_modules/@arcgis/core/symbols/callouts/LineCallout3D.js"),LineCallout3DBorder=__webpack_require__("./node_modules/@arcgis/core/symbols/callouts/LineCallout3DBorder.js");const TileTreeDebugger_u=[[0,179,255],[117,62,128],[0,104,255],[215,189,166],[32,0,193],[98,162,206],[102,112,129],[52,125,0],[142,118,246],[138,83,0],[92,122,255],[122,55,83],[0,142,255],[81,40,179],[0,200,244],[13,24,127],[0,170,147],[19,58,241],[22,44,35]];let d=class extends Accessor.c{constructor(e){super(e),this.updating=!1,this.enablePolygons=!0,this.enableLabels=!0,this._polygons=new Map,this._labels=new Map,this._enabled=!0}initialize(){this._symbols=TileTreeDebugger_u.map((e=>new SimpleFillSymbol.c({color:[e[0],e[1],e[2],.6],outline:{color:"black",width:1}}))),this.update()}destroy(){this._enabled=!1,this.clear()}get enabled(){return this._enabled}set enabled(e){this._enabled!==e&&(this._enabled=e,this.update())}update(){if(!this._enabled)return void this.clear();const t=this.getTiles(),i=new Array,a=new Set((this._labels.size,this._labels.keys()));t.forEach(((m,u)=>{const d=m.lij.toString();a.delete(d);const g=m.lij[0],f=m.geometry;if(this.enablePolygons&&!this._polygons.has(d)){const e=new Graphic.c({geometry:f,symbol:this._symbols[g%this._symbols.length]});this._polygons.set(d,e),i.push(e)}if(this.enableLabels){const a=(e=>{if(null!=e.label)return e.label;let s=e.lij.toString();return null!=e.loadPriority&&(s+=` (${e.loadPriority})`),s})(m),g=u/(t.length-1),w=(0,mathUtils.Cq)(0,200,g),_=(0,mathUtils.Cq)(20,6,g)/.75,j=null!=m.loadPriority&&m.loadPriority>=t.length,v=new Color.c([w,j?0:w,j?0:w]),S="3d"===this.view.type?()=>new PointSymbol3D.c({verticalOffset:new Symbol3DVerticalOffset.c({screenLength:40/.75}),callout:new LineCallout3D.c({color:new Color.c("white"),border:new LineCallout3DBorder.c({color:new Color.c("black")})}),symbolLayers:new Collection.c([new TextSymbol3DLayer.c({text:a,halo:{color:"white",size:1/.75},material:{color:v},size:_})])}):()=>new TextSymbol.c({text:a,haloColor:"white",haloSize:1/.75,color:v,size:_}),x=this._labels.get(d);if(x){const e=S();null!=x.symbol&&JSON.stringify(e)===JSON.stringify(x.symbol)||(x.symbol=e)}else{const e=new Graphic.c({geometry:f.extent.center,symbol:S()});this._labels.set(d,e),i.push(e)}}}));const m=new Array;a.forEach((e=>{const s=this._polygons.get(e);null!=s&&(m.push(s),this._polygons.delete(e));const o=this._labels.get(e);null!=o&&(m.push(o),this._labels.delete(e))})),this.view.graphics.removeMany(m),this.view.graphics.addMany(i)}clear(){this.view.graphics.removeMany(Array.from(this._polygons.values())),this.view.graphics.removeMany(Array.from(this._labels.values())),this._polygons.clear(),this._labels.clear()}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],d.prototype,"view",void 0),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],d.prototype,"updating",void 0),(0,tslib_es6._)([(0,property.qq)()],d.prototype,"enabled",null),d=(0,tslib_es6._)([(0,subclass.c)("esri.views.support.TileTreeDebugger")],d);let n=class extends d{constructor(e){super(e)}initialize(){const e=setInterval((()=>this._fetchDebugInfo()),2e3);this.addHandles((0,handleUtils.uU)((()=>clearInterval(e))))}getTiles(){if(!this._debugInfo)return[];const e=new Map,t=new Map;this._debugInfo.storedTiles.forEach((t=>{e.set(t.data.id,t.featureCount)})),this._debugInfo.pendingTiles.forEach((r=>{e.set(r.data.id,r.featureCount),t.set(r.data.id,r.state)}));const r=r=>{const o=t.get(r),s=e.get(r)??"?";return o?`${o}:${s}\n${r}`:`store:${s}\n${r}`},o=new Map;return this._debugInfo.storedTiles.forEach((e=>{o.set(e.data.id,e.data)})),this._debugInfo.pendingTiles.forEach((e=>{o.set(e.data.id,e.data)})),Array.from(o.values()).map((e=>({lij:[e.level,e.row,e.col],geometry:Polygon.c.fromExtent((0,aaBoundingRect.WU)(e.extent,this.view.spatialReference)),label:r(e.id)})))}_fetchDebugInfo(){this.handle.getDebugInfo(null).then((e=>{this._debugInfo=e,this.update()}))}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],n.prototype,"handle",void 0),n=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive.snapping.featureSources.WorkerTileTreeDebugger")],n);var maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),WorkerHandle=__webpack_require__("./node_modules/@arcgis/core/core/workers/WorkerHandle.js"),typeUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/typeUtils.js"),dehydratedPoint=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/dehydratedPoint.js");let h=class extends Accessor.c{get updating(){return this._updatingHandles.updating||this._workerHandleUpdating}constructor(e){super(e),this._updatingHandles=new UpdatingHandles.A,this._suspendController=null,this.schedule=null,this.hasZ=!1,this.elevationAlignPointsInFeatures=async e=>{const t=[];for(const{points:i}of e.pointsInFeatures)for(const{z:e}of i)t.push(e);return{elevations:t,drapedObjectIds:new Set,failedObjectIds:new Set}},this.queryForSymbologySnapping=async()=>({candidates:[],sourceCandidateIndices:[]}),this.availability=0,this._workerHandleUpdating=!0,this._editId=0,this.updateOutFields=(0,promiseUtils.Cu)((async(e,t)=>{await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("updateOutFields",[...e],t)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},t))}))}destroy(){this._suspendController=(0,maybe.K8)(this._suspendController),this._workerHandle.destroy(),this._updatingHandles.destroy()}initialize(){this._workerHandle=new FeatureServiceSnappingSourceWorkerHandle_c(this.schedule,{alignElevation:async(e,{signal:t})=>({result:await this.elevationAlignPointsInFeatures(e.query,t)}),getSymbologyCandidates:async(e,{signal:t})=>({result:await this.queryForSymbologySnapping(e,t)})}),this.addHandles([this._workerHandle.on("notify-updating",(({updating:e})=>this._workerHandleUpdating=e)),this._workerHandle.on("notify-availability",(({availability:e})=>this._set("availability",e)))])}async setup(e,t){const i=this._serviceInfoFromLayer(e.layer);if(null==i)return;const o={configuration:this._convertConfiguration(e.configuration),serviceInfo:i,spatialReference:e.spatialReference.toJSON(),hasZ:this.hasZ,elevationInfo:e.layer.elevationInfo?.toJSON()};await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("setup",o,t)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},t))}async configure(e,t){const i=this._convertConfiguration(e);await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("configure",i,t)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},t))}async refresh(e){await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("refresh",{},e)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},e))}async fetchCandidates(e,t){const{point:i,filter:o,coordinateHelper:n}=e,a={...e,point:(0,dehydratedPoint.A)(i[0],i[1],i[2],n.spatialReference.toJSON()),filter:o?.toJSON()};return this._workerHandle.invoke(a,t)}async updateTiles(e,t){const i={tiles:e.tiles,tileInfo:null!=e.tileInfo?e.tileInfo.toJSON():null,tileSize:e.tileSize};await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("updateTiles",i,t)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},t))}async applyEdits(e,t){const o=this._editId++,n={id:o};await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("beginApplyEdits",n,t));const r=await this._updatingHandles.addPromise((0,promiseUtils.Yv)(e.result,t)),s={id:o,edits:{addedFeatures:r.addedFeatures?.map((({objectId:e})=>e)).filter(arrayUtils.G6)??[],deletedFeatures:r.deletedFeatures?.map((({objectId:e,globalId:t})=>({objectId:e,globalId:t})))??[],updatedFeatures:r.updatedFeatures?.map((({objectId:e})=>e)).filter(arrayUtils.G6)??[]}};await this._updatingHandles.addPromise(this._workerHandle.invokeMethod("endApplyEdits",s,t)),this._updatingHandles.addPromise(this._workerHandle.invokeMethod("whenNotUpdating",{},t))}getDebugInfo(e){return this._workerHandle.invokeMethod("getDebugInfo",{},e)}async notifyElevationSourceChange(){await this._workerHandle.invokeMethod("notifyElevationSourceChange",{})}async notifySymbologyChange(){await this._workerHandle.invokeMethod("notifySymbologyChange",{})}async setSymbologySnappingSupported(e){await this._workerHandle.invokeMethod("setSymbologySnappingSupported",e)}async setSuspended(e){this._suspendController?.abort(),this._suspendController=new AbortController,await this._workerHandle.invokeMethod("setSuspended",e,this._suspendController.signal)}_convertConfiguration(e){return{filter:null!=e.filter?e.filter.toJSON():null,customParameters:e.customParameters,viewType:e.viewType}}_serviceInfoFromLayer(e){return"multipatch"===e.geometryType||"mesh"===e.geometryType?null:{url:e.parsedUrl?.path??"",fieldsIndex:e.fieldsIndex.toJSON(),geometryType:typeUtils.U.toJSON(e.geometryType),capabilities:e.capabilities,objectIdField:e.objectIdField,globalIdField:e.globalIdField,spatialReference:e.spatialReference.toJSON(),timeInfo:e.timeInfo?.toJSON()}}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],h.prototype,"schedule",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],h.prototype,"hasZ",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],h.prototype,"elevationAlignPointsInFeatures",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],h.prototype,"queryForSymbologySnapping",void 0),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],h.prototype,"updating",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],h.prototype,"availability",void 0),(0,tslib_es6._)([(0,property.qq)()],h.prototype,"_workerHandleUpdating",void 0),h=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorkerHandle")],h);class FeatureServiceSnappingSourceWorkerHandle_c extends WorkerHandle.A{constructor(e,t){super("FeatureServiceSnappingSourceWorker","fetchCandidates",{},e,{strategy:"dedicated",client:t})}}var Point=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js"),LOD=__webpack_require__("./node_modules/@arcgis/core/layers/support/LOD.js"),TileInfo=__webpack_require__("./node_modules/@arcgis/core/layers/support/TileInfo.js");let FeatureServiceTilesSimple_a=class extends Accessor.c{get tiles(){return[new TileKey.g("0/0/0",0,0,0,(0,aaBoundingRect.WK)(-1e8,-1e8,1e8,1e8))]}get tileInfo(){return new TileInfo.c({origin:new Point.c({x:-1e8,y:1e8,spatialReference:this.layer.spatialReference}),size:[512,512],lods:[new LOD.c({level:0,scale:1,resolution:390625})],spatialReference:this.layer.spatialReference})}get tileSize(){return this.tileInfo.size[0]}constructor(e){super(e),this.pointOfInterest=null}};(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],FeatureServiceTilesSimple_a.prototype,"tiles",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],FeatureServiceTilesSimple_a.prototype,"tileInfo",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],FeatureServiceTilesSimple_a.prototype,"tileSize",null),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],FeatureServiceTilesSimple_a.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.qq)()],FeatureServiceTilesSimple_a.prototype,"pointOfInterest",void 0),FeatureServiceTilesSimple_a=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTilesSimple")],FeatureServiceTilesSimple_a);var debugFlags=__webpack_require__("./node_modules/@arcgis/core/views/support/debugFlags.js");let F=class extends Accessor.c{get _updateTilesParameters(){return{tiles:this._tilesOfInterest.tiles,tileInfo:this._tilesOfInterest.tileInfo,tileSize:this._tilesOfInterest.tileSize}}get _layerView(){return this.view?.allLayerViews.find((e=>e.layer===this._layer))}get _isSuspended(){return!(!(0,layerUtils.CA)(this._layer)||this._layer.sublayers.find((e=>e.visible)))||!(!this.view||!1===this._layerView?.suspended&&this.layerSource.enabled)}get updating(){return this._workerHandle?.updating||this._updatingHandles.updating}get _outFields(){const{view:e,_layerView:t,layerSource:r}=this,{layer:i}=r,{fieldsIndex:s,timeInfo:o,floorInfo:a,subtypeField:n}=i,l=t&&"filter"in t?t.filter:null,u=l?.where&&"1=1"!==l.where?this._getOrLoadWhereFields(l.where,s):[];if(l?.timeExtent&&o){const{startField:e,endField:t}=o,r=s.get(e)?.name??e,i=s.get(t)?.name??t;r&&u.push(r),i&&u.push(i)}if(e?.map&&(0,snappingUtils.Sq)(e.map)&&e.map.utilityNetworks?.find((e=>e.isUtilityLayer(i)))){const e=i.fieldsIndex.get("assetGroup")?.name,t=i.fieldsIndex.get("assetType")?.name;e&&t&&(u.push(e),u.push(t))}if(i&&a?.floorField&&e?.floors?.length){const e=s.get(a.floorField)?.name??a.floorField;e&&u.push(e)}if(n){const e=s.get(n)?.name??n;e&&u.push(e)}return new Set(u)}get configuration(){const{view:e}=this,t=null!=e?e.type:"2d";return{filter:this._layer.createQuery(),customParameters:this._layer.customParameters,viewType:t}}get availability(){return this._workerHandle?.availability??0}get _layer(){return this.layerSource.layer}constructor(e){super(e),this._updatingHandles=new UpdatingHandles.A,this._workerHandle=null,this._debug=null,this._memoizedMakeGetGroundElevation=(0,memoize.s)(queryEngineUtils.w)}initialize(){let e;const t=this.view;if(null!=t)switch(t.type){case"2d":this._tilesOfInterest=new p({view:t,layer:this._layer}),e=this._workerHandle=new h;break;case"3d":{const{resourceController:r}=t,i=this._layer;this._tilesOfInterest=new FeatureServiceTiles3D_p({view:t}),e=this._workerHandle=new h({schedule:e=>r.immediate.schedule(e),hasZ:this._layer.hasZ&&(this._layer.returnZ??!0),elevationAlignPointsInFeatures:async(e,r)=>{const s=await t.whenLayerView(i);return(0,promiseUtils.wp)(r),s.elevationAlignPointsInFeatures(e,r)},queryForSymbologySnapping:async(e,r)=>{const s=await t.whenLayerView(i);return(0,promiseUtils.wp)(r),s.queryForSymbologySnapping(e,r)}}),this.addHandles([t.elevationProvider.on("elevation-change",(({context:t})=>{const{elevationInfo:r}=i;(0,elevationInfoUtils.Mr)(t,r)&&(0,promiseUtils.jO)(e.notifyElevationSourceChange())})),(0,reactiveUtils.aE)((()=>i.elevationInfo),(()=>(0,promiseUtils.jO)(e.notifyElevationSourceChange())),reactiveUtils._8),(0,reactiveUtils.aE)((()=>this._layerView?.processor?.renderer),(()=>(0,promiseUtils.jO)(e.notifySymbologyChange())),reactiveUtils._8),(0,reactiveUtils.aE)((()=>this._layerView?.symbologySnappingSupported??!1),(t=>(0,promiseUtils.jO)(e.setSymbologySnappingSupported(t))),reactiveUtils._8),(0,reactiveUtils.on)((()=>this._layerView?.layer),["edits","apply-edits","graphic-update"],(()=>e.notifySymbologyChange()))]);break}}else this._tilesOfInterest=new FeatureServiceTilesSimple_a({layer:this._layer}),e=this._workerHandle=new h;this.addHandles([(0,handleUtils.sX)(e)]),(0,promiseUtils.jO)(e.setup({layer:this._layer,spatialReference:this.spatialReference,configuration:this.configuration},null)),this._updatingHandles.add((()=>this._updateTilesParameters),(()=>(0,promiseUtils.jO)(e.updateTiles(this._updateTilesParameters,null))),reactiveUtils._8),this.addHandles([(0,reactiveUtils.aE)((()=>this.configuration),(t=>(0,promiseUtils.jO)(e.configure(t,null))),reactiveUtils.du),(0,reactiveUtils.aE)((()=>this._outFields),(t=>(0,promiseUtils.jO)(e.updateOutFields(t))),reactiveUtils._8),(0,reactiveUtils.aE)((()=>this._isSuspended),(t=>(0,promiseUtils.jO)(e.setSuspended(t))),reactiveUtils.KG)]),null!=t&&this.addHandles((0,reactiveUtils.aE)((()=>debugFlags.c.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES),(r=>{r&&!this._debug?(this._debug=new n({view:t,handle:e}),this.addHandles((0,handleUtils.sX)(this._debug),"debug")):!r&&this._debug&&this.removeHandles("debug")}),reactiveUtils._8)),this.addHandles(this.layerSource.layer.on("apply-edits",(t=>{(0,promiseUtils.jO)(e.applyEdits(t,null))})))}destroy(){this._updatingHandles.destroy()}refresh(){this._workerHandle?.refresh(null)}async fetchCandidates(e,t){const{coordinateHelper:r,point:i}=e;this._tilesOfInterest.pointOfInterest=r.arrayToPoint(i);const s=this._memoizedMakeGetGroundElevation(this.view,r.spatialReference);return(await this._workerHandle.fetchCandidates({...e},t)).candidates.map((e=>(0,queryEngineUtils._)(e,s)))}getDebugInfo(e){return this._workerHandle.getDebugInfo(e)}_getOrLoadWhereFields(e,t){const{_whereModule:i}=this;if(!this._loadWhereModuleTask&&!i){const e=(0,asyncUtils.kn)((async()=>{const e=await Promise.all([__webpack_require__.e(74016),__webpack_require__.e(33268)]).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/core/sql/WhereClause.js"));return this._whereModule=e.WhereClause,this._whereModule}));return this._loadWhereModuleTask=e,this._updatingHandles.addPromise(e.promise),[]}if(!i)return[];try{return i.create(e,t).fieldNames}catch(s){return[]}}};(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],F.prototype,"spatialReference",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],F.prototype,"layerSource",void 0),(0,tslib_es6._)([(0,property.qq)({constructOnly:!0})],F.prototype,"view",void 0),(0,tslib_es6._)([(0,property.qq)()],F.prototype,"_tilesOfInterest",void 0),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],F.prototype,"_updateTilesParameters",null),(0,tslib_es6._)([(0,property.qq)()],F.prototype,"_layerView",null),(0,tslib_es6._)([(0,property.qq)()],F.prototype,"_isSuspended",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],F.prototype,"updating",null),(0,tslib_es6._)([(0,property.qq)()],F.prototype,"_outFields",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],F.prototype,"configuration",null),(0,tslib_es6._)([(0,property.qq)({readOnly:!0})],F.prototype,"availability",null),(0,tslib_es6._)([(0,property.qq)()],F.prototype,"_loadWhereModuleTask",void 0),(0,tslib_es6._)([(0,property.qq)()],F.prototype,"_whereModule",void 0),F=(0,tslib_es6._)([(0,subclass.c)("esri.views.interactive.snapping.featureSources.FeatureServiceSnappingSource")],F)},"./node_modules/@arcgis/core/views/interactive/snapping/featureSources/queryEngineUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>a,w:()=>o});var _sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/sketch/normalizedPoint.js"),_candidates_DrapedEdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/DrapedEdgeSnappingCandidate.js"),_candidates_EdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/EdgeSnappingCandidate.js"),_candidates_VertexSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/candidates/VertexSnappingCandidate.js");function r({x:t,y:n,z:d}){return(0,_sketch_normalizedPoint_js__WEBPACK_IMPORTED_MODULE_0__.WK)(t,n,d??0)}function a(e,a){switch(e.type){case"edge":return e.draped?new _candidates_DrapedEdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_1__.s({edgeStart:r(e.start),edgeEnd:r(e.end),targetPoint:r(e.target),objectId:e.objectId,getGroundElevation:a}):new _candidates_EdgeSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_2__.W({edgeStart:r(e.start),edgeEnd:r(e.end),targetPoint:r(e.target),objectId:e.objectId,isDraped:!1});case"vertex":return new _candidates_VertexSnappingCandidate_js__WEBPACK_IMPORTED_MODULE_3__.y({targetPoint:r(e.target),objectId:e.objectId,isDraped:!1})}}function o(e,t){return null!=e&&"3d"===e.type?(n,d)=>e.elevationProvider.getElevation(n,d,0,t,"ground"):()=>null}},"./node_modules/@arcgis/core/views/interactive/snapping/hints/PointSnappingHint.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O:()=>n});var _chunks_vec3_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/vec3.js"),_SnappingHint_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/views/interactive/snapping/hints/SnappingHint.js");class n extends _SnappingHint_js__WEBPACK_IMPORTED_MODULE_1__.m{constructor(t,s,n){super(s,n),this.point=t}equals(s){return s instanceof n&&(0,_chunks_vec3_js__WEBPACK_IMPORTED_MODULE_0__.h)(this.point,s.point)}}},"./node_modules/@arcgis/core/views/support/layerViewUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function n(n){return n&&"function"==typeof n.highlight}function t(n,e,t){return null==n||n>t&&(0===e||n<e)}__webpack_require__.d(__webpack_exports__,{EB:()=>t,Ul:()=>n})}}]);