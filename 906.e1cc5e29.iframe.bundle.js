"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[906],{"./node_modules/@arcgis/core/layers/support/rasterFunctions/rasterFunctionHelper.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Ue:()=>rasterFunctionHelper_l});var Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),JSONSupport=(__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js"));let e=class extends JSONSupport.wq{constructor(){super(...arguments),this.raster=void 0}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],e.prototype,"raster",void 0),e=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],e);const p=e;var AspectFunctionArguments_e;let t=AspectFunctionArguments_e=class extends p{clone(){return new AspectFunctionArguments_e({raster:this.raster})}};t=AspectFunctionArguments_e=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.AspectFunctionArguments")],t);const c=t;var cast=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/cast.js");let n=class extends JSONSupport.wq{constructor(){super(...arguments),this.functionArguments=null,this.readingBufferSize=0}bind(r,t=!1){const s=this._getRasterValues();for(let e=0;e<s.length;e++){const o=s[e];if(o&&"object"==typeof o&&"bind"in o&&(!o.rasterInfo||t)){const s=o.bind(r,t);if(!s.success)return s}}return!this.rasterInfo||t?(this.sourceRasterInfos=this._getSourceRasterInfos(r),this._bindSourceRasters()):{success:!0}}process(r){const t=this._getRasterValues().map((t=>this._readRasterValue(t,r)));return this._processPixels({...r,pixelBlocks:t})}getPrimaryRasters(){const r=[],t=[];return this._getPrimaryRasters(this,r,t),{rasters:r,rasterIds:t}}_getOutputPixelType(r){return"unknown"===this.outputPixelType?r:this.outputPixelType??r}_getRasterValues(){const{rasterArgumentNames:r}=this;return"rasters"===r[0]&&Array.isArray(this.functionArguments.rasters)?this.functionArguments.rasters:r.map((r=>this.functionArguments[r]))}_getSourceRasterInfos(r){const t=this._getRasterValues(),{rasterInfos:s,rasterIds:e}=r;return t.map((r=>r&&"object"==typeof r&&"bind"in r&&r.rasterInfo?r.rasterInfo:"string"==typeof r&&e.includes(r)?s[e.indexOf(r)]:s[0]))}_getPrimaryRasterId(r){return r?.url}_getPrimaryRasters(r,t=[],s=[]){for(let e=0;e<r.sourceRasters.length;e++){const o=r.sourceRasters[e];if("number"!=typeof o)if("bind"in o)this._getPrimaryRasters(o,t,s);else{const r=o,e=this._getPrimaryRasterId(r);if(null==e)continue;s.includes(e)||(this.mainPrimaryRasterId===e?(t.unshift(r),s.unshift(e)):(t.push(r),s.push(e)))}}}_readRasterValue(r,t){const{primaryPixelBlocks:e}=t;if((0,maybe.Wi)(r)||"$$"===r){const r=e[0];return(0,maybe.Wi)(r)?null:r.clone()}if("string"==typeof r){const s=t.primaryRasterIds.indexOf(r);return-1===s?null:e[s]}if("number"==typeof r){const t=e[0];if((0,maybe.Wi)(t))return null;const o=new Float32Array(t.width*t.height);o.fill(r);const i=t.clone();return i.pixels=i.pixels.map((()=>o)),i}return r.process(t)}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],n.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],n.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],n.prototype,"rasterArgumentNames",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}}),(0,cast.p)((r=>r?.toLowerCase()))],n.prototype,"outputPixelType",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],n.prototype,"mainPrimaryRasterId",void 0),(0,tslib_es6._)([(0,property.Cb)()],n.prototype,"sourceRasters",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],n.prototype,"sourceRasterInfos",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],n.prototype,"rasterInfo",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],n.prototype,"readingBufferSize",void 0),n=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.BaseRasterFunction")],n);const a=n;var surfaceUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/rasterFunctions/surfaceUtils.js");let AspectFunction_c=class extends a{constructor(){super(...arguments),this.functionName="Aspect",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){const t=this.sourceRasterInfos[0];this.isGCS=t.spatialReference.isGeographic,this.outputPixelType=this._getOutputPixelType("f32");const s=t.clone();return s.pixelType=this.outputPixelType,s.statistics=null,s.histograms=null,this.rasterInfo=s,{success:!0}}_processPixels(t){const e=t.pixelBlocks?.[0];if((0,maybe.Wi)(e))return null;const{extent:r}=t,o=r?{x:r.width/e.width,y:r.height/e.height}:{x:1,y:1};return(0,surfaceUtils.M_)(e,{resolution:o})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],AspectFunction_c.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:c,json:{write:!0,name:"rasterFunctionArguments"}})],AspectFunction_c.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],AspectFunction_c.prototype,"rasterArgumentNames",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],AspectFunction_c.prototype,"isGCS",void 0),AspectFunction_c=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.AspectFunction")],AspectFunction_c);const AspectFunction_p=AspectFunction_c;var lang=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),enumeration=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js"),jsonMap=__webpack_require__("./node_modules/@arcgis/core/core/jsonMap.js"),PixelBlock=__webpack_require__("./node_modules/@arcgis/core/layers/support/PixelBlock.js");const customBandIndexUtils_e=new Set(["+","-","*","/","(",")"]);function customBandIndexUtils_n(e,t,n,r){if("number"==typeof n&&"number"==typeof r)return n+r;let l;if("number"==typeof n){l=r.length;const e=n;(n=new Float32Array(l)).fill(e)}else if(l=n.length,r.constructor===Number){const e=r;(r=new Float32Array(l)).fill(e)}const o=new Float32Array(l);switch(t){case"+":for(let t=0;t<l;t++)(null==e||e[t])&&(o[t]=n[t]+r[t]);break;case"-":for(let t=0;t<l;t++)(null==e||e[t])&&(o[t]=n[t]-r[t]);break;case"*":for(let t=0;t<l;t++)(null==e||e[t])&&(o[t]=n[t]*r[t]);break;case"/":for(let t=0;t<l;t++)(null==e||e[t])&&r[t]&&(o[t]=n[t]/r[t]);break;case"(":case")":throw"encountered error with custom band index equation"}return o}function r(e,t){e.splice(t,1);let n=0,r=0;do{n=0,r=0;for(let t=0;t<e.length;t++)if("("===e[t])n=t;else if(")"===e[t]){r=t;break}r===n+1&&e.splice(n,2)}while(r===n+1);return e}function l(e){if(1===e.length)return{opIndex:0,numIndex:0};let t=0,n=0;for(let s=0;s<e.length;s++)if("("===e[s])t=s;else if(")"===e[s]){n=s;break}const r=0===n?e:e.slice(t+1,n);let l=-1;for(let s=0;s<r.length;s++)if("*"===r[s]||"/"===r[s]){l=s;break}if(l>-1)n>0&&(l+=t+1);else{for(let e=0;e<r.length;e++)if("+"===r[e]||"-"===r[e]){l=e;break}n>0&&(l+=t+1)}let o=0;for(let s=0;s<l;s++)"("===e[s]&&o++;return{opIndex:l,numIndex:l-o}}function o(e,o,s){let a,{ops:f,nums:i}=function customBandIndexUtils_t(t,n){(t=t.replace(/ /g,"")).startsWith("-")&&(t="0"+t),t.startsWith("+")&&(t=t.slice(1,t.length));const r=t.split(""),l=[],o=[];let s="";for(let a=0;a<r.length;a++){const t=r[a];if(customBandIndexUtils_e.has(t))""!==s&&o.push(parseFloat(s)),l.push(t),s="";else{if("b"===t.toLowerCase()){a++,s=t.concat(r[a]),o.push(n[parseInt(s[1],10)-1]),s="";continue}s=s.concat(t),a===r.length-1&&o.push(parseFloat(s))}}return{ops:l,nums:o}}(s,o);if(0===f.length){const e=1===i.length?i[0]:o[0];if(e instanceof Float32Array)return[e];const t=new Float32Array(o[0].length);return"number"==typeof e?t.fill(e):t.set(e),[t]}for(;f.length>0;){const{numIndex:t,opIndex:o}=l(f);if(a=customBandIndexUtils_n(e,f[o],i[t],i[t+1]),1===f.length)break;f=r(f,o),i.splice(t,2,a)}return[a]}var pixelUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/rasterFunctions/pixelUtils.js");const bandIndexUtils_a=new jsonMap.X({0:"custom",1:"ndvi",2:"savi",3:"tsavi",4:"msavi",5:"gemi",6:"pvi",7:"gvitm",8:"sultan",9:"vari",10:"gndvi",11:"sr",12:"ndvi-re",13:"sr-re",14:"mtvi2",15:"rtvi-core",16:"ci-re",17:"ci-g",18:"ndwi",19:"evi",20:"iron-oxide",21:"ferrous-minerals",22:"clay-minerals",23:"wndwi",24:"bai",25:"nbr",26:"ndbi",27:"ndmi",28:"ndsi",29:"mndwi"},{useNumericKeys:!0});function s(n,a){if(!(0,pixelUtils.nk)(n))return n;const{equation:s,method:i}=a,x=a.bandIndexes.map((n=>n-1)),{pixels:j,mask:q}=n;let M;switch(i){case"gndvi":case"nbr":case"ndbi":case"ndvi":case"ndvi-re":case"ndsi":case"ndmi":case"mndwi":M=bandIndexUtils_l(q,j[x[0]],j[x[1]]);break;case"ndwi":M=bandIndexUtils_l(q,j[x[1]],j[x[0]]);break;case"sr":case"sr-re":case"iron-oxide":case"ferrous-minerals":case"clay-minerals":M=function bandIndexUtils_c(n,t,e){const r=e.length,o=new Float32Array(r);for(let a=0;a<r;a++)if(null==n||n[a]){const n=t[a],r=e[a];r&&(o[a]=n/r)}return[o]}(q,j[x[0]],j[x[1]]);break;case"ci-g":case"ci-re":M=function u(n,t,e){const r=t.length,o=new Float32Array(r);for(let a=0;a<r;a++)if(null==n||n[a]){const n=t[a],r=e[a];r&&(o[a]=n/r-1)}return[o]}(q,j[x[0]],j[x[1]]);break;case"savi":M=function f(n,t,e,r){const o=e.length,a=new Float32Array(o);for(let s=0;s<o;s++)if(null==n||n[s]){const n=e[s],o=t[s],i=o+n+r;i&&(a[s]=(o-n)/i*(1+r))}return[a]}(q,j[x[0]],j[x[1]],x[2]+1);break;case"tsavi":M=function m(n,t,e,r,o,a){const s=e.length,i=new Float32Array(s),l=-o*r+a*(1+r*r);for(let c=0;c<s;c++)if(null==n||n[c]){const n=e[c],a=t[c],s=o*a+n+l;s&&(i[c]=r*(a-r*n-o)/s)}return[i]}(q,j[x[0]],j[x[1]],x[2]+1,x[3]+1,x[4]+1);break;case"msavi":M=function w(n,t,e){const r=e.length,o=new Float32Array(r);for(let a=0;a<r;a++)if(null==n||n[a]){const n=e[a],r=t[a];o[a]=.5*(2*(r+1)-Math.sqrt((2*r+1)**2-8*(r-n)))}return[o]}(q,j[x[0]],j[x[1]]);break;case"gemi":M=function h(n,t,e){const r=e.length,o=new Float32Array(r);for(let a=0;a<r;a++)if(null==n||n[a]){const n=e[a],r=t[a];if(1!==n){const t=(2*(r*r-n*n)+1.5*r+.5*n)/(r+n+.5);o[a]=t*(1-.25*t)-(n-.125)/(1-n)}}return[o]}(q,j[x[0]],j[x[1]]);break;case"pvi":M=function d(n,t,e,r,o){const a=e.length,s=new Float32Array(a),i=Math.sqrt(1+r*r);for(let l=0;l<a;l++)if(null==n||n[l]){const n=e[l],a=t[l];s[l]=(a-r*n-o)/i}return[s]}(q,j[x[0]],j[x[1]],x[2]+1,x[3]+1);break;case"gvitm":M=function g(n,t){const[e,r,o,a,s,i]=t,l=e.length,c=new Float32Array(l);for(let u=0;u<l;u++)(null==n||n[u])&&(c[u]=-.2848*e[u]-.2435*r[u]-.5436*o[u]+.7243*a[u]+.084*s[u]-1.18*i[u]);return[c]}(q,[j[x[0]],j[x[1]],j[x[2]],j[x[3]],j[x[4]],j[x[5]]]);break;case"sultan":M=function y(n,t){const[e,,r,o,a,s]=t,i=e.length,l=new Float32Array(i),c=new Float32Array(i),u=new Float32Array(i);for(let f=0;f<i;f++)(null==n||n[f])&&(l[f]=s[f]?a[f]/s[f]*100:0,c[f]=e[f]?a[f]/e[f]*100:0,u[f]=o[f]?r[f]/o[f]*(a[f]/o[f])*100:0);return[l,c,u]}(q,[j[x[0]],j[x[1]],j[x[2]],j[x[3]],j[x[4]],j[x[5]]]);break;case"vari":M=function b(n,t){const[e,r,o]=t,a=e.length,s=new Float32Array(a);for(let i=0;i<a;i++)if(null==n||n[i])for(i=0;i<a;i++){const n=e[i],t=r[i],a=t+n-o[i];a&&(s[i]=(t-n)/a)}return[s]}(q,[j[x[0]],j[x[1]],j[x[2]]]);break;case"mtvi2":M=function v(n,t){const[e,r,o]=t,a=e.length,s=new Float32Array(a);for(let i=0;i<a;i++)if(null==n||n[i])for(i=0;i<a;i++){const n=e[i],t=r[i],a=o[i],l=Math.sqrt((2*n+1)**2-6*n-5*Math.sqrt(t)-.5);s[i]=1.5*(1.2*(n-a)-2.5*(t-a))*l}return[s]}(q,[j[x[0]],j[x[1]],j[x[2]]]);break;case"rtvi-core":M=function k(n,t){const[e,r,o]=t,a=e.length,s=new Float32Array(a);for(let i=0;i<a;i++)if(null==n||n[i])for(i=0;i<a;i++){const n=e[i],t=r[i],a=o[i];s[i]=100*(n-t)-10*(n-a)}return[s]}(q,[j[x[0]],j[x[1]],j[x[2]]]);break;case"evi":M=function bandIndexUtils_p(n,t){const[e,r,o]=t,a=e.length,s=new Float32Array(a);for(let i=0;i<a;i++)if(null==n||n[i])for(i=0;i<a;i++){const n=e[i],t=r[i],a=n+6*t-7.5*o[i]+1;a&&(s[i]=2.5*(n-t)/a)}return[s]}(q,[j[x[0]],j[x[1]],j[x[2]]]);break;case"wndwi":M=function A(n,t,e=.5){const[r,o,a]=t,s=o.length,i=new Float32Array(s);for(let l=0;l<s;l++)if(null==n||n[l])for(l=0;l<s;l++){const n=r[l],t=o[l],s=a[l],c=n+e*t+(1-e)*s;c&&(i[l]=(n-e*t-(1-e)*s)/c)}return[i]}(q,[j[x[0]],j[x[1]],j[x[2]]],x[3]??.5);break;case"bai":M=function F(n,t,e){const r=e.length,o=new Float32Array(r);for(let a=0;a<r;a++)if(null==n||n[a])for(a=0;a<r;a++){const n=(.1-t[a])**2+(.06-e[a])**2;n&&(o[a]=1/n)}return[o]}(q,j[x[0]],j[x[1]]);break;case"custom":M=o(q,j,s);break;default:return n}const U=(0,maybe.pC)(q)?new Uint8Array(q.length):null;(0,maybe.pC)(q)&&(0,maybe.pC)(U)&&U.set(q);const B=new PixelBlock.Z({width:n.width,height:n.height,pixelType:"f32",pixels:M,mask:U});return B.updateStatistics(),B}function bandIndexUtils_l(n,t,e){const r=e.length,o=new Float32Array(r);for(let a=0;a<r;a++)if(null==n||n[a]){const n=t[a],r=e[a],s=n+r;s&&(o[a]=(n-r)/s)}return[o]}var BandArithmeticFunctionArguments_p;let BandArithmeticFunctionArguments_a=BandArithmeticFunctionArguments_p=class extends p{constructor(){super(...arguments),this.method="custom"}clone(){return new BandArithmeticFunctionArguments_p({method:this.method,bandIndexes:this.bandIndexes,raster:(0,lang.d9)(this.raster)})}};(0,tslib_es6._)([(0,property.Cb)({json:{type:String,write:!0}})],BandArithmeticFunctionArguments_a.prototype,"bandIndexes",void 0),(0,tslib_es6._)([(0,enumeration.J)(bandIndexUtils_a)],BandArithmeticFunctionArguments_a.prototype,"method",void 0),BandArithmeticFunctionArguments_a=BandArithmeticFunctionArguments_p=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.BandArithmeticFunctionArguments")],BandArithmeticFunctionArguments_a);const i=BandArithmeticFunctionArguments_a;let BandArithmeticFunction_u=class extends a{constructor(){super(...arguments),this.functionName="BandArithmetic",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const t=this.sourceRasterInfos[0],s=t.clone();return s.pixelType=this.outputPixelType,s.statistics=null,s.histograms=null,s.bandCount="sultan"===this.functionArguments.method?t.bandCount:1,this.rasterInfo=s,{success:!0}}_processPixels(t){const e=t.pixelBlocks?.[0];if((0,maybe.Wi)(e))return e;const{method:r,bandIndexes:o}=this.functionArguments,i=o.split(" ").map((t=>parseFloat(t)));return s(e,{method:r,bandIndexes:i,equation:o})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],BandArithmeticFunction_u.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:i,json:{write:!0,name:"rasterFunctionArguments"}})],BandArithmeticFunction_u.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],BandArithmeticFunction_u.prototype,"rasterArgumentNames",void 0),BandArithmeticFunction_u=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.BandArithmeticFunction")],BandArithmeticFunction_u);const BandArithmeticFunction_a=BandArithmeticFunction_u;var ColormapFunctionArguments_c,reader=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/reader.js"),colorRamps=__webpack_require__("./node_modules/@arcgis/core/rest/support/colorRamps.js");let ColormapFunctionArguments_l=ColormapFunctionArguments_c=class extends p{readColorRamp(o){return(0,colorRamps.i)(o)}clone(){return new ColormapFunctionArguments_c({colormap:(0,lang.d9)(this.colormap),colormapName:this.colormapName,colorRamp:this.colorRamp?.clone(),colorRampName:this.colorRampName})}};(0,tslib_es6._)([(0,property.Cb)({type:[[Number]],json:{write:!0}})],ColormapFunctionArguments_l.prototype,"colormap",void 0),(0,tslib_es6._)([(0,property.Cb)({type:String,json:{write:!0}})],ColormapFunctionArguments_l.prototype,"colormapName",void 0),(0,tslib_es6._)([(0,property.Cb)({types:colorRamps.V,json:{write:!0}})],ColormapFunctionArguments_l.prototype,"colorRamp",void 0),(0,tslib_es6._)([(0,reader.r)("colorRamp")],ColormapFunctionArguments_l.prototype,"readColorRamp",null),(0,tslib_es6._)([(0,property.Cb)({type:String,json:{write:!0}})],ColormapFunctionArguments_l.prototype,"colorRampName",void 0),ColormapFunctionArguments_l=ColormapFunctionArguments_c=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.ColormapFunctionArguments")],ColormapFunctionArguments_l);const ColormapFunctionArguments_i=ColormapFunctionArguments_l;var colorRampUtils=__webpack_require__("./node_modules/@arcgis/core/renderers/support/colorRampUtils.js");let ColormapFunction_i=class extends a{constructor(){super(...arguments),this.functionName="Colormap",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const r=this.sourceRasterInfos[0];if(r.bandCount>1)return{success:!1,error:"colormap-function: source data must be single band"};let{colormap:o,colorRamp:t}=this.functionArguments;if(o?.length||t&&(o=(0,colorRampUtils.XL)(t,256,!0)),!o?.length)return{success:!1,error:"colormap-function: missing colormap argument"};this.outputPixelType=this._getOutputPixelType("u8");const s=r.clone();return s.pixelType=this.outputPixelType,s.colormap=o,this.rasterInfo=s,{success:!0}}_processPixels(r){return r.pixelBlocks?.[0]}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],ColormapFunction_i.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:ColormapFunctionArguments_i,json:{write:!0,name:"rasterFunctionArguments"}})],ColormapFunction_i.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],ColormapFunction_i.prototype,"rasterArgumentNames",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],ColormapFunction_i.prototype,"indexedColormap",void 0),ColormapFunction_i=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.ColormapFunction")],ColormapFunction_i);const ColormapFunction_p=ColormapFunction_i;var CompositeBandFunctionArguments_a,writer=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/writer.js");let CompositeBandFunctionArguments_c=CompositeBandFunctionArguments_a=class extends p{writeRasters(r,s){s.rasters=r.map((r=>"number"==typeof r||"string"==typeof r?r:r.toJSON()))}clone(){return new CompositeBandFunctionArguments_a({rasters:(0,lang.d9)(this.rasters)})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],CompositeBandFunctionArguments_c.prototype,"rasters",void 0),(0,tslib_es6._)([(0,writer.c)("rasters")],CompositeBandFunctionArguments_c.prototype,"writeRasters",null),CompositeBandFunctionArguments_c=CompositeBandFunctionArguments_a=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.CompositeBandFunctionArguments")],CompositeBandFunctionArguments_c);const CompositeBandFunctionArguments_n=CompositeBandFunctionArguments_c;let CompositeBandFunction_p=class extends a{constructor(){super(...arguments),this.functionName="CompositeBand",this.functionArguments=null,this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const{sourceRasterInfos:t}=this,r=t[0];this.outputPixelType=this._getOutputPixelType(r.pixelType);const e=r.clone();if(e.attributeTable=null,e.colormap=null,e.pixelType=this.outputPixelType,e.bandCount=t.map((({bandCount:t})=>t)).reduce(((t,s)=>t+s)),t.every((({statistics:t})=>(0,maybe.pC)(t)&&t.length))){const r=[];t.forEach((({statistics:t})=>(0,maybe.pC)(t)&&r.push(...t))),e.statistics=r}if(t.every((({histograms:t})=>(0,maybe.pC)(t)&&t.length))){const r=[];t.forEach((({histograms:t})=>(0,maybe.pC)(t)&&r.push(...t))),e.histograms=r}return this.rasterInfo=e,{success:!0}}_processPixels(t){const{pixelBlocks:s}=t;if(!s)return null;const e=s?.[0];return(0,maybe.Wi)(e)?null:(0,pixelUtils.Gd)(s)}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],CompositeBandFunction_p.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:CompositeBandFunctionArguments_n,json:{write:!0,name:"rasterFunctionArguments"}})],CompositeBandFunction_p.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],CompositeBandFunction_p.prototype,"rasterArgumentNames",void 0),CompositeBandFunction_p=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.CompositeBandFunction")],CompositeBandFunction_p);const CompositeBandFunction_u=CompositeBandFunction_p;var convolutionUtils_t;!function(e){e[e.UserDefined=-1]="UserDefined",e[e.LineDetectionHorizontal=0]="LineDetectionHorizontal",e[e.LineDetectionVertical=1]="LineDetectionVertical",e[e.LineDetectionLeftDiagonal=2]="LineDetectionLeftDiagonal",e[e.LineDetectionRightDiagonal=3]="LineDetectionRightDiagonal",e[e.GradientNorth=4]="GradientNorth",e[e.GradientWest=5]="GradientWest",e[e.GradientEast=6]="GradientEast",e[e.GradientSouth=7]="GradientSouth",e[e.GradientNorthEast=8]="GradientNorthEast",e[e.GradientNorthWest=9]="GradientNorthWest",e[e.SmoothArithmeticMean=10]="SmoothArithmeticMean",e[e.Smoothing3x3=11]="Smoothing3x3",e[e.Smoothing5x5=12]="Smoothing5x5",e[e.Sharpening3x3=13]="Sharpening3x3",e[e.Sharpening5x5=14]="Sharpening5x5",e[e.Laplacian3x3=15]="Laplacian3x3",e[e.Laplacian5x5=16]="Laplacian5x5",e[e.SobelHorizontal=17]="SobelHorizontal",e[e.SobelVertical=18]="SobelVertical",e[e.Sharpen=19]="Sharpen",e[e.Sharpen2=20]="Sharpen2",e[e.PointSpread=21]="PointSpread",e[e.None=255]="None"}(convolutionUtils_t||(convolutionUtils_t={}));const convolutionUtils_n=new Map;function convolutionUtils_i(e,t,n,o,i,r,a){const l=new Float32Array(t*n),s=r.length,h=a?0:o,c=a?o:0,p=a?1:t;for(let f=h;f<n-h;f++){const n=f*t;for(let a=c;a<t-c;a++){if(i&&!i[n+a])continue;let t=0;for(let i=0;i<s;i++)t+=e[n+a+(i-o)*p]*r[i];l[n+a]=t}}return l}function convolutionUtils_r(e,t,n,o,i,r,a){const l=new Float32Array(t*n),s=Math.floor(o/2),h=Math.floor(i/2);for(let c=s;c<n-s;c++){const n=c*t;for(let c=h;c<t-h;c++){if(r&&!r[n+c])continue;let p=0;for(let r=0;r<o;r++)for(let o=0;o<i;o++)p+=e[n+c+(r-s)*t+o-h]*a[r*i+o];l[n+c]=p}}return l}function convolutionUtils_l(e,t,n,o,i){const r=Math.floor(o/2);for(let l=0;l<r;l++)for(let o=0;o<t;o++)e[l*t+o]=e[(i-1-l)*t+o],e[(n-1-l)*t+o]=e[(n-i+l)*t+o];const a=Math.floor(i/2);for(let l=0;l<n;l++){const n=l*t;for(let o=0;o<a;o++)e[n+o]=e[n+i-1-o],e[n+t-o-1]=e[n+t+o-i]}}function convolutionUtils_h(e,t){const n=function convolutionUtils_o(e){const t=Math.sqrt(e.length),n=e.slice(0,t),o=[1];for(let i=1;i<t;i++){let n=null;for(let o=0;o<t;o++){const r=e[o+i*t],a=e[o];if(null==n)if(0===a){if(r)return{separable:!1,row:null,col:null}}else n=r/a;else if(r/a!==n)return{separable:!1,row:null,col:null}}if(null==n)return{separable:!1,row:null,col:null};o.push(n)}return{separable:!0,row:n,col:o}}(t.kernel),i=!1!==t.mirrorEdges,r=n.separable?function convolutionUtils_s(t,n,o,r=!0){const{pixels:a,width:s,height:h,pixelType:c,mask:p}=t,f=a.length,u=[],S=n.length,g=o.length,x=Math.floor(S/2),d=Math.floor(g/2);for(let e=0;e<f;e++){let t=convolutionUtils_i(a[e],s,h,x,p,n,!0);t=convolutionUtils_i(t,s,h,d,p,o,!1),r&&convolutionUtils_l(t,s,h,S,g),u.push(t)}return new PixelBlock.Z({width:s,height:h,pixelType:c,pixels:u,mask:p})}(e,n.row,n.col,i):function convolutionUtils_a(t,n,o=!0){const{pixels:i,width:a,height:s,pixelType:h,mask:c}=t,p=i.length,f=[],{kernel:u,rows:S,cols:g}=n;for(let e=0;e<p;e++){const t=convolutionUtils_r(i[e],a,s,S,g,c,u);o&&convolutionUtils_l(t,a,s,S,g),f.push(t)}return new PixelBlock.Z({width:a,height:s,pixelType:h,pixels:f,mask:c})}(e,t,i),{outputPixelType:l}=t;return l&&r.clamp(l),r}var ConvolutionFunctionArguments_i;convolutionUtils_n.set(convolutionUtils_t.None,[0,0,0,0,1,0,0,0,0]),convolutionUtils_n.set(convolutionUtils_t.LineDetectionHorizontal,[-1,-1,-1,2,2,2,-1,-1,-1]),convolutionUtils_n.set(convolutionUtils_t.LineDetectionVertical,[-1,2,-1,-1,2,-1,-1,2,-1]),convolutionUtils_n.set(convolutionUtils_t.LineDetectionLeftDiagonal,[2,-1,-1,-1,2,-1,-1,-1,2]),convolutionUtils_n.set(convolutionUtils_t.LineDetectionRightDiagonal,[-1,-1,2,-1,2,-1,2,-1,-1]),convolutionUtils_n.set(convolutionUtils_t.GradientNorth,[-1,-2,-1,0,0,0,1,2,1]),convolutionUtils_n.set(convolutionUtils_t.GradientWest,[-1,0,1,-2,0,2,-1,0,1]),convolutionUtils_n.set(convolutionUtils_t.GradientEast,[1,0,-1,2,0,-2,1,0,-1]),convolutionUtils_n.set(convolutionUtils_t.GradientSouth,[1,2,1,0,0,0,-1,-2,-1]),convolutionUtils_n.set(convolutionUtils_t.GradientNorthEast,[0,-1,-2,1,0,-1,2,1,0]),convolutionUtils_n.set(convolutionUtils_t.GradientNorthWest,[-2,-1,0,-1,0,1,0,1,2]),convolutionUtils_n.set(convolutionUtils_t.SmoothArithmeticMean,[.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111,.111111111111]),convolutionUtils_n.set(convolutionUtils_t.Smoothing3x3,[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625]),convolutionUtils_n.set(convolutionUtils_t.Smoothing5x5,[1,1,1,1,1,1,4,4,4,1,1,4,12,4,1,1,4,4,4,1,1,1,1,1,1]),convolutionUtils_n.set(convolutionUtils_t.Sharpening3x3,[-1,-1,-1,-1,9,-1,-1,-1,-1]),convolutionUtils_n.set(convolutionUtils_t.Sharpening5x5,[-1,-3,-4,-3,-1,-3,0,6,0,-3,-4,6,21,6,-4,-3,0,6,0,-3,-1,-3,-4,-3,-1]),convolutionUtils_n.set(convolutionUtils_t.Laplacian3x3,[0,-1,0,-1,4,-1,0,-1,0]),convolutionUtils_n.set(convolutionUtils_t.Laplacian5x5,[0,0,-1,0,0,0,-1,-2,-1,0,-1,-2,17,-2,-1,0,-1,-2,-1,0,0,0,-1,0,0]),convolutionUtils_n.set(convolutionUtils_t.SobelHorizontal,[-1,-2,-1,0,0,0,1,2,1]),convolutionUtils_n.set(convolutionUtils_t.SobelVertical,[-1,0,1,-2,0,2,-1,0,1]),convolutionUtils_n.set(convolutionUtils_t.Sharpen,[0,-.25,0,-.25,2,-.25,0,-.25,0]),convolutionUtils_n.set(convolutionUtils_t.Sharpen2,[-.25,-.25,-.25,-.25,3,-.25,-.25,-.25,-.25]),convolutionUtils_n.set(convolutionUtils_t.PointSpread,[-.627,.352,-.627,.352,2.923,.352,-.627,.352,-.627]);let ConvolutionFunctionArguments_c=ConvolutionFunctionArguments_i=class extends p{constructor(){super(...arguments),this.rows=3,this.cols=3,this.kernel=[0,0,0,0,1,0,0,0,0]}set kernelType(e){this._set("kernelType",e);const r=convolutionUtils_n.get(e);if(!r||e===convolutionUtils_t.UserDefined||e===convolutionUtils_t.None)return;const s=Math.sqrt(r.length);this._set("kernel",r),this._set("cols",s),this._set("rows",s)}clone(){return new ConvolutionFunctionArguments_i({cols:this.cols,rows:this.rows,kernel:[...this.kernel],kernelType:this.kernelType,raster:(0,lang.d9)(this.raster)})}};(0,tslib_es6._)([(0,property.Cb)({json:{type:Number,write:!0}})],ConvolutionFunctionArguments_c.prototype,"rows",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{type:Number,write:!0}})],ConvolutionFunctionArguments_c.prototype,"cols",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{name:"type",type:Number,write:!0}})],ConvolutionFunctionArguments_c.prototype,"kernelType",null),(0,tslib_es6._)([(0,property.Cb)({json:{type:[Number],write:!0}})],ConvolutionFunctionArguments_c.prototype,"kernel",void 0),ConvolutionFunctionArguments_c=ConvolutionFunctionArguments_i=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.ConvolutionFunctionArguments")],ConvolutionFunctionArguments_c);const ConvolutionFunctionArguments_l=ConvolutionFunctionArguments_c;let ConvolutionFunction_p=class extends a{constructor(){super(...arguments),this.functionName="Convolution",this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{kernelType:e,rows:t,cols:o,kernel:s}=this.functionArguments;if(!convolutionUtils_n.has(e))return{success:!1,error:`convolution-function: the specified kernel type is not supported ${e}`};if(e!==convolutionUtils_t.None&&t*o!==s.length)return{success:!1,error:"convolution-function: the specified rows and cols do not match the length of the kernel"};const r=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType(r.pixelType);const n=r.clone();n.pixelType=this.outputPixelType;const c=[convolutionUtils_t.None,convolutionUtils_t.Sharpen,convolutionUtils_t.Sharpen2,convolutionUtils_t.Sharpening3x3,convolutionUtils_t.Sharpening5x5];return"u8"===this.outputPixelType||c.includes(e)||(n.statistics=null,n.histograms=null),this.rasterInfo=n,{success:!0}}_processPixels(e){const o=e.pixelBlocks?.[0];if((0,maybe.Wi)(o)||this.functionArguments.kernelType===convolutionUtils_t.None)return o;let{kernel:s,rows:r,cols:n}=this.functionArguments;const i=s.reduce(((e,t)=>e+t));return 0!==i&&1!==i&&(s=s.map((e=>e/i))),convolutionUtils_h(o,{kernel:s,rows:r,cols:n,outputPixelType:this.outputPixelType})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],ConvolutionFunction_p.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:ConvolutionFunctionArguments_l,json:{write:!0,name:"rasterFunctionArguments"}})],ConvolutionFunction_p.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],ConvolutionFunction_p.prototype,"rasterArgumentNames",void 0),ConvolutionFunction_p=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.ConvolutionFunction")],ConvolutionFunction_p);const ConvolutionFunction_l=ConvolutionFunction_p;var ExtractBandFunctionArguments_i;let ExtractBandFunctionArguments_n=ExtractBandFunctionArguments_i=class extends p{constructor(){super(...arguments),this.bandIDs=[],this.missingBandAction=pixelUtils.CD.bestMatch}clone(){return new ExtractBandFunctionArguments_i({bandIDs:[...this.bandIDs],missingBandAction:this.missingBandAction})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],ExtractBandFunctionArguments_n.prototype,"bandIDs",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],ExtractBandFunctionArguments_n.prototype,"missingBandAction",void 0),ExtractBandFunctionArguments_n=ExtractBandFunctionArguments_i=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.ExtractBandFunctionArguments")],ExtractBandFunctionArguments_n);const ExtractBandFunctionArguments_c=ExtractBandFunctionArguments_n;let ExtractBandFunction_c=class extends a{constructor(){super(...arguments),this.functionName="ExtractBand",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{sourceRasterInfos:t}=this,r=t[0],{bandCount:e}=r,{bandIDs:o,missingBandAction:n}=this.functionArguments;if(n===pixelUtils.CD.fail&&o.some((t=>t<0||t>=e)))return{success:!1,error:"extract-band-function: invalid bandIDs"};this.outputPixelType=this._getOutputPixelType("f32");const i=r.clone();i.pixelType=this.outputPixelType;const{statistics:c,histograms:u}=i;return(0,maybe.pC)(c)&&c.length&&(i.statistics=o.map((t=>c[t]||c[c.length-1]))),(0,maybe.pC)(u)&&u.length&&(i.histograms=o.map((t=>u[t]||u[u.length-1]))),this.rasterInfo=i,{success:!0}}_processPixels(t){const s=t.pixelBlocks?.[0];if((0,maybe.Wi)(s))return null;const e=s.pixels.length,o=this.functionArguments.bandIDs.map((t=>t>=e?e-1:t));return s.extractBands(o)}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],ExtractBandFunction_c.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:ExtractBandFunctionArguments_c,json:{write:!0,name:"rasterFunctionArguments"}})],ExtractBandFunction_c.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],ExtractBandFunction_c.prototype,"rasterArgumentNames",void 0),ExtractBandFunction_c=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.ExtractBandFunction")],ExtractBandFunction_c);const ExtractBandFunction_u=ExtractBandFunction_c;var LocalFunctionArguments_a;let LocalFunctionArguments_i=LocalFunctionArguments_a=class extends p{constructor(){super(...arguments),this.rasters=[],this.processAsMultiband=!1}writeRasters(r,s){s.rasters=r.map((r=>"number"==typeof r||"string"==typeof r?r:r.toJSON()))}clone(){return new LocalFunctionArguments_a({method:this.operation,processAsMultiband:this.processAsMultiband,rasters:(0,lang.d9)(this.rasters)})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],LocalFunctionArguments_i.prototype,"operation",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],LocalFunctionArguments_i.prototype,"rasters",void 0),(0,tslib_es6._)([(0,writer.c)("rasters")],LocalFunctionArguments_i.prototype,"writeRasters",null),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],LocalFunctionArguments_i.prototype,"processAsMultiband",void 0),LocalFunctionArguments_i=LocalFunctionArguments_a=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.LocalFunctionArguments")],LocalFunctionArguments_i);const LocalFunctionArguments_c=LocalFunctionArguments_i;var localUtils_o;!function(t){t[t.Plus=1]="Plus",t[t.Minus=2]="Minus",t[t.Times=3]="Times",t[t.SquareRoot=4]="SquareRoot",t[t.Power=5]="Power",t[t.ACos=6]="ACos",t[t.ASin=7]="ASin",t[t.ATan=8]="ATan",t[t.ATanH=9]="ATanH",t[t.Abs=10]="Abs",t[t.BitwiseAnd=11]="BitwiseAnd",t[t.BitwiseLeftShift=12]="BitwiseLeftShift",t[t.BitwiseNot=13]="BitwiseNot",t[t.BitwiseOr=14]="BitwiseOr",t[t.BitwiseRightShift=15]="BitwiseRightShift",t[t.BitwiseXOr=16]="BitwiseXOr",t[t.BooleanAnd=17]="BooleanAnd",t[t.BooleanNot=18]="BooleanNot",t[t.BooleanOr=19]="BooleanOr",t[t.BooleanXOr=20]="BooleanXOr",t[t.Cos=21]="Cos",t[t.CosH=22]="CosH",t[t.Divide=23]="Divide",t[t.EqualTo=24]="EqualTo",t[t.Exp=25]="Exp",t[t.Exp10=26]="Exp10",t[t.Exp2=27]="Exp2",t[t.GreaterThan=28]="GreaterThan",t[t.GreaterThanEqual=29]="GreaterThanEqual",t[t.Int=30]="Int",t[t.IsNull=31]="IsNull",t[t.Float=32]="Float",t[t.LessThan=33]="LessThan",t[t.LessThanEqual=34]="LessThanEqual",t[t.Ln=35]="Ln",t[t.Log10=36]="Log10",t[t.Log2=37]="Log2",t[t.Majority=38]="Majority",t[t.Max=39]="Max",t[t.Mean=40]="Mean",t[t.Med=41]="Med",t[t.Min=42]="Min",t[t.Minority=43]="Minority",t[t.Mod=44]="Mod",t[t.Negate=45]="Negate",t[t.NotEqual=46]="NotEqual",t[t.Range=47]="Range",t[t.RoundDown=48]="RoundDown",t[t.RoundUp=49]="RoundUp",t[t.SetNull=50]="SetNull",t[t.Sin=51]="Sin",t[t.SinH=52]="SinH",t[t.Square=53]="Square",t[t.Std=54]="Std",t[t.Sum=55]="Sum",t[t.Tan=56]="Tan",t[t.TanH=57]="TanH",t[t.Variety=58]="Variety",t[t.ACosH=59]="ACosH",t[t.ASinH=60]="ASinH",t[t.ATan2=61]="ATan2",t[t.FloatDivide=64]="FloatDivide",t[t.FloorDivide=65]="FloorDivide",t[t.MajorityIgnoreNoData=66]="MajorityIgnoreNoData",t[t.MaxIgnoreNoData=67]="MaxIgnoreNoData",t[t.MeanIgnoreNoData=68]="MeanIgnoreNoData",t[t.MedIgnoreNoData=69]="MedIgnoreNoData",t[t.MinIgnoreNoData=70]="MinIgnoreNoData",t[t.MinorityIgnoreNoData=71]="MinorityIgnoreNoData",t[t.RangeIgnoreNoData=72]="RangeIgnoreNoData",t[t.StdIgnoreNoData=73]="StdIgnoreNoData",t[t.SumIgnoreNoData=74]="SumIgnoreNoData",t[t.VarietyIgnoreNoData=75]="VarietyIgnoreNoData",t[t.Con=76]="Con"}(localUtils_o||(localUtils_o={}));function localUtils_s(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]+a[n]);return l}function localUtils_l(t,e,o){const[r]=t,a=r.length,s=PixelBlock.Z.createEmptyBand("f32",a);return s.set(r),s}function localUtils_i(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]-a[n]);return l}function localUtils_c(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]*a[n]);return l}function localUtils_u(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=0===a[n]?0:r[n]/a[n]);return l}function localUtils_f(t,e,n){return localUtils_u(t,e,"f32")}function localUtils_h(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=0===a[n]?0:Math.floor(r[n]/a[n]));return l}function localUtils_g(t,e,o,r){const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r(a[n]));return l}function localUtils_d(t,e,o,r){const[a,s]=t,l=a.length,i=PixelBlock.Z.createEmptyBand(o,l);for(let n=0;n<l;n++)e&&!e[n]||(i[n]=r(a[n],s[n]));return i}function localUtils_p(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]&a[n]);return l}function localUtils_y(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]<<a[n]);return l}function B(t,e,o){const[r]=t,a=r.length,s=PixelBlock.Z.createEmptyBand(o,a);for(let n=0;n<a;n++)e&&!e[n]||(s[n]=~r[n]);return s}function M(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]|a[n]);return l}function localUtils_m(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]>>a[n]);return l}function E(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]^a[n]);return l}function N(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]&&a[n]?1:0);return l}function localUtils_w(t,e,o){const[r]=t,a=r.length,s=PixelBlock.Z.createEmptyBand(o,a);for(let n=0;n<a;n++)e&&!e[n]||(s[n]=r[n]?0:1);return s}function D(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]||a[n]?1:0);return l}function S(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=(r[n]?1:0)^(a[n]?1:0));return l}function localUtils_A(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]===a[n]?1:0);return l}function I(t,e,o,r){const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r**a[n]);return l}function T(t,e,n){return I(t,e,n,10)}function x(t,e,n){return I(t,e,n,2)}function q(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]>a[n]?1:0);return l}function H(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]>=a[n]?1:0);return l}function L(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]<a[n]?1:0);return l}function R(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]<=a[n]?1:0);return l}function C(t,e,o){const[r]=t,a=r.length,s=PixelBlock.Z.createEmptyBand(o,a);if(!e)return s;for(let n=0;n<a;n++)s[n]=e[n]?0:1;return s}function localUtils_F(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]%a[n]);return l}function O(t,e,o){const[r]=t,a=r.length,s=PixelBlock.Z.createEmptyBand(o,a);for(let n=0;n<a;n++)e&&!e[n]||(s[n]=-r[n]);return s}function localUtils_b(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)e&&!e[n]||(l[n]=r[n]===a[n]?0:1);return l}function localUtils_k(t,e,o){const[r,a]=t,s=r.length,l=PixelBlock.Z.createEmptyBand(o,s),i=new Uint8Array(s);for(let n=0;n<s;n++)null!=e&&!e[n]||0!==r[n]||(l[n]=a[n],i[n]=255);return{band:l,mask:i}}function localUtils_v(t,e,o){const[r,a,s]=t,l=r.length,i=PixelBlock.Z.createEmptyBand(o,l);for(let n=0;n<l;n++)e&&!e[n]||(i[n]=r[n]?a[n]:s[n]);return i}function j(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s);l.set(a);for(let n=0;n<s;n++)if(!e||e[n])for(let e=1;e<r;e++){const o=t[e];l[n]<o[n]&&(l[n]=o[n])}return l}function P(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s);l.set(a);for(let n=0;n<s;n++)if(!e||e[n])for(let e=1;e<r;e++){const o=t[e];l[n]>o[n]&&(l[n]=o[n])}return l}function G(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s);l.set(a);for(let n=0;n<s;n++)if(!e||e[n]){let e=l[n];for(let o=1;o<r;o++){const r=t[o];l[n]<r[n]&&(l[n]=r[n]),e>r[n]&&(e=r[n])}l[n]-=e}return l}function U(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s);l.set(a);for(let n=0;n<s;n++)if(!e||e[n]){for(let e=1;e<r;e++){const o=t[e];l[n]+=o[n]}l[n]/=r}return l}function V(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s);l.set(a);for(let n=0;n<s;n++)if(!e||e[n])for(let e=1;e<r;e++){const o=t[e];l[n]+=o[n]}return l}function X(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s);for(let n=0;n<s;n++)if(!e||e[n]){const e=new Float32Array(r);let o=0;for(let s=0;s<r;s++){const r=t[s];o+=r[n],e[s]=r[n]}o/=r;let a=0;for(let t=0;t<r;t++)a+=(e[t]-o)*e[t]-o;l[n]=Math.sqrt(a/r-1)}return l}function z(t,e,o){const r=t.length;if(r<2)return t[0];const a=Math.floor(r/2),[s]=t,l=s.length,i=PixelBlock.Z.createEmptyBand(o,l),c=new Float32Array(r);for(let n=0;n<l;n++)if(!e||e[n]){for(let e=0;e<r;e++)c[e]=t[e][n];c.sort(),i[n]=c[a]}return i}function J(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s),i=new Map;for(let n=0;n<s;n++)if(!e||e[n]){let e;i.clear();for(let s=0;s<r;s++)e=t[s][n],i.set(e,i.has(e)?i.get(e)+1:1);let o=0,a=0;for(const t of i.keys())o=i.get(t),o>a&&(a=o,e=t);l[n]=e}return l}function K(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s),i=new Map;for(let n=0;n<s;n++)if(!e||e[n]){let e;i.clear();for(let s=0;s<r;s++)e=t[s][n],i.set(e,i.has(e)?i.get(e)+1:1);let o=0,a=t.length;for(const t of i.keys())o=i.get(t),o<a&&(a=o,e=t);l[n]=e}return l}function Q(t,e,o){const r=t.length;if(r<2)return t[0];const[a]=t,s=a.length,l=PixelBlock.Z.createEmptyBand(o,s),i=new Set;for(let n=0;n<s;n++)if(!e||e[n]){let e;i.clear();for(let o=0;o<r;o++)e=t[o][n],i.add(e);l[n]=i.size}return l}function W(t,e,n){return J(t,null,n)}function Y(t,e,n){return K(t,null,n)}function Z(t,e,n){return Q(t,null,n)}function $(t,e,n){return j(t,null,n)}function _(t,e,n){return P(t,null,n)}function tt(t,e,n){return X(t,null,n)}function et(t,e,n){return V(t,null,n)}function nt(t,e,n){return U(t,null,n)}function ot(t,e,n){return z(t,null,n)}function rt(t,e,n){return G(t,null,n)}const at=new Map,st=new Map,lt=new Map;function ct(e,r,s={}){!function it(){at.size||(at.set(4,Math.sqrt),at.set(6,Math.acos),at.set(7,Math.asin),at.set(8,Math.atan),at.set(9,Math.atanh),at.set(10,Math.abs),at.set(21,Math.cos),at.set(22,Math.cosh),at.set(25,Math.exp),at.set(30,Math.floor),at.set(35,Math.log),at.set(36,Math.log10),at.set(37,Math.log2),at.set(48,Math.floor),at.set(49,Math.ceil),at.set(51,Math.sin),at.set(52,Math.sinh),at.set(56,Math.tan),at.set(57,Math.tanh),at.set(59,Math.acosh),at.set(60,Math.asinh),at.set(65,Math.floor),st.set(5,Math.pow),st.set(61,Math.atan2),lt.set(1,localUtils_s),lt.set(2,localUtils_i),lt.set(3,localUtils_c),lt.set(11,localUtils_p),lt.set(12,localUtils_y),lt.set(12,localUtils_y),lt.set(13,B),lt.set(14,M),lt.set(15,localUtils_m),lt.set(16,E),lt.set(17,N),lt.set(18,localUtils_w),lt.set(19,D),lt.set(20,S),lt.set(23,localUtils_u),lt.set(24,localUtils_A),lt.set(26,T),lt.set(27,x),lt.set(28,q),lt.set(29,H),lt.set(31,C),lt.set(32,localUtils_l),lt.set(33,L),lt.set(34,R),lt.set(44,localUtils_F),lt.set(45,O),lt.set(46,localUtils_b),lt.set(64,localUtils_f),lt.set(65,localUtils_h),lt.set(76,localUtils_v),lt.set(38,J),lt.set(39,j),lt.set(40,U),lt.set(41,z),lt.set(42,P),lt.set(43,K),lt.set(47,G),lt.set(54,X),lt.set(55,V),lt.set(58,Q),lt.set(66,W),lt.set(67,$),lt.set(68,nt),lt.set(69,ot),lt.set(70,_),lt.set(71,Y),lt.set(72,rt),lt.set(73,tt),lt.set(74,et),lt.set(75,Z))}();const l=(0,maybe.Wg)(function localUtils_a(t){const n=t.map((t=>t.mask)).filter((t=>(0,maybe.pC)(t)));if(0===n.length)return null;const o=n[0].length,r=new Uint8Array(o);if(1===n.length)return r.set(n[0]),r;let a,s=n[0];for(let e=1;e<n.length;e++){a=n[e];for(let t=0;t<o;t++)r[t]=s[t]|a[t];s=a}return r}(e)),{processAsMultiband:i,outputPixelType:c="f32"}=s,u=i?e[0].pixels.length:1,f=[];let h;for(let t=0;t<u;t++){const n=e.map((e=>e.pixels[t]));let a;if(r===localUtils_o.SetNull){const t=localUtils_k(n,l,c);a=t.band,h=t.mask}else lt.has(r)?a=lt.get(r)(n,l,c):at.has(r)?a=localUtils_g(n,l,c,at.get(r)):st.has(r)&&(a=localUtils_d(n,l,c,st.get(r)));if(null==a)return null;f.push(a)}h||r===localUtils_o.IsNull||(h=l);const p=e[0];return new PixelBlock.Z({width:p.width,height:p.height,pixelType:c,mask:h,pixels:f})}let LocalFunction_u=class extends a{constructor(){super(...arguments),this.functionName="Local",this.functionArguments=null,this.rasterArgumentNames=["rasters"]}_bindSourceRasters(){const{sourceRasterInfos:t}=this,s=t[0],{bandCount:o}=s,{processAsMultiband:r}=this.functionArguments;if(r&&t.some((t=>t.bandCount!==o)))return{success:!1,error:"local-function: input rasters do not have same band count"};this.outputPixelType=this._getOutputPixelType("f32");const e=s.clone();return e.pixelType=this.outputPixelType,e.statistics=null,e.histograms=null,r||(e.bandCount=1),this.rasterInfo=e,{success:!0}}_processPixels(t){const{pixelBlocks:o}=t;return(0,maybe.Wi)(o)||o.some((t=>(0,maybe.Wi)(t)))?null:ct(o,this.functionArguments.operation,{processAsMultiband:this.functionArguments.processAsMultiband,outputPixelType:this.outputPixelType??void 0})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],LocalFunction_u.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:LocalFunctionArguments_c,json:{write:!0,name:"rasterFunctionArguments"}})],LocalFunction_u.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],LocalFunction_u.prototype,"rasterArgumentNames",void 0),LocalFunction_u=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.LocalFunction")],LocalFunction_u);const LocalFunction_c=LocalFunction_u;var MaskFunctionArguments_a;let MaskFunctionArguments_n=MaskFunctionArguments_a=class extends p{constructor(){super(...arguments),this.includedRanges=null,this.noDataValues=null,this.noDataInterpretation=pixelUtils.DX.matchAny}clone(){return new MaskFunctionArguments_a({includedRanges:this.includedRanges?.slice()??[],noDataValues:this.noDataValues?.slice()??[],noDataInterpretation:this.noDataInterpretation})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],MaskFunctionArguments_n.prototype,"includedRanges",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],MaskFunctionArguments_n.prototype,"noDataValues",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],MaskFunctionArguments_n.prototype,"noDataInterpretation",void 0),MaskFunctionArguments_n=MaskFunctionArguments_a=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.MaskFunctionArguments")],MaskFunctionArguments_n);const MaskFunctionArguments_i=MaskFunctionArguments_n;let MaskFunction_p=class extends a{constructor(){super(...arguments),this.functionName="Mask",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null}_bindSourceRasters(){const t=this.sourceRasterInfos[0].clone(),{pixelType:s}=t;this.outputPixelType=this._getOutputPixelType(s),t.pixelType=this.outputPixelType,this.rasterInfo=t;const{includedRanges:e,noDataValues:o}=this.functionArguments;return e?.length||o?.length?(this.lookup=(0,pixelUtils.nA)(s,this.functionArguments.includedRanges,this.functionArguments.noDataValues),{success:!0}):{success:!1,error:"missing includedRanges or noDataValues argument"}}_processPixels(t){const e=t.pixelBlocks?.[0];if((0,maybe.Wi)(e))return null;const{outputPixelType:o,lookup:r}=this,{includedRanges:n,noDataValues:u,noDataInterpretation:p}=this.functionArguments,c=p===pixelUtils.DX.matchAll;return(0,pixelUtils.sS)(e,{includedRanges:n,noDataValues:u,outputPixelType:o,matchAll:c,lookup:r})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],MaskFunction_p.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:MaskFunctionArguments_i,json:{write:!0,name:"rasterFunctionArguments"}})],MaskFunction_p.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],MaskFunction_p.prototype,"rasterArgumentNames",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],MaskFunction_p.prototype,"lookup",void 0),MaskFunction_p=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.MaskFunction")],MaskFunction_p);const MaskFunction_c=MaskFunction_p;var NDVIFunctionArguments_t;let NDVIFunctionArguments_i=NDVIFunctionArguments_t=class extends p{constructor(){super(...arguments),this.visibleBandID=0,this.infraredBandID=1,this.scaled=!0}clone(){const{visibleBandID:r,infraredBandID:s,scaled:e}=this;return new NDVIFunctionArguments_t({visibleBandID:r,infraredBandID:s,scaled:e})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],NDVIFunctionArguments_i.prototype,"visibleBandID",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],NDVIFunctionArguments_i.prototype,"infraredBandID",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],NDVIFunctionArguments_i.prototype,"scaled",void 0),NDVIFunctionArguments_i=NDVIFunctionArguments_t=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.NDVIFunctionArguments")],NDVIFunctionArguments_i);const NDVIFunctionArguments_a=NDVIFunctionArguments_i;let NDVIFunction_c=class extends a{constructor(){super(...arguments),this.functionName="NDVI",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const{scaled:t}=this.functionArguments;this.outputPixelType=this._getOutputPixelType(t?"u8":"f32");const s=this.sourceRasterInfos[0].clone();s.pixelType=this.outputPixelType,s.colormap=null,s.histograms=null;const[r,e,o,n]=t?[0,200,100,10]:[-1,1,0,.1];return s.statistics=[{min:r,max:e,avg:o,stddev:n}],this.rasterInfo=s,{success:!0}}_processPixels(t){const r=t.pixelBlocks?.[0];if((0,maybe.Wi)(r))return null;const{visibleBandID:e,infraredBandID:n,scaled:i}=this.functionArguments;return function bandIndexUtils_i(n,t,r,o){const{mask:a,pixels:s,width:i,height:l}=n,c=s[r],u=s[t],f=u.length,m=o?new Uint8Array(f):new Float32Array(f),w=o?100:1,h=o?100:0;for(let e=0;e<f;e++)if(null==a||a[e]){const n=c[e],t=u[e],r=n+t;r&&(m[e]=(n-t)/r*w+h)}const d=new PixelBlock.Z({width:i,height:l,mask:a,pixelType:o?"u8":"f32",pixels:[m]});return d.updateStatistics(),d}(r,e,n,i)}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],NDVIFunction_c.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:NDVIFunctionArguments_a,json:{write:!0,name:"rasterFunctionArguments"}})],NDVIFunction_c.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],NDVIFunction_c.prototype,"rasterArgumentNames",void 0),NDVIFunction_c=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.NDVIFunction")],NDVIFunction_c);const NDVIFunction_u=NDVIFunction_c;var RemapFunctionArguments_r;let RemapFunctionArguments_a=RemapFunctionArguments_r=class extends p{constructor(){super(...arguments),this.inputRanges=null,this.outputValues=null,this.noDataRanges=null,this.allowUnmatched=!1}clone(){return new RemapFunctionArguments_r({inputRanges:[...this.inputRanges],outputValues:[...this.outputValues],noDataRanges:[...this.noDataRanges],allowUnmatched:this.allowUnmatched})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],RemapFunctionArguments_a.prototype,"inputRanges",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],RemapFunctionArguments_a.prototype,"outputValues",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],RemapFunctionArguments_a.prototype,"noDataRanges",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],RemapFunctionArguments_a.prototype,"allowUnmatched",void 0),RemapFunctionArguments_a=RemapFunctionArguments_r=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.RemapFunctionArguments")],RemapFunctionArguments_a);const RemapFunctionArguments_n=RemapFunctionArguments_a;let RemapFunction_l=class extends a{constructor(){super(...arguments),this.functionName="Remap",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null}_bindSourceRasters(){const t=this.sourceRasterInfos[0].clone(),{pixelType:o}=t;this.outputPixelType=this._getOutputPixelType(o),t.pixelType=this.outputPixelType,t.colormap=null,t.histograms=null;const{statistics:s}=t,{allowUnmatched:r,outputValues:n}=this.functionArguments;if((0,maybe.pC)(s)&&s.length&&!r){let t=n[0],e=t;for(let o=0;o<n.length;o++)t=t>n[o]?n[o]:t,e=e>n[o]?e:n[o];for(let o=0;o<s.length;o++)s[o]={...s[o],min:t,max:e}}return this.rasterInfo=t,this.lookup=r?null:(0,pixelUtils.oB)(o,this.functionArguments.inputRanges,n),{success:!0}}_processPixels(t){const e=t.pixelBlocks?.[0];if((0,maybe.Wi)(e))return null;const{lookup:s,outputPixelType:r}=this;if(s)return(0,pixelUtils.XV)(e,{lut:[s.lut],offset:s.offset,outputPixelType:r});const{inputRanges:n,outputValues:u,noDataRanges:a,allowUnmatched:l}=this.functionArguments;return(0,pixelUtils.a2)(e,{inputRanges:n,outputValues:u,noDataRanges:a,allowUnmatched:l,outputPixelType:r})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],RemapFunction_l.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:RemapFunctionArguments_n,json:{write:!0,name:"rasterFunctionArguments"}})],RemapFunction_l.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],RemapFunction_l.prototype,"rasterArgumentNames",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],RemapFunction_l.prototype,"lookup",void 0),RemapFunction_l=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.RemapFunction")],RemapFunction_l);const RemapFunction_c=RemapFunction_l;var SlopeFunctionArguments_i;const SlopeFunctionArguments_c=new jsonMap.X({0:"degree",1:"percent-rise",2:"adjusted"},{useNumericKeys:!0});let SlopeFunctionArguments_a=SlopeFunctionArguments_i=class extends p{constructor(){super(...arguments),this.slopeType="degree",this.zFactor=1,this.pixelSizePower=.664,this.pixelSizeFactor=.024}clone(){return new SlopeFunctionArguments_i({slopeType:this.slopeType,zFactor:this.zFactor,pixelSizePower:this.pixelSizePower,pixelSizeFactor:this.pixelSizeFactor,raster:this.raster})}};(0,tslib_es6._)([(0,enumeration.J)(SlopeFunctionArguments_c)],SlopeFunctionArguments_a.prototype,"slopeType",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number,json:{write:!0}})],SlopeFunctionArguments_a.prototype,"zFactor",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number,json:{name:"psPower",write:!0}})],SlopeFunctionArguments_a.prototype,"pixelSizePower",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number,json:{name:"psFactor",write:!0}})],SlopeFunctionArguments_a.prototype,"pixelSizeFactor",void 0),SlopeFunctionArguments_a=SlopeFunctionArguments_i=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.SlopeFunctionArguments")],SlopeFunctionArguments_a);const SlopeFunctionArguments_n=SlopeFunctionArguments_a;let SlopeFunction_p=class extends a{constructor(){super(...arguments),this.functionName="Slope",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.isGCS=!1}_bindSourceRasters(){this.outputPixelType=this._getOutputPixelType("f32");const t=this.sourceRasterInfos[0].clone();return t.pixelType=this.outputPixelType,t.statistics=null,t.histograms=null,this.rasterInfo=t,this.isGCS=t.spatialReference.isGeographic,{success:!0}}_processPixels(t){const s=t.pixelBlocks?.[0];if((0,maybe.Wi)(s))return null;const{zFactor:r,slopeType:o,pixelSizePower:i,pixelSizeFactor:p}=this.functionArguments,{isGCS:c}=this,{extent:u}=t,a=u?{x:u.width/s.width,y:u.height/s.height}:{x:1,y:1};return(0,surfaceUtils.yg)(s,{zFactor:r,slopeType:o,pixelSizePower:i,pixelSizeFactor:p,isGCS:c,resolution:a})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],SlopeFunction_p.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:SlopeFunctionArguments_n,json:{write:!0,name:"rasterFunctionArguments"}})],SlopeFunction_p.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],SlopeFunction_p.prototype,"rasterArgumentNames",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],SlopeFunction_p.prototype,"isGCS",void 0),SlopeFunction_p=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.SlopeFunction")],SlopeFunction_p);const SlopeFunction_c=SlopeFunction_p;var StatisticsHistogramsFunctionArguments_e;let StatisticsHistogramsFunctionArguments_c=StatisticsHistogramsFunctionArguments_e=class extends p{constructor(){super(...arguments),this.statistics=null,this.histograms=null}clone(){return new StatisticsHistogramsFunctionArguments_e({statistics:(0,lang.d9)(this.statistics),histograms:(0,lang.d9)(this.histograms)})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],StatisticsHistogramsFunctionArguments_c.prototype,"statistics",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],StatisticsHistogramsFunctionArguments_c.prototype,"histograms",void 0),StatisticsHistogramsFunctionArguments_c=StatisticsHistogramsFunctionArguments_e=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.StatisticsHistogramsFunctionArguments")],StatisticsHistogramsFunctionArguments_c);const StatisticsHistogramsFunctionArguments_a=StatisticsHistogramsFunctionArguments_c;let StatisticsHistogramsFunction_i=class extends a{constructor(){super(...arguments),this.functionName="StatisticsHistograms",this.functionArguments=null,this.rasterArgumentNames=["raster"]}_bindSourceRasters(){const t=this.sourceRasterInfos[0];this.outputPixelType=this._getOutputPixelType("u8");const s=t.clone(),{statistics:r,histograms:o}=this.functionArguments;return s.histograms=o,r&&(s.statistics=r.map((([t,s,r,o])=>({min:t,max:s,avg:r,stddev:o})))),this.rasterInfo=s,{success:!0}}_processPixels(t){return t.pixelBlocks?.[0]}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],StatisticsHistogramsFunction_i.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:StatisticsHistogramsFunctionArguments_a,json:{write:!0,name:"rasterFunctionArguments"}})],StatisticsHistogramsFunction_i.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],StatisticsHistogramsFunction_i.prototype,"rasterArgumentNames",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],StatisticsHistogramsFunction_i.prototype,"indexedColormap",void 0),StatisticsHistogramsFunction_i=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.StatisticsHistogramsFunction")],StatisticsHistogramsFunction_i);const StatisticsHistogramsFunction_n=StatisticsHistogramsFunction_i;var StretchFunctionArguments_n;const StretchFunctionArguments_p=new jsonMap.X({0:"none",3:"standard-deviation",4:"histogram-equalization",5:"min-max",6:"percent-clip",7:"sigmoid"},{useNumericKeys:!0});let StretchFunctionArguments_c=StretchFunctionArguments_n=class extends p{constructor(){super(...arguments),this.computeGamma=!1,this.dynamicRangeAdjustment=!1,this.gamma=[],this.histograms=null,this.statistics=null,this.stretchType="none",this.useGamma=!1}writeStatistics(t,e,o){t?.length&&(Array.isArray(t[0])||(t=t.map((t=>[t.min,t.max,t.avg,t.stddev]))),e[o]=t)}clone(){return new StretchFunctionArguments_n({stretchType:this.stretchType,outputMin:this.outputMin,outputMax:this.outputMax,useGamma:this.useGamma,computeGamma:this.computeGamma,statistics:(0,lang.d9)(this.statistics),gamma:(0,lang.d9)(this.gamma),sigmoidStrengthLevel:this.sigmoidStrengthLevel,numberOfStandardDeviations:this.numberOfStandardDeviations,minPercent:this.minPercent,maxPercent:this.maxPercent,histograms:(0,lang.d9)(this.histograms),dynamicRangeAdjustment:this.dynamicRangeAdjustment,raster:this.raster})}};(0,tslib_es6._)([(0,property.Cb)({type:Boolean,json:{write:!0}})],StretchFunctionArguments_c.prototype,"computeGamma",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Boolean,json:{name:"dra",write:!0}})],StretchFunctionArguments_c.prototype,"dynamicRangeAdjustment",void 0),(0,tslib_es6._)([(0,property.Cb)({type:[Number],json:{write:!0}})],StretchFunctionArguments_c.prototype,"gamma",void 0),(0,tslib_es6._)([(0,property.Cb)()],StretchFunctionArguments_c.prototype,"histograms",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number,json:{write:!0}})],StretchFunctionArguments_c.prototype,"maxPercent",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number,json:{write:!0}})],StretchFunctionArguments_c.prototype,"minPercent",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number,json:{write:!0}})],StretchFunctionArguments_c.prototype,"numberOfStandardDeviations",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number,json:{name:"max",write:!0}})],StretchFunctionArguments_c.prototype,"outputMax",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number,json:{name:"min",write:!0}})],StretchFunctionArguments_c.prototype,"outputMin",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number,json:{write:!0}})],StretchFunctionArguments_c.prototype,"sigmoidStrengthLevel",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{type:[[Number]],write:!0}})],StretchFunctionArguments_c.prototype,"statistics",void 0),(0,tslib_es6._)([(0,writer.c)("statistics")],StretchFunctionArguments_c.prototype,"writeStatistics",null),(0,tslib_es6._)([(0,enumeration.J)(StretchFunctionArguments_p)],StretchFunctionArguments_c.prototype,"stretchType",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Boolean,json:{write:!0}})],StretchFunctionArguments_c.prototype,"useGamma",void 0),StretchFunctionArguments_c=StretchFunctionArguments_n=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.StretchFunctionArguments")],StretchFunctionArguments_c);const StretchFunctionArguments_u=StretchFunctionArguments_c;var stretchUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/rasterFunctions/stretchUtils.js");let StretchFunction_a=class extends a{constructor(){super(...arguments),this.functionName="Stretch",this.functionArguments=null,this.rasterArgumentNames=["raster"],this.lookup=null,this.cutOffs=null}_bindSourceRasters(){this.lookup=null,this.cutOffs=null;const t=this.sourceRasterInfos[0],{pixelType:s}=t,{functionArguments:e}=this,{dynamicRangeAdjustment:o,gamma:r,useGamma:i}=e;if(!o&&["u8","u16","s8","s16"].includes(s)){const o=(0,stretchUtils.AV)(e.toJSON(),{rasterInfo:t});this.lookup=(0,stretchUtils.hE)({pixelType:s,...o,gamma:i?r:null})}else o&&(this.cutOffs=(0,stretchUtils.AV)(e.toJSON(),{rasterInfo:t}));this.outputPixelType=this._getOutputPixelType(s);const u=t.clone();return u.pixelType=this.outputPixelType,u.statistics=null,u.histograms=null,"u8"===this.outputPixelType&&(u.keyProperties.DataType="processed"),this.rasterInfo=u,{success:!0}}_processPixels(t){const e=t.pixelBlocks?.[0];if((0,maybe.Wi)(e))return e;const{lookup:o}=this;if(o)return(0,pixelUtils.XV)(e,{...o,outputPixelType:this.rasterInfo.pixelType});const{functionArguments:r}=this,u=this.cutOffs||(0,stretchUtils.AV)(r.toJSON(),{rasterInfo:this.sourceRasterInfos[0],pixelBlock:e}),p=r.useGamma?r.gamma:null;return(0,stretchUtils.dy)(e,{...u,gamma:p,outputPixelType:this.outputPixelType})}};(0,tslib_es6._)([(0,property.Cb)({json:{write:!0,name:"rasterFunction"}})],StretchFunction_a.prototype,"functionName",void 0),(0,tslib_es6._)([(0,property.Cb)({type:StretchFunctionArguments_u,json:{write:!0,name:"rasterFunctionArguments"}})],StretchFunction_a.prototype,"functionArguments",void 0),(0,tslib_es6._)([(0,property.Cb)()],StretchFunction_a.prototype,"rasterArgumentNames",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],StretchFunction_a.prototype,"lookup",void 0),(0,tslib_es6._)([(0,property.Cb)({json:{write:!0}})],StretchFunction_a.prototype,"cutOffs",void 0),StretchFunction_a=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterFunctions.StretchFunction")],StretchFunction_a);const StretchFunction_l=StretchFunction_a,rasterFunctionHelper_d=new Map;function rasterFunctionHelper_l(r,e){if("rasterFunction"in r)return rasterFunctionHelper_h(r,e??{});throw new Error.Z("raster-function-helper","unsupported raster function json.")}function rasterFunctionHelper_h(r,e){const{rasterFunction:s,rasterFunctionArguments:n}=r,o=r.outputPixelType?.toLowerCase();if(null==s||!rasterFunctionHelper_d.has(s))throw new Error.Z("raster-function-helper",`unsupported raster function: ${s}`);const a=rasterFunctionHelper_d.get(s),c=("function"==typeof a.ctor?a.ctor:a.ctor.default).fromJSON({...r,outputPixelType:o}),{rasterArgumentNames:i}=c,u=[],m=function rasterFunctionHelper_N(t,r){return"rasters"===r[0]&&Array.isArray(t.rasters)?t.rasters:r.map((r=>t[r]))}(n,i),p="rasters"===i[0],f=[];for(let t=0;t<m.length;t++){const r=m[t];let s;null==r||"string"==typeof r&&r.startsWith("$")?u.push(e?.raster):"string"==typeof r?e[r]&&u.push(e[r]):"number"!=typeof r&&"rasterFunction"in r&&(s=rasterFunctionHelper_h(r,e),p||(c.functionArguments[i[t]]=s),u.push(s)),p&&f.push(s??r)}if(p&&(c.functionArguments.rasters=f),e){c.sourceRasters=u;const t=e.raster?.url;t&&(c.mainPrimaryRasterId=t)}return c}rasterFunctionHelper_d.set("Aspect",{desc:"Aspect Function",ctor:AspectFunction_p,rasterArgumentNames:["raster"]}),rasterFunctionHelper_d.set("BandArithmetic",{desc:"Band Arithmetic Function",ctor:BandArithmeticFunction_a,rasterArgumentNames:["raster"]}),rasterFunctionHelper_d.set("Colormap",{desc:"Colormap Function",ctor:ColormapFunction_p,rasterArgumentNames:["raster"]}),rasterFunctionHelper_d.set("CompositeBand",{desc:"CompositeBand Function",ctor:CompositeBandFunction_u,rasterArgumentNames:["rasters"]}),rasterFunctionHelper_d.set("Convolution",{desc:"Convolution Function",ctor:ConvolutionFunction_l,rasterArgumentNames:["raster"]}),rasterFunctionHelper_d.set("ExtractBand",{desc:"ExtractBand Function",ctor:ExtractBandFunction_u,rasterArgumentNames:["raster"]}),rasterFunctionHelper_d.set("Local",{desc:"Local Function",ctor:LocalFunction_c,rasterArgumentNames:["rasters"]}),rasterFunctionHelper_d.set("Mask",{desc:"Mask Function",ctor:MaskFunction_c,rasterArgumentNames:["raster"]}),rasterFunctionHelper_d.set("NDVI",{desc:"NDVI Function",ctor:NDVIFunction_u,rasterArgumentNames:["raster"]}),rasterFunctionHelper_d.set("Remap",{desc:"Remap Function",ctor:RemapFunction_c,rasterArgumentNames:["raster"]}),rasterFunctionHelper_d.set("Slope",{desc:"Slope Function",ctor:SlopeFunction_c,rasterArgumentNames:["raster"]}),rasterFunctionHelper_d.set("StatisticsHistograms",{desc:"Statistics Histograms Function",ctor:StatisticsHistogramsFunction_n,rasterArgumentNames:["raster"]}),rasterFunctionHelper_d.set("Stretch",{desc:"Stretch Function",ctor:StretchFunction_l,rasterArgumentNames:["raster"]})},"./node_modules/@arcgis/core/layers/support/rasterFunctions/rasterProjectionHelper.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Hq:()=>Q,Mk:()=>M,P_:()=>V,Qp:()=>$,VO:()=>C,_D:()=>v,kZ:()=>ne,kr:()=>oe,nF:()=>j,tB:()=>J,ut:()=>U,vF:()=>ie,zD:()=>T});__webpack_require__("./node_modules/@arcgis/core/geometry.js");var d,e,_core_Error_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/unitUtils.js"),_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/chunks/pe.js"),_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/projection.js"),_geometry_Extent_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/geometry/Extent.js"),_geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js"),_geometry_Polygon_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/geometry/Polygon.js"),_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js");function M(e,t,n){return!(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.Up)(e,t,n)}function w(t,n,o){const i=M(t,n,o);if(i&&!(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.kR)())throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z("rasterprojectionhelper-project","projection engine is not loaded");return i}(e=d||(d={}))[e.None=0]="None",e[e.North=1]="North",e[e.South=2]="South",e[e.Both=3]="Both";const R=(e,t,n,o=0)=>{if(1===n[0])return[0,0];let i=1,r=-1,s=1,a=-1;for(let g=0;g<e.length;g+=2)isNaN(e[g])||(i=i>e[g]?e[g]:i,r=r>e[g]?r:e[g],s=s>e[g+1]?e[g+1]:s,a=a>e[g+1]?a:e[g+1]);const{cols:l,rows:c}=t,f=(r-i)/l/n[0],u=(a-s)/c/n[1],m=2*o;let h=0,x=!1,p=[0,0];for(let g=0;g<l-3;g++){for(let t=0;t<c-3;t++){const n=g*c*2+2*t,o=(e[n]+e[n+4]+e[n+4*c]+e[n+4*c+4])/4,i=(e[n+1]+e[n+5]+e[n+4*c+1]+e[n+4*c+5])/4,r=Math.abs((o-e[n+2*c+2])/f),s=Math.abs((i-e[n+2*c+3])/u);if(r+s>h&&(h=r+s,p=[r,s]),m&&h>m){x=!0;break}}if(x)break}return p},P={3395:20037508.342789244,3410:17334193.943686873,3857:20037508.342788905,3975:17367530.445161372,4087:20037508.342789244,4088:20015108.787169147,6933:17367530.445161372,32662:20037508.342789244,53001:20015086.79602057,53002:10007543.39801029,53003:20015086.79602057,53004:20015086.79602057,53016:14152803.599503474,53017:17333573.624304302,53034:20015086.79602057,53079:20015114.352186374,53080:20015114.352186374,54001:20037508.342789244,54002:10018754.171394624,54003:20037508.342789244,54004:20037508.342789244,54016:14168658.027268292,54017:17367530.44516137,54034:20037508.342789244,54079:20037508.342789244,54080:20037508.342789244,54100:20037508.342789244,54101:20037508.342789244},N=new Map,E=new Map,k=500;async function T(){(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.kR)()||await(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.zD)()}function v(e,t,n){return w(e.spatialReference,t)?n?(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.rS)(t,e.spatialReference,e):(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.rS)(e.spatialReference,t,e):null}function C(e,i,r,s=null){const a=e.spatialReference;if(a.equals(i))return e;w(a,i,s);const l=r.center,c=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_5__.Z({xmin:l.x-e.x/2,xmax:l.x+e.x/2,ymin:l.y-e.y/2,ymax:l.y+e.y/2,spatialReference:a}),f=(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.iV)(c,i,s),u=U(i);let m;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(f)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(u)&&f.width>=u){const t=(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_2__.c9)(a)/(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_2__.c9)(i);m={x:e.x*t,y:e.y*t}}else m={x:f.width,y:f.height};return m}function _(e,t=.01){return(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_2__.c9)(e)?t/(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_2__.c9)(e):0}function j(e,t,n=null,o=!0){const i=e.spatialReference;if(i.equals(t))return e;w(i,t,n);const r=(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.iV)(e,t,n);return o&&r?(z([e],[r],i,t),r):r}function z(e,t,o,i){const r=D(o,!0),s=D(i,!0),a=_(o,k),l=_(i,k);if(a&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(r)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(s))for(let n=0;n<e.length;n++){const o=t[n];if(!o)continue;const{x:i}=e[n],{x:c}=o;c>=s[1]-l&&Math.abs(i-r[0])<a?o.x-=s[1]-s[0]:c<=s[0]+l&&Math.abs(i-r[1])<a&&(o.x+=s[1]-s[0])}}function W(e){const{inSR:t,outSR:o,datumTransformation:i,preferPE:r}=e;if(t.equals(o)){const{points:t}=Y(e,null);return t}if(t.isWebMercator&&o.isWGS84||t.isWGS84&&o.isWebMercator)return function A(e){const{cols:t,rows:n,xres:o,yres:i,usePixelCenter:r,inSR:s,outSR:a}=e;let{xmin:l,ymax:c}=e;r&&(l+=o/2,c-=i/2);const f=[],u=[],m=Math.max(t,n);for(let g=0;g<m;g++){const e=l+o*Math.min(t,g),r=c-i*Math.min(n,g),m=(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.iV)(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z({x:e,y:r,spatialReference:s}),a);g<=t&&f.push(m.x),g<=n&&u.push(m.y)}const x=[];for(let h=0;h<t;h++)for(let e=0;e<n;e++)x.push([f[h],u[e]]);return x}(e);if(w(t,o,i)&&r){if(t.isGeographic)return O(e);const o=B(t);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(o))return O(e)}return function L(e){const{points:t}=Y(e,null),{inSR:n,outSR:o,datumTransformation:i}=e,r=t.map((e=>new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z(e[0],e[1],n))),s=(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.iV)(r,o,i);return i&&z(r,s,n,o),s.map((e=>e?[e.x,e.y]:[NaN,NaN]))}(e)}function O(e){const{inSR:t,outSR:o,datumTransformation:l}=e,c=B(t),{points:f,mask:u}=Y(e,c);if(!t.isGeographic){const e=t.wkid?_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.e.coordsys(t.wkid):_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.e.fromString(t.isGeographic?_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.f.PE_TYPE_GEOGCS:_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.f.PE_TYPE_PROJCS,t.wkt);_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.g.projToGeog(e,f.length,f)}if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(l)&&l.steps.length){let e;const t=179.9955;if(o.isGeographic&&(e=f.map((([e])=>e>t?1:e<-t?-1:0))),l.steps.forEach((e=>{const t=e.wkid?_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.e.geogtran(e.wkid):_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.e.fromString(_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.f.PE_TYPE_GEOGTRAN,e.wkt);_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.h.geogToGeog(t,f.length,f,null,e.isInverse?_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.f.PE_TRANSFORM_2_TO_1:_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.f.PE_TRANSFORM_1_TO_2)})),e)for(let n=0;n<f.length;n++){const o=e[n],i=f[n][0],r=i>t?1:i<-t?-1:0;o&&r&&o!==r&&(f[n][0]=o>0?i+360:i-360)}}if(!o.isGeographic){const e=B(o,!0),t=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(e)&&e.isEnvelope?[e.bbox[1],e.bbox[3]]:[-90,90];!function F(e,t){const[n,o]=t;for(let i=0;i<e.length;i++){const t=e[i][1];(t<n||t>o)&&(e[i]=[NaN,NaN])}}(f,t);const a=o.wkid?_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.e.coordsys(o.wkid):_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.e.fromString(o.isGeographic?_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.f.PE_TYPE_GEOGCS:_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.f.PE_TYPE_PROJCS,o.wkt);_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.g.geogToProj(a,f.length,f)}let m=f;if(u&&f.length!==u.length){m=[];for(let e=0,t=0;e<u.length;e++)u[e]?m.push(f[t++]):m.push([NaN,NaN])}return m}function B(e,t=!1){let n=e.wkid||e.wkt;if(!n||e.isGeographic)return null;if(n=String(n),N.has(n)){const e=N.get(n);return t?e?.gcs:e?.pcs}const o=e.wkid?_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.e.coordsys(e.wkid):_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.e.fromString(e.isGeographic?_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.f.PE_TYPE_GEOGCS:_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.f.PE_TYPE_PROJCS,e.wkt),s=I(o,_(e,1e-4)),a=I(o,0,!0);return N.set(n,{pcs:s,gcs:a}),t?a:s}function I(e,t=0,n=!1){const o=_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.j.generate(e),i=n?e.horizonGcsGenerate():e.horizonPcsGenerate();if(!o||!i?.length)return null;let r=!1,s=i.find((e=>1===e.getInclusive()&&1===e.getKind()));if(!s){if(s=i.find((e=>1===e.getInclusive()&&0===e.getKind())),!s)return null;r=!0}const a=n?0:(2===o.getNorthPoleLocation()?1:0)|(2===o.getSouthPoleLocation()?2:0),c=o.isPannableRectangle(),f=s.getCoord();if(r)return{isEnvelope:r,isPannable:c,vertices:f,coef:null,bbox:[f[0][0]-t,f[0][1]-t,f[1][0]+t,f[1][1]+t],poleLocation:a};let u=0;const m=[];let[h,x]=f[0],[p,g]=f[0];for(let l=0,y=f.length;l<y;l++){u++,u===y&&(u=0);const[e,t]=f[l],[n,o]=f[u];if(o===t)m.push([e,n,t,o,2]);else{const i=(n-e)/(o-t||1e-4),r=e-i*t;t<o?m.push([i,r,t,o,0]):m.push([i,r,o,t,1])}h=h<e?h:e,x=x<t?x:t,p=p>e?p:e,g=g>t?g:t}return{isEnvelope:!1,isPannable:c,vertices:f,coef:m,bbox:[h,x,p,g],poleLocation:a}}function Y(e,n){const o=[],{cols:i,rows:r,xres:s,yres:a,usePixelCenter:l}=e;let{xmin:c,ymax:f}=e;if(l&&(c+=s/2,f-=a/2),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(n)){for(let e=0;e<i;e++)for(let t=0;t<r;t++)o.push([c+s*e,f-a*t]);return{points:o}}const u=new Uint8Array(i*r);if(n.isEnvelope){const{bbox:[e,t,l,m]}=n;for(let h=0,x=0;h<i;h++){const i=c+s*h,p=n.isPannable||i>=e&&i<=l;for(let e=0;e<r;e++,x++){const n=f-a*e;p&&n>=t&&n<=m&&(o.push([i,n]),u[x]=1)}}return{points:o,mask:u}}const m=n.coef,h=[];for(let t=0;t<r;t++){const e=f-a*t,n=[],o=[];for(let t=0;t<m.length;t++){const[i,r,s,a,l]=m[t];if(e===s&&s===a)n.push(i),n.push(r),o.push(2),o.push(2);else if(e>=s&&e<=a){const t=i*e+r;n.push(t),o.push(l)}}let i=n;if(n.length>2){let e=2===o[0]?0:o[0],t=n[0];i=[];for(let r=1;r<o.length;r++)2===o[r]&&r!==o.length-1||(o[r]!==e&&(i.push(0===e?Math.min(t,n[r-1]):Math.max(t,n[r-1])),e=o[r],t=n[r]),r===o.length-1&&i.push(0===o[r]?Math.min(t,n[r]):Math.max(t,n[r])));i.sort(((e,t)=>e-t))}else n[0]>n[1]&&(i=[n[1],n[0]]);h.push(i)}for(let t=0,x=0;t<i;t++){const e=c+s*t;for(let t=0;t<r;t++,x++){const n=f-a*t,i=h[t];if(2===i.length)e>=i[0]&&e<=i[1]&&(o.push([e,n]),u[x]=1);else if(i.length>2){let t=!1;for(let n=0;n<i.length;n+=2)if(e>=i[n]&&e<=i[n+1]){t=!0;break}t&&(o.push([e,n]),u[x]=1)}}}return{points:o,mask:u}}function q(e){const n=U(e[0].spatialReference);if(e.length<2||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(n))return e[0];let{xmin:o,xmax:i,ymin:r,ymax:s}=e[0];for(let t=1;t<e.length;t++){const o=e[t];i=o.xmax+n*t,r=Math.min(r,o.ymin),s=Math.max(s,o.ymax)}return new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_5__.Z({xmin:o,xmax:i,ymin:r,ymax:s,spatialReference:e[0].spatialReference})}function J(e,o,i=null,r=!0){const s=e.spatialReference;if(s.equals(o))return e;const a=Q(e),l=U(s,!0),c=U(o);if(0===a||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(l)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(c)){const a=K(e,o,i,r);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(l)&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(c)&&Math.abs(a.width-c)<_(o)&&(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.kR)()){const t=B(s);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(t)&&t.poleLocation===d.None&&e.width<(t.bbox[2]-t.bbox[0])/2)return function X(e,n){const o=U(n);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(o))return null;let{xmin:i,ymin:r,xmax:s,ymax:a}=e;const l=e.spatialReference,c=new _geometry_Polygon_js__WEBPACK_IMPORTED_MODULE_7__.Z({spatialReference:l,rings:[[[i,r],[s,r],[s,a],[i,a],[i,r]]]}),f=(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.iV)(c,n);if(2!==f.rings.length||!f.rings[0].length||!f.rings[1].length)return null;const{rings:u}=f,m=_(l),p=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_5__.Z({spatialReference:n});for(let t=0;t<2;t++){i=s=u[t][0][0],r=a=u[t][0][1];for(let e=0;e<u[t].length;e++)i=i>u[t][e][0]?u[t][e][0]:i,s=s<u[t][e][0]?u[t][e][0]:s,r=r>u[t][e][1]?u[t][e][1]:r,a=a<u[t][e][1]?u[t][e][1]:a;if(0===t)p.ymin=r,p.ymax=a,p.xmin=i,p.xmax=s;else if(p.ymin=Math.min(p.ymin,r),p.ymax=Math.max(p.ymax,a),Math.abs(s-o/2)<m)p.xmin=i,p.xmax=p.xmax+o;else{if(!(Math.abs(i+o/2)<m))return null;p.xmax=s+o}}return p}(e,o)||a}return a}const u=e.clone().normalize();if(1===u.length&&e.xmax<l&&e.xmax-l/2>_(s)){const{xmin:t,xmax:n}=e;for(let o=0;o<=a;o++){const i=0===o?t:-l/2,r=o===a?n-l*o:l/2;u[o]=new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_5__.Z({xmin:i,xmax:r,ymin:e.ymin,ymax:e.ymax,spatialReference:s})}}return q(u.map((e=>K(e,o,i,r))).filter(_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC))}function K(e,n,o=null,i=!0,r=!0){const s=e.spatialReference;if(s.equals(n)||!n)return e;w(s,n,o);const a=(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_4__.iV)(e,n,o);if(r&&n.isWebMercator&&a&&(a.ymax=Math.min(20037508.342787,a.ymax),a.ymin=Math.max(-20037508.342787,a.ymin),a.ymin>=a.ymax))return null;if(!i||!a)return a;const l=D(s,!0),c=D(n,!0);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(l)||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(c))return a;const f=_(s,.001),u=_(s,k),m=_(n,.001);if(Math.abs(a.xmin-c[0])<m&&Math.abs(a.xmax-c[1])<m){const t=Math.abs(e.xmin-l[0]),i=Math.abs(l[1]-e.xmax);if(t<f&&i>u){a.xmin=c[0];const t=[];t.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z(e.xmax,e.ymin,s)),t.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z(e.xmax,(e.ymin+e.ymax)/2,s)),t.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z(e.xmax,e.ymax,s));const i=t.map((e=>j(e,n,o))).filter((e=>!isNaN(e?.x))).map((e=>e.x));a.xmax=Math.max.apply(null,i)}if(i<f&&t>u){a.xmax=c[1];const t=[];t.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z(e.xmin,e.ymin,s)),t.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z(e.xmin,(e.ymin+e.ymax)/2,s)),t.push(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z(e.xmin,e.ymax,s));const i=t.map((e=>j(e,n,o))).filter((e=>!isNaN(e?.x))).map((e=>e.x));a.xmin=Math.min.apply(null,i)}}else{const e=_(n,.001);Math.abs(a.xmin-c[0])<e&&(a.xmin=c[0]),Math.abs(a.xmax-c[1])<e&&(a.xmax=c[1])}return a}function U(e,t=!1){if(!e)return null;const n=t?20037508.342787:20037508.342788905;return e.isWebMercator?2*n:e.wkid&&e.isGeographic?360:2*P[e.wkid]||null}function D(e,t=!1){if(e.isGeographic)return[-180,180];const o=U(e,t);return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(o)?[-o/2,o/2]:null}function H(e,t,n,o){let i=(e-t)/n;return i-Math.floor(i)!=0?i=Math.floor(i):o&&(i-=1),i}function Q(e,n=!1){const o=U(e.spatialReference);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(o))return 0;const i=n?0:-o/2,r=_(e.spatialReference),s=!n&&Math.abs(e.xmax-o/2)<r?o/2:e.xmax,a=!n&&Math.abs(e.xmin+o/2)<r?-o/2:e.xmin;return H(s,i,o,!0)-H(a,i,o,!1)}function V(e){const o=e.storageInfo.origin.x,i=U(e.spatialReference,!0);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.Wi)(i))return{originX:o,halfWorldWidth:null,pyramidsInfo:null};const r=i/2,{nativePixelSize:s,storageInfo:a,extent:l}=e,{maximumPyramidLevel:c,blockWidth:f,pyramidScalingFactor:u}=a;let m=s.x;const h=[],x=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(e.transform)&&"gcs-shift"===e.transform.type,p=o+(x?0:r),g=x?i-o:r-o;for(let t=0;t<=c;t++){const e=(l.xmax-o)/m/f,t=e-Math.floor(e)==0?e:Math.ceil(e),n=g/m/f,i=n-Math.floor(n)==0?n:Math.ceil(n),r=Math.floor(p/m/f),s=Math.round(p/m)%f,a=(f-Math.round(g/m)%f)%f;h.push({resolutionX:m,blockWidth:f,datsetColumnCount:t,worldColumnCountFromOrigin:i,leftMargin:s,rightPadding:a,originColumnOffset:r}),m*=u}return{originX:o,halfWorldWidth:r,pyramidsInfo:h,hasGCSSShiftTransform:x}}function $(e){const t=e.isAdaptive&&null==e.spacing;let o=e.spacing||[32,32],i=ee(e),r={cols:i.size[0]+1,rows:i.size[1]+1};const s=i.outofBoundPointCount>0&&i.outofBoundPointCount<i.offsets.length/2;let a=i.outofBoundPointCount===i.offsets.length/2||t&&s?[0,0]:R(i.offsets,r,o,4);const l=(a[0]+a[1])/2,c=e.projectedExtent.spatialReference,f=e.srcBufferExtent.spatialReference;if(t&&(s||l>4)&&(M(c,f,e.datumTransformation)&&(c.isGeographic||(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(B(c))),o=[4,4],i=ee({...e,spacing:o}),r={cols:i.size[0]+1,rows:i.size[1]+1},a=R(i.offsets,r,o,4)),i.error=a,o[0]>1&&(i.coefficients=te(i.offsets,r,s)),e.includeGCSGrid&&!c.isGeographic&&!c.isWebMercator)if(f.isGeographic)i.gcsGrid={offsets:i.offsets,coefficients:i.coefficients,spacing:o};else{const t=B(c);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(t)&&!t.isEnvelope){const t=function Z(e){if(!e||e.isGeographic)return e;const t=String(e.wkid||e.wkt);let n;return E.has(t)?n=E.get(t):(n=(e.wkid?_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.e.coordsys(e.wkid):_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.e.fromString(_chunks_pe_js__WEBPACK_IMPORTED_MODULE_3__.f.PE_TYPE_PROJCS,e.wkt)).getGeogcs().getCode(),E.set(t,n)),new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_8__.Z({wkid:n})}(c),n=J(e.projectedExtent,t),{offsets:a}=ee({...e,srcBufferExtent:n,spacing:o}),l=te(a,r,s);i.gcsGrid={offsets:a,coefficients:l,spacing:o}}}return i}function ee(e){const{projectedExtent:t,srcBufferExtent:o,pixelSize:i,datumTransformation:r,rasterTransform:s}=e,a=t.spatialReference,l=o.spatialReference,c=w(a,l),{xmin:f,ymin:u,xmax:m,ymax:h}=t,x=U(l),g=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(x)&&(e.hasWrapAround||"gcs-shift"===s?.type),y=e.spacing||[32,32],d=y[0]*i.x,M=y[1]*i.y,R=1===y[0],P=Math.ceil((m-f)/d-.1/y[0])+(R?0:1),G=Math.ceil((h-u)/M-.1/y[1])+(R?0:1),N=W({cols:P,rows:G,xmin:f,ymax:h,xres:d,yres:M,inSR:a,outSR:l,datumTransformation:r,preferPE:y[0]<=4,usePixelCenter:R}),E=[];let T,v=0;const C=R?-1:NaN,{xmin:j,xmax:z,ymax:L,width:O,height:A}=o,I=_(l,k),Y=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(x)&&j>0&&z>x/2;let F=!1;if(c){const e=B(a);F=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(e)&&e.poleLocation>0}for(let n=0;n<P;n++){const e=[];for(let t=0;t<G;t++){let o=N[n*G+t];if(g&&o[0]>z&&o[0]>x/2-I?o[0]-=x:g&&0===n&&o[0]<0&&Y&&!s&&(o[0]+=x),!o||isNaN(o[0])||isNaN(o[1]))E.push(C),E.push(C),e.push(null),v++;else{if(s){const e=s.inverseTransform(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z({x:o[0],y:o[1],spatialReference:l}));o=[e.x,e.y]}e.push(o),n>0&&g&&T[t]&&o[0]<T[t][0]&&(o[0]+=x,F&&o[0]>z&&o[0]>x&&(o[0]-=x)),E.push((o[0]-j)/O),E.push((L-o[1])/A)}}T=e}return{offsets:E,error:null,coefficients:null,outofBoundPointCount:v,spacing:y,size:R?[P,G]:[P-1,G-1]}}function te(e,t,n){const{cols:o,rows:i}=t,r=new Float32Array((o-1)*(i-1)*2*6),s=new Float32Array([-0,-1,1,-1,1,-0,1,-0,-0]),a=new Float32Array([-1,1,0,0,-1,1,1,0,0]);for(let l=0;l<o-1;l++){for(let t=0;t<i-1;t++){let n=l*i*2+2*t;const c=e[n],f=e[n+1],u=e[n+2],m=e[n+3];n+=2*i;const h=e[n],x=e[n+1],p=e[n+2],g=e[n+3];let y=0,d=12*(t*(o-1)+l);for(let e=0;e<3;e++)r[d++]=s[y++]*c+s[y++]*u+s[y++]*p;y=0;for(let e=0;e<3;e++)r[d++]=s[y++]*f+s[y++]*m+s[y++]*g;y=0;for(let e=0;e<3;e++)r[d++]=a[y++]*c+a[y++]*h+a[y++]*p;y=0;for(let e=0;e<3;e++)r[d++]=a[y++]*f+a[y++]*x+a[y++]*g}if(n)for(let e=0;e<r.length;e++)isNaN(r[e])&&(r[e]=-1)}return r}function ne(e){const t=e.clone().normalize();return 1===t.length?t[0]:q(t)}function oe(e,t,i){const{storageInfo:r,pixelSize:s}=t;let a=0,l=!1;const{pyramidResolutions:c}=r;if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(c)&&c.length){const n=(e.x+e.y)/2,r=c[c.length-1],f=(r.x+r.y)/2,u=(s.x+s.y)/2;if(n<=u)a=0;else if(n>=f)a=c.length,l=n/f>8;else{let e,t=u;for(let o=1;o<=c.length;o++){if(e=(c[o-1].x+c[o-1].y)/2,n<=e){n===e?a=o:"down"===i?(a=o-1,l=n/t>8):a="up"===i||n-t>e-n||n/t>2?o:o-1;break}t=e}}const m=0===a?s:c[a-1];return l&&Math.min(m.x,m.y)*(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_2__.c9)(t.spatialReference)>19567&&(l=!1),{pyramidLevel:a,pyramidResolution:new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z({x:m.x,y:m.y,spatialReference:t.spatialReference}),excessiveReading:l}}const f=Math.log(e.x/s.x)/Math.LN2,u=Math.log(e.y/s.y)/Math.LN2,m=t.storageInfo.maximumPyramidLevel||0;a="down"===i?Math.floor(Math.min(f,u)):"up"===i?Math.ceil(Math.max(f,u)):Math.round((f+u)/2),a<0?a=0:a>m&&(l=a>m+3,a=m);const h=2**a;return{pyramidLevel:a,pyramidResolution:new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z({x:h*t.nativePixelSize.x,y:h*t.nativePixelSize.y,spatialReference:t.spatialReference}),excessiveReading:l}}function ie(e,t,i=512,r=!0){const{extent:s,spatialReference:a,pixelSize:l}=e,c=C(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z({x:l.x,y:l.y,spatialReference:a}),t,s);if(null==c)return{projectedPixelSize:null,scales:null,srcResolutions:null,isCustomTilingScheme:!1};const f=(c.x+c.y)/2,u=(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_2__.c9)(t),m=f*u*96*39.37,h=t.isGeographic?256/i*295828763.7958547:256/i*591657527.591555;let x="vector-magdir"===e.dataType||"vector-uv"===e.dataType;const g=J(s,t),y=Math.min(Math.ceil(Math.log(Math.min(e.width,e.height)/32)/Math.LN2),Math.ceil(Math.log(h/2/m)/Math.LN2));if(!x&&r&&(t.isGeographic||t.isWebMercator)&&(x=g.xmin*g.xmax<0,!x&&y<3)){const e=U(t);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__.pC)(e)){const t=2**y*f*i,n=Math.ceil(e/t);x=1===n||2===n&&e/2-g.xmax<t}}let d,M=m;const w=1.001;if(x){M=h;const e=t.isGeographic?1341104507446289e-21:.29858214164761665,n=e*(96*u*39.37),o=t.isGeographic?4326:3857;d=C(new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__.Z({x:e,y:e,spatialReference:{wkid:o}}),a,g),d.x*=M/n,d.y*=M/n}else{d={x:l.x,y:l.y};let e=0;for(;M<h*(w/2)&&e<y;)e++,M*=2,d.x*=2,d.y*=2;Math.max(M,h)/Math.min(M,h)<=w&&(M=h)}const R=[M],P=[{x:d.x,y:d.y}],b=Math.min(70.5310735,m)/w;for(;M>=b;)M/=2,d.x/=2,d.y/=2,R.push(M),P.push({x:d.x,y:d.y});return{projectedPixelSize:c,scales:R,srcResolutions:P,isCustomTilingScheme:!x}}},"./node_modules/@arcgis/core/layers/support/rasterTransforms/BaseRasterTransform.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>a});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"));let t=class extends _core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_0__.wq{get affectsPixelSize(){return!1}forwardTransform(r){return r}inverseTransform(r){return r}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_5__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.Cb)()],t.prototype,"affectsPixelSize",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_5__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.Cb)({json:{write:!0}})],t.prototype,"spatialReference",void 0),t=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_5__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__.j)("esri.layers.support.rasterTransforms.BaseRasterTransform")],t);const a=t},"./node_modules/@arcgis/core/layers/support/rasterTransforms/GCSShiftTransform.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>c});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_3__=(__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js")),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),_BaseRasterTransform_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/layers/support/rasterTransforms/BaseRasterTransform.js");let a=class extends _BaseRasterTransform_js__WEBPACK_IMPORTED_MODULE_5__.Z{constructor(){super(...arguments),this.type="gcs-shift",this.tolerance=1e-8}forwardTransform(r){return"point"===(r=r.clone()).type?(r.x>180+this.tolerance&&(r.x-=360),r):(r.xmin>=180-this.tolerance?(r.xmax-=360,r.xmin-=360):r.xmax>180+this.tolerance&&(r.xmin=-180,r.xmax=180),r)}inverseTransform(r){return"point"===(r=r.clone()).type?(r.x<-this.tolerance&&(r.x+=360),r):(r.xmin<-this.tolerance&&(r.xmin+=360,r.xmax+=360),r)}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_6__._)([(0,_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_3__.J)({GCSShiftXform:"gcs-shift"})],a.prototype,"type",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_6__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_0__.Cb)()],a.prototype,"tolerance",void 0),a=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_6__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_4__.j)("esri.layers.support.rasterTransforms.GCSShiftTransform")],a);const c=a},"./node_modules/@arcgis/core/layers/support/rasterTransforms/PolynomialTransform.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>m});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__=(__webpack_require__("./node_modules/@arcgis/core/geometry.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js")),_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js")),_core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/reader.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),_core_accessorSupport_decorators_writer_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/writer.js"),_BaseRasterTransform_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/layers/support/rasterTransforms/BaseRasterTransform.js"),_geometry_Point_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/geometry/Point.js"),_geometry_Extent_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/geometry/Extent.js");function l(e,r,o){const{x:t,y:s}=r;if(o<2)return{x:e[0]+t*e[2]+s*e[4],y:e[1]+t*e[3]+s*e[5]};if(2===o){const r=t*t,o=s*s,n=t*s;return{x:e[0]+t*e[2]+s*e[4]+r*e[6]+n*e[8]+o*e[10],y:e[1]+t*e[3]+s*e[5]+r*e[7]+n*e[9]+o*e[11]}}const n=t*t,i=s*s,f=t*s,p=n*t,l=n*s,a=t*i,c=s*i;return{x:e[0]+t*e[2]+s*e[4]+n*e[6]+f*e[8]+i*e[10]+p*e[12]+l*e[14]+a*e[16]+c*e[18],y:e[1]+t*e[3]+s*e[5]+n*e[7]+f*e[9]+i*e[11]+p*e[13]+l*e[15]+a*e[17]+c*e[19]}}function a(e,r,o){const{xmin:t,ymin:s,xmax:n,ymax:i,spatialReference:f}=r;let a=[];if(o<2)a.push({x:t,y:i}),a.push({x:n,y:i}),a.push({x:t,y:s}),a.push({x:n,y:s});else{let e=10;for(let r=0;r<e;r++)a.push({x:t,y:s+(i-s)*r/(e-1)}),a.push({x:n,y:s+(i-s)*r/(e-1)});e=8;for(let r=1;r<=e;r++)a.push({x:t+(n-t)*r/e,y:s}),a.push({x:t+(n-t)*r/e,y:i})}a=a.map((r=>l(e,r,o)));const c=a.map((e=>e.x)),u=a.map((e=>e.y));return new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_10__.Z({xmin:Math.min.apply(null,c),xmax:Math.max.apply(null,c),ymin:Math.min.apply(null,u),ymax:Math.max.apply(null,u),spatialReference:f})}let u=class extends _BaseRasterTransform_js__WEBPACK_IMPORTED_MODULE_8__.Z{constructor(){super(...arguments),this.polynomialOrder=1,this.type="polynomial"}readForwardCoefficients(e,r){const{coeffX:o,coeffY:t}=r;if(!o?.length||!t?.length||o.length!==t.length)return null;const s=[];for(let n=0;n<o.length;n++)s.push(o[n]),s.push(t[n]);return s}writeForwardCoefficients(e,r,o){const t=[],s=[];for(let n=0;n<e?.length;n++)n%2==0?t.push(e[n]):s.push(e[n]);r.coeffX=t,r.coeffY=s}get inverseCoefficients(){let e=this._get("inverseCoefficients");const r=this._get("forwardCoefficients");return!e&&r&&this.polynomialOrder<2&&(e=function c(e){const[r,o,t,s,n,i]=e,f=t*i-n*s,p=n*s-t*i;return[(n*o-r*i)/f,(t*o-r*s)/p,i/f,s/p,-n/f,-t/p]}(r)),e}set inverseCoefficients(e){this._set("inverseCoefficients",e)}readInverseCoefficients(e,r){const{inverseCoeffX:o,inverseCoeffY:t}=r;if(!o?.length||!t?.length||o.length!==t.length)return null;const s=[];for(let n=0;n<o.length;n++)s.push(o[n]),s.push(t[n]);return s}writeInverseCoefficients(e,r,o){const t=[],s=[];for(let n=0;n<e?.length;n++)n%2==0?t.push(e[n]):s.push(e[n]);r.inverseCoeffX=t,r.inverseCoeffY=s}get affectsPixelSize(){return this.polynomialOrder>0}forwardTransform(e){if("point"===e.type){const r=l(this.forwardCoefficients,e,this.polynomialOrder);return new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_9__.Z({x:r.x,y:r.y,spatialReference:e.spatialReference})}return a(this.forwardCoefficients,e,this.polynomialOrder)}inverseTransform(e){if("point"===e.type){const r=l(this.inverseCoefficients,e,this.polynomialOrder);return new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_9__.Z({x:r.x,y:r.y,spatialReference:e.spatialReference})}return a(this.inverseCoefficients,e,this.polynomialOrder)}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.Cb)({json:{write:!0}})],u.prototype,"polynomialOrder",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.Cb)()],u.prototype,"forwardCoefficients",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__._)([(0,_core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_5__.r)("forwardCoefficients",["coeffX","coeffY"])],u.prototype,"readForwardCoefficients",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__._)([(0,_core_accessorSupport_decorators_writer_js__WEBPACK_IMPORTED_MODULE_7__.c)("forwardCoefficients")],u.prototype,"writeForwardCoefficients",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.Cb)({json:{write:!0}})],u.prototype,"inverseCoefficients",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__._)([(0,_core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_5__.r)("inverseCoefficients",["inverseCoeffX","inverseCoeffY"])],u.prototype,"readInverseCoefficients",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__._)([(0,_core_accessorSupport_decorators_writer_js__WEBPACK_IMPORTED_MODULE_7__.c)("inverseCoefficients")],u.prototype,"writeInverseCoefficients",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_1__.Cb)()],u.prototype,"affectsPixelSize",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__._)([(0,_core_accessorSupport_decorators_enumeration_js__WEBPACK_IMPORTED_MODULE_4__.J)({PolynomialXform:"polynomial"})],u.prototype,"type",void 0),u=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_11__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.j)("esri.layers.support.rasterTransforms.PolynomialTransform")],u);const m=u},"./node_modules/@arcgis/core/layers/support/rasterTransforms/utils.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{j:()=>f,c:()=>i});var GCSShiftTransform=__webpack_require__("./node_modules/@arcgis/core/layers/support/rasterTransforms/GCSShiftTransform.js"),tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),enumeration=(__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/enumeration.js")),subclass=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),BaseRasterTransform=__webpack_require__("./node_modules/@arcgis/core/layers/support/rasterTransforms/BaseRasterTransform.js");let e=class extends BaseRasterTransform.Z{constructor(){super(...arguments),this.type="identity"}};(0,tslib_es6._)([(0,enumeration.J)({IdentityXform:"identity"})],e.prototype,"type",void 0),e=(0,tslib_es6._)([(0,subclass.j)("esri.layers.support.rasterTransforms.IdentityTransform")],e);const p=e;var PolynomialTransform=__webpack_require__("./node_modules/@arcgis/core/layers/support/rasterTransforms/PolynomialTransform.js");const o={GCSShiftXform:GCSShiftTransform.Z,IdentityXform:p,PolynomialXform:PolynomialTransform.Z},utils_e=Object.keys(o);function f(r){const t=r?.type;return!r||utils_e.includes(t)}function i(r){const t=r?.type;if(!t)return null;const n=o[r?.type];if(n){const t=new n;return t.read(r),t}return null}}}]);