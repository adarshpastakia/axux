"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[15999],{"./node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{P:()=>j});var _Error_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_MD5_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/MD5.js"),_multiOriginJSONSupportUtils_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js"),_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js"),_uuid_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/uuid.js"),_metadata_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/metadata.js"),_PropertyOrigin_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/PropertyOrigin.js"),_property_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/portal/support/resourceExtension.js"),_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/chunks/persistableUrlUtils.js");function j(t){const r=t?.origins??[void 0];return(e,o)=>{const s=function U(t,r,e){if("resource"===t?.type)return function w(t,r,n){const i=(0,_metadata_js__WEBPACK_IMPORTED_MODULE_4__.z4)(r,n);return{type:String,read:(t,r,e)=>{const o=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.r)(t,r,e);return i.type===String?o:"function"==typeof i.type?new i.type({url:o}):void 0},write:{writer(r,p,c,u){if(!u?.resources)return"string"==typeof r?void(p[c]=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.t)(r,u)):void(p[c]=r.write({},u));const l=function x(t){return null==t?null:"string"==typeof t?t:t.url}(r),m=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.t)(l,{...u,verifyItemRelativeUrls:u?.verifyItemRelativeUrls?{writtenUrls:u.verifyItemRelativeUrls.writtenUrls,rootPath:void 0}:void 0},_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.M.NO),d=i.type!==String&&(!(0,_multiOriginJSONSupportUtils_js__WEBPACK_IMPORTED_MODULE_9__.H)(this)||u?.origin&&this.originIdOf(n)>(0,_PropertyOrigin_js__WEBPACK_IMPORTED_MODULE_5__.aB)(u.origin)),h={object:this,propertyName:n,value:r,targetUrl:m,dest:p,targetPropertyName:c,context:u,params:t};u?.portalItem&&m&&!(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.oP)(m)?d&&t?.contentAddressed?I(h):d?function N(t){const{context:r,targetUrl:e,params:o,value:s,dest:n,targetPropertyName:i}=t;if(!r.portalItem)return;const c=r.portalItem.resourceFromPath(e),u=b(s,e,r),a=(0,_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__.n)(u),l=(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.Zo)(c.path),d=o?.compress??!1;a===l?(r.resources&&S({...t,resource:c,content:u,compress:d,updates:r.resources.toUpdate}),n[i]=e):I(t)}(h):function P({context:t,targetUrl:r,dest:e,targetPropertyName:o}){t.portalItem&&t.resources&&(t.resources.toKeep.push({resource:t.portalItem.resourceFromPath(r),compress:!1}),e[o]=r)}(h):u?.portalItem&&(null==m||null!=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.i)(m)||(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.w8)(m)||d)?I(h):p[c]=m}}}}(t,r,e);switch(t?.type??"other"){case"other":return{read:!0,write:!0};case"url":{const{read:t,write:r}=_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.a;return{read:t,write:r}}}}(t,e,o);for(const t of r){const r=(0,_property_js__WEBPACK_IMPORTED_MODULE_6__.rM)(e,t,o);for(const t in s)r[t]=s[t]}}}function I(e){const{targetUrl:o,params:p,value:u,context:a,dest:l,targetPropertyName:d}=e;if(!a.portalItem)return;const f=(0,_chunks_persistableUrlUtils_js__WEBPACK_IMPORTED_MODULE_8__.p)(o),y=b(u,o,a);if(p?.contentAddressed&&"json"!==y.type)return void a.messages?.push(new _Error_js__WEBPACK_IMPORTED_MODULE_0__.A("persistable:contentAddressingUnsupported",`Property "${d}" is trying to serializing a resource with content of type ${y.type} with content addressing. Content addressing is only supported for json resources.`,{content:y}));const g=p?.contentAddressed&&"json"===y.type?(0,_MD5_js__WEBPACK_IMPORTED_MODULE_1__.d)(y.jsonString):f?.filename??(0,_uuid_js__WEBPACK_IMPORTED_MODULE_3__.lk)(),v=(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.fj)(p?.prefix??f?.prefix,g),j=`${v}.${(0,_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__.n)(y)}`;if(p?.contentAddressed&&a.resources&&"json"===y.type){const t=a.resources.toKeep.find((t=>t.resource.path===j))??a.resources.toAdd.find((t=>t.resource.path===j));if(t)return void(l[d]=t.resource.itemRelativeUrl)}const U=a.portalItem.resourceFromPath(j);(0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.w8)(o)&&a.resources&&a.resources.pendingOperations.push((0,_urlUtils_js__WEBPACK_IMPORTED_MODULE_2__.tk)(o).then((t=>{U.path=`${v}.${(0,_portal_support_resourceExtension_js__WEBPACK_IMPORTED_MODULE_7__.n)({type:"blob",blob:t})}`,l[d]=U.itemRelativeUrl})).catch((()=>{})));const w=p?.compress??!1;a.resources&&S({...e,resource:U,content:y,compress:w,updates:a.resources.toAdd}),l[d]=U.itemRelativeUrl}function S({object:t,propertyName:r,updates:e,resource:o,content:s,compress:n}){e.push({resource:o,content:s,compress:n,finish:e=>{!function O(t,r,e){"string"==typeof t[r]?t[r]=e.url:t[r].url=e.url}(t,r,e)}})}function b(t,r,e){return"string"==typeof t?{type:"url",url:r}:{type:"json",jsonString:JSON.stringify(t.toJSON(e))}}},"./node_modules/@arcgis/core/layers/SceneLayer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>me});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Graphic=__webpack_require__("./node_modules/@arcgis/core/Graphic.js"),PopupTemplate=__webpack_require__("./node_modules/@arcgis/core/PopupTemplate.js"),types=(__webpack_require__("./node_modules/@arcgis/core/renderers/ClassBreaksRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/DictionaryRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/DotDensityRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/HeatmapRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/PieChartRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/Renderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/SimpleRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/UniqueValueRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/support/jsonUtils.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/support/types.js")),request=__webpack_require__("./node_modules/@arcgis/core/request.js"),Clonable=__webpack_require__("./node_modules/@arcgis/core/core/Clonable.js"),Collection=__webpack_require__("./node_modules/@arcgis/core/core/Collection.js"),Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),Logger=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),MultiOriginJSONSupport=__webpack_require__("./node_modules/@arcgis/core/core/MultiOriginJSONSupport.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),urlUtils=__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),utils=(__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/utils.js")),reader=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/reader.js"),subclass=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js"),PropertyOrigin=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/PropertyOrigin.js"),Layer=__webpack_require__("./node_modules/@arcgis/core/layers/Layer.js"),APIKeyMixin=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/APIKeyMixin.js"),ArcGISService=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/ArcGISService.js"),EditBusLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/EditBusLayer.js"),OperationalLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/OperationalLayer.js"),PortalLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/PortalLayer.js"),ScaleRangeLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/ScaleRangeLayer.js"),SceneService=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/SceneService.js"),arcgisLayerUrl=__webpack_require__("./node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js"),associatedFeatureServiceUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/associatedFeatureServiceUtils.js"),capabilities=__webpack_require__("./node_modules/@arcgis/core/layers/support/capabilities.js"),commonProperties=__webpack_require__("./node_modules/@arcgis/core/layers/support/commonProperties.js"),featureLayerUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/featureLayerUtils.js"),FeatureReduction=__webpack_require__("./node_modules/@arcgis/core/layers/support/FeatureReduction.js"),FeatureReductionSelection=__webpack_require__("./node_modules/@arcgis/core/layers/support/FeatureReductionSelection.js"),fieldProperties=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldProperties.js"),FieldsIndex=__webpack_require__("./node_modules/@arcgis/core/layers/support/FieldsIndex.js"),fieldUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldUtils.js"),I3SLayerDefinitions=__webpack_require__("./node_modules/@arcgis/core/layers/support/I3SLayerDefinitions.js"),LabelClass=__webpack_require__("./node_modules/@arcgis/core/layers/support/LabelClass.js"),labelingInfo=__webpack_require__("./node_modules/@arcgis/core/layers/support/labelingInfo.js"),LayerFloorInfo=__webpack_require__("./node_modules/@arcgis/core/layers/support/LayerFloorInfo.js"),lazyLayerLoader=__webpack_require__("./node_modules/@arcgis/core/layers/support/lazyLayerLoader.js"),JSONSupport=__webpack_require__("./node_modules/@arcgis/core/core/JSONSupport.js");let s=class extends JSONSupport.oY{constructor(){super(...arguments),this.name=null,this.field=null,this.currentRangeExtent=null,this.fullRangeExtent=null,this.type="rangeInfo"}};(0,tslib_es6._)([(0,property.MZ)({type:String,json:{read:!0,write:!0}})],s.prototype,"name",void 0),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{read:!0,write:!0}})],s.prototype,"field",void 0),(0,tslib_es6._)([(0,property.MZ)({type:[Number],json:{read:!0,write:!0}})],s.prototype,"currentRangeExtent",void 0),(0,tslib_es6._)([(0,property.MZ)({type:[Number],json:{read:!0,write:!0}})],s.prototype,"fullRangeExtent",void 0),(0,tslib_es6._)([(0,property.MZ)({type:["rangeInfo"],readOnly:!0,json:{read:!1,write:!0}})],s.prototype,"type",void 0),s=(0,tslib_es6._)([(0,subclass.$)("esri.layers.support.RangeInfo")],s);var c,lang=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),persistable=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/persistable.js"),Warning=__webpack_require__("./node_modules/@arcgis/core/core/Warning.js"),Polygon=__webpack_require__("./node_modules/@arcgis/core/geometry/Polygon.js"),projection=__webpack_require__("./node_modules/@arcgis/core/geometry/projection.js");let p=c=class extends((0,JSONSupport.Te)(Collection.A.ofType(Polygon.A))){constructor(e){super(e)}clone(){return new c(this.items.map((e=>e.clone())))}write(e,r){return this.toJSON(r)}toJSON(e){const r=e?.layer?.spatialReference;return r?this.toArray().map((t=>{if(!r.equals(t.spatialReference)){if(!(0,projection.canProjectWithoutEngine)(t.spatialReference,r))return e?.messages&&e.messages.push(new Warning.A("scenefilter:unsupported","Scene filters with incompatible spatial references are not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),null;const s=new Polygon.A;(0,projection.projectPolygon)(t,s,r),t=s}const s=t.toJSON(e);return delete s.spatialReference,s})).filter((e=>null!=e)):(e?.messages&&e.messages.push(new Warning.A("scenefilter:unsupported","Writing Scene filters without context layer is not supported",{modification:this,spatialReference:e.layer.spatialReference,context:e})),this.toArray().map((r=>r.toJSON(e))))}static fromJSON(e,r){const t=new c;return e.forEach((e=>t.add(Polygon.A.fromJSON(e,r)))),t}};p=c=(0,tslib_es6._)([(0,subclass.$)("esri.layers.support.PolygonCollection")],p);const l=p;var u,persistableUrlUtils=__webpack_require__("./node_modules/@arcgis/core/chunks/persistableUrlUtils.js");let g=u=class extends JSONSupport.oY{constructor(e){super(e),this.spatialRelationship="disjoint",this.geometries=new l,this._geometriesSource=null}initialize(){this.addHandles((0,reactiveUtils.on)((()=>this.geometries),"after-changes",(()=>this.geometries=this.geometries),reactiveUtils.OH))}readGeometries(e,r,o){Array.isArray(e)?this.geometries=l.fromJSON(e,o):this._geometriesSource={url:(0,persistableUrlUtils.f)(e,o),context:o}}async loadGeometries(e,o){if(null==this._geometriesSource)return;const{url:s,context:t}=this._geometriesSource,i=await(0,request.A)(s,{responseType:"json",signal:o?.signal}),a=e.toJSON(),p=i.data.map((e=>({...e,spatialReference:a})));this.geometries=l.fromJSON(p,t),this._geometriesSource=null}clone(){const e=new u({geometries:(0,lang.o8)(this.geometries),spatialRelationship:this.spatialRelationship});return e._geometriesSource=this._geometriesSource,e}};(0,tslib_es6._)([(0,property.MZ)({type:["disjoint","contains"],nonNullable:!0,json:{write:!0}})],g.prototype,"spatialRelationship",void 0),(0,tslib_es6._)([(0,property.MZ)({type:l,nonNullable:!0,json:{write:!0}}),(0,persistable.P)({origins:["web-scene","portal-item"],type:"resource",prefix:"geometries",contentAddressed:!0})],g.prototype,"geometries",void 0),(0,tslib_es6._)([(0,reader.w)(["web-scene","portal-item"],"geometries")],g.prototype,"readGeometries",null),g=u=(0,tslib_es6._)([(0,subclass.$)("esri.layers.support.SceneFilter")],g);const h=g;var styleUtils=__webpack_require__("./node_modules/@arcgis/core/renderers/support/styleUtils.js"),Query=__webpack_require__("./node_modules/@arcgis/core/rest/support/Query.js"),elevationInfoUtils=__webpack_require__("./node_modules/@arcgis/core/support/elevationInfoUtils.js"),featureFlags=__webpack_require__("./node_modules/@arcgis/core/support/featureFlags.js"),popupUtils=__webpack_require__("./node_modules/@arcgis/core/support/popupUtils.js"),I3SUtil=__webpack_require__("./node_modules/@arcgis/core/views/3d/layers/i3s/I3SUtil.js"),support_popupUtils=__webpack_require__("./node_modules/@arcgis/core/views/layers/support/popupUtils.js"),opacityUtils=__webpack_require__("./node_modules/@arcgis/core/webdoc/support/opacityUtils.js");const ye=new Set(["3DObject","Point"]),ue=(0,fieldProperties.p)();let ce=class extends((0,EditBusLayer.w6)((0,SceneService.w6)((0,ArcGISService.b)((0,OperationalLayer.q)((0,PortalLayer.A)((0,ScaleRangeLayer.j)((0,MultiOriginJSONSupport.P)((0,APIKeyMixin.p)((0,Clonable.O)(Layer.A)))))))))){constructor(...e){super(...e),this.featureReduction=null,this.rangeInfos=null,this.operationalLayerType="ArcGISSceneServiceLayer",this.type="scene",this.fields=null,this.floorInfo=null,this.outFields=null,this.nodePages=null,this.materialDefinitions=null,this.textureSetDefinitions=null,this.geometryDefinitions=null,this.serviceUpdateTimeStamp=null,this.excludeObjectIds=new Collection.A,this.definitionExpression=null,this.filter=null,this.path=null,this.labelsVisible=!0,this.labelingInfo=null,this.legendEnabled=!0,this.priority=null,this.semantic=null,this.cachedDrawingInfo={color:!1},this.popupEnabled=!0,this.popupTemplate=null,this.objectIdField=null,this.globalIdField=null,this._fieldUsageInfo={},this.screenSizePerspectiveEnabled=!0,this.serviceItemId=void 0}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}destroy(){this._set("renderer",null)}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){const r=this.getFeatureType(t?.feature)?.domains?.[e];return r&&"inherited"!==r.type?r:this.getField(e)?.domain??null}getFeatureType(e){return e&&this.associatedLayer?this.associatedLayer.getFeatureType(e):null}get types(){return this.associatedLayer?.types??[]}get typeIdField(){return this.associatedLayer?.typeIdField??null}get templates(){return this.associatedLayer?.templates??null}get formTemplate(){return this.associatedLayer?.formTemplate??null}get fieldsIndex(){return new FieldsIndex.A(this.fields)}readNodePages(e,t,r){return"Point"===t.layerType&&(e=t.pointNodePages),null==e||"object"!=typeof e?null:I3SLayerDefinitions.W4.fromJSON(e,r)}set elevationInfo(e){this._set("elevationInfo",e),this.loaded&&this._validateElevationInfo()}get effectiveCapabilities(){return this._capabilitiesFromAssociatedFeatureLayer(this.associatedLayer?.effectiveCapabilities)}get effectiveEditingEnabled(){return null!=this.associatedLayer&&(0,featureLayerUtils.C$)(this.associatedLayer)}get geometryType(){return fe[this.profile]||"mesh"}set renderer(e){(0,fieldUtils.yp)(e,this.fieldsIndex),this._set("renderer",e)}readCachedDrawingInfo(e){return null!=e&&"object"==typeof e||(e={}),null==e.color&&(e.color=!1),e}get capabilities(){return this._capabilitiesFromAssociatedFeatureLayer(this.associatedLayer?.capabilities)}_capabilitiesFromAssociatedFeatureLayer(e){e=null!=e?e:capabilities.P;const{query:t,queryRelated:r,editing:{supportsGlobalId:i,supportsRollbackOnFailure:s,supportsUploadWithItemId:o,supportsGeometryUpdate:a,supportsReturnServiceEditsInSourceSpatialReference:n},data:{supportsZ:l,supportsM:p,isVersioned:d,supportsAttachment:y},operations:{supportsEditing:u,supportsAdd:c,supportsUpdate:h,supportsDelete:f,supportsQuery:m,supportsQueryAttachments:g,supportsAsyncConvert3D:v}}=e,b=e.operations.supportsChangeTracking,I=!!this.associatedLayer?.infoFor3D&&(0,featureFlags.Vo)();return{query:t,queryRelated:r,editing:{supportsGlobalId:i,supportsReturnServiceEditsInSourceSpatialReference:n,supportsRollbackOnFailure:s,supportsGeometryUpdate:I&&a,supportsUploadWithItemId:o},data:{supportsAttachment:y,supportsZ:l,supportsM:p,isVersioned:d},operations:{supportsQuery:m,supportsQueryAttachments:g,supportsEditing:u&&b,supportsAdd:I&&c&&b,supportsDelete:I&&f&&b,supportsUpdate:h&&b,supportsAsyncConvert3D:v}}}get editingEnabled(){return this._isOverridden("editingEnabled")?this._get("editingEnabled"):this.associatedLayer?.editingEnabled??!1}set editingEnabled(e){this._overrideIfSome("editingEnabled",e)}get infoFor3D(){return this.associatedLayer?.infoFor3D??null}get relationships(){return this.associatedLayer?.relationships}get defaultPopupTemplate(){return this.associatedLayer||this.attributeStorageInfo?this.createPopupTemplate():null}readObjectIdField(e,t){return!e&&t.fields&&t.fields.some((t=>("esriFieldTypeOID"===t.type&&(e=t.name),!!e))),e||void 0}readGlobalIdField(e,t){return!e&&t.fields&&t.fields.some((t=>("esriFieldTypeGlobalID"===t.type&&(e=t.name),!!e))),e||void 0}get displayField(){return this.associatedLayer?.displayField??null}readProfile(e,t){const r=t.store.profile;return null!=r&&he[r]?he[r]:(Logger.A.getLogger(this).error("Unknown or missing profile",{profile:r,layer:this}),"mesh-pyramids")}load(e){return this.addResolvingPromise(this._load(e)),Promise.resolve(this)}async _load(e){const t=null!=e?e.signal:null;await this.loadFromPortal({supportedTypes:["Scene Service"]},e).catch(promiseUtils.QP),await this._fetchService(t),await Promise.all([this._fetchIndexAndUpdateExtent(this.nodePages,t),this._setAssociatedFeatureLayer(t),this._loadFilterGeometries()]),this._validateElevationInfo(),this._applyAssociatedLayerOverrides(),this._populateFieldUsageInfo(),await(0,styleUtils.L)(this,{origin:"service"},t),(0,fieldUtils.yp)(this.renderer,this.fieldsIndex),await this.finishLoadEditablePortalLayer(e)}async beforeSave(){null!=this.filter&&(this.filter=this.filter.clone(),await this.load())}async _loadFilterGeometries(){if(this.filter)try{await this.filter.loadGeometries(this.spatialReference)}catch(e){Logger.A.getLogger(this).error("#_loadFilterGeometries()",this,"Failed to load filter geometries. Geometry filter will not be applied for this layer.",{error:e}),this.filter=null}}createQuery(){const e=new Query.A;return"mesh"!==this.geometryType&&(e.returnGeometry=!0,e.returnZ=!0),e.where=this.definitionExpression||"1=1",e.sqlFormat="standard",e.outFields=["*"],e}queryExtent(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryExtent(e||this.createQuery(),t)))}queryFeatureCount(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryFeatureCount(e||this.createQuery(),t)))}queryFeatures(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryFeatures(e||this.createQuery(),t))).then((e=>{if(e?.features)for(const t of e.features)t.layer=this,t.sourceLayer=this;return e}))}async queryRelatedFeatures(e,t){if(await this.load(),!this.associatedLayer)throw new Error.A("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:this});return this.associatedLayer.queryRelatedFeatures(e,t)}async queryRelatedFeaturesCount(e,t){if(await this.load(),!this.associatedLayer)throw new Error.A("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:this});return this.associatedLayer.queryRelatedFeaturesCount(e,t)}async queryCachedAttributes(e,t){const r=(0,fieldUtils.hL)(this.fieldsIndex,await(0,support_popupUtils.TO)(this,(0,support_popupUtils.D8)(this)));return(0,I3SUtil.s1)(this.parsedUrl.path,this.attributeStorageInfo??[],e,t,r)}async queryCachedFeature(e,r){const i=await this.queryCachedAttributes(e,[r]);if(!i||0===i.length)throw new Error.A("scenelayer:feature-not-in-cached-data","Feature not found in cached data");const s=new Graphic.A;return s.attributes=i[0],s.layer=this,s.sourceLayer=this,s}queryObjectIds(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryObjectIds(e||this.createQuery(),t)))}queryAttachments(e,t){return this._getAssociatedLayerForQuery().then((r=>r.queryAttachments(e,t)))}getFieldUsageInfo(e){const t={supportsLabelingInfo:!1,supportsRenderer:!1,supportsPopupTemplate:!1,supportsLayerQuery:!1};return this.loaded?this._fieldUsageInfo[e]||t:(Logger.A.getLogger(this).error("#getFieldUsageInfo()","Unavailable until layer is loaded"),t)}createPopupTemplate(e){return(0,popupUtils.tn)(this,e)}_getAssociatedLayerForQuery(){const e=this.associatedLayer;return e?.loaded?Promise.resolve(e):this._loadAssociatedLayerForQuery()}async _loadAssociatedLayerForQuery(){if(await this.load(),!this.associatedLayer)throw new Error.A("scenelayer:query-not-available","SceneLayer queries are not available without an associated feature layer",{layer:this});try{await this.associatedLayer.load()}catch(e){throw new Error.A("scenelayer:query-not-available","SceneLayer associated feature layer could not be loaded",{layer:this,error:e})}return this.associatedLayer}hasCachedStatistics(e){return null!=this.statisticsInfo&&this.statisticsInfo.some((t=>t.name===e))}async queryCachedStatistics(e,t){if(await this.load(t),!this.statisticsInfo)throw new Error.A("scenelayer:no-cached-statistics","Cached statistics are not available for this layer");const r=this.fieldsIndex.get(e);if(!r)throw new Error.A("scenelayer:field-unexisting",`Field '${e}' does not exist on the layer`);for(const i of this.statisticsInfo)if(i.name===r.name){const e=(0,urlUtils.fj)(this.parsedUrl.path,i.href);return(0,request.A)(e,{query:{f:"json",token:this.apiKey},responseType:"json",signal:t?t.signal:null}).then((e=>e.data))}throw new Error.A("scenelayer:no-cached-statistics","Cached statistics for this attribute are not available")}async saveAs(e,t){return this._debouncedSaveOperations(SceneService.Xh.SAVE_AS,{...t,getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"scene"},e)}async save(){const e={getTypeKeywords:()=>this._getTypeKeywords(),portalItemLayerType:"scene"};return this._debouncedSaveOperations(SceneService.Xh.SAVE,e)}async applyEdits(e,t){const{applyEdits:r}=await __webpack_require__.e(15470).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/layers/graphics/editingSupport.js"));let i=t;await this.load();const s=this.associatedLayer;if(!s)throw new Error.A(`${this.type}-layer:not-editable`,"Service is not editable");await s.load();const{globalIdField:o}=s,a=!!s.infoFor3D,l=i?.globalIdUsed??!0;if(a&&null==o)throw new Error.A(`${this.type}-layer:not-editable`,"Valid globalIdField expected on editable SceneLayer");if(a&&!l)throw new Error.A(`${this.type}-layer:globalid-required`,"globalIdUsed must not be false for SceneLayer editing as globalIds are required.");return(0,arcgisLayerUrl.Wo)(s.url)&&a&&null!=e.deleteFeatures&&null!=o&&(i={...i,globalIdToObjectId:await(0,featureLayerUtils.GA)(s,e.deleteFeatures,o)}),r(this,s.source,e,i)}async uploadAssets(e,t){if(await this.load(),null==this.associatedLayer)throw new Error.A(`${this.type}-layer:not-editable`,"Service is not editable");return await this.associatedLayer.load(),this.associatedLayer.uploadAssets(e,t)}on(e,t){return super.on(e,t)}validateLayer(e){if(e.layerType&&!ye.has(e.layerType))throw new Error.A("scenelayer:layer-type-not-supported","SceneLayer does not support this layer type",{layerType:e.layerType});if(isNaN(this.version.major)||isNaN(this.version.minor))throw new Error.A("layer:service-version-not-supported","Service version is not supported.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});if(this.version.major>2)throw new Error.A("layer:service-version-too-new","Service version is too new.",{serviceVersion:this.version.versionString,supportedVersions:"1.x, 2.x"});!function t(e,t){let r=!1,i=!1;if(null==e)r=!0,i=!0;else{const s=t&&t.isGeographic;switch(e){case"east-north-up":case"earth-centered":r=!0,i=s;break;case"vertex-reference-frame":r=!0,i=!s;break;default:r=!1}}if(!r)throw new Error.A("scenelayer:unsupported-normal-reference-frame","Normal reference frame is invalid.");if(!i)throw new Error.A("scenelayer:incompatible-normal-reference-frame","Normal reference frame is incompatible with layer spatial reference.")}(this.normalReferenceFrame,this.spatialReference)}_getTypeKeywords(){const e=[];if("points"===this.profile)e.push("Point");else{if("mesh-pyramids"!==this.profile)throw new Error.A("scenelayer:unknown-profile","SceneLayer:save() encountered an unknown SceneLayer profile: "+this.profile);e.push("3DObject")}return e}_populateFieldUsageInfo(){if(this._fieldUsageInfo={},this.fields)for(const e of this.fields){const t=!(!this.attributeStorageInfo||!this.attributeStorageInfo.some((t=>t.name===e.name))),r=!!this.associatedLayer?.fields?.some((t=>t&&e.name===t.name)),i={supportsLabelingInfo:t,supportsRenderer:t,supportsPopupTemplate:t||r,supportsLayerQuery:r};this._fieldUsageInfo[e.name]=i}}_applyAssociatedLayerOverrides(){this._applyAssociatedLayerFieldsOverrides(),this._applyAssociatedLayerPopupOverrides(),this._applyAssociatedLayerExtentOverride(),this._applyAssociatedLayerPrivileges()}_applyAssociatedLayerFieldsOverrides(){if(!this.associatedLayer?.fields)return;let e=null;for(const t of this.associatedLayer.fields){const r=this.getField(t.name);r?(!r.domain&&t.domain&&(r.domain=t.domain.clone()),r.editable=t.editable,r.nullable=t.nullable,r.length=t.length):(e||(e=this.fields?this.fields.slice():[]),e.push(t.clone()))}e&&this._set("fields",e)}_applyAssociatedLayerPopupOverrides(){if(!this.associatedLayer)return;const e=["popupTemplate","popupEnabled"],t=(0,utils.oY)(this);for(let r=0;r<e.length;r++){const i=e[r],s=this.originIdOf(i),o=this.associatedLayer.originIdOf(i);s<o&&(o===PropertyOrigin.Gr.SERVICE||o===PropertyOrigin.Gr.PORTAL_ITEM)&&t.setAtOrigin(i,this.associatedLayer[i],o)}}_applyAssociatedLayerExtentOverride(){const e=this.associatedLayer?.editingInfo?.lastEditDate,t=this.associatedLayer?.serverGens,r=this.associatedLayer?.getAtOrigin("fullExtent","service");(0,featureFlags.Vo)()&&null!=this.associatedLayer?.infoFor3D&&r&&(0,arcgisLayerUrl.Wo)(this.associatedLayer?.url)&&e&&this.serviceUpdateTimeStamp?.lastUpdate!==e.getTime()&&(this.serviceUpdateTimeStamp||t?.minServerGen!==t?.serverGen)&&(0,utils.oY)(this).setAtOrigin("fullExtent",r.clone(),PropertyOrigin.Gr.SERVICE)}_applyAssociatedLayerPrivileges(){const e=this.associatedLayer;e&&(this._set("userHasEditingPrivileges",e.userHasEditingPrivileges),this._set("userHasFullEditingPrivileges",e.userHasFullEditingPrivileges),this._set("userHasUpdateItemPrivileges",e.userHasUpdateItemPrivileges))}async _setAssociatedFeatureLayer(e){if(["mesh-pyramids","points"].includes(this.profile))try{const{serverUrl:t,layerId:r,portalItem:i}=await(0,associatedFeatureServiceUtils.L)(`${this.url}/layers/${this.layerId}`,{sceneLayerItem:this.portalItem,apiKey:this.apiKey,signal:e}),s=await lazyLayerLoader.S.FeatureLayer();this.associatedLayer=new s({url:t,layerId:r,portalItem:i}),await this.associatedLayer.load()}catch(t){(0,promiseUtils.zf)(t)||this._logWarningOnPopupEnabled()}}async _logWarningOnPopupEnabled(){await(0,reactiveUtils.C_)((()=>this.popupEnabled&&null!=this.popupTemplate));const e=`this SceneLayer: ${this.title}`;null==this.attributeStorageInfo?Logger.A.getLogger(this).warn(`Associated FeatureLayer could not be loaded and no binary attributes found. Popups will not work on ${e}`):Logger.A.getLogger(this).info(`Associated FeatureLayer could not be loaded. Falling back to binary attributes for Popups on ${e}`)}_validateElevationInfo(){const e=this.elevationInfo;"mesh-pyramids"===this.profile&&(0,elevationInfoUtils.XF)(Logger.A.getLogger(this),(0,elevationInfoUtils.$7)("Mesh scene layers","relative-to-scene",e)),(0,elevationInfoUtils.XF)(Logger.A.getLogger(this),(0,elevationInfoUtils.tW)("Scene layers",e))}};(0,tslib_es6._)([(0,property.MZ)({types:{key:"type",base:FeatureReduction.c,typeMap:{selection:FeatureReductionSelection.A}},json:{origins:{"web-scene":{name:"layerDefinition.featureReduction",write:!0},"portal-item":{name:"layerDefinition.featureReduction",write:!0}}}})],ce.prototype,"featureReduction",void 0),(0,tslib_es6._)([(0,property.MZ)({type:[s],json:{read:!1,origins:{"web-scene":{name:"layerDefinition.rangeInfos",write:!0},"portal-item":{name:"layerDefinition.rangeInfos",write:!0}}}})],ce.prototype,"rangeInfos",void 0),(0,tslib_es6._)([(0,property.MZ)({json:{read:!1}})],ce.prototype,"associatedLayer",void 0),(0,tslib_es6._)([(0,property.MZ)({type:["show","hide"]})],ce.prototype,"listMode",void 0),(0,tslib_es6._)([(0,property.MZ)({type:["ArcGISSceneServiceLayer"]})],ce.prototype,"operationalLayerType",void 0),(0,tslib_es6._)([(0,property.MZ)({json:{read:!1},readOnly:!0})],ce.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)({...ue.fields,readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],ce.prototype,"fields",void 0),(0,tslib_es6._)([(0,property.MZ)()],ce.prototype,"types",null),(0,tslib_es6._)([(0,property.MZ)()],ce.prototype,"typeIdField",null),(0,tslib_es6._)([(0,property.MZ)()],ce.prototype,"templates",null),(0,tslib_es6._)([(0,property.MZ)()],ce.prototype,"formTemplate",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0,clonable:!1})],ce.prototype,"fieldsIndex",null),(0,tslib_es6._)([(0,property.MZ)({type:LayerFloorInfo.A,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],ce.prototype,"floorInfo",void 0),(0,tslib_es6._)([(0,property.MZ)(ue.outFields)],ce.prototype,"outFields",void 0),(0,tslib_es6._)([(0,property.MZ)({type:I3SLayerDefinitions.W4,readOnly:!0,json:{read:!1}})],ce.prototype,"nodePages",void 0),(0,tslib_es6._)([(0,reader.w)("service","nodePages",["nodePages","pointNodePages"])],ce.prototype,"readNodePages",null),(0,tslib_es6._)([(0,property.MZ)({type:[I3SLayerDefinitions.uV],readOnly:!0})],ce.prototype,"materialDefinitions",void 0),(0,tslib_es6._)([(0,property.MZ)({type:[I3SLayerDefinitions.Ot],readOnly:!0})],ce.prototype,"textureSetDefinitions",void 0),(0,tslib_es6._)([(0,property.MZ)({type:[I3SLayerDefinitions.L0],readOnly:!0})],ce.prototype,"geometryDefinitions",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ce.prototype,"serviceUpdateTimeStamp",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ce.prototype,"attributeStorageInfo",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ce.prototype,"statisticsInfo",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Collection.A.ofType(Number),nonNullable:!0,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.excludeObjectIds",write:{enabled:!0}}})],ce.prototype,"excludeObjectIds",void 0),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],ce.prototype,"definitionExpression",void 0),(0,tslib_es6._)([(0,property.MZ)({type:h,json:{name:"layerDefinition.polygonFilter",write:{enabled:!0,allowNull:!0},origins:{service:{read:!1,write:!1}}}})],ce.prototype,"filter",void 0),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],ce.prototype,"path",void 0),(0,tslib_es6._)([(0,property.MZ)(commonProperties.Yj)],ce.prototype,"elevationInfo",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0,json:{read:!1}})],ce.prototype,"effectiveCapabilities",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],ce.prototype,"effectiveEditingEnabled",null),(0,tslib_es6._)([(0,property.MZ)({type:String})],ce.prototype,"geometryType",null),(0,tslib_es6._)([(0,property.MZ)(commonProperties.kF)],ce.prototype,"labelsVisible",void 0),(0,tslib_es6._)([(0,property.MZ)({type:[LabelClass.A],json:{origins:{service:{name:"drawingInfo.labelingInfo",read:{reader:labelingInfo.w},write:!1}},name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:labelingInfo.w},write:!0}})],ce.prototype,"labelingInfo",void 0),(0,tslib_es6._)([(0,property.MZ)(commonProperties.fV)],ce.prototype,"legendEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)({type:Number,json:{origins:{"web-document":{default:1,write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}},read:{source:["opacity","layerDefinition.drawingInfo.transparency"],reader(e,t){if("number"==typeof e&&e>=0&&e<=1)return e;const r=t.layerDefinition?.drawingInfo?.transparency;return void 0!==r?(0,opacityUtils.D)(r):void 0}}},"portal-item":{write:!0},service:{read:!1}}}})],ce.prototype,"opacity",void 0),(0,tslib_es6._)([(0,property.MZ)({type:["Low","High"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],ce.prototype,"priority",void 0),(0,tslib_es6._)([(0,property.MZ)({type:["Labels"],readOnly:!0,json:{read:!1,origins:{service:{read:!0}}}})],ce.prototype,"semantic",void 0),(0,tslib_es6._)([(0,property.MZ)({types:types.X,json:{origins:{service:{read:{source:"drawingInfo.renderer"}}},name:"layerDefinition.drawingInfo.renderer",write:!0},value:null})],ce.prototype,"renderer",null),(0,tslib_es6._)([(0,property.MZ)({json:{read:!1}})],ce.prototype,"cachedDrawingInfo",void 0),(0,tslib_es6._)([(0,reader.w)("service","cachedDrawingInfo")],ce.prototype,"readCachedDrawingInfo",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0,json:{read:!1}})],ce.prototype,"capabilities",null),(0,tslib_es6._)([(0,property.MZ)({type:Boolean,json:{read:!1}})],ce.prototype,"editingEnabled",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0,json:{write:!1,read:!1}})],ce.prototype,"infoFor3D",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0,json:{write:!1,read:!1}})],ce.prototype,"relationships",null),(0,tslib_es6._)([(0,property.MZ)(commonProperties.M6)],ce.prototype,"popupEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)({type:PopupTemplate.A,json:{name:"popupInfo",write:!0}})],ce.prototype,"popupTemplate",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0,json:{read:!1}})],ce.prototype,"defaultPopupTemplate",null),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{read:!1}})],ce.prototype,"objectIdField",void 0),(0,tslib_es6._)([(0,reader.w)("service","objectIdField",["objectIdField","fields"])],ce.prototype,"readObjectIdField",null),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{read:!1}})],ce.prototype,"globalIdField",void 0),(0,tslib_es6._)([(0,reader.w)("service","globalIdField",["globalIdField","fields"])],ce.prototype,"readGlobalIdField",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0,type:String,json:{read:!1}})],ce.prototype,"displayField",null),(0,tslib_es6._)([(0,property.MZ)({type:String,json:{read:!1}})],ce.prototype,"profile",void 0),(0,tslib_es6._)([(0,reader.w)("service","profile",["store.profile"])],ce.prototype,"readProfile",null),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0,type:String,json:{origins:{service:{read:{source:"store.normalReferenceFrame"}}},read:!1}})],ce.prototype,"normalReferenceFrame",void 0),(0,tslib_es6._)([(0,property.MZ)(commonProperties.PY)],ce.prototype,"screenSizePerspectiveEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)({json:{read:!1,origins:{service:{read:!0}}}})],ce.prototype,"serviceItemId",void 0),ce=(0,tslib_es6._)([(0,subclass.$)("esri.layers.SceneLayer")],ce);const he={"mesh-pyramids":"mesh-pyramids",meshpyramids:"mesh-pyramids","features-meshes":"mesh-pyramids",points:"points","features-points":"points",lines:"lines","features-lines":"lines",polygons:"polygons","features-polygons":"polygons"},fe={"mesh-pyramids":"mesh",points:"point",lines:"polyline",polygons:"polygon"},me=ce},"./node_modules/@arcgis/core/layers/mixins/EditBusLayer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Mk:()=>p,Zk:()=>c,w6:()=>F});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_Evented_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Evented.js"),_core_lang_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),_versionManagement_support_versionManagementUtils_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/versionManagement/support/versionManagementUtils.js");const o=new _core_Evented_js__WEBPACK_IMPORTED_MODULE_1__.A.EventEmitter;function c(e,t,s=null,r=!1){const d=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.Tw)();return r=null==t||r,o.emit("apply-edits",{serviceUrl:e,layerId:t,gdbVersion:s,mayReceiveServiceEdits:r,result:d.promise}),d}const u="esri.layers.mixins.EditBusLayer",m=Symbol(u);function p(e){return null!=e&&"object"==typeof e&&m in e}function b(e){return null!=e&&"object"==typeof e&&"gdbVersion"in e}function g(e,t,s){const i=new URL(e).host,r=_versionManagement_support_versionManagementUtils_js__WEBPACK_IMPORTED_MODULE_9__.Z3.get(i),n=e=>!e||e===r;return n(t)&&n(s)||t===s}const F=t=>{var i;let d=class extends t{constructor(...e){super(...e),this[i]=!0,this._applyEditsHandler=e=>{const{serviceUrl:t,layerId:i,gdbVersion:r,mayReceiveServiceEdits:d,result:o}=e,l=t===this.url,a=null!=i&&null!=this.layerId&&i===this.layerId,c=b(this),h=b(this)&&g(t,r,this.gdbVersion);if(!l||c&&!h||!a&&!d)return;const u=o.then((e=>{if(a&&(e.addedFeatures.length||e.updatedFeatures.length||e.deletedFeatures.length||e.addedAttachments.length||e.updatedAttachments.length||e.deletedAttachments.length))return this.emit("edits",(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.o8)(e)),e;const t=e.editedFeatures?.find((({layerId:e})=>e===this.layerId));if(t){const{adds:i,updates:r,deletes:d}=t.editedFeatures,n={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:i?i.map((({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],deletedFeatures:d?d.map((({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],updatedFeatures:r?r.map((({current:{attributes:e}})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],editedFeatures:(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.o8)(e.editedFeatures),exceededTransferLimit:!1,historicMoment:(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.o8)(e.historicMoment)};return this.emit("edits",n),n}return{edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.o8)(e.editedFeatures),exceededTransferLimit:!1,historicMoment:(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_2__.o8)(e.historicMoment)}})).then((e=>("historicMoment"in this&&this.historicMoment!==e.historicMoment&&(0,_versionManagement_support_versionManagementUtils_js__WEBPACK_IMPORTED_MODULE_9__.w5)(t,r)&&(this.historicMoment=e.historicMoment),e)));this.emit("apply-edits",{result:u})},this._updateMomentHandler=e=>{const{serviceUrl:t,gdbVersion:s,moment:i}=e,r=t===this.url,d=b(this),n=b(this)&&g(t,s,this.gdbVersion),o=b(this)&&!g(t,this.gdbVersion,null);r&&d&&n&&o&&"historicMoment"in this&&this.historicMoment!==i&&(this.historicMoment=i)},this.when().then((()=>{this.addHandles(function l(e){return o.on("apply-edits",new WeakRef(e))}(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(function a(e){return o.on("update-moment",new WeakRef(e))}(this._updateMomentHandler))}),(()=>{}))}};return i=m,d=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__.$)(u)],d),d}},"./node_modules/@arcgis/core/portal/support/resourceExtension.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>p});var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/urlUtils.js");function p(i){return o[function t(i){return"json"===i.type?"application/json":"blob"===i.type?i.blob.type:function n(p){const t=(0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_0__.Zo)(p);return g[t]||a}(i.url)}(i)]||e}const o={},a="text/plain",e=o[a],g={png:"image/png",jpeg:"image/jpeg",jpg:"image/jpg",bmp:"image/bmp",gif:"image/gif",json:"application/json",txt:"text/plain",xml:"application/xml",svg:"image/svg+xml",zip:"application/zip",pbf:"application/vnd.mapbox-vector-tile",gz:"application/gzip","bin.gz":"application/octet-stream"};for(const l in g)o[g[l]]=l},"./node_modules/@arcgis/core/renderers/support/styleUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{L:()=>t});var _core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/asyncUtils.js"),_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_core_Warning_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/Warning.js");async function t(t,i,n){const s=t&&t.getAtOrigin&&t.getAtOrigin("renderer",i.origin);if(s&&"unique-value"===s.type&&s.styleOrigin){const a=await(0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_0__.Ke)(s.populateFromStyle());if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__.Te)(n),!1===a.ok){const e=a.error;i?.messages&&i.messages.push(new _core_Warning_js__WEBPACK_IMPORTED_MODULE_2__.A("renderer:style-reference",`Failed to create unique value renderer from style reference: ${e.message}`,{error:e,context:i})),t.clear("renderer",i?.origin)}}}},"./node_modules/@arcgis/core/versionManagement/support/versionManagementUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{TA:()=>r,Z3:()=>t,ZJ:()=>s,w5:()=>a});const r=(0,__webpack_require__("./node_modules/@arcgis/core/core/uuid.js").vD)(),t=new Map,n=new Map;new Map;async function s(e,t,o=!1){if(!e||!t)return!0;const s=e.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),a=n.get(s)?.entries();if(a)for(const[n,i]of a)if(i.name===t){const e=!i.stack?.hasForwardEdits();if(!e&&o){const[{deleteForwardEdits:e},{default:t}]=await Promise.all([__webpack_require__.e(78088).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/rest/versionManagement/gdbVersion/deleteForwardEdits.js")),__webpack_require__.e(7944).then(__webpack_require__.bind(__webpack_require__,"./node_modules/@arcgis/core/rest/versionManagement/gdbVersion/support/DeleteForwardEditsParameters.js"))]);return e(s,n,new t({sessionId:r,moment:i.moment}))}return e}return!0}function a(e,r){if(!e)return!1;const t=e.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),o=n.get(t)?.entries();if(o)for(const[n,s]of o)if(s.name===r)return"edit"===s.lockType;return!1}}}]);