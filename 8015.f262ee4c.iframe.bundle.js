"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[8015],{"./node_modules/@arcgis/core/core/accessorSupport/originUtils.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>i});var _multiOriginJSONSupportUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js");function i(i){i&&i.writtenProperties&&i.writtenProperties.forEach((({target:i,propName:t,newOrigin:e})=>{(0,_multiOriginJSONSupportUtils_js__WEBPACK_IMPORTED_MODULE_0__.l)(i)&&e&&i.originOf(t)!==e&&i.updateOrigin(t,e)}))}},"./node_modules/@arcgis/core/core/multiOriginJSONSupportUtils.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{function i(i){return i&&"getAtOrigin"in i&&"originOf"in i}__webpack_require__.d(__webpack_exports__,{l:()=>i})},"./node_modules/@arcgis/core/layers/save/featureLayerUtils.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{save:()=>C,saveAll:()=>Y,saveAs:()=>B});var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),_core_Error_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_core_Logger_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),_core_accessorSupport_originUtils_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/originUtils.js"),_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/layers/FeatureLayer.js"),_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js"),_support_fetchService_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/layers/support/fetchService.js"),_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/layers/support/layerUtils.js"),_portal_Portal_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/portal/Portal.js"),_portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/portal/PortalItem.js"),_portal_support_jsonContext_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/portal/support/jsonContext.js"),_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/portal/support/portalItemUtils.js");const I=_core_Logger_js__WEBPACK_IMPORTED_MODULE_2__.Z.getLogger("esri.layers.FeatureLayer"),S="Feature Service";function g(e,t){return`Layer (title: ${e.title}, id: ${e.id}) of type '${e.declaredClass}' ${t}`}function j(e,r){if(r.type!==S)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z("feature-layer:portal-item-wrong-type",g(e,`should have portal item of type "${S}"`))}async function L(e){if(await e.load(),(0,_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__.rQ)(e))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z("feature-layer:save",g(e,"using an in-memory source cannot be saved to a portal item"))}async function J(e,t,r){"beforeSave"in e&&"function"==typeof e.beforeSave&&await e.beforeSave();const a=e.write({},t);return function P(e,r){let a=(e.messages??[]).filter((({type:e})=>"error"===e)).map((({name:e,message:r,details:a})=>new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z(e,r,a)));if(r?.ignoreUnsupported&&(a=a.filter((({name:e})=>"layer:unsupported"!==e&&"symbol:unsupported"!==e&&"symbol-layer:unsupported"!==e&&"property:unsupported"!==e&&"url:unsupported"!==e))),a.length>0)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z("feature-layer:save","Failed to save feature layer due to unsupported or invalid content. See 'details.errors' for more detailed information",{errors:a})}(t,r),a}function N(e){const{layer:t,layerJSON:r}=e;return t.isTable?{layers:[],tables:[r]}:{layers:[r],tables:[]}}function O(e){(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.qj)(e,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.Kz.JSAPI),e.typeKeywords&&(e.typeKeywords=e.typeKeywords.filter(((e,t,r)=>r.indexOf(e)===t)))}async function T(e,t){return/\/\d+\/?$/.test(e.url??"")?N(t[0]):async function $(e,t){const{layer:{url:r,customParameters:a,apiKey:o}}=t[0];let s=await e.fetchData("json");s&&null!=s.layers&&null!=s.tables||(s=await async function x(e,t,r){var a,o;e||(e={}),(a=e).layers||(a.layers=[]),(o=e).tables||(o.tables=[]);const{url:s,customParameters:l,apiKey:i}=t,{serviceJSON:n,layersJSON:u}=await(0,_support_fetchService_js__WEBPACK_IMPORTED_MODULE_6__.V)(s,{customParameters:l,apiKey:i}),c=A(e.layers,n.layers,r),y=A(e.tables,n.tables,r);e.layers=c.itemResources,e.tables=y.itemResources;const d=[...c.added,...y.added],m=u?[...u.layers,...u.tables]:[];return await async function U(e,t,r,o){const s=t.map((({id:e})=>new _FeatureLayer_js__WEBPACK_IMPORTED_MODULE_4__.default({url:r,layerId:e,sourceJSON:o.find((({id:t})=>t===e))})));await(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.as)(s.map((e=>e.load()))),s.forEach((t=>{const{layerId:r,loaded:o,defaultPopupTemplate:s}=t;o&&!(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.Wi)(s)&&K(t,{id:r,popupInfo:s.toJSON()},e)}))}(e,d,s,m),e}(s,{url:r??"",customParameters:a,apiKey:o},t.map((e=>e.layer.layerId))));for(const l of t)K(l.layer,l.layerJSON,s);return s}(e,t)}function A(t,r,a){const o=(0,_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__.e5)(t,r,((e,t)=>e.id===t.id));t=t.filter((e=>!o.removed.some((t=>t.id===e.id))));const s=o.added.map((({id:e})=>({id:e})));return s.forEach((({id:e})=>{t.push({id:e})})),{itemResources:t,added:s.filter((({id:e})=>!a.includes(e)))}}function K(e,t,r){e.isTable?F(r.tables,t):F(r.layers,t)}function F(e,t){if(!e)return;const r=e.findIndex((({id:e})=>e===t.id));-1===r?e.push(t):e[r]=t}function R(e){const{portalItem:t}=e;return(0,_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_11__.y2)(e)&&!e.dynamicDataSource&&!!t?.loaded&&t.type===S}const C=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.Ds)((async function M(e,t){await L(e),function E(e){const r=e.portalItem;if(!r)throw I.error("save: requires the portalItem property to be set"),new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z("feature-layer:portal-item-not-set",g(e,"requires the portalItem property to be set"));if(!r.loaded)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z("feature-layer:portal-item-not-loaded",g(e,"cannot be saved to a portal item that does not exist or is inaccessible"));j(e,r)}(e);const r=e.portalItem,a=(0,_portal_support_jsonContext_js__WEBPACK_IMPORTED_MODULE_9__.Y)(r),o=await J(e,a,t),s=await T(r,[{layer:e,layerJSON:o}]);return O(r),await r.update({data:s}),(0,_core_accessorSupport_originUtils_js__WEBPACK_IMPORTED_MODULE_13__.D)(a),r}));const Y=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.Ds)((async(e,t)=>{await async function D(e){if(!e?.length)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z("feature-layer-utils-saveall:missing-parameters","'layers' array should contain at least one feature layer");await Promise.all(e.map((e=>e.load())));for(const o of e)if(!R(o))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z("feature-layer-utils-saveall:invalid-parameters",`'layers' array should only contain layers or tables in a feature service loaded from 'Feature Service' item. ${g(o,"does not conform")}`,{layer:o});const r=e.map((e=>e.portalItem.id));if(new Set(r).size>1)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z("feature-layer-utils-saveall:invalid-parameters","All layers in the 'layers' array should be loaded from the same portal item");const a=e.map((e=>e.layerId));if(new Set(a).size!==a.length)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__.Z("feature-layer-utils-saveall:invalid-parameters","'layers' array should contain only one instance each of layer or table in a feature service")}(e);const r=e[0].portalItem,a=(0,_portal_support_jsonContext_js__WEBPACK_IMPORTED_MODULE_9__.Y)(r),o=await Promise.all(e.map((e=>J(e,a,t)))),s=await T(r,e.map(((e,t)=>({layer:e,layerJSON:o[t]}))));return O(r),await r.update({data:s}),await Promise.all(e.slice(1).map((e=>e.portalItem.reload()))),(0,_core_accessorSupport_originUtils_js__WEBPACK_IMPORTED_MODULE_13__.D)(a),r.clone()})),B=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.Ds)((async function G(e,t,r){await L(e);const a=function _(e,t){var r,a;let o=_portal_PortalItem_js__WEBPACK_IMPORTED_MODULE_8__.default.from(t);return o.id&&(o=o.clone(),o.id=null),(r=o).type??(r.type=S),(a=o).portal??(a.portal=_portal_Portal_js__WEBPACK_IMPORTED_MODULE_7__.Z.getDefault()),j(e,o),o}(e,t),o=(0,_portal_support_jsonContext_js__WEBPACK_IMPORTED_MODULE_9__.Y)(a),s=N({layer:e,layerJSON:await J(e,o,r)});return await async function q(e,t){const{url:r,layerId:a,title:s,fullExtent:l,isTable:i}=e,n=(0,_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_5__.Qc)(r),p=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.pC)(n)&&"FeatureServer"===n.serverType;t.url=p?r:`${r}/${a}`,t.title||(t.title=s),t.extent=null,!i&&(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.pC)(l)&&(t.extent=await(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.$o)(l)),(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.ck)(t,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.Kz.METADATA),(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.ck)(t,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.Kz.MULTI_LAYER),(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.qj)(t,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.Kz.SINGLE_LAYER),i&&(0,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.qj)(t,_portal_support_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.Kz.TABLE),O(t)}(e,a),await async function z(e,t,r){const a=e.portal;await(a?._signIn()),await(a?.user?.addItem({item:e,data:t,folder:r?.folder}))}(a,s,r),e.portalItem=a,(0,_core_accessorSupport_originUtils_js__WEBPACK_IMPORTED_MODULE_13__.D)(o),a}))},"./node_modules/@arcgis/core/layers/support/fetchService.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>a,V:()=>r});var _request_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/request.js");async function r(e,r){let s=await a(e,r);s=s||{},s.layers=s.layers?.filter(t)||[];const n={serviceJSON:s};if((s.currentVersion??0)<10.5)return n;const o=await a(e+"/layers",r);return n.layersJSON={layers:o?.layers?.filter(t)||[],tables:o?.tables||[]},n}function t(e){return!e.type||"Feature Layer"===e.type}async function a(r,t){return(await(0,_request_js__WEBPACK_IMPORTED_MODULE_0__.default)(r,{responseType:"json",query:{f:"json",...t?.customParameters,token:t?.apiKey}})).data}},"./node_modules/@arcgis/core/portal/support/portalItemUtils.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$o:()=>a,Kz:()=>f,_$:()=>s,ck:()=>c,qj:()=>i});var _geometry_projection_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/geometry/projection.js"),_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js"),_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/webMercatorUtils.js");function i(e,t){if(!s(e,t)){const r=e.typeKeywords;r?r.push(t):e.typeKeywords=[t]}}function s(e,t){return!!e.typeKeywords?.includes(t)}function c(e,t){const r=e.typeKeywords;if(r){const e=r.indexOf(t);e>-1&&r.splice(e,1)}}async function a(e){const t=e.clone().normalize();let r;if(t.length>1)for(const o of t)r?o.width>r.width&&(r=o):r=o;else r=t[0];return async function n(n){const i=n.spatialReference;if(i.isWGS84)return n.clone();if(i.isWebMercator)return(0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_2__.Sx)(n);const s=_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_1__.Z.WGS84;return await(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_0__.iQ)(i,s),(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_0__.iV)(n,s)}(r)}const f={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table"}}}]);