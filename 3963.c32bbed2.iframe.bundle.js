"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[3963],{"./node_modules/@arcgis/core/layers/OGCFeatureLayer.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>V});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),PopupTemplate=(__webpack_require__("./node_modules/@arcgis/core/geometry.js"),__webpack_require__("./node_modules/@arcgis/core/PopupTemplate.js")),types=(__webpack_require__("./node_modules/@arcgis/core/renderers/ClassBreaksRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/DictionaryRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/DotDensityRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/HeatmapRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/PieChartRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/Renderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/SimpleRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/UniqueValueRenderer.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/support/jsonUtils.js"),__webpack_require__("./node_modules/@arcgis/core/renderers/support/types.js")),MultiOriginJSONSupport=__webpack_require__("./node_modules/@arcgis/core/core/MultiOriginJSONSupport.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),typeUtils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/typeUtils.js"),Layer=__webpack_require__("./node_modules/@arcgis/core/layers/Layer.js"),Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),Loadable=__webpack_require__("./node_modules/@arcgis/core/core/Loadable.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),ogcFeatureUtils=__webpack_require__("./node_modules/@arcgis/core/layers/ogc/ogcFeatureUtils.js"),FeatureSet=__webpack_require__("./node_modules/@arcgis/core/rest/support/FeatureSet.js"),SpatialReference=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js");let C=class extends Loadable.Z{constructor(){super(...arguments),this.featureDefinition=null,this.type="ogc-feature"}load(e){return this.addResolvingPromise(this._loadOGCServices(this.layer,e)),this.when()}getSource(){const{featureDefinition:{collection:e,layerDefinition:t,spatialReference:s,supportedCrs:r},layer:{apiKey:o,customParameters:p,effectiveMaxRecordCount:i}}=this;return{type:"ogc-source",collection:e,layerDefinition:t,maxRecordCount:i,queryParameters:{apiKey:o,customParameters:p},spatialReference:s,supportedCrs:r}}queryExtent(e,t={}){return null}queryFeatureCount(e,t={}){return null}queryFeatures(e,t={}){return this.queryFeaturesJSON(e,t).then((e=>FeatureSet.Z.fromJSON(e)))}queryFeaturesJSON(e,t={}){const s=this.getSource();return this.load(t).then((()=>(0,ogcFeatureUtils.yN)(s,e,t)))}queryObjectIds(e,t={}){return null}serviceSupportsSpatialReference(e){return!(!e.isWGS84&&!e.isWebMercator&&!this.featureDefinition.supportedCrs[e.wkid])}_conformsToType(e,t){const s=new RegExp(`^${t}$`,"i");return e.conformsTo.some((e=>s.test(e)))??!1}_getCapabilities(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1},query:{maxRecordCount:t,maxRecordCountFactor:void 0,standardMaxRecordCount:void 0,supportsCacheHint:!1,supportsCentroid:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,supportsSqlExpression:!1,tileMaxRecordCount:void 0},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUploadWithItemId:!1,supportsUpdateWithoutM:!1}}}_getMaxRecordCount(e){const t=e?.components?.parameters;return t?.limit?.schema?.maximum??t?.limitFeatures?.schema?.maximum}_getStorageSpatialReference(e){const t=e.storageCrs??ogcFeatureUtils.$9,s=(0,ogcFeatureUtils.d)(t);return(0,maybe.Wi)(s)?SpatialReference.Z.WGS84:new SpatialReference.Z({wkid:s})}_getSupportedSpatialReferences(e,t){const s="#/crs",r=e.crs??[ogcFeatureUtils.$9],o=r.includes(s)?r.filter((e=>e!==s)).concat(t.crs??[]):r,p=/^http:\/\/www\.opengis.net\/def\/crs\/epsg\/.*\/3785$/i;return o.filter((e=>!p.test(e)))}async _loadOGCServices(e,s){const r=(0,maybe.pC)(s)?s.signal:null,{apiKey:p,collectionId:i,customParameters:a,fields:u,geometryType:g,hasZ:h,objectIdField:C,timeInfo:R,url:w}=e,x={fields:u?.map((e=>e.toJSON())),geometryType:typeUtils.P.toJSON(g),hasZ:h??!1,objectIdField:C,timeInfo:R?.toJSON()},j={apiKey:p,customParameters:a,signal:r},F=await(0,ogcFeatureUtils.gp)(w,j),[O,v]=await Promise.all([(0,ogcFeatureUtils.G4)(F,j),(0,ogcFeatureUtils.j)(F,j)]);if(!this._conformsToType(O,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson"))throw new Error.Z("ogc-feature-layer:no-geojson-support","Server does not support geojson");const T=v.collections.find((e=>e.id===i));if(!T)throw new Error.Z("ogc-feature-layer:collection-not-found","Server does not contain the named collection");const D=this._conformsToType(O,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30")?await(0,ogcFeatureUtils.eS)(F,j):null,_=await(0,ogcFeatureUtils.w9)(T,x,j),b=this._getMaxRecordCount(D),P=this._getCapabilities(_.hasZ,b),q=this._getStorageSpatialReference(T).toJSON(),M=this._getSupportedSpatialReferences(T,v),A=new RegExp(`^${ogcFeatureUtils.Lu}`,"i"),E={};for(const t of M){const e=(0,ogcFeatureUtils.d)(t);(0,maybe.pC)(e)&&(E[e]||(E[e]=t.replace(A,"")))}this.featureDefinition={capabilities:P,collection:T,layerDefinition:_,spatialReference:q,supportedCrs:E}}};(0,tslib_es6._)([(0,property.Cb)()],C.prototype,"featureDefinition",void 0),(0,tslib_es6._)([(0,property.Cb)({constructOnly:!0})],C.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.Cb)()],C.prototype,"type",void 0),C=(0,tslib_es6._)([(0,subclass.j)("esri.layers.graphics.sources.OGCFeatureSource")],C);var APIKeyMixin=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/APIKeyMixin.js"),BlendLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/BlendLayer.js"),CustomParametersMixin=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/CustomParametersMixin.js"),FeatureEffectLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/FeatureEffectLayer.js"),FeatureReductionLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/FeatureReductionLayer.js"),OperationalLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/OperationalLayer.js"),OrderedLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/OrderedLayer.js"),PortalLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/PortalLayer.js"),RefreshableLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/RefreshableLayer.js"),ScaleRangeLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/ScaleRangeLayer.js"),TemporalLayer=__webpack_require__("./node_modules/@arcgis/core/layers/mixins/TemporalLayer.js"),commonProperties=__webpack_require__("./node_modules/@arcgis/core/layers/support/commonProperties.js"),FeatureType=__webpack_require__("./node_modules/@arcgis/core/layers/support/FeatureType.js"),Field=__webpack_require__("./node_modules/@arcgis/core/layers/support/Field.js"),fieldProperties=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldProperties.js"),fieldUtils=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldUtils.js"),LabelClass=__webpack_require__("./node_modules/@arcgis/core/layers/support/LabelClass.js"),labelingInfo=__webpack_require__("./node_modules/@arcgis/core/layers/support/labelingInfo.js"),Query=__webpack_require__("./node_modules/@arcgis/core/rest/support/Query.js"),popupUtils=__webpack_require__("./node_modules/@arcgis/core/support/popupUtils.js"),Extent=__webpack_require__("./node_modules/@arcgis/core/geometry/Extent.js");const M=(0,fieldProperties.v)();let B=class extends((0,APIKeyMixin.V)((0,CustomParametersMixin.N)((0,FeatureReductionLayer.M)((0,FeatureEffectLayer.b)((0,BlendLayer.h)((0,OrderedLayer.c)((0,TemporalLayer.n)((0,ScaleRangeLayer.M)((0,OperationalLayer.q)((0,PortalLayer.I)((0,RefreshableLayer.Q)((0,MultiOriginJSONSupport.R)(Layer.Z))))))))))))){constructor(e){super(e),this.capabilities=null,this.collectionId=null,this.copyright=null,this.definitionExpression=null,this.description=null,this.displayField=null,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelingInfo=null,this.labelsVisible=!0,this.legendEnabled=!0,this.maxRecordCount=null,this.objectIdField=null,this.operationalLayerType="OGCFeatureLayer",this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new C({layer:this}),this.spatialReference=null,this.title=null,this.type="ogc-feature",this.typeIdField=null,this.types=null,this.url=null}destroy(){this.source?.destroy()}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["OGCFeatureServer"]},e).then((()=>this._fetchService(e)))),this.when()}get defaultPopupTemplate(){return this.createPopupTemplate()}get effectiveMaxRecordCount(){return this.maxRecordCount??this.capabilities?.query.maxRecordCount??5e3}get isTable(){return this.loaded&&null==this.geometryType}set renderer(e){(0,fieldUtils.YN)(e,this.fieldsIndex),this._set("renderer",e)}on(e,r){return super.on(e,r)}createPopupTemplate(e){return(0,popupUtils.eZ)(this,e)}createQuery(){return new Query.Z}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,r){let t,i=!1;const o=r?.feature?.attributes,s=this.typeIdField&&o?.[this.typeIdField];return null!=s&&this.types&&(i=this.types.some((r=>r.id==s&&(t=r.domains?.[e],"inherited"===t?.type&&(t=this._getLayerDomain(e)),!0)))),i||t||(t=this._getLayerDomain(e)),t}queryFeatures(e,r){return this.load().then((()=>this.source.queryFeatures(Query.Z.from(e)||this.createQuery(),r))).then((e=>(e?.features?.forEach((e=>{e.layer=e.sourceLayer=this})),e)))}serviceSupportsSpatialReference(e){return this.source?.serviceSupportsSpatialReference(e)??!1}async _fetchService(e){await this.source.load(e),this.read(this.source.featureDefinition,{origin:"service"}),(0,fieldUtils.YN)(this.renderer,this.fieldsIndex),(0,fieldUtils.UF)(this.timeInfo,this.fieldsIndex)}_getLayerDomain(e){if(!this.fields)return null;for(const r of this.fields)if(r.name===e&&r.domain)return r.domain;return null}};(0,tslib_es6._)([(0,property.Cb)({readOnly:!0,json:{origins:{service:{read:!0}}}})],B.prototype,"capabilities",void 0),(0,tslib_es6._)([(0,property.Cb)({type:String,json:{write:!0}})],B.prototype,"collectionId",void 0),(0,tslib_es6._)([(0,property.Cb)({type:String})],B.prototype,"copyright",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0})],B.prototype,"defaultPopupTemplate",null),(0,tslib_es6._)([(0,property.Cb)({type:String})],B.prototype,"definitionExpression",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0,type:String,json:{origins:{service:{name:"collection.description"}}}})],B.prototype,"description",void 0),(0,tslib_es6._)([(0,property.Cb)({type:String})],B.prototype,"displayField",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number})],B.prototype,"effectiveMaxRecordCount",null),(0,tslib_es6._)([(0,property.Cb)(commonProperties.PV)],B.prototype,"elevationInfo",void 0),(0,tslib_es6._)([(0,property.Cb)({type:[Field.Z],json:{origins:{service:{name:"layerDefinition.fields"}}}})],B.prototype,"fields",void 0),(0,tslib_es6._)([(0,property.Cb)(M.fieldsIndex)],B.prototype,"fieldsIndex",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0,type:Extent.Z,json:{origins:{service:{name:"layerDefinition.extent"}}}})],B.prototype,"fullExtent",void 0),(0,tslib_es6._)([(0,property.Cb)({type:typeUtils.M.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:typeUtils.M.read}}}}})],B.prototype,"geometryType",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Boolean,json:{origins:{service:{name:"layerDefinition.hasZ"}}}})],B.prototype,"hasZ",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Boolean,readOnly:!0})],B.prototype,"isTable",null),(0,tslib_es6._)([(0,property.Cb)({type:[LabelClass.Z],json:{origins:{"web-document":{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:labelingInfo.r},write:!0}}}})],B.prototype,"labelingInfo",void 0),(0,tslib_es6._)([(0,property.Cb)(commonProperties.iR)],B.prototype,"labelsVisible",void 0),(0,tslib_es6._)([(0,property.Cb)(commonProperties.rn)],B.prototype,"legendEnabled",void 0),(0,tslib_es6._)([(0,property.Cb)({type:Number})],B.prototype,"maxRecordCount",void 0),(0,tslib_es6._)([(0,property.Cb)({type:String,json:{origins:{service:{name:"layerDefinition.objectIdField"}}}})],B.prototype,"objectIdField",void 0),(0,tslib_es6._)([(0,property.Cb)({type:["OGCFeatureLayer"]})],B.prototype,"operationalLayerType",void 0),(0,tslib_es6._)([(0,property.Cb)(commonProperties.C_)],B.prototype,"popupEnabled",void 0),(0,tslib_es6._)([(0,property.Cb)({type:PopupTemplate.Z,json:{name:"popupInfo",write:!0}})],B.prototype,"popupTemplate",void 0),(0,tslib_es6._)([(0,property.Cb)({types:types.A,json:{origins:{service:{name:"layerDefinition.drawingInfo.renderer",write:!1},"web-scene":{types:types.o,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:!0}})],B.prototype,"renderer",null),(0,tslib_es6._)([(0,property.Cb)(commonProperties.YI)],B.prototype,"screenSizePerspectiveEnabled",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0})],B.prototype,"source",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0,type:SpatialReference.Z,json:{origins:{service:{read:!0}}}})],B.prototype,"spatialReference",void 0),(0,tslib_es6._)([(0,property.Cb)({type:String,json:{write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"collection.title"}}}})],B.prototype,"title",void 0),(0,tslib_es6._)([(0,property.Cb)({readOnly:!0,json:{read:!1}})],B.prototype,"type",void 0),(0,tslib_es6._)([(0,property.Cb)({type:String,readOnly:!0})],B.prototype,"typeIdField",void 0),(0,tslib_es6._)([(0,property.Cb)({type:[FeatureType.Z]})],B.prototype,"types",void 0),(0,tslib_es6._)([(0,property.Cb)(commonProperties.HQ)],B.prototype,"url",void 0),B=(0,tslib_es6._)([(0,subclass.j)("esri.layers.OGCFeatureLayer")],B);const V=B},"./node_modules/@arcgis/core/layers/graphics/sources/geojson/geojson.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{O3:()=>T,lG:()=>I,my:()=>L,q9:()=>s});var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/OptimizedFeature.js"),_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js"),_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldUtils.js");const i={LineString:"esriGeometryPolyline",MultiLineString:"esriGeometryPolyline",MultiPoint:"esriGeometryMultipoint",Point:"esriGeometryPoint",Polygon:"esriGeometryPolygon",MultiPolygon:"esriGeometryPolygon"};function s(e){return i[e]}function*c(e){switch(e.type){case"Feature":yield e;break;case"FeatureCollection":for(const t of e.features)t&&(yield t)}}function*u(e){if(e)switch(e.type){case"Point":yield e.coordinates;break;case"LineString":case"MultiPoint":yield*e.coordinates;break;case"MultiLineString":case"Polygon":for(const t of e.coordinates)yield*t;break;case"MultiPolygon":for(const t of e.coordinates)for(const e of t)yield*e}}function f(e){for(const t of e)if(t.length>2)return!0;return!1}function p(e){let t=0;for(let n=0;n<e.length;n++){const o=e[n],r=e[(n+1)%e.length];t+=o[0]*r[1]-r[0]*o[1]}return t<=0}function d(e){const t=e[0],n=e[e.length-1];return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]||e.push(t),e}function g(e,t,n){switch(t.type){case"LineString":return function m(e,t,n){return G(e,t.coordinates,n),e}(e,t,n);case"MultiLineString":return function h(e,t,n){for(const o of t.coordinates)G(e,o,n);return e}(e,t,n);case"MultiPoint":return function w(e,t,n){return G(e,t.coordinates,n),e}(e,t,n);case"MultiPolygon":return function P(e,t,n){for(const o of t.coordinates){S(e,o[0],n);for(let t=1;t<o.length;t++)F(e,o[t],n)}return e}(e,t,n);case"Point":return function b(e,t,n){return k(e,t.coordinates,n),e}(e,t,n);case"Polygon":return function j(e,t,n){const o=t.coordinates;S(e,o[0],n);for(let r=1;r<o.length;r++)F(e,o[r],n);return e}(e,t,n)}}function S(e,t,n){const o=d(t);!function a(e){return!p(e)}(o)?G(e,o,n):M(e,o,n)}function F(e,t,n){const o=d(t);!function y(e){return p(e)}(o)?G(e,o,n):M(e,o,n)}function G(e,t,n){for(const o of t)k(e,o,n);e.lengths.push(t.length)}function M(e,t,n){for(let o=t.length-1;o>=0;o--)k(e,t[o],n);e.lengths.push(t.length)}function k(e,t,n){const[o,r,i]=t;e.coords.push(o,r),n.hasZ&&e.coords.push(i||0)}function O(e){switch(typeof e){case"string":return"esriFieldTypeString";case"number":return"esriFieldTypeDouble";default:return"unknown"}}function T(t){if(!t)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.Z("geojson-layer:empty","GeoJSON data is empty");if("Feature"!==t.type&&"FeatureCollection"!==t.type)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.Z("geojson-layer:unsupported-geojson-object","missing or not supported GeoJSON object type",{data:t});const{crs:n}=t;if(!n)return;const o="string"==typeof n?n:"name"===n.type?n.properties.name:"EPSG"===n.type?n.properties.code:null,r=new RegExp(".*(CRS84H?|4326)$","i");if(!o||!r.test(o))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__.Z("geojson-layer:unsupported-crs","unsupported GeoJSON 'crs' member",{crs:n})}function L(e,t={}){const n=[],i=new Set,l=new Set;let a,y=!1,p=null,d=!1,{geometryType:g=null}=t,m=!1;for(const r of c(e)){const{geometry:e,properties:t,id:c}=r;if((!e||(g||(g=s(e.type)),s(e.type)===g))&&(y||(y=f(u(e))),d||(d=null!=c,d&&(a=typeof c,t&&(p=Object.keys(t).filter((e=>t[e]===c))))),t&&p&&d&&null!=c&&(p.length>1?p=p.filter((e=>t[e]===c)):1===p.length&&(p=t[p[0]]===c?p:[])),!m&&t)){let e=!0;for(const r in t){if(i.has(r))continue;const s=t[r];if(null==s){e=!1,l.add(r);continue}const c=O(s);if("unknown"===c){l.add(r);continue}l.delete(r),i.add(r);const u=(0,_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__.q6)(r);u&&n.push({name:u,alias:r,type:c})}m=e}}const h=(0,_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__.q6)(1===p?.length&&p[0]||null)??void 0;if(h)for(const o of n)if(o.name===h&&(0,_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__.H7)(o)){o.type="esriFieldTypeOID";break}return{fields:n,geometryType:g,hasZ:y,objectIdFieldName:h,objectIdFieldType:a,unknownFields:Array.from(l)}}function I(e,t){return Array.from(function*l(e,o={}){const{geometryType:r,objectIdField:i}=o;for(const c of e){const{geometry:e,properties:u,id:l}=c;if(e&&s(e.type)!==r)continue;const f=u||{};let a;i&&(a=f[i],null==l||a||(f[i]=a=l));const y=new _OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_2__.u_(e?g(new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_3__.Z,e,o):null,f,null,a??void 0);yield y}}(c(e),t))}},"./node_modules/@arcgis/core/layers/ogc/ogcFeatureUtils.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$9:()=>F,G4:()=>k,Lu:()=>j,WW:()=>q,d:()=>v,eS:()=>S,gp:()=>x,j:()=>T,w9:()=>I,yN:()=>N});__webpack_require__("./node_modules/@arcgis/core/geometry.js");var _request_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/request.js"),_core_Error_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),_core_Logger_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js"),_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/webMercatorUtils.js"),_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js"),_graphics_OptimizedFeatureSet_js__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/OptimizedFeatureSet.js"),_graphics_sources_geojson_geojson_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/sources/geojson/geojson.js"),_graphics_sources_support_clientSideDefaults_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/layers/graphics/sources/support/clientSideDefaults.js"),_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/layers/support/FieldsIndex.js"),_support_fieldType_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldType.js"),_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@arcgis/core/geometry/SpatialReference.js");const h=_core_Logger_js__WEBPACK_IMPORTED_MODULE_3__.Z.getLogger("esri.layers.graphics.sources.ogcfeature"),j="http://www.opengis.net/def/crs/",F=`${j}OGC/1.3/CRS84`;async function I(n,r,a={},o=5){const{links:s}=n,l=D(s,"items","application/geo+json")||D(s,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.Wi)(l))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__.Z("ogc-feature-layer:missing-items-page","Missing items url");const{data:c}=await(0,_request_js__WEBPACK_IMPORTED_MODULE_1__.default)(l.href,{signal:a.signal,query:{limit:o,...a.customParameters,token:a.apiKey},headers:{accept:"application/geo+json"}});await(0,_graphics_sources_geojson_geojson_js__WEBPACK_IMPORTED_MODULE_7__.O3)(c);const d=(0,_graphics_sources_geojson_geojson_js__WEBPACK_IMPORTED_MODULE_7__.my)(c,{geometryType:r.geometryType}),u=r.fields||d.fields||[],f=null!=r.hasZ?r.hasZ:d.hasZ,b=d.geometryType,j=r.objectIdField||d.objectIdFieldName||"OBJECTID";let F=r.timeInfo;const I=u.find((({name:e})=>e===j));if(I)I.editable=!1,I.nullable=!1;else{if(!d.objectIdFieldType)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__.Z("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");u.unshift({name:j,alias:j,type:"number"===d.objectIdFieldType?"esriFieldTypeOID":"esriFieldTypeString",editable:!1,nullable:!1})}if(j!==d.objectIdFieldName){const e=u.find((({name:e})=>e===d.objectIdFieldName));e&&(e.type="esriFieldTypeInteger")}u===d.fields&&d.unknownFields.length>0&&h.warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:d.unknownFields}});for(const e of u){if(null==e.name&&(e.name=e.alias),null==e.alias&&(e.alias=e.name),"esriFieldTypeOID"!==e.type&&"esriFieldTypeGlobalID"!==e.type&&(e.editable=null==e.editable||!!e.editable,e.nullable=null==e.nullable||!!e.nullable),!e.name)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__.Z("ogc-feature-layer:invalid-field-name","field name is missing",{field:e});if(!_support_fieldType_js__WEBPACK_IMPORTED_MODULE_10__.v.jsonValues.includes(e.type))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__.Z("ogc-feature-layer:invalid-field-type",`invalid type for field "${e.name}"`,{field:e})}if(F){const e=new _support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_9__.Z(u);if(F.startTimeField){const t=e.get(F.startTimeField);t?(F.startTimeField=t.name,t.type="esriFieldTypeDate"):F.startTimeField=null}if(F.endTimeField){const t=e.get(F.endTimeField);t?(F.endTimeField=t.name,t.type="esriFieldTypeDate"):F.endTimeField=null}if(F.trackIdField){const t=e.get(F.trackIdField);t?F.trackIdField=t.name:(F.trackIdField=null,h.warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:F}}))}F.startTimeField||F.endTimeField||(h.warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:F}}),F=null)}return{drawingInfo:b?(0,_graphics_sources_support_clientSideDefaults_js__WEBPACK_IMPORTED_MODULE_8__.bU)(b):null,extent:W(n),geometryType:b,fields:u,hasZ:!!f,objectIdField:j,timeInfo:F}}async function T(n,r={}){const{links:a}=n,o=D(a,"data","application/json")||D(a,"http://www.opengis.net/def/rel/ogc/1.0/data","application/json");if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.Wi)(o))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__.Z("ogc-feature-layer:missing-collections-page","Missing collections url");const{apiKey:s,customParameters:l,signal:c}=r,{data:d}=await(0,_request_js__WEBPACK_IMPORTED_MODULE_1__.default)(o.href,{signal:c,headers:{accept:"application/json"},query:{...l,token:s}});return d}async function k(n,r={}){const{links:a}=n,o=D(a,"conformance","application/json")||D(a,"http://www.opengis.net/def/rel/ogc/1.0/conformance","application/json");if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.Wi)(o))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__.Z("ogc-feature-layer:missing-conformance-page","Missing conformance url");const{apiKey:s,customParameters:l,signal:c}=r,{data:d}=await(0,_request_js__WEBPACK_IMPORTED_MODULE_1__.default)(o.href,{signal:c,headers:{accept:"application/json"},query:{...l,token:s}});return d}async function x(t,n={}){const{apiKey:i,customParameters:r,signal:a}=n,{data:o}=await(0,_request_js__WEBPACK_IMPORTED_MODULE_1__.default)(t,{signal:a,headers:{accept:"application/json"},query:{...r,token:i}});return o}async function S(t,n={}){const r="application/vnd.oai.openapi+json;version=3.0",a=D(t.links,"service-desc",r);if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.Wi)(a))return h.warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const{apiKey:o,customParameters:s,signal:l}=n,{data:c}=await(0,_request_js__WEBPACK_IMPORTED_MODULE_1__.default)(a.href,{signal:l,headers:{accept:r},query:{...s,token:o}});return c}function v(e){const t=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(e)?.groups;if(!t)return null;const{authority:n,code:i}=t;switch(n.toLowerCase()){case"ogc":switch(i.toLowerCase()){case"crs27":return _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_11__.Z.GCS_NAD_1927.wkid;case"crs83":return 4269;case"crs84":case"crs84h":return _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_11__.Z.WGS84.wkid;default:return null}case"esri":case"epsg":{const e=Number.parseInt(i,10);return Number.isNaN(e)?null:e}default:return null}}async function N(e,t,n){const i=await q(e,t,n);return(0,_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__.cn)(i)}async function q(n,l,m){const{collection:p,layerDefinition:g,maxRecordCount:y,queryParameters:{apiKey:w,customParameters:h},spatialReference:j,supportedCrs:F}=n,{links:I}=p,T=D(I,"items","application/geo+json")||D(I,"http://www.opengis.net/def/rel/ogc/1.0/items","application/geo+json");if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.Wi)(T))throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__.Z("ogc-feature-layer:missing-items-page","Missing items url");const{geometry:k,num:x,start:S,timeExtent:v,where:N}=l;if(l.objectIds)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__.Z("ogc-feature-layer:query-by-objectids-not-supported","Queries with objectids are not supported");const q=_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_11__.Z.fromJSON(j),O=(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.Pt)(l.outSpatialReference,q),C=O.isWGS84?null:R(O,F),W=G(k,F),P=function M(e){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.Wi)(e))return null;const{start:t,end:n}=e;return`${(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.pC)(t)?t.toISOString():".."}/${(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.pC)(n)?n.toISOString():".."}`}(v),Z=function $(e){return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.Wi)(e)||!e||"1=1"===e?null:e}(N),K=x??(null!=S&&void 0!==S?10:y),{data:L}=await(0,_request_js__WEBPACK_IMPORTED_MODULE_1__.default)(T.href,{...m,query:{...h,...W,crs:C,datetime:P,query:Z,limit:K,startindex:S,token:w},headers:{accept:"application/geo+json"}});let J=!1;if(L.links){J=!!L.links.find((e=>"next"===e.rel))}!J&&Number.isInteger(L.numberMatched)&&Number.isInteger(L.numberReturned)&&(J=L.numberReturned<L.numberMatched);const{fields:z,geometryType:A,hasZ:E,objectIdField:U}=g,_=(0,_graphics_sources_geojson_geojson_js__WEBPACK_IMPORTED_MODULE_7__.lG)(L,{geometryType:A,hasZ:E,objectIdField:U});if(!C&&O.isWebMercator)for(const e of _)if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.pC)(e.geometry)&&null!=A){const t=(0,_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__.di)(e.geometry,A,E,!1);t.spatialReference=_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_11__.Z.WGS84,e.geometry=(0,_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__.GH)((0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_5__.iV)(t,O))}for(const e of _)e.objectId=e.attributes[U];const B=C||!C&&O.isWebMercator?O.toJSON():_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__.Zn,Q=new _graphics_OptimizedFeatureSet_js__WEBPACK_IMPORTED_MODULE_13__.Z;return Q.exceededTransferLimit=J,Q.features=_,Q.fields=z,Q.geometryType=A,Q.hasZ=E,Q.objectIdFieldName=U,Q.spatialReference=B,Q}function R(e,t){const{isWebMercator:n,wkid:i}=e;if(!i)return null;const r=n?t[3857]??t[102100]??t[102113]??t[900913]:t[e.wkid];return r?`${j}${r}`:null}function C(e){if((0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.Wi)(e))return"";const{xmin:t,ymin:n,xmax:r,ymax:a}=e;return`${t},${n},${r},${a}`}function G(e,t){if(!function O(e){return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.pC)(e)&&"extent"===e.type}(e))return null;const{spatialReference:n}=e;if(!n||n.isWGS84)return{bbox:C(e)};const i=R(n,t);return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_12__.pC)(i)?{bbox:C(e),"bbox-crs":i}:n.isWebMercator?{bbox:C((0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_5__.iV)(e,_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_11__.Z.WGS84))}:null}function W(e){const t=e.extent?.spatial;if(!t)return null;const n=t.bbox[0],i=4===n.length,r=n[0],a=n[1],o=i?void 0:n[2];return{xmin:r,ymin:a,xmax:i?n[2]:n[3],ymax:i?n[3]:n[4],zmin:o,zmax:i?void 0:n[5],spatialReference:_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_11__.Z.WGS84.toJSON()}}function D(e,t,n){return e.find((e=>e.rel===t&&e.type===n))||e.find((e=>e.rel===t&&!e.type))}}}]);