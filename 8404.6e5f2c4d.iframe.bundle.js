"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[8404],{"./node_modules/@arcgis/core/geometry/support/quantizationUtils.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{G6:()=>C,Ie:()=>B,J9:()=>q,RF:()=>O,U1:()=>v,vY:()=>s,ym:()=>U});var _core_maybe_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/geometry/support/jsonUtils.js");const a=(n,t,e)=>[t,e],m=(n,t,e)=>[t,e,n[2]],c=(n,t,e)=>[t,e,n[2],n[3]];function s(t){return t?{originPosition:"upper-left"===t.originPosition?"upperLeft":"lower-left"===t.originPosition?"lowerLeft":t.originPosition,scale:t.tolerance?[t.tolerance,t.tolerance]:[1,1],translate:(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.pC)(t.extent)?[t.extent.xmin,t.extent.ymax]:[0,0]}:null}function x({scale:n,translate:t},e){return Math.round((e-t[0])/n[0])}function h({scale:n,translate:t},e){return Math.round((t[1]-e)/n[1])}function I(n,t,e){const r=[];let u,i,o,l;for(let a=0;a<e.length;a++){const m=e[a];a>0?(o=x(n,m[0]),l=h(n,m[1]),o===u&&l===i||(r.push(t(m,o-u,l-i)),u=o,i=l)):(u=x(n,m[0]),i=h(n,m[1]),r.push(t(m,u,i)))}return r.length>0?r:null}function z({scale:n,translate:t},e){return e*n[0]+t[0]}function T({scale:n,translate:t},e){return t[1]-e*n[1]}function M(n,t,e){const r=new Array(e.length);if(!e.length)return r;const[u,i]=n.scale;let o=z(n,e[0][0]),l=T(n,e[0][1]);r[0]=t(e[0],o,l);for(let a=1;a<e.length;a++){const n=e[a];o+=n[0]*u,l-=n[1]*i,r[a]=t(n,o,l)}return r}function E(n,t,e){const r=new Array(e.length);for(let u=0;u<e.length;u++)r[u]=M(n,t,e[u]);return r}function L(n,t,e,r,u){return t.points=function p(n,t,e,r){return I(n,e?r?c:m:r?m:a,t)}(n,e.points,r,u)??[],t}function O(n,t,e,r,u){return t.x=x(n,e.x),t.y=h(n,e.y),t!==e&&(r&&(t.z=e.z),u&&(t.m=e.m)),t}function S(n,t,e,r,u){const i=function N(n,t,e,r){const u=[],i=e?r?c:m:r?m:a;for(let o=0;o<t.length;o++){const e=I(n,i,t[o]);e&&e.length>=3&&u.push(e)}return u.length?u:null}(n,e.rings,r,u);return i?(t.rings=i,t):null}function d(n,t,e,r,u){const i=function y(n,t,e,r){const u=[],i=e?r?c:m:r?m:a;for(let o=0;o<t.length;o++){const e=I(n,i,t[o]);e&&e.length>=2&&u.push(e)}return u.length?u:null}(n,e.paths,r,u);return i?(t.paths=i,t):null}function U(n,t){return n&&t?(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__.wp)(t)?O(n,{},t,!1,!1):(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__.l9)(t)?d(n,{},t,!1,!1):(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__.oU)(t)?S(n,{},t,!1,!1):(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__.aW)(t)?L(n,{},t,!1,!1):(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__.YX)(t)?function G(n,t,e,r,u){return t.xmin=x(n,e.xmin),t.ymin=h(n,e.ymin),t.xmax=x(n,e.xmax),t.ymax=h(n,e.ymax),t!==e&&(r&&(t.zmin=e.zmin,t.zmax=e.zmax),u&&(t.mmin=e.mmin,t.mmax=e.mmax)),t}(n,{},t,!1,!1):null:null}function q(t,e,r,u,i){return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.pC)(r)&&(e.points=function b(n,t,e,r){return M(n,e?r?c:m:r?m:a,t)}(t,r.points,u,i)),e}function v(n,e,r,u,i){return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.Wi)(r)||(e.x=z(n,r.x),e.y=T(n,r.y),e!==r&&(u&&(e.z=r.z),i&&(e.m=r.m))),e}function B(t,e,r,u,i){return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.pC)(r)&&(e.rings=function V(n,t,e,r){return E(n,e?r?c:m:r?m:a,t)}(t,r.rings,u,i)),e}function C(t,e,r,u,i){return(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_1__.pC)(r)&&(e.paths=function F(n,t,e,r){return E(n,e?r?c:m:r?m:a,t)}(t,r.paths,u,i)),e}},"./node_modules/@arcgis/core/symbols/cim/CIMResourceManager.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>o});var request=__webpack_require__("./node_modules/@arcgis/core/request.js"),core_Error=__webpack_require__("./node_modules/@arcgis/core/core/Error.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),index2=__webpack_require__("./node_modules/@arcgis/core/chunks/index2.js"),time=__webpack_require__("./node_modules/@arcgis/core/core/time.js");const n=[137,80,78,71,13,10,26,10];function i(t){const e=new Uint8Array(t);return!n.some(((t,o)=>t!==e[o]))}function a(t){if(!i(t))return!1;const e=new DataView(t),o=new Uint8Array(t);let r,n=8;do{const t=e.getUint32(n);if(r=String.fromCharCode.apply(String,Array.prototype.slice.call(o.subarray(n+4,n+8))),"acTL"===r)return!0;n+=12+t}while("IEND"!==r&&n<o.length);return!1}var imageutils=__webpack_require__("./node_modules/@arcgis/core/geometry/support/meshUtils/exporters/gltf/imageutils.js"),index3=__webpack_require__("./node_modules/@arcgis/core/chunks/index3.js");const gif_a=[71,73,70];function gif_o(t){if(!function r(t){const e=new Uint8Array(t);return!gif_a.some(((t,i)=>t!==e[i]))}(t))return!1;const e=new DataView(t),i=e.getUint8(10);let s=13+(128&i?3*2**(1+(7&i)):0),n=0,a=!1;for(;!a;){switch(e.getUint8(s++)){case 33:if(!o())return!1;break;case 44:c();break;case 59:a=!0;break;default:return!1}if(n>1)return!0}function o(){switch(e.getUint8(s++)){case 249:!function d(){s++,s+=4,h()}();break;case 1:!function m(){n++,s++,s+=12,h()}();break;case 254:!function u(){h()}();break;case 255:!function f(){s++,s+=8,s+=3,h()}();break;default:return!1}return!0}function c(){n++,s+=8;const t=e.getUint8(s++);s+=128&t?3*2**(1+(7&t)):0,s++,h()}function h(){let t;for(;t=e.getUint8(s++);)s+=t}return!1}class o{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,t){const r=this._resourceMap.get(e);if(r)return{width:r.width,height:r.height};let i=this._inFlightResourceMap.get(e);return i?i.then((e=>({width:e.width,height:e.height}))):(i=async function c(e,t){const{arrayBuffer:r,mediaType:o}=await async function u(i,s){let n;const a=";base64,";if(i.includes(a)){const e=i.indexOf(a),t=i.indexOf(a)+a.length,r=i.substring(t),s=atob(r),o=new Uint8Array(s.length);for(let i=0;i<s.length;i++)o[i]=s.charCodeAt(i);n={arrayBuffer:o.buffer,mediaType:i.substring(0,e).replace("data:","")}}else try{const t=await(0,request.default)(i,{responseType:"array-buffer",...s});n={arrayBuffer:t.data,mediaType:t.getHeader("Content-Type")}}catch(o){if(!(0,promiseUtils.D_)(o))throw new core_Error.Z("mapview-invalid-resource",`Could not fetch requested resource at ${i}`)}return n}(e,t),c="image/png"===o;return"image/gif"===o&&gif_o(r)?async function gif_n(n,a){const r=(0,index3.p)(n),o=(0,index3.d)(r,!0),{width:c,height:d}=r.lsd,m=document.createElement("canvas");m.width=c,m.height=d;const u=m.getContext("2d",{willReadFrequently:!0}),f=[],h=[];for(const i of o){h.push((0,time.HA)(i.delay||100));const s=new ImageData(i.patch,i.dims.width,i.dims.height),n=(0,imageutils.E0)(s),a=3===i.disposalType?u.getImageData(i.dims.left,i.dims.top,i.dims.width,i.dims.height):void 0;u.drawImage(n,i.dims.left,i.dims.top);const r=u.getImageData(0,0,c,d);f.push(r),1===i.disposalType||(2===i.disposalType?u.clearRect(i.dims.left,i.dims.top,i.dims.width,i.dims.height):3===i.disposalType&&u.putImageData(a,i.dims.left,i.dims.top))}return{frameDurations:h,getFrame:t=>f[t],width:c,height:d}}(r):c&&a(r)?async function apng_r(r,n){const i=(0,index2.p)(r);if(i instanceof Error)throw i;await i.createImages(),(0,promiseUtils.k_)(n);const{frames:a,width:s,height:p}=i,c=document.createElement("canvas");c.width=s,c.height=p;const l=c.getContext("2d",{willReadFrequently:!0}),m=[],h=[];for(const t of a){h.push((0,time.HA)(t.delay||100));const e=t.imageElement;0===t.blendOp?l.globalCompositeOperation="copy":l.globalCompositeOperation="source-over";const r=2===t.disposeOp?l.getImageData(t.left,t.top,t.width,t.height):void 0;l.drawImage(e,t.left,t.top);const n=l.getImageData(0,0,s,p);m.push(n),0===t.disposeOp||(1===t.disposeOp?l.clearRect(t.left,t.top,t.width,t.height):2===t.disposeOp&&l.putImageData(r,t.left,t.top))}return{frameDurations:h,getFrame:t=>m[t],width:s,height:p}}(r,t):async function h(i,s){const n=window.URL.createObjectURL(i);try{const{data:t}=await(0,request.default)(n,{...s,responseType:"image"});return t}catch(a){if(!(0,promiseUtils.D_)(a))throw new core_Error.Z("mapview-invalid-resource",`Could not fetch requested resource at ${n}`);throw a}finally{window.URL.revokeObjectURL(n)}}(new Blob([r],{type:o}),t)}(e,t),this._inFlightResourceMap.set(e,i),i.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}}},"./node_modules/@arcgis/core/symbols/support/previewCIMSymbol.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{previewCIMSymbol:()=>d});var CIMSymbolRasterizer_M,e,screenUtils=__webpack_require__("./node_modules/@arcgis/core/core/screenUtils.js"),CIMSymbolHelper=__webpack_require__("./node_modules/@arcgis/core/symbols/cim/CIMSymbolHelper.js"),Color=__webpack_require__("./node_modules/@arcgis/core/Color.js"),request=__webpack_require__("./node_modules/@arcgis/core/request.js"),maybe=__webpack_require__("./node_modules/@arcgis/core/core/maybe.js"),promiseUtils=__webpack_require__("./node_modules/@arcgis/core/core/promiseUtils.js"),cimAnalyzer=__webpack_require__("./node_modules/@arcgis/core/symbols/cim/cimAnalyzer.js"),CIMResourceManager=__webpack_require__("./node_modules/@arcgis/core/symbols/cim/CIMResourceManager.js"),CIMSymbolDrawHelper=__webpack_require__("./node_modules/@arcgis/core/symbols/cim/CIMSymbolDrawHelper.js"),Rasterizer=__webpack_require__("./node_modules/@arcgis/core/symbols/cim/Rasterizer.js"),TextRasterizer=__webpack_require__("./node_modules/@arcgis/core/symbols/cim/TextRasterizer.js"),utils=__webpack_require__("./node_modules/@arcgis/core/symbols/cim/utils.js"),cimSymbolUtils=__webpack_require__("./node_modules/@arcgis/core/symbols/support/cimSymbolUtils.js"),Symbol3DAnchorPosition2D=__webpack_require__("./node_modules/@arcgis/core/symbols/support/Symbol3DAnchorPosition2D.js");(e=CIMSymbolRasterizer_M||(CIMSymbolRasterizer_M={})).Legend="legend",e.Preview="preview";const _=e=>e&&e.scaleFactor?e.scaleFactor:1;var previewUtils=__webpack_require__("./node_modules/@arcgis/core/symbols/support/previewUtils.js"),renderUtils=__webpack_require__("./node_modules/@arcgis/core/symbols/support/renderUtils.js");const h=new class z{constructor(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._imageDataCanvas=null,this._pictureMarkerCache=new Map,this._textRasterizer=new TextRasterizer.Z,this._cimResourceManager=new CIMResourceManager.Z,this._rasterizer=new Rasterizer.Z(this._cimResourceManager)}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,a,i,r,s,o,n){if(!e)return null;const{data:g}=e;if(!g||"CIMSymbolReference"!==g.type||!g.symbol)return null;const{symbol:u}=g;s||(s=(0,utils.JW)(u));const d=await CIMSymbolHelper.E0.resolveSymbolOverrides(g,t,this._spatialReference,r,s,o,n);this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const p=this._imageDataCanvas,y=this._cimResourceManager,w=[];CIMSymbolHelper.B$.fetchResources(d,y,w),w.length>0&&await Promise.all(w);const{width:C,height:M}=a,_=function I(e,t,a,i){const r=1,s=-t/2+r,o=t/2-r,n=a/2-r,c=-a/2+r;switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[s,0],[0,0],[o,0]]]};default:return"legend"===i?{rings:[[[s,n],[o,0],[o,c],[s,c],[s,n]]]}:{rings:[[[s,n],[o,n],[o,c],[s,c],[s,n]]]}}}(s,C,M,i),z=CIMSymbolHelper.B$.getEnvelope(d,_,y);if(!z)return null;const x=1.3333333333333333*(window.devicePixelRatio||1);let R=1,b=0,P=0;switch(u.type){case"CIMPointSymbol":case"CIMTextSymbol":{let e=1;z.width>C&&(e=C/z.width);let t=1;z.height>M&&(t=M/z.height),"preview"===i&&(z.width<C&&(e=C/z.width),z.height<M&&(t=M/z.height)),R=Math.min(e,t),b=z.x+z.width/2,P=z.y+z.height/2}break;case"CIMLineSymbol":{let e=1;z.height>M&&(e=M/z.height),R=e,P=z.y+z.height/2;const t=z.x*R+C/2,a=(z.x+z.width)*R+C/2;if(t<0){const{paths:e}=_;e[0][0][0]-=t}if(a>C){const{paths:e}=_;e[0][2][0]-=a-C}}break;case"CIMPolygonSymbol":{b=z.x+z.width/2,P=z.y+z.height/2;const e=z.x*R+C/2,t=(z.x+z.width)*R+C/2,a=z.y*R+M/2,i=(z.y+z.height)*R+M/2,{rings:r}=_;e<0&&(r[0][0][0]-=e,r[0][3][0]-=e,r[0][4][0]-=e),a<0&&(r[0][0][1]+=a,r[0][1][1]+=a,r[0][4][1]+=a),t>C&&(r[0][1][0]-=t-C,r[0][2][0]-=t-C),i>M&&(r[0][2][1]+=i-M,r[0][3][1]+=i-M)}}p.width=C*x,p.height=M*x;p.width+=2,p.height+=2;const S=p.getContext("2d"),k=CIMSymbolDrawHelper.zA.createIdentity();return k.translate(-b,-P),k.scale(R*x,-R*x),k.translate(C*x/2+1,M*x/2+1),S.clearRect(0,0,p.width,p.height),new CIMSymbolDrawHelper.cD(S,y,k,!0).drawSymbol(d,_),S.getImageData(0,0,p.width,p.height)}async analyzeCIMSymbol(e,t,a,r,o){const n=[],c=t?{geometryType:r,spatialReference:this._spatialReference,fields:t}:null;let h;await(0,cimAnalyzer.c)(e.data,c,this._cimResourceManager,n,this._avoidSDF),(0,promiseUtils.k_)(o);for(const i of n)"CIMPictureMarker"!==i.cim.type&&"CIMPictureFill"!==i.cim.type&&"CIMPictureStroke"!==i.cim.type||(h||(h=[]),h.push(this._fetchPictureMarkerResource(i,o))),a&&"text"===i.type&&"string"==typeof i.text&&i.text.includes("[")&&(i.text=(0,utils.Qs)(a,i.text,i.cim.textCase));return h&&await Promise.all(h),n}rasterizeCIMSymbol3D(e,t,a,i,r,s){const o=[];for(const n of e){i&&"function"==typeof i.scaleFactor&&(i.scaleFactor=i.scaleFactor(t,r,s));const e=this._getRasterizedResource(n,t,a,i,r,s);if(!e)continue;let c=0,h=e.anchorX||0,l=e.anchorY||0,m=!1,g=0,u=0;if("esriGeometryPoint"===a){const e=_(i);if(g=(0,utils.hf)(n.offsetX,t,r,s)*e||0,u=(0,utils.hf)(n.offsetY,t,r,s)*e||0,"marker"===n.type)c=(0,utils.hf)(n.rotation,t,r,s)||0,m=!!n.rotateClockwise&&n.rotateClockwise;else if("text"===n.type){if(c=(0,utils.hf)(n.angle,t,r,s)||0,void 0!==n.horizontalAlignment)switch(n.horizontalAlignment){case"left":h=-.5;break;case"right":h=.5;break;default:h=0}if(void 0!==n.verticalAlignment)switch(n.verticalAlignment){case"top":l=.5;break;case"bottom":l=-.5;break;case"baseline":l=-.25;break;default:l=0}}}null!=e&&o.push({angle:c,rotateClockWise:m,anchorX:h,anchorY:l,offsetX:g,offsetY:u,rasterizedResource:e})}return this.getSymbolImage(o)}getSymbolImage(e){const t=document.createElement("canvas"),i=(0,maybe.s3)(t.getContext("2d"));let s=0,o=0,n=0,c=0;const h=[];for(let a=0;a<e.length;a++){const t=e[a],l=t.rasterizedResource;if(!l)continue;const m=l.size,g=t.offsetX,u=t.offsetY,f=t.anchorX,d=t.anchorY,p=t.rotateClockWise||!1;let y=t.angle,w=(0,screenUtils.F2)(g)-m[0]*(.5+f),C=(0,screenUtils.F2)(u)-m[1]*(.5+d),M=w+m[0],_=C+m[1];if(y){p&&(y=-y);const e=Math.sin(y*Math.PI/180),t=Math.cos(y*Math.PI/180),a=w*t-C*e,i=w*e+C*t,r=w*t-_*e,s=w*e+_*t,o=M*t-_*e,n=M*e+_*t,c=M*t-C*e,h=M*e+C*t;w=Math.min(a,r,o,c),C=Math.min(i,s,n,h),M=Math.max(a,r,o,c),_=Math.max(i,s,n,h)}s=w<s?w:s,o=C<o?C:o,n=M>n?M:n,c=_>c?_:c;const v=i.createImageData(l.size[0],l.size[1]);v.data.set(new Uint8ClampedArray(l.image.buffer));const z={offsetX:g,offsetY:u,rotateClockwise:p,angle:y,rasterizedImage:v,anchorX:f,anchorY:d};h.push(z)}t.width=n-s,t.height=c-o;const l=-s,m=c;for(let a=0;a<h.length;a++){const e=h[a],t=this._imageDataToCanvas(e.rasterizedImage),s=e.rasterizedImage.width,o=e.rasterizedImage.height,n=l-s*(.5+e.anchorX),c=m-o*(.5-e.anchorY);if(e.angle){const a=(360-e.angle)*Math.PI/180;i.save(),i.translate((0,screenUtils.F2)(e.offsetX),-(0,screenUtils.F2)(e.offsetY)),i.translate(l,m),i.rotate(a),i.translate(-l,-m),i.drawImage(t,n,c),i.restore()}else i.drawImage(t,n+(0,screenUtils.F2)(e.offsetX),c-(0,screenUtils.F2)(e.offsetY))}const g=new Symbol3DAnchorPosition2D.e({x:l/t.width-.5,y:m/t.height-.5});return{imageData:0!==t.width&&0!==t.height?i.getImageData(0,0,t.width,t.height):i.createImageData(1,1),anchorPosition:g}}async _fetchPictureMarkerResource(e,a){const i=e.materialHash;if(!this._pictureMarkerCache.get(i)){const r=(await(0,request.default)(e.cim.url,{responseType:"image",signal:a&&a.signal})).data;this._pictureMarkerCache.set(i,r)}}_imageDataToCanvas(e){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const t=this._imageDataCanvas,i=(0,maybe.s3)(t.getContext("2d"));return t.width=e.width,t.height=e.height,i.putImageData(e,0,0),t}_imageTo32Array(t,i,r,s){this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas"));const o=this._imageDataCanvas,n=(0,maybe.s3)(o.getContext("2d"));if(o.width=i,o.height=r,n.drawImage(t,0,0,i,r),s){n.save();const a=new Color.Z(s);n.fillStyle=a.toHex(),n.globalCompositeOperation="multiply",n.fillRect(0,0,i,r),n.globalCompositeOperation="destination-atop",n.drawImage(t,0,0,i,r),n.restore()}return new Uint32Array(n.getImageData(0,0,i,r).data.buffer)}_getRasterizedResource(e,t,i,r,s,o){let n,c,h;if("text"===e.type)return this._rasterizeTextResource(e,t,r,s,o);({analyzedCIM:n,hash:c}=function x(e,t,a,i){let r,s;"function"==typeof e.materialHash?(r=(0,e.materialHash)(t,a,i),s=(0,cimAnalyzer.S)(e.cim,e.materialOverrides)):(r=e.materialHash,s=e.cim);return{analyzedCIM:s,hash:r}}(e,t,s,o));const g=_(r);if("CIMPictureMarker"===e.cim.type){const i=(0,utils.hf)(e.size,t,s,o)*g,{image:r,width:n,height:c}=(0,maybe.s3)(this._getPictureResource(e,i,(0,utils.hf)(e.color,t,s,o)));return h={image:r,size:[n,c],sdf:!1,simplePattern:!1,anchorX:e.anchorPoint?e.anchorPoint.x:0,anchorY:e.anchorPoint?e.anchorPoint.y:0},h}(0,cimSymbolUtils.FW)(n,g,{preserveOutlineWidth:!1});const u=n;c+=i,r&&(c+=JSON.stringify(r));const f=this._resourceCache;return f.has(c)?f.get(c):(h=this._rasterizer.rasterizeJSONResource({cim:u,type:e.type,url:e.url,mosaicHash:c,size:null,path:null},window.devicePixelRatio||1,this._avoidSDF),f.set(c,h),h)}_rasterizeTextResource(e,t,a,i,r){const s=_(a),o=(0,utils.hf)(e.text,t,i,r);if(!o||0===o.length)return null;const n=(0,utils.hf)(e.fontName,t,i,r),c=(0,utils.hf)(e.style,t,i,r),h=(0,utils.hf)(e.weight,t,i,r),l=(0,utils.hf)(e.decoration,t,i,r),m=(0,utils.hf)(e.size,t,i,r)*s,g=(0,utils.hf)(e.horizontalAlignment,t,i,r),u=(0,utils.hf)(e.verticalAlignment,t,i,r),f=(0,utils.nn)((0,utils.hf)(e.color,t,i,r)),d=(0,utils.nn)((0,utils.hf)(e.outlineColor,t,i,r)),w={color:f,size:m,horizontalAlignment:g,verticalAlignment:u,font:{family:n,style:c,weight:h,decoration:l},halo:{size:(0,utils.hf)(e.outlineSize,t,i,r)||0,color:d,style:c},pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(o,w)}_getPictureResource(e,t,a){const i=this._pictureMarkerCache.get(e.materialHash);if(!i)return null;const s=i.height/i.width,o=t?s>1?(0,screenUtils.F2)(t):(0,screenUtils.F2)(t)/s:i.width,n=t?s>1?(0,screenUtils.F2)(t)*s:(0,screenUtils.F2)(t):i.height;return{image:this._imageTo32Array(i,o,n,a),width:o,height:n}}}(null,!0),m=(0,screenUtils.Wz)(previewUtils.b_.size),c=(0,screenUtils.Wz)(previewUtils.b_.maxSize),u=(0,screenUtils.Wz)(previewUtils.b_.lineWidth),f=1;async function d(e,l={}){const{node:s,opacity:d,symbolConfig:p}=l,g="object"==typeof p&&"isSquareFill"in p&&p.isSquareFill,w=l.cimOptions||l,b=w.geometryType||(0,utils.JW)(e?.data?.symbol),M=function y(e){const t=e?.size;return"number"==typeof t?{width:t,height:t}:{width:null!=t&&"object"==typeof t&&"width"in t?t.width:null,height:null!=t&&"object"==typeof t&&"height"in t?t.height:null}}(l),{feature:j,fieldMap:v}=w;if(null==M.width||null==M.height){const t=await CIMSymbolHelper.E0.resolveSymbolOverrides(e.data,j,null,v,b);if(!t)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:t},e.data.primitiveOverrides=void 0;const l=[];CIMSymbolHelper.B$.fetchResources(t,h.resourceManager,l),l.length>0&&await Promise.all(l);const n=CIMSymbolHelper.B$.getEnvelope(t,null,h.resourceManager),r=n?.width,s=n?.height;M.width="esriGeometryPolygon"===b?m:"esriGeometryPolyline"===b?u:null!=r&&isFinite(r)?Math.min(r,c):m,M.height="esriGeometryPolygon"===b?m:null!=s&&isFinite(s)?Math.max(Math.min(s,c),f):m}const S=await h.rasterizeCIMSymbolAsync(e,j,M,g||"esriGeometryPolygon"!==b?CIMSymbolRasterizer_M.Preview:CIMSymbolRasterizer_M.Legend,v,b);if(!S)return null;const{width:C,height:I}=S,P=document.createElement("canvas");P.width=C,P.height=I,P.getContext("2d").putImageData(S,0,0);const x=(0,screenUtils.F2)(M.width),z=(0,screenUtils.F2)(M.height),F=new Image(x,z);F.src=P.toDataURL(),null!=d&&(F.style.opacity=`${d}`);let G=F;if(null!=l.effectView){const e={shape:{type:"image",x:0,y:0,width:x,height:z,src:F.src},fill:null,stroke:null,offset:[0,0]};G=(0,renderUtils.wh)([[e]],[x,z],{effectView:l.effectView})}return s&&G&&s.appendChild(G),G}},"./node_modules/@arcgis/core/views/2d/engine/webgl/alignmentUtils.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{var e,t;function r(t){switch(t){case"left":return e.Left;case"right":return e.Right;case"center":return e.Center}}function n(e){switch(e){case"top":return t.Top;case"middle":return t.Center;case"baseline":return t.Baseline;case"bottom":return t.Bottom}}function a(r){switch(r){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[e.Right,t.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[e.Center,t.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[e.Left,t.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[e.Right,t.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[e.Center,t.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[e.Left,t.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[e.Right,t.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[e.Center,t.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[e.Left,t.Top];default:return console.debug(`Found invalid placement type ${r}`),[e.Center,t.Center]}}function c(t){switch(t){case e.Right:return-1;case e.Center:return 0;case e.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${t}`),0}}function o(e){switch(e){case t.Top:return 1;case t.Center:return 0;case t.Bottom:case t.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${e}`),0}}function s(t){switch(t){case"left":return e.Left;case"right":return e.Right;case"center":return e.Center}}function i(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}__webpack_require__.d(__webpack_exports__,{Hd:()=>s,M7:()=>e,NS:()=>i,TR:()=>t,b7:()=>n,g:()=>c,kH:()=>r,qv:()=>a,tf:()=>o}),function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right"}(e||(e={})),function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline"}(t||(t={}))},"./node_modules/@arcgis/core/views/2d/engine/webgl/number.js":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Au:()=>M,Jz:()=>x,UJ:()=>w});const n=new Float32Array(1);new Uint32Array(n.buffer);function M(n){return[255&n,(65280&n)>>>8,(16711680&n)>>>16,(4278190080&n)>>>24]}function w(n,r){return 65535&n|r<<16}function x(n,r,t,u){return 255&n|(255&r)<<8|(255&t)<<16|u<<24}}}]);