"use strict";(self.webpackChunkaxux=self.webpackChunkaxux||[]).push([[12134],{"./node_modules/@arcgis/core/smartMapping/support/utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{fs:()=>Z,i0:()=>N});var _intl_date_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/intl/date.js"),_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldUtils.js"),_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__("./node_modules/@arcgis/core/support/arcadeOnDemand.js"),__webpack_require__("./node_modules/@arcgis/core/support/basemapUtils.js"),__webpack_require__("./node_modules/@arcgis/core/time/timeZoneUtils.js"));new Set(["integer","small-integer"]);function Z(t){return(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__.vE)(t)||(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__.zD)(t)||(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_1__.Ah)(t)}function N(s,o){const{format:a,timeZoneOptions:c,fieldType:l}=o??{};let d,u;if(c&&({timeZone:d,timeZoneName:u}=(0,_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_4__.hv)(c.layerTimeZone,c.datesInUnknownTimezone,c.viewTimeZone,(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.J2)(a||"short-date-short-time"),l)),"string"==typeof s&&isNaN(Date.parse("time-only"===l?`1970-01-01T${s}Z`:s)))return s;switch(l){case"date-only":{const r=(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.J2)(a||"short-date");return"string"==typeof s?(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.iS)(s,{...r}):(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.Yq)(s,{...r,timeZone:_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_4__.n$})}case"time-only":{const r=(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.J2)(a||"short-time");return"string"==typeof s?(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.F8)(s,r):(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.Yq)(s,{...r,timeZone:_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_4__.n$})}case"timestamp-offset":{if(!d&&"string"==typeof s&&new Date(s).toISOString()!==s)return s;const i=a||c?(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.J2)(a||"short-date-short-time"):void 0,n=i?{...i,timeZone:d,timeZoneName:u}:void 0;return"string"==typeof s?(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.Ey)(s,n):(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.Yq)(s,n)}default:{const r=a||c?(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.J2)(a||"short-date-short-time"):void 0;return(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_0__.Yq)("string"==typeof s?new Date(s):s,r?{...r,timeZone:d,timeZoneName:u}:void 0)}}}},"./node_modules/@arcgis/core/views/draw/support/GraphicMover.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>U});var tslib_es6=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),Evented=(__webpack_require__("./node_modules/@arcgis/core/symbols.js"),__webpack_require__("./node_modules/@arcgis/core/core/Evented.js")),lang=__webpack_require__("./node_modules/@arcgis/core/core/lang.js"),reactiveUtils=__webpack_require__("./node_modules/@arcgis/core/core/reactiveUtils.js"),property=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),subclass=(__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),GraphicsLayer=__webpack_require__("./node_modules/@arcgis/core/layers/GraphicsLayer.js"),drawUtils=__webpack_require__("./node_modules/@arcgis/core/views/draw/support/drawUtils.js"),HighlightHelper=__webpack_require__("./node_modules/@arcgis/core/views/draw/support/HighlightHelper.js"),layerUtils=__webpack_require__("./node_modules/@arcgis/core/views/draw/support/layerUtils.js");class GraphicMoverEvents_t{constructor(t,i,s,h,e){this.graphic=t,this.index=i,this.x=s,this.y=h,this.viewEvent=e,this.type="graphic-click"}}class GraphicMoverEvents_i{constructor(t,i,s,h,e){this.graphic=t,this.index=i,this.x=s,this.y=h,this.viewEvent=e,this.type="graphic-double-click"}}class GraphicMoverEvents_s{constructor(t,i,s,h,e,r,c,a,n,p){this.graphic=t,this.allGraphics=i,this.index=s,this.x=h,this.y=e,this.dx=r,this.dy=c,this.totalDx=a,this.totalDy=n,this.viewEvent=p,this.defaultPrevented=!1,this.type="graphic-move-start"}preventDefault(){this.defaultPrevented=!0}}class GraphicMoverEvents_h{constructor(t,i,s,h,e,r,c,a,n,p){this.graphic=t,this.allGraphics=i,this.index=s,this.x=h,this.y=e,this.dx=r,this.dy=c,this.totalDx=a,this.totalDy=n,this.viewEvent=p,this.defaultPrevented=!1,this.type="graphic-move"}preventDefault(){this.defaultPrevented=!0}}class e{constructor(t,i,s,h,e,r,c,a,n,p){this.graphic=t,this.allGraphics=i,this.index=s,this.x=h,this.y=e,this.dx=r,this.dy=c,this.totalDx=a,this.totalDy=n,this.viewEvent=p,this.defaultPrevented=!1,this.type="graphic-move-stop"}preventDefault(){this.defaultPrevented=!0}}class GraphicMoverEvents_r{constructor(t,i,s,h,e){this.graphic=t,this.index=i,this.x=s,this.y=h,this.viewEvent=e,this.type="graphic-pointer-over"}}class c{constructor(t,i,s,h,e){this.graphic=t,this.index=i,this.x=s,this.y=h,this.viewEvent=e,this.type="graphic-pointer-out"}}class a{constructor(t,i,s,h,e){this.graphic=t,this.index=i,this.x=s,this.y=h,this.viewEvent=e,this.type="graphic-pointer-down"}}class n{constructor(t,i,s,h,e){this.graphic=t,this.index=i,this.x=s,this.y=h,this.viewEvent=e,this.type="graphic-pointer-up"}}var InputManager=__webpack_require__("./node_modules/@arcgis/core/views/input/InputManager.js"),GraphicManipulator=__webpack_require__("./node_modules/@arcgis/core/views/interactive/GraphicManipulator.js"),screenUtils=__webpack_require__("./node_modules/@arcgis/core/views/support/screenUtils.js"),SimpleMarkerSymbol=__webpack_require__("./node_modules/@arcgis/core/symbols/SimpleMarkerSymbol.js"),SimpleLineSymbol=__webpack_require__("./node_modules/@arcgis/core/symbols/SimpleLineSymbol.js"),SimpleFillSymbol=__webpack_require__("./node_modules/@arcgis/core/symbols/SimpleFillSymbol.js");const M="indicator-symbols";let E=class extends Evented.A.EventedAccessor{constructor(i){super(i),this._activeGraphic=null,this._dragEvent=null,this._hoverGraphic=null,this._indicators=[],this._initialDragGeometry=null,this._manipulators=[],this._layerViews=null,this.type="graphic-mover",this.callbacks={onGraphicClick(){},onGraphicDoubleClick(){},onGraphicMoveStart(){},onGraphicMove(){},onGraphicMoveStop(){},onGraphicPointerOver(){},onGraphicPointerOut(){},onGraphicPointerDown(){},onGraphicPointerUp(){}},this.enableMoveAllGraphics=!1,this.graphics=[],this.indicatorsEnabled=!1,this.layer=new GraphicsLayer.A({listMode:"hide",internal:!0,title:"GraphicMover highlight layer"}),this.view=null}initialize(){(0,layerUtils.Y)(this.view,this.layer),this._highlightHelper=new HighlightHelper.A({view:this.view}),this.refresh(),this.addHandles([(0,reactiveUtils.wB)((()=>this.graphics.length),(()=>this.refresh())),(0,reactiveUtils.z7)((()=>this.view?.ready),(()=>{this.addHandles([this.view.on("immediate-click",(i=>this._clickHandler(i)),InputManager.o.TOOL),this.view.on("double-click",(i=>this._doubleClickHandler(i)),InputManager.o.TOOL),this.view.on("pointer-down",(i=>this._pointerDownHandler(i)),InputManager.o.TOOL),this.view.on("pointer-move",(i=>this._pointerMoveHandler(i)),InputManager.o.TOOL),this.view.on("pointer-up",(i=>this._pointerUpHandler(i)),InputManager.o.TOOL),this.view.on("drag",(i=>this._dragHandler(i)),InputManager.o.TOOL),this.view.on("key-down",(i=>this._keyDownHandler(i)),InputManager.o.TOOL)])}),{once:!0,initial:!0}),(0,reactiveUtils.wB)((()=>this.view),(i=>{this._highlightHelper.removeAll(),this._highlightHelper.view=i}))])}destroy(){this._removeIndicators(),this.view.map?.remove(this.layer),this.layer.destroy(),this.reset(),this._manipulators.forEach((i=>i.destroy())),this._manipulators=null}set highlightsEnabled(i){this._highlightHelper?.removeAll(),this._set("highlightsEnabled",i),i&&this._highlightHelper?.add(this.graphics)}get state(){const i=this.view.ready,t=this.graphics.length>0,e=this._activeGraphic;return i&&t?e?"moving":"active":i?"ready":"disabled"}refresh(){this.reset(),this._setup()}reset(){this._activeGraphic=null,this._hoverGraphic=null,this._dragEvent=null,this._highlightHelper.removeAll()}updateGeometry(i,t){const e=this.graphics[i];e&&(e.set("geometry",t),this._setUpIndicators())}_setup(){this._setUpHighlights(),this._setUpIndicators(),this._setUpManipulators(),this._syncLayerViews()}_clickHandler(i){const t=this._findTargetGraphic((0,screenUtils.ZV)(i));if(t){const e=new GraphicMoverEvents_t(t,this.graphics.indexOf(t),i.x,i.y,i);this.emit("graphic-click",e),this.callbacks.onGraphicClick&&this.callbacks.onGraphicClick(e)}}_doubleClickHandler(i){const t=this._findTargetGraphic((0,screenUtils.ZV)(i));if(t){const e=new GraphicMoverEvents_i(t,this.graphics.indexOf(t),i.x,i.y,i);this.emit("graphic-double-click",e),this.callbacks.onGraphicDoubleClick&&this.callbacks.onGraphicDoubleClick(e)}}_pointerDownHandler(i){const t=this._findTargetGraphic((0,screenUtils.ZV)(i));if(t){this._activeGraphic=t;const{x:e,y:s}=i,r=new a(t,this.graphics.indexOf(t),e,s,i);this.emit("graphic-pointer-down",r),this.callbacks.onGraphicPointerDown&&this.callbacks.onGraphicPointerDown(r)}else this._activeGraphic=null}_pointerUpHandler(i){if(this._activeGraphic){const{x:t,y:e}=i,s=this.graphics.indexOf(this._activeGraphic),r=new n(this._activeGraphic,s,t,e,i);this.emit("graphic-pointer-up",r),this.callbacks.onGraphicPointerUp&&this.callbacks.onGraphicPointerUp(r)}}_pointerMoveHandler(i){if(this._dragEvent)return;const t=this._findTargetGraphic((0,screenUtils.ZV)(i));if(t){const{x:e,y:s}=i;if(this._hoverGraphic){if(this._hoverGraphic===t)return;const r=this.graphics.indexOf(this._hoverGraphic),o=new c(this.graphics[r],r,e,s,i);this._hoverGraphic=null,this.emit("graphic-pointer-out",o),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(o)}const r=this.graphics.indexOf(t),o=new GraphicMoverEvents_r(t,r,e,s,i);return this._hoverGraphic=t,this.emit("graphic-pointer-over",o),void(this.callbacks.onGraphicPointerOver&&this.callbacks.onGraphicPointerOver(o))}if(this._hoverGraphic){const{x:t,y:e}=i,s=this.graphics.indexOf(this._hoverGraphic),r=new c(this.graphics[s],s,t,e,i);this._hoverGraphic=null,this.emit("graphic-pointer-out",r),this.callbacks.onGraphicPointerOut&&this.callbacks.onGraphicPointerOut(r)}}_dragHandler(i){if("start"!==i.action&&!this._dragEvent||!this._activeGraphic?.geometry)return;"start"===i.action&&this._removeIndicators(),i.stopPropagation();const{action:t,x:s,y:r}=i,o=this.graphics.indexOf(this._activeGraphic),h=this._dragEvent?s-this._dragEvent.x:0,a=this._dragEvent?r-this._dragEvent.y:0,n=s-i.origin.x,l=r-i.origin.y,p="start"===t?this._activeGraphic.geometry:this._initialDragGeometry,d=(0,drawUtils.lR)(p,n,l,this.view);if(this._activeGraphic.geometry=d,this.enableMoveAllGraphics&&this.graphics.forEach((i=>{i!==this._activeGraphic&&(i.geometry=(0,drawUtils.lR)(i.geometry,h,a,this.view))})),this._dragEvent=i,"start"===t){this._initialDragGeometry=(0,lang.o8)(p);const t=new GraphicMoverEvents_s(this._activeGraphic,this.graphics,o,s,r,h,a,n,l,i);this.emit("graphic-move-start",t),this.callbacks.onGraphicMoveStart&&this.callbacks.onGraphicMoveStart(t),t.defaultPrevented&&this._activeGraphic.set("geometry",p)}else if("update"===t){const t=new GraphicMoverEvents_h(this._activeGraphic,this.graphics,o,s,r,h,a,n,l,i);this.emit("graphic-move",t),this.callbacks.onGraphicMove&&this.callbacks.onGraphicMove(t),t.defaultPrevented&&(this._activeGraphic.geometry=p)}else{const t=new e(this._activeGraphic,this.graphics,o,s,r,h,a,n,l,i);this._dragEvent=null,this._activeGraphic=null,this._setUpIndicators(),this.emit("graphic-move-stop",t),this.callbacks.onGraphicMoveStop&&this.callbacks.onGraphicMoveStop(t),t.defaultPrevented&&(this.graphics[o].set("geometry",this._initialDragGeometry),this._setUpIndicators()),this._initialDragGeometry=null}}_keyDownHandler(i){"a"!==i.key&&"d"!==i.key&&"n"!==i.key||"moving"!==this.state||i.stopPropagation()}_findTargetGraphic(i){const t=this.view.toMap(i),e=this.graphics;let s=null,r=Number.MAX_VALUE;this._syncLayerViews();const o=this._layerViews.flatMap((i=>"graphicsViews"in i?Array.from(i.graphicsViews(),(i=>i.hitTest(t))).flat():i.graphicsView.hitTest(t))).filter((i=>e.includes(i))).sort(((i,t)=>e.indexOf(i)-e.indexOf(t)));return o.length?o[0]:(this._manipulators.forEach((t=>{const e=t.intersectionDistance(i);null!=e&&e<r&&(r=e,s=t.graphic)})),s)}_syncLayerViews(){this._layerViews=[];const i=new Set;for(const t of this.graphics){const e=(0,layerUtils.i)(this.view,t.layer);e&&i.add(e)}this._layerViews=[...i]}_setUpManipulators(){const{graphics:i,view:t}=this;this._manipulators.forEach((i=>i.destroy())),this._manipulators=i.length?i.map((i=>new GraphicManipulator.l({graphic:i,view:t}))):[]}_setUpHighlights(){this.highlightsEnabled&&this._highlightHelper.add(this.graphics)}_setUpIndicators(){if(this._removeIndicators(),this.indicatorsEnabled){for(const i of this.graphics){const t=i.clone();t.symbol=this._getSymbolForIndicator(i),this._indicators.push(t),this.addHandles((0,reactiveUtils.wB)((()=>i.symbol),(()=>this._setUpIndicators())),M)}this.layer.addMany(this._indicators)}}_removeIndicators(){this.removeHandles(M),this._indicators.length&&(this.layer.removeMany(this._indicators),this._indicators.forEach((i=>i.destroy())),this._indicators=[])}_getSymbolForIndicator(i){if(null==i.symbol)return null;switch(i.symbol.type){case"cim":return new SimpleMarkerSymbol.A({style:"circle",size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}});case"picture-marker":{const{xoffset:t,yoffset:e,height:s,width:r}=i.symbol,o=s===r?r:Math.max(s,r);return new SimpleMarkerSymbol.A({xoffset:t,yoffset:e,size:o,style:"square",color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case"simple-marker":{const{xoffset:t,yoffset:e,size:s,style:r}=i.symbol;return new SimpleMarkerSymbol.A({xoffset:t,yoffset:e,style:"circle"===r?"circle":"square",size:s+2,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}case"simple-fill":return new SimpleFillSymbol.A({color:[0,0,0,0],outline:{style:"dash",color:[255,127,0,1],width:1}});case"simple-line":return new SimpleLineSymbol.A({color:[255,127,0,1],style:"dash",width:1});case"text":{const{xoffset:e,yoffset:s}=i.symbol;return new SimpleMarkerSymbol.A({xoffset:e,yoffset:s,size:12,color:[0,0,0,0],outline:{color:[255,127,0,1],width:1}})}default:return null}}};(0,tslib_es6._)([(0,property.MZ)()],E.prototype,"_activeGraphic",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],E.prototype,"type",void 0),(0,tslib_es6._)([(0,property.MZ)()],E.prototype,"callbacks",void 0),(0,tslib_es6._)([(0,property.MZ)()],E.prototype,"enableMoveAllGraphics",void 0),(0,tslib_es6._)([(0,property.MZ)()],E.prototype,"graphics",void 0),(0,tslib_es6._)([(0,property.MZ)({value:!1})],E.prototype,"highlightsEnabled",null),(0,tslib_es6._)([(0,property.MZ)()],E.prototype,"indicatorsEnabled",void 0),(0,tslib_es6._)([(0,property.MZ)()],E.prototype,"layer",void 0),(0,tslib_es6._)([(0,property.MZ)({readOnly:!0})],E.prototype,"state",null),(0,tslib_es6._)([(0,property.MZ)()],E.prototype,"view",void 0),E=(0,tslib_es6._)([(0,subclass.$)("esri.views.draw.support.GraphicMover")],E);const U=E},"./node_modules/@arcgis/core/views/draw/support/HighlightHelper.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>l});var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/chunks/tslib.es6.js"),_core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/Accessor.js"),_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js"),_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__=(__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/ensureType.js"),__webpack_require__("./node_modules/@arcgis/core/core/arrayUtils.js"),__webpack_require__("./node_modules/@arcgis/core/core/has.js"),__webpack_require__("./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js")),_layerUtils_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/views/draw/support/layerUtils.js"),_support_layerViewUtils_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@arcgis/core/views/support/layerViewUtils.js"),_widgets_Feature_support_featureUtils_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/widgets/Feature/support/featureUtils.js");let h=class extends _core_Accessor_js__WEBPACK_IMPORTED_MODULE_1__.A{constructor(r){super(r),this.view=null}add(r){const s=!r||Array.isArray(r)?r:[r];s?.length&&s.forEach((r=>this._highlight(r)))}remove(r){const s=!r||Array.isArray(r)?r:[r];s?.length&&s.forEach((r=>this._unhighlight(r)))}removeAll(){this.removeAllHandles()}_highlight(r){const s=(0,_layerUtils_js__WEBPACK_IMPORTED_MODULE_8__.i)(this.view,r.layer);(0,_support_layerViewUtils_js__WEBPACK_IMPORTED_MODULE_9__.Of)(s)&&this.addHandles(s.highlight(r),(0,_widgets_Feature_support_featureUtils_js__WEBPACK_IMPORTED_MODULE_7__.Fr)(r))}_unhighlight(r){r&&this.removeHandles((0,_widgets_Feature_support_featureUtils_js__WEBPACK_IMPORTED_MODULE_7__.Fr)(r))}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__.MZ)()],h.prototype,"view",void 0),h=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__.$)("esri.views.draw.support.HighlightHelper")],h);const l=h},"./node_modules/@arcgis/core/views/support/layerViewUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function n(n){return n&&"function"==typeof n.highlight}function t(n,e,t){return null==n||n>t&&(0===e||n<e)}__webpack_require__.d(__webpack_exports__,{JU:()=>t,Of:()=>n})},"./node_modules/@arcgis/core/widgets/Feature/support/featureUtils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A4:()=>v,AB:()=>x,Ao:()=>he,DU:()=>se,Fr:()=>Fe,J9:()=>re,JF:()=>E,MK:()=>P,Tt:()=>M,Uu:()=>ae,a$:()=>ne,bG:()=>oe,bV:()=>q,c3:()=>ce,cS:()=>Te,gd:()=>z,kX:()=>C,ld:()=>ie,lm:()=>Y,q6:()=>be,s$:()=>de,sS:()=>J,u2:()=>D,x1:()=>ue,xL:()=>R});var _core_Logger_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@arcgis/core/core/Logger.js"),_core_string_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@arcgis/core/core/string.js"),_intl_date_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@arcgis/core/intl/date.js"),_intl_number_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@arcgis/core/intl/number.js"),_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@arcgis/core/layers/support/fieldUtils.js"),_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@arcgis/core/layers/support/layerUtils.js"),_smartMapping_support_utils_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@arcgis/core/smartMapping/support/utils.js"),_support_arcadeOnDemand_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@arcgis/core/support/arcadeOnDemand.js"),_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@arcgis/core/time/timeZoneUtils.js");const y=_core_Logger_js__WEBPACK_IMPORTED_MODULE_0__.A.getLogger("esri.widgets.Feature.support.featureUtils"),g=/href=(""|'')/gi,I=/(\{([^\{\r\n]+)\})/g,h=/\'/g,b=/^\s*expression\//i,T=/(\n)/gi,w=/[\u00A0-\u9999<>\&]/gim,F=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,N=/^(?:mailto:|tel:)/,j="relationships/",Z=(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_2__.J2)("short-date-short-time");function E(e){if(null!=e)return(e.sourceLayer||e.layer)??void 0}async function x(e,t){return"function"==typeof e?e(t):e}function C(e=""){if(e)return!N.test(e.trim().toLowerCase())}function M(e){return!!e&&b.test(e)}function q(e,t){const n=function U(e,t){if(!M(t)||!e)return null;const n=t.replace(b,"").toLowerCase();let r=null;return e.some((e=>e.name.toLowerCase()===n&&(r=e,!0))),r}(t,e?.fieldName);return n?n.title||null:e?e.label||e.fieldName:null}function v(e,t){const n=$(t,e);return n?n.name:e}function R(e,t){return e&&e.map((e=>v(e,t)))}function $(e,t){return e&&"function"==typeof e.getField&&t?e.getField(t)??null:null}function k(e){return`${e}`.trim()}function D({attributes:e,globalAttributes:t,layer:n,text:r,expressionAttributes:i,fieldInfoMap:o}){return r?z({formattedAttributes:t,template:Q(r,{...t,...i,...e},n),fieldInfoMap:o}):""}function z({formattedAttributes:e,template:n,fieldInfoMap:r}){return k(function L(e){return e.replaceAll(g,"")}((0,_core_string_js__WEBPACK_IMPORTED_MODULE_1__.HC)((0,_core_string_js__WEBPACK_IMPORTED_MODULE_1__.HC)(n,(e=>function A(e,t){const n=t.get(e.toLowerCase());return`{${n?.fieldName||e}}`}(e,r))),e)))}function G(e,t=!1){const n={...e};return Object.keys(n).forEach((e=>function O(e,t,n=!1){const r=t[e];if("string"==typeof r){const i="%27",o=(n?encodeURIComponent(r):r).replaceAll(h,i);t[e]=o}}(e,n,t))),n}function P(e,t){return e.replaceAll(I,((e,n,r)=>{const i=$(t,r);return i?`{${i.name}}`:n}))}function Q(e,t,n){const r=P(e,n);return r?r.replaceAll(F,((e,n,r)=>function S(e,n,r){const i=(n=k(n))&&"{"!==n[0];return(0,_core_string_js__WEBPACK_IMPORTED_MODULE_1__.HC)(e,G(r,i||!1))}(e,n||r,t))):r}function J(e){return function H(e){return null!=e&&"object"==typeof e&&"fieldsIndex"in e&&"geometryType"in e&&"getField"in e&&"load"in e&&"loaded"in e&&"objectIdField"in e&&"spatialReference"in e&&"type"in e&&("feature"===e.type||"scene"===e.type)&&"when"in e}(e)&&function B(e){return null!=e&&"object"==typeof e&&"createQuery"in e&&"queryFeatureCount"in e&&"queryObjectIds"in e&&"queryRelatedFeatures"in e&&"queryRelatedFeaturesCount"in e&&"relationships"in e}(e)}function V(e,t){const{fieldInfos:n,fieldName:r,preventPlacesFormatting:l,layer:u,timeZone:s}=t,c=Y(n,r),d=$(u,r);if(c&&!(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.JL)(r)){const t=d?.type,n=c.format?.dateFormat;if("date"===t||"date-only"===t||"time-only"===t||"timestamp-offset"===t||n)return(0,_smartMapping_support_utils_js__WEBPACK_IMPORTED_MODULE_6__.i0)(e,{format:n,fieldType:t,timeZoneOptions:{layerTimeZone:u&&"preferredTimeZone"in u?u.preferredTimeZone:null,viewTimeZone:s,datesInUnknownTimezone:!(!u||!("datesInUnknownTimezone"in u)||!u.datesInUnknownTimezone)}})}const p=c?.format;return"string"==typeof e&&(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.JL)(r)&&p?function W(e,t){return e=e.trim(),/\d{2}-\d{2}/.test(e)?e:e.includes(",")?X(e,",",", ",t):e.includes(";")?X(e,";","; ",t):e.includes(" ")?X(e," "," ",t):(0,_intl_number_js__WEBPACK_IMPORTED_MODULE_3__.ZV)(Number(e),(0,_intl_number_js__WEBPACK_IMPORTED_MODULE_3__.yx)(t))}(e,p):"string"==typeof(e=function _(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}(e,p))||null==e||null==p?ae(e):(0,_intl_number_js__WEBPACK_IMPORTED_MODULE_3__.ZV)(e,l?{...(0,_intl_number_js__WEBPACK_IMPORTED_MODULE_3__.yx)(p),minimumFractionDigits:0,maximumFractionDigits:20}:(0,_intl_number_js__WEBPACK_IMPORTED_MODULE_3__.yx)(p))}function X(e,t,n,r){return e.trim().split(t).map((e=>(0,_intl_number_js__WEBPACK_IMPORTED_MODULE_3__.ZV)(Number(e),(0,_intl_number_js__WEBPACK_IMPORTED_MODULE_3__.yx)(r)))).join(n)}function Y(e,t){if(e?.length&&t)return e.find((e=>e.fieldName?.toLowerCase()===t.toLowerCase()))}function ne(e,t,r,i){const{creatorField:o,creationDateField:a,editorField:l,editDateField:u}=e;if(!t)return;const s=(0,_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_8__.hv)(i&&"preferredTimeZone"in i?i.preferredTimeZone:null,!(!i||!("datesInUnknownTimezone"in i)||!i.datesInUnknownTimezone),r,Z,"date"),f={...Z,...s},c=t[u];if("number"==typeof c){const e=t[l];return{type:"edit",date:(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_2__.Yq)(c,f),user:e}}const d=t[a];if("number"==typeof d){const e=t[o];return{type:"create",date:(0,_intl_date_js__WEBPACK_IMPORTED_MODULE_2__.Yq)(d,f),user:e}}return null}function re(e,t){const n=new Map;return e?(e.forEach((e=>{const r=v(e.fieldName,t);e.fieldName=r,n.set(r.toLowerCase(),e)})),n):n}function ie(e){const t=[];if(!e)return t;const{fieldInfos:n,content:r}=e;return n&&t.push(...n),r&&Array.isArray(r)?(r.forEach((e=>{if("fields"===e.type){const n=e?.fieldInfos;n&&t.push(...n)}})),t):t}function oe(e){return e.replaceAll(w,(e=>`&#${e.charCodeAt(0)};`))}function ae(e){return"string"==typeof e?e.replaceAll(T,'<br class="esri-text-new-line" />'):e}function le(e){const{value:t,fieldName:n,fieldInfos:r,fieldInfoMap:i,layer:o,graphic:a,timeZone:l}=e;if(null==t)return"";const s=function te({fieldName:e,value:t,graphic:n,layer:r}){if(de(e))return null;if(!r||"function"!=typeof r.getFieldDomain)return null;const i=n&&r.getFieldDomain(e,{feature:n});return i&&"coded-value"===i.type?i.getName(t):null}({fieldName:n,value:t,graphic:a,layer:o});if(s)return s;const d=function ee({fieldName:e,graphic:t,layer:n}){if(de(e))return null;if(!n||"function"!=typeof n.getFeatureType)return null;const{typeIdField:r}=n;if(!r||e!==r)return null;const i=n.getFeatureType(t);return i?i.name:null}({fieldName:n,graphic:a,layer:o});if(d)return d;if(i.get(n.toLowerCase()))return V(t,{fieldInfos:r||Array.from(i.values()),fieldName:n,layer:o,timeZone:l});const p=o?.fieldsIndex?.get(n);return p&&((0,_smartMapping_support_utils_js__WEBPACK_IMPORTED_MODULE_6__.fs)(p)||(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.OH)(p))?(0,_smartMapping_support_utils_js__WEBPACK_IMPORTED_MODULE_6__.i0)(t,{fieldType:p.type,timeZoneOptions:{layerTimeZone:o&&"preferredTimeZone"in o?o.preferredTimeZone:null,viewTimeZone:l,datesInUnknownTimezone:!(!o||!("datesInUnknownTimezone"in o)||!o.datesInUnknownTimezone)}}):ae(t)}function ue({fieldInfos:e,attributes:t,layer:n,graphic:r,fieldInfoMap:i,relatedInfos:o,timeZone:a}){const l={};return o?.forEach((t=>function ye({attributes:e,relatedInfo:t,fieldInfoMap:n,fieldInfos:r,layer:i,timeZone:o}){e&&t&&(t.relatedFeatures?.forEach((a=>me({attributes:e,graphic:a,relatedInfo:t,fieldInfoMap:n,fieldInfos:r,layer:i,timeZone:o}))),t.relatedStatsFeatures?.forEach((a=>me({attributes:e,graphic:a,relatedInfo:t,fieldInfoMap:n,fieldInfos:r,layer:i,timeZone:o}))))}({attributes:l,relatedInfo:t,fieldInfoMap:i,fieldInfos:e,layer:n,timeZone:a}))),t&&Object.keys(t).forEach((o=>{const u=t[o];l[o]=le({fieldName:o,fieldInfos:e,fieldInfoMap:i,layer:n,value:u,graphic:r,timeZone:a})})),l}async function se(e,t){const{layer:n,graphic:r,outFields:i,objectIds:o,returnGeometry:a,spatialReference:l}=e,u=o[0];if("number"!=typeof u&&"string"!=typeof u){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:n,graphic:r,objectId:u,requiredFields:i};return y.warn(e,t),null}if(!(0,_layers_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_5__.BR)(n)?.operations?.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:n,graphic:r,requiredFields:i,returnGeometry:a};return y.warn(e,t),null}const f=n.createQuery();return f.objectIds=o,f.outFields=i?.length?i:[n.objectIdField],f.returnGeometry=!!a,f.returnZ=!!a,f.returnM=!!a,f.outSpatialReference=l,(await n.queryFeatures(f,t)).features[0]}async function ce({graphic:e,popupTemplate:t,layer:n,spatialReference:r},i){if(!n||!t)return;if("function"==typeof n.load&&await n.load(i),!e.attributes)return;const o=e.attributes[n.objectIdField];if(null==o)return;const a=[o],u=await t.getRequiredFields(n.fieldsIndex),s=(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_4__.Kl)(u,e),f=s?[]:u,c=t.returnGeometry||await async function fe(e){if(!e.expressionInfos?.length)return!1;const t=await(0,_support_arcadeOnDemand_js__WEBPACK_IMPORTED_MODULE_7__.lw)(),{arcadeUtils:{hasGeometryFunctions:n}}=t;return n(e)}(t);if(s&&!c)return;const d=await se({layer:n,graphic:e,outFields:f,objectIds:a,returnGeometry:c,spatialReference:r},i);d&&(d.geometry&&(e.geometry=d.geometry),d.attributes&&(e.attributes={...e.attributes,...d.attributes}))}function de(e=""){return!!e&&e.includes(j)}function me({attributes:e,graphic:t,relatedInfo:n,fieldInfos:r,fieldInfoMap:i,layer:o,timeZone:a}){e&&t&&n&&Object.keys(t.attributes).forEach((l=>{const u=function pe(e){return e?`${j}${e.layerId}/${e.fieldName}`:""}({layerId:n.relation.id.toString(),fieldName:l}),s=t.attributes[l];e[u]=le({fieldName:u,fieldInfos:r,fieldInfoMap:i,layer:o,value:s,graphic:t,timeZone:a})}))}const ge=e=>{if(!e)return!1;const t=e.toUpperCase();return t.includes("CURRENT_TIMESTAMP")||t.includes("CURRENT_DATE")||t.includes("CURRENT_TIME")},Ie=({layer:e,method:t,query:n,definitionExpression:r})=>{if(!e.capabilities?.query?.supportsCacheHint||"attachments"===t)return;const i=null!=n.where?n.where:null,o=null!=n.geometry?n.geometry:null;ge(r)||ge(i)||"extent"===o?.type||"tile"===n.resultType||(n.cacheHint=!0)},he=({query:e,layer:t,method:n})=>{Ie({layer:t,method:n,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression}`})},be=({queryPayload:e,layer:t,method:n})=>{Ie({layer:t,method:n,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression}`})};function Te(e,t,n){return e&&t&&n?we(e.allLayers,t,n)||we(e.allTables,t,n):null}function we(e,t,n){const r="scene"===t.type&&t.associatedLayer?t.associatedLayer.url:t.url;return e.filter(J).find((e=>e!==t&&e.url===r&&e.layerId===n.relatedTableId))}function Fe(e){const t=e.getObjectId();return null!=t?`oid:${t}`:`uid:${e.uid}`}}}]);